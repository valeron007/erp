<!-- Main Header -->
<header class="main-header">
  <nav class="navbar navbar-static-top">
    <div class="container">
      <div class="navbar-header">
        <a href="/dashboard" class="navbar-brand"><b>Gidroiz</b>Online</a>
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse">
          <i class="fa fa-bars"></i>
        </button>
      </div>

      <% if user_signed_in? %>
          <div class="collapse navbar-collapse pull-left" id="navbar-collapse">
            <ul class="nav navbar-nav">
              <% if has_daily_timesheets_access %>
                  <li class="<%= (controller_name == 'daily_timesheets')?'active':'' %>">
                    <%= link_to t('Daily Timesheets'), daily_timesheets_path %>
                  </li>
              <% end %>
              <% if has_daily_work_access %>
                  <li class="<%= (controller_name == 'daily_works')?'active':'' %>">
                    <%= link_to t('Daily Works'), daily_works_path %>
                  </li>
              <% end %>
              <% if has_leads_access %>
                  <li class="<%= (controller_name == 'leads')?'active':'' %>">
                    <%= link_to t('Leads'), leads_path %>
                  </li>
              <% end %>
              <% if has_deliveries_access %>
                  <li class="<%= (controller_name == 'deliveries')?'active':'' %>">
                    <%= link_to t('Deliveries'), deliveries_path %>
                  </li>
              <% end %>

              <% if has_storage_access %>
                  <li class="dropdown <%= (['s_materials','s_tools','s_others','s_transactions'].include?(controller_name))?'active':'' %>">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown"><%= t('Storage') %> <span class="caret"></span></a>
                    <ul class="dropdown-menu" role="menu">
                      <% if has_s_materials_access %>
                          <li class="<%= (controller_name == 's_materials')?'active':'' %>"><%= link_to t('Materials'), s_materials_path %></li>
                      <% end %>
                      <% if has_s_tools_access %>
                          <li class="<%= (controller_name == 's_tools')?'active':'' %>"><%= link_to t('Tools'), s_tools_path %></li>
                      <% end %>
                      <% if has_s_others_access %>
                          <li class="<%= (controller_name == 's_others')?'active':'' %>"><%= link_to t('Others'), s_others_path %></li>
                      <% end %>
                      <% if has_s_additionals_access %>
                          <li class="<%= (controller_name == 's_additionals')?'active':'' %>"><%= link_to t('Additionals'), s_additionals_path %></li>
                      <% end %>
                      <% if has_s_transactions_access %>
                          <li class="<%= (controller_name == 's_transactions')?'active':'' %>"><%= link_to t('Transactions'), s_transactions_path %></li>
                      <% end %>
                    </ul>
                  </li>
              <% end %>
              <% if has_management_access %>
                  <li class="dropdown <%= (['employees','facilities','tasks','expenses','documents', 'phone_search'].include?(controller_name))?'active':'' %>">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown"><%= t('References') %> <span class="caret"></span></a>
                    <ul class="dropdown-menu" role="menu">
                      <% if has_employees_access && has_contractors_access && has_clients_access %>
                        <li class="<%= (controller_name == 'phone_search')?'active':'' %>">
                          <%= link_to t('Phone Search'), phone_search_path %>
                        </li>
                        <li class="divider"></li>
                      <% end %>
                      <% if has_employees_access %>
                          <li class="<%= (controller_name == 'employees')?'active':'' %>">
                            <%= link_to t('Employees'), employees_path %>
                          </li>
                      <% end %>
                      <% if has_facilities_access %>
                          <li class="<%= (controller_name == 'facilities')?'active':'' %>">
                            <%= link_to t('Facilities'), facilities_path %>
                          </li>
                      <% end %>
                      <% if has_clients_access %>
                          <li class="<%= (controller_name == 'clients')?'active':'' %>">
                            <%= link_to t('Clients'), clients_path %>
                          </li>
                      <% end %>
                      <% if has_tasks_access %>
                          <li class="divider"></li>
                          <li class="<%= (controller_name == 'tasks')?'active':'' %>">
                            <%= link_to t('Tasks'), tasks_path %>
                          </li>
                      <% end %>
                      <% if has_expenses_access %>
                          <li class="<%= (controller_name == 'expenses')?'active':'' %>">
                            <%= link_to t('Expenses'), expenses_path %>
                          </li>
                      <% end %>
                      <% if has_documents_access %>
                          <li class="divider"></li>
                          <li class="<%= (controller_name == 'documents')?'active':'' %>">
                            <%= link_to t('Documents'), documents_path %>
                          </li>
                      <% end %>
                    </ul>
                  </li>
              <% end %>
              <% if has_reports_access %>
                  <li class="dropdown <%= (controller_name == 'report')?'active':'' %>">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown"><%= t('Reports') %> <span class="caret"></span></a>
                    <ul class="dropdown-menu" role="menu">
                      <% if has_employee_payments_report_access %><li class="<%= current_page?(report_employee_payments_path)?'active':'' %>"><%= link_to t('Employee Payments Report'), report_employee_payments_path %></li><% end %>
                      <% if has_facility_works_report_access %><li class="<%= current_page?(report_facility_works_url)?'active':'' %>"><%= link_to t('Facility Works Report'), report_facility_works_url %></li><% end %>
                      <% if has_labor_costs_report_access %><li class="<%= current_page?(report_labor_costs_path)?'active':'' %>"><%= link_to t('Labor Costs Report'), report_labor_costs_path %></li><% end %>
                      <% if has_work_efficiency_report_access %><li class="<%= current_page?(report_work_efficiency_path)?'active':'' %>"><%= link_to t('Work Efficiency Report'), report_work_efficiency_path %></li><% end %>
                      <% if has_daily_summary_report_access %><li class="<%= current_page?(report_daily_summary_path)?'active':'' %>"><%= link_to t('Daily Summary Report'), report_daily_summary_path %></li><% end %>
                      <% if has_calc_report_access %><li class="<%= current_page?(report_calc_path)?'active':'' %>"><%= link_to t('Calc Report'), report_calc_path %></li><% end %>
                      <% if has_dashboard_report_access %>
                          <li class="divider"></li>
                          <li class="<%= current_page?(report_dashboard_path)?'active':'' %>"><%= link_to t('Reports Dashboard'), report_dashboard_path %></li>
                      <% end %>
                    </ul>
                  </li>
              <% end %>
              <% if has_referenses_access %>
                  <li class="dropdown <%= (['positions','work_types','penalties','adoc_statuses','adoc_names','users'].include?(controller_name))?'active':'' %>">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown"><%= t('Management') %> <span class="caret"></span></a>
                    <ul class="dropdown-menu" role="menu">
                      <% if has_users_access %>
                        <li class="<%= (controller_name == 'call_records')?'active':'' %>">
                          <%= link_to t('Call Records'), callrecords_path %>
                        </li>
                        <li class="divider"></li>
                      <% end %>
                      <% if has_contact_access %><li class="<%= (controller_name == 'contacts')?'active':'' %>"><%= link_to t('Contacts'), contacts_path %></li><% end %>
                      <% if has_positions_access %><li class="<%= (controller_name == 'positions')?'active':'' %>"><%= link_to t('Positions'), positions_path %></li><% end %>
                      <% if has_penalties_access %><li class="<%= (controller_name == 'penalties')?'active':'' %>"><%= link_to t('Penalties'), penalties_path %></li><% end %>
                      <% if has_adoc_statuses_access %><li class="<%= (controller_name == 'adoc_statuses')?'active':'' %>"><%= link_to t('Adoc Statuses'), adoc_statuses_path %></li><% end %>
                      <% if has_adoc_names_access %><li class="<%= (controller_name == 'adoc_names')?'active':'' %>"><%= link_to t('Adoc Names'), adoc_names_path %></li><% end %>
                      <% if has_units_access %><li class="<%= (controller_name == 'units')?'active':'' %>"><%= link_to t('Units'), units_path %></li><% end %>

                      <% if has_works_access %>
                          <% if has_work_categories_access %>
                              <li class="<%= (controller_name == 'work_categories')?'active':'' %>"><%= link_to t('Work categories'), work_categories_path %></li>
                          <% end %>
                          <% if has_work_types_access %>
                              <li class="<%= (controller_name == 'work_types')?'active':'' %>"><%= link_to t('Work types'), work_types_path %></li>
                          <% end %>
                          <li class="divider"></li>
                      <% end %>

                      <% if has_warehouse_access %>
                          <% if has_tools_access %>
                              <li class="<%= (controller_name == 'tools')?'active':'' %>"><%= link_to t('Tools'), tools_path %></li>
                          <% end %>
                          <% if has_materials_access %>
                              <li class="<%= (controller_name == 'materials')?'active':'' %>"><%= link_to t('Materials'), materials_path %></li>
                          <% end %>
                          <% if has_others_access %>
                              <li class="<%= (controller_name == 'others')?'active':'' %>"><%= link_to t('Others'), others_path %></li>
                          <% end %>
                          <% if has_additional_access %>
                              <li class="<%= (controller_name == 'additionals')?'active':'' %>"><%= link_to t('Additionals'), additionals_path %></li>
                          <% end %>
                          <% if has_inventory_type_access %>
                              <li class="<%= (controller_name == 'inventory_types')?'active':'' %>"><%= link_to t('Inventory Types'), inventory_types_path %></li>
                          <% end %>
                          <li class="divider"></li>
                      <% end %>

                      <% if has_contractors_access %>
                          <li class="<%= (controller_name == 'contractors')?'active':'' %>"><%= link_to t('Contractors'), contractors_path %></li>
                      <% end %>
                      <% if has_transport_companies_access %>
                          <li class="<%= (controller_name == 'transport_companies')?'active':'' %>"><%= link_to t('Transport companies'), transport_companies_path %></li>
                      <% end %>
                      <% if has_delivery_letters_access %>
                          <li class="<%= (controller_name == 'delivery_letters')?'active':'' %>"><%= link_to t('Delivery letters'), delivery_letters_path %></li>
                      <% end %>

                      <% if has_kpi_access %>
                          <li class="<%= (controller_name == 'kpi')?'active':'' %>"><%= link_to t('KPI'), kpis_path %></li>
                      <% end %>

                      <% if has_users_access %>
                          <li class="divider"></li>
                          <li class="<%= (controller_name == 'users')?'active':'' %>">
                            <%= link_to t('Users'), users_path %>
                          </li>
                      <% end %>
                    </ul>
                  </li>
              <% end %>
            </ul>
          </div><!-- /.navbar-collapse -->

          <div class="navbar-custom-menu">
            <ul class="nav navbar-nav">

              <!-- User Account Menu -->
              <li class="dropdown user user-menu">
                <!-- Menu Toggle Button -->
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                  <!-- The user image in the navbar-->
                  <%= image_tag 'default-avatar-160x160.png', 'class' => 'user-image' %>
                  <!-- hidden-xs hides the username on small devices so only the image appears. -->
                  <span class="hidden-xs"><%= current_user.name %></span>
                  <% if count_assigned_tasks(current_user) > 0 %>
                    <span class="badge bg-red">
                      <%= count_assigned_tasks(current_user) %>
                    </span>
                  <% end %>
                </a>
                <ul class="dropdown-menu">
                  <!-- The user image in the menu -->
                  <li class="user-header">
                    <%= image_tag 'default-avatar-160x160.png', 'class' => 'img-circle' %>
                    <p>
                      <%= current_user.name %>
                      <small><%= t('Member since') %> <%= current_user.created_at.strftime("%b. %Y") %></small>
                    </p>
                  </li>
                  <!-- Menu Body -->
                  <li class="user-body">
                    <div class="col-xs-12 text-center">
                      <% if count_assigned_tasks(current_user) > 0 %>
                        <%= link_to tasks_path do %>
                          <span class="badge bg-red">
                            <%= count_assigned_tasks(current_user) %>
                          </span>
                          <%= t("Tasks") %>
                        <% end %>
                      <% end %>
                    </div>
                  </li>
                  <!-- Menu Footer-->
                  <li class="user-footer">
                    <!--<div class="pull-left">
                      <a href="#" class="btn btn-default btn-flat">Profile</a>
                    </div>-->
                    <div class="pull-right">
                      <%= link_to(t('Sign out'), destroy_user_session_path, :method => :delete, 'class' => 'btn btn-default btn-flat') %>
                    </div>
                  </li>
                </ul>
              </li>
            </ul>
          </div><!-- /.navbar-custom-menu -->
      <% end %>
    </div><!-- /.container-fluid -->
  </nav>
</header>