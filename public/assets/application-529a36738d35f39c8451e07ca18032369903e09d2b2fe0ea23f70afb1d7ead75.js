/*!
 * jQuery JavaScript Library v1.12.4
 * http://jquery.com/
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2016-05-20T17:17Z
 */
function _init(){"use strict";$.AdminLTE.layout={activate:function(){var e=this;e.fix(),e.fixSidebar(),$(window,".wrapper").resize(function(){e.fix(),e.fixSidebar()})},fix:function(){var e=$(".main-header").outerHeight()+$(".main-footer").outerHeight(),t=$(window).height(),o=$(".sidebar").height();if($("body").hasClass("fixed"))$(".content-wrapper, .right-side").css("min-height",t-$(".main-footer").outerHeight());else{var n;t>=o?($(".content-wrapper, .right-side").css("min-height",t-e),n=t-e):($(".content-wrapper, .right-side").css("min-height",o),n=o);var r=$($.AdminLTE.options.controlSidebarOptions.selector);void 0!==r&&r.height()>n&&$(".content-wrapper, .right-side").css("min-height",r.height())}},fixSidebar:function(){if(!$("body").hasClass("fixed"))return void("undefined"!=typeof $.fn.slimScroll&&$(".sidebar").slimScroll({destroy:!0}).height("auto"));"undefined"==typeof $.fn.slimScroll&&window.console&&window.console.error("Error: the fixed layout requires the slimscroll plugin!"),$.AdminLTE.options.sidebarSlimScroll&&"undefined"!=typeof $.fn.slimScroll&&($(".sidebar").slimScroll({destroy:!0}).height("auto"),$(".sidebar").slimscroll({height:$(window).height()-$(".main-header").height()+"px",color:"rgba(0,0,0,0.2)",size:"3px"}))}},$.AdminLTE.pushMenu={activate:function(e){var t=$.AdminLTE.options.screenSizes;$(e).on("click",function(e){e.preventDefault(),$(window).width()>t.sm-1?$("body").hasClass("sidebar-collapse")?$("body").removeClass("sidebar-collapse").trigger("expanded.pushMenu"):$("body").addClass("sidebar-collapse").trigger("collapsed.pushMenu"):$("body").hasClass("sidebar-open")?$("body").removeClass("sidebar-open").removeClass("sidebar-collapse").trigger("collapsed.pushMenu"):$("body").addClass("sidebar-open").trigger("expanded.pushMenu")}),$(".content-wrapper").click(function(){$(window).width()<=t.sm-1&&$("body").hasClass("sidebar-open")&&$("body").removeClass("sidebar-open")}),($.AdminLTE.options.sidebarExpandOnHover||$("body").hasClass("fixed")&&$("body").hasClass("sidebar-mini"))&&this.expandOnHover()},expandOnHover:function(){var e=this,t=$.AdminLTE.options.screenSizes.sm-1;$(".main-sidebar").hover(function(){$("body").hasClass("sidebar-mini")&&$("body").hasClass("sidebar-collapse")&&$(window).width()>t&&e.expand()},function(){$("body").hasClass("sidebar-mini")&&$("body").hasClass("sidebar-expanded-on-hover")&&$(window).width()>t&&e.collapse()})},expand:function(){$("body").removeClass("sidebar-collapse").addClass("sidebar-expanded-on-hover")},collapse:function(){$("body").hasClass("sidebar-expanded-on-hover")&&$("body").removeClass("sidebar-expanded-on-hover").addClass("sidebar-collapse")}},$.AdminLTE.tree=function(e){var t=this,o=$.AdminLTE.options.animationSpeed;$(document).on("click",e+" li a",function(e){var n=$(this),r=n.next();if(r.is(".treeview-menu")&&r.is(":visible"))r.slideUp(o,function(){r.removeClass("menu-open")}),r.parent("li").removeClass("active");else if(r.is(".treeview-menu")&&!r.is(":visible")){var i=n.parents("ul").first(),a=i.find("ul:visible").slideUp(o);a.removeClass("menu-open");var s=n.parent("li");r.slideDown(o,function(){r.addClass("menu-open"),i.find("li.active").removeClass("active"),s.addClass("active"),t.layout.fix()})}r.is(".treeview-menu")&&e.preventDefault()})},$.AdminLTE.controlSidebar={activate:function(){var e=this,t=$.AdminLTE.options.controlSidebarOptions,o=$(t.selector);$(t.toggleBtnSelector).on("click",function(n){n.preventDefault(),o.hasClass("control-sidebar-open")||$("body").hasClass("control-sidebar-open")?e.close(o,t.slide):e.open(o,t.slide)});var n=$(".control-sidebar-bg");e._fix(n),$("body").hasClass("fixed")?e._fixForFixed(o):$(".content-wrapper, .right-side").height()<o.height()&&e._fixForContent(o)},open:function(e,t){t?e.addClass("control-sidebar-open"):$("body").addClass("control-sidebar-open")},close:function(e,t){t?e.removeClass("control-sidebar-open"):$("body").removeClass("control-sidebar-open")},_fix:function(e){var t=this;$("body").hasClass("layout-boxed")?(e.css("position","absolute"),e.height($(".wrapper").height()),$(window).resize(function(){t._fix(e)})):e.css({position:"fixed",height:"auto"})},_fixForFixed:function(e){e.css({position:"fixed","max-height":"100%",overflow:"auto","padding-bottom":"50px"})},_fixForContent:function(e){$(".content-wrapper, .right-side").css("min-height",e.height())}},$.AdminLTE.boxWidget={selectors:$.AdminLTE.options.boxWidgetOptions.boxWidgetSelectors,icons:$.AdminLTE.options.boxWidgetOptions.boxWidgetIcons,animationSpeed:$.AdminLTE.options.animationSpeed,activate:function(e){var t=this;e||(e=document),$(e).on("click",t.selectors.collapse,function(e){e.preventDefault(),t.collapse($(this))}),$(e).on("click",t.selectors.remove,function(e){e.preventDefault(),t.remove($(this))})},collapse:function(e){var t=this,o=e.parents(".box").first(),n=o.find("> .box-body, > .box-footer, > form  >.box-body, > form > .box-footer");o.hasClass("collapsed-box")?(e.children(":first").removeClass(t.icons.open).addClass(t.icons.collapse),n.slideDown(t.animationSpeed,function(){o.removeClass("collapsed-box")})):(e.children(":first").removeClass(t.icons.collapse).addClass(t.icons.open),n.slideUp(t.animationSpeed,function(){o.addClass("collapsed-box")}))},remove:function(e){e.parents(".box").first().slideUp(this.animationSpeed)}}}/*! AdminLTE app.js
 * ================
 * Main JS application file for AdminLTE v2. This file
 * should be included in all pages. It controls some layout
 * options and implements exclusive AdminLTE plugins.
 *
 * @Author  Almsaeed Studio
 * @Support <http://www.almsaeedstudio.com>
 * @Email   <support@almsaeedstudio.com>
 * @version 2.3.0
 * @license MIT <http://opensource.org/licenses/MIT>
 */
if(function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){function o(e){var t=!!e&&"length"in e&&e.length,o=he.type(e);return"function"!==o&&!he.isWindow(e)&&("array"===o||0===t||"number"==typeof t&&t>0&&t-1 in e)}function n(e,t,o){if(he.isFunction(t))return he.grep(e,function(e,n){return!!t.call(e,n,e)!==o});if(t.nodeType)return he.grep(e,function(e){return e===t!==o});if("string"==typeof t){if(Se.test(t))return he.filter(t,e,o);t=he.filter(t,e)}return he.grep(e,function(e){return he.inArray(e,t)>-1!==o})}function r(e,t){do{e=e[t]}while(e&&1!==e.nodeType);return e}function i(e){var t={};return he.each(e.match(Fe)||[],function(e,o){t[o]=!0}),t}function a(){ne.addEventListener?(ne.removeEventListener("DOMContentLoaded",s),e.removeEventListener("load",s)):(ne.detachEvent("onreadystatechange",s),e.detachEvent("onload",s))}function s(){(ne.addEventListener||"load"===e.event.type||"complete"===ne.readyState)&&(a(),he.ready())}function l(e,t,o){if(o===undefined&&1===e.nodeType){var n="data-"+t.replace(Le,"-$1").toLowerCase();if("string"==typeof(o=e.getAttribute(n))){try{o="true"===o||"false"!==o&&("null"===o?null:+o+""===o?+o:Pe.test(o)?he.parseJSON(o):o)}catch(e){}he.data(e,t,o)}else o=undefined}return o}function c(e){var t;for(t in e)if(("data"!==t||!he.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function d(e,t,o,n){if(Ae(e)){var r,i,a=he.expando,s=e.nodeType,l=s?he.cache:e,c=s?e[a]:e[a]&&a;if(c&&l[c]&&(n||l[c].data)||o!==undefined||"string"!=typeof t)return c||(c=s?e[a]=oe.pop()||he.guid++:a),l[c]||(l[c]=s?{}:{toJSON:he.noop}),"object"!=typeof t&&"function"!=typeof t||(n?l[c]=he.extend(l[c],t):l[c].data=he.extend(l[c].data,t)),i=l[c],n||(i.data||(i.data={}),i=i.data),o!==undefined&&(i[he.camelCase(t)]=o),"string"==typeof t?null==(r=i[t])&&(r=i[he.camelCase(t)]):r=i,r}}function u(e,t,o){if(Ae(e)){var n,r,i=e.nodeType,a=i?he.cache:e,s=i?e[he.expando]:he.expando;if(a[s]){if(t&&(n=o?a[s]:a[s].data)){he.isArray(t)?t=t.concat(he.map(t,he.camelCase)):t in n?t=[t]:(t=he.camelCase(t),t=t in n?[t]:t.split(" ")),r=t.length;for(;r--;)delete n[t[r]];if(o?!c(n):!he.isEmptyObject(n))return}(o||(delete a[s].data,c(a[s])))&&(i?he.cleanData([e],!0):ue.deleteExpando||a!=a.window?delete a[s]:a[s]=undefined)}}}function p(e,t,o,n){var r,i=1,a=20,s=n?function(){return n.cur()}:function(){return he.css(e,t,"")},l=s(),c=o&&o[3]||(he.cssNumber[t]?"":"px"),d=(he.cssNumber[t]||"px"!==c&&+l)&&Ie.exec(he.css(e,t));if(d&&d[3]!==c){c=c||d[3],o=o||[],d=+l||1;do{i=i||".5",d/=i,he.style(e,t,d+c)}while(i!==(i=s()/l)&&1!==i&&--a)}return o&&(d=+d||+l||0,r=o[1]?d+(o[1]+1)*o[2]:+o[2],n&&(n.unit=c,n.start=d,n.end=r)),r}function h(e){var t=ze.split("|"),o=e.createDocumentFragment();if(o.createElement)for(;t.length;)o.createElement(t.pop());return o}function f(e,t){var o,n,r=0,i="undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t||"*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll(t||"*"):undefined;if(!i)for(i=[],o=e.childNodes||e;null!=(n=o[r]);r++)!t||he.nodeName(n,t)?i.push(n):he.merge(i,f(n,t));return t===undefined||t&&he.nodeName(e,t)?he.merge([e],i):i}function m(e,t){for(var o,n=0;null!=(o=e[n]);n++)he._data(o,"globalEval",!t||he._data(t[n],"globalEval"))}function g(e){Ue.test(e.type)&&(e.defaultChecked=e.checked)}function v(e,t,o,n,r){for(var i,a,s,l,c,d,u,p=e.length,v=h(t),y=[],b=0;b<p;b++)if((a=e[b])||0===a)if("object"===he.type(a))he.merge(y,a.nodeType?[a]:a);else if(Ye.test(a)){for(l=l||v.appendChild(t.createElement("div")),c=(je.exec(a)||["",""])[1].toLowerCase(),u=Ve[c]||Ve._default,l.innerHTML=u[1]+he.htmlPrefilter(a)+u[2],i=u[0];i--;)l=l.lastChild;if(!ue.leadingWhitespace&&Be.test(a)&&y.push(t.createTextNode(Be.exec(a)[0])),!ue.tbody)for(a="table"!==c||Ge.test(a)?"<table>"!==u[1]||Ge.test(a)?0:l:l.firstChild,i=a&&a.childNodes.length;i--;)he.nodeName(d=a.childNodes[i],"tbody")&&!d.childNodes.length&&a.removeChild(d);for(he.merge(y,l.childNodes),l.textContent="";l.firstChild;)l.removeChild(l.firstChild);l=v.lastChild}else y.push(t.createTextNode(a));for(l&&v.removeChild(l),ue.appendChecked||he.grep(f(y,"input"),g),b=0;a=y[b++];)if(n&&he.inArray(a,n)>-1)r&&r.push(a);else if(s=he.contains(a.ownerDocument,a),l=f(v.appendChild(a),"script"),s&&m(l),o)for(i=0;a=l[i++];)He.test(a.type||"")&&o.push(a);return l=null,v}function y(){return!0}function b(){return!1}function C(){try{return ne.activeElement}catch(e){}}function w(e,t,o,n,r,i){var a,s;if("object"==typeof t){"string"!=typeof o&&(n=n||o,o=undefined);for(s in t)w(e,s,o,n,t[s],i);return e}if(null==n&&null==r?(r=o,n=o=undefined):null==r&&("string"==typeof o?(r=n,n=undefined):(r=n,n=o,o=undefined)),!1===r)r=b;else if(!r)return e;return 1===i&&(a=r,r=function(e){return he().off(e),a.apply(this,arguments)},r.guid=a.guid||(a.guid=he.guid++)),e.each(function(){he.event.add(this,t,r,n,o)})}function x(e,t){return he.nodeName(e,"table")&&he.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function S(e){return e.type=(null!==he.find.attr(e,"type"))+"/"+e.type,e}function _(e){var t=nt.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function k(e,t){if(1===t.nodeType&&he.hasData(e)){var o,n,r,i=he._data(e),a=he._data(t,i),s=i.events;if(s){delete a.handle,a.events={};for(o in s)for(n=0,r=s[o].length;n<r;n++)he.event.add(t,o,s[o][n])}a.data&&(a.data=he.extend({},a.data))}}function T(e,t){var o,n,r;if(1===t.nodeType){if(o=t.nodeName.toLowerCase(),!ue.noCloneEvent&&t[he.expando]){r=he._data(t);for(n in r.events)he.removeEvent(t,n,r.handle);t.removeAttribute(he.expando)}"script"===o&&t.text!==e.text?(S(t).text=e.text,_(t)):"object"===o?(t.parentNode&&(t.outerHTML=e.outerHTML),ue.html5Clone&&e.innerHTML&&!he.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===o&&Ue.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===o?t.defaultSelected=t.selected=e.defaultSelected:"input"!==o&&"textarea"!==o||(t.defaultValue=e.defaultValue)}}function E(e,t,o,n){t=ie.apply([],t);var r,i,a,s,l,c,d=0,u=e.length,p=u-1,h=t[0],m=he.isFunction(h);if(m||u>1&&"string"==typeof h&&!ue.checkClone&&ot.test(h))return e.each(function(r){var i=e.eq(r);m&&(t[0]=h.call(this,r,i.html())),E(i,t,o,n)});if(u&&(c=v(t,e[0].ownerDocument,!1,e,n),r=c.firstChild,1===c.childNodes.length&&(c=r),r||n)){for(s=he.map(f(c,"script"),S),a=s.length;d<u;d++)i=c,d!==p&&(i=he.clone(i,!0,!0),a&&he.merge(s,f(i,"script"))),o.call(e[d],i,d);if(a)for(l=s[s.length-1].ownerDocument,he.map(s,_),d=0;d<a;d++)i=s[d],He.test(i.type||"")&&!he._data(i,"globalEval")&&he.contains(l,i)&&(i.src?he._evalUrl&&he._evalUrl(i.src):he.globalEval((i.text||i.textContent||i.innerHTML||"").replace(rt,"")));c=r=null}return e}function F(e,t,o){for(var n,r=t?he.filter(t,e):e,i=0;null!=(n=r[i]);i++)o||1!==n.nodeType||he.cleanData(f(n)),n.parentNode&&(o&&he.contains(n.ownerDocument,n)&&m(f(n,"script")),n.parentNode.removeChild(n));return e}function D(e,t){var o=he(t.createElement(e)).appendTo(t.body),n=he.css(o[0],"display");return o.detach(),n}function M(e){var t=ne,o=lt[e];return o||(o=D(e,t),"none"!==o&&o||(st=(st||he("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement),t=(st[0].contentWindow||st[0].contentDocument).document,t.write(),t.close(),o=D(e,t),st.detach()),lt[e]=o),o}function A(e,t){return{get:function(){return e()?void delete this.get:(this.get=t).apply(this,arguments)}}}function P(e){if(e in St)return e;for(var t=e.charAt(0).toUpperCase()+e.slice(1),o=xt.length;o--;)if((e=xt[o]+t)in St)return e}function L(e,t){for(var o,n,r,i=[],a=0,s=e.length;a<s;a++)n=e[a],n.style&&(i[a]=he._data(n,"olddisplay"),o=n.style.display,t?(i[a]||"none"!==o||(n.style.display=""),""===n.style.display&&$e(n)&&(i[a]=he._data(n,"olddisplay",M(n.nodeName)))):(r=$e(n),(o&&"none"!==o||!r)&&he._data(n,"olddisplay",r?o:he.css(n,"display"))));for(a=0;a<s;a++)n=e[a],n.style&&(t&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=t?i[a]||"":"none"));return e}function R(e,t,o){var n=bt.exec(t);return n?Math.max(0,n[1]-(o||0))+(n[2]||"px"):t}function I(e,t,o,n,r){for(var i=o===(n?"border":"content")?4:"width"===t?1:0,a=0;i<4;i+=2)"margin"===o&&(a+=he.css(e,o+Oe[i],!0,r)),n?("content"===o&&(a-=he.css(e,"padding"+Oe[i],!0,r)),"margin"!==o&&(a-=he.css(e,"border"+Oe[i]+"Width",!0,r))):(a+=he.css(e,"padding"+Oe[i],!0,r),"padding"!==o&&(a+=he.css(e,"border"+Oe[i]+"Width",!0,r)));return a}function O(e,t,o){var n=!0,r="width"===t?e.offsetWidth:e.offsetHeight,i=ht(e),a=ue.boxSizing&&"border-box"===he.css(e,"boxSizing",!1,i);if(r<=0||null==r){if(r=ft(e,t,i),(r<0||null==r)&&(r=e.style[t]),dt.test(r))return r;n=a&&(ue.boxSizingReliable()||r===e.style[t]),r=parseFloat(r)||0}return r+I(e,t,o||(a?"border":"content"),n,i)+"px"}function $(e,t,o,n,r){return new $.prototype.init(e,t,o,n,r)}function N(){return e.setTimeout(function(){_t=undefined}),_t=he.now()}function U(e,t){var o,n={height:e},r=0;for(t=t?1:0;r<4;r+=2-t)o=Oe[r],n["margin"+o]=n["padding"+o]=e;return t&&(n.opacity=n.width=e),n}function j(e,t,o){for(var n,r=(z.tweeners[t]||[]).concat(z.tweeners["*"]),i=0,a=r.length;i<a;i++)if(n=r[i].call(o,t,e))return n}function H(e,t,o){var n,r,i,a,s,l,c,d=this,u={},p=e.style,h=e.nodeType&&$e(e),f=he._data(e,"fxshow");o.queue||(s=he._queueHooks(e,"fx"),null==s.unqueued&&(s.unqueued=0,l=s.empty.fire,s.empty.fire=function(){s.unqueued||l()}),s.unqueued++,d.always(function(){d.always(function(){s.unqueued--,he.queue(e,"fx").length||s.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(o.overflow=[p.overflow,p.overflowX,p.overflowY],c=he.css(e,"display"),"inline"===("none"===c?he._data(e,"olddisplay")||M(e.nodeName):c)&&"none"===he.css(e,"float")&&(ue.inlineBlockNeedsLayout&&"inline"!==M(e.nodeName)?p.zoom=1:p.display="inline-block")),o.overflow&&(p.overflow="hidden",ue.shrinkWrapBlocks()||d.always(function(){p.overflow=o.overflow[0],p.overflowX=o.overflow[1],p.overflowY=o.overflow[2]}));for(n in t)if(r=t[n],Tt.exec(r)){if(delete t[n],i=i||"toggle"===r,r===(h?"hide":"show")){if("show"!==r||!f||f[n]===undefined)continue;h=!0}u[n]=f&&f[n]||he.style(e,n)}else c=undefined;if(he.isEmptyObject(u))"inline"===("none"===c?M(e.nodeName):c)&&(p.display=c);else{f?"hidden"in f&&(h=f.hidden):f=he._data(e,"fxshow",{}),i&&(f.hidden=!h),h?he(e).show():d.done(function(){he(e).hide()}),d.done(function(){var t;he._removeData(e,"fxshow");for(t in u)he.style(e,t,u[t])});for(n in u)a=j(h?f[n]:0,n,d),n in f||(f[n]=a.start,h&&(a.end=a.start,a.start="width"===n||"height"===n?1:0))}}function B(e,t){var o,n,r,i,a;for(o in e)if(n=he.camelCase(o),r=t[n],i=e[o],he.isArray(i)&&(r=i[1],i=e[o]=i[0]),o!==n&&(e[n]=i,delete e[o]),(a=he.cssHooks[n])&&"expand"in a){i=a.expand(i),delete e[n];for(o in i)o in e||(e[o]=i[o],t[o]=r)}else t[n]=r}function z(e,t,o){var n,r,i=0,a=z.prefilters.length,s=he.Deferred().always(function(){delete l.elem}),l=function(){if(r)return!1;for(var t=_t||N(),o=Math.max(0,c.startTime+c.duration-t),n=o/c.duration||0,i=1-n,a=0,l=c.tweens.length;a<l;a++)c.tweens[a].run(i);return s.notifyWith(e,[c,i,o]),i<1&&l?o:(s.resolveWith(e,[c]),!1)},c=s.promise({elem:e,props:he.extend({},t),opts:he.extend(!0,{specialEasing:{},easing:he.easing._default},o),originalProperties:t,originalOptions:o,startTime:_t||N(),duration:o.duration,tweens:[],createTween:function(t,o){var n=he.Tween(e,c.opts,t,o,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(n),n},stop:function(t){var o=0,n=t?c.tweens.length:0;if(r)return this;for(r=!0;o<n;o++)c.tweens[o].run(1);return t?(s.notifyWith(e,[c,1,0]),s.resolveWith(e,[c,t])):s.rejectWith(e,[c,t]),this}}),d=c.props;for(B(d,c.opts.specialEasing);i<a;i++)if(n=z.prefilters[i].call(c,e,d,c.opts))return he.isFunction(n.stop)&&(he._queueHooks(c.elem,c.opts.queue).stop=he.proxy(n.stop,n)),n;return he.map(d,j,c),he.isFunction(c.opts.start)&&c.opts.start.call(e,c),he.fx.timer(he.extend(l,{elem:e,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}function V(e){return he.attr(e,"class")||""}function Y(e){return function(t,o){"string"!=typeof t&&(o=t,t="*");var n,r=0,i=t.toLowerCase().match(Fe)||[];if(he.isFunction(o))for(;n=i[r++];)"+"===n.charAt(0)?(n=n.slice(1)||"*",(e[n]=e[n]||[]).unshift(o)):(e[n]=e[n]||[]).push(o)}}function G(e,t,o,n){function r(s){var l;return i[s]=!0,he.each(e[s]||[],function(e,s){var c=s(t,o,n);return"string"!=typeof c||a||i[c]?a?!(l=c):void 0:(t.dataTypes.unshift(c),r(c),!1)}),l}var i={},a=e===Qt;return r(t.dataTypes[0])||!i["*"]&&r("*")}function W(e,t){var o,n,r=he.ajaxSettings.flatOptions||{};for(n in t)t[n]!==undefined&&((r[n]?e:o||(o={}))[n]=t[n]);return o&&he.extend(!0,e,o),e}function q(e,t,o){for(var n,r,i,a,s=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),r===undefined&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(a in s)if(s[a]&&s[a].test(r)){l.unshift(a);break}if(l[0]in o)i=l[0];else{for(a in o){if(!l[0]||e.converters[a+" "+l[0]]){i=a;break}n||(n=a)}i=i||n}if(i)return i!==l[0]&&l.unshift(i),o[i]}function K(e,t,o,n){var r,i,a,s,l,c={},d=e.dataTypes.slice();if(d[1])for(a in e.converters)c[a.toLowerCase()]=e.converters[a];for(i=d.shift();i;)if(e.responseFields[i]&&(o[e.responseFields[i]]=t),!l&&n&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=i,i=d.shift())if("*"===i)i=l;else if("*"!==l&&l!==i){if(!(a=c[l+" "+i]||c["* "+i]))for(r in c)if(s=r.split(" "),s[1]===i&&(a=c[l+" "+s[0]]||c["* "+s[0]])){!0===a?a=c[r]:!0!==c[r]&&(i=s[0],d.unshift(s[1]));break}if(!0!==a)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(e){return{state:"parsererror",error:a?e:"No conversion from "+l+" to "+i}}}return{state:"success",data:t}}function X(e){return e.style&&e.style.display||he.css(e,"display")}function Q(e){if(!he.contains(e.ownerDocument||ne,e))return!0;for(;e&&1===e.nodeType;){if("none"===X(e)||"hidden"===e.type)return!0;e=e.parentNode}return!1}function Z(e,t,o,n){var r;if(he.isArray(t))he.each(t,function(t,r){o||oo.test(e)?n(e,r):Z(e+"["+("object"==typeof r&&null!=r?t:"")+"]",r,o,n)});else if(o||"object"!==he.type(t))n(e,t);else for(r in t)Z(e+"["+r+"]",t[r],o,n)}function J(){try{return new e.XMLHttpRequest}catch(e){}}function ee(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}function te(e){return he.isWindow(e)?e:9===e.nodeType&&(e.defaultView||e.parentWindow)}var oe=[],ne=e.document,re=oe.slice,ie=oe.concat,ae=oe.push,se=oe.indexOf,le={},ce=le.toString,de=le.hasOwnProperty,ue={},pe="1.12.4",he=function(e,t){return new he.fn.init(e,t)},fe=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,me=/^-ms-/,ge=/-([\da-z])/gi,ve=function(e,t){return t.toUpperCase()};he.fn=he.prototype={jquery:pe,constructor:he,selector:"",length:0,toArray:function(){return re.call(this)},get:function(e){return null!=e?e<0?this[e+this.length]:this[e]:re.call(this)},pushStack:function(e){var t=he.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e){return he.each(this,e)},map:function(e){return this.pushStack(he.map(this,function(t,o){return e.call(t,o,t)}))},slice:function(){return this.pushStack(re.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,o=+e+(e<0?t:0);return this.pushStack(o>=0&&o<t?[this[o]]:[])},end:function(){return this.prevObject||this.constructor()},push:ae,sort:oe.sort,splice:oe.splice},he.extend=he.fn.extend=function(){var e,t,o,n,r,i,a=arguments[0]||{},s=1,l=arguments.length,c=!1;for("boolean"==typeof a&&(c=a,a=arguments[s]||{},s++),"object"==typeof a||he.isFunction(a)||(a={}),s===l&&(a=this,s--);s<l;s++)if(null!=(r=arguments[s]))for(n in r)e=a[n],o=r[n],a!==o&&(c&&o&&(he.isPlainObject(o)||(t=he.isArray(o)))?(t?(t=!1,i=e&&he.isArray(e)?e:[]):i=e&&he.isPlainObject(e)?e:{},a[n]=he.extend(c,i,o)):o!==undefined&&(a[n]=o));return a},he.extend({expando:"jQuery"+(pe+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===he.type(e)},isArray:Array.isArray||function(e){return"array"===he.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){var t=e&&e.toString();return!he.isArray(e)&&t-parseFloat(t)+1>=0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},isPlainObject:function(e){var t;if(!e||"object"!==he.type(e)||e.nodeType||he.isWindow(e))return!1;try{if(e.constructor&&!de.call(e,"constructor")&&!de.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}if(!ue.ownFirst)for(t in e)return de.call(e,t);for(t in e);return t===undefined||de.call(e,t)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?le[ce.call(e)]||"object":typeof e},globalEval:function(t){t&&he.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(me,"ms-").replace(ge,ve)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t){var n,r=0;if(o(e))for(n=e.length;r<n&&!1!==t.call(e[r],r,e[r]);r++);else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},trim:function(e){return null==e?"":(e+"").replace(fe,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(o(Object(e))?he.merge(n,"string"==typeof e?[e]:e):ae.call(n,e)),n},inArray:function(e,t,o){var n;if(t){if(se)return se.call(t,e,o);for(n=t.length,o=o?o<0?Math.max(0,n+o):o:0;o<n;o++)if(o in t&&t[o]===e)return o}return-1},merge:function(e,t){for(var o=+t.length,n=0,r=e.length;n<o;)e[r++]=t[n++];if(o!==o)for(;t[n]!==undefined;)e[r++]=t[n++];return e.length=r,e},grep:function(e,t,o){for(var n=[],r=0,i=e.length,a=!o;r<i;r++)!t(e[r],r)!==a&&n.push(e[r]);return n},map:function(e,t,n){var r,i,a=0,s=[];if(o(e))for(r=e.length;a<r;a++)null!=(i=t(e[a],a,n))&&s.push(i);else for(a in e)null!=(i=t(e[a],a,n))&&s.push(i);return ie.apply([],s)},guid:1,proxy:function(e,t){var o,n,r;return"string"==typeof t&&(r=e[t],t=e,e=r),he.isFunction(e)?(o=re.call(arguments,2),n=function(){return e.apply(t||this,o.concat(re.call(arguments)))},n.guid=e.guid=e.guid||he.guid++,n):undefined},now:function(){return+new Date},support:ue}),"function"==typeof Symbol&&(he.fn[Symbol.iterator]=oe[Symbol.iterator]),he.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){le["[object "+t+"]"]=t.toLowerCase()});var ye=/*!
 * Sizzle CSS Selector Engine v2.2.1
 * http://sizzlejs.com/
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2015-10-17
 */
function(e){function t(e,t,o,n){var r,i,a,s,l,c,u,h,f=t&&t.ownerDocument,m=t?t.nodeType:9;if(o=o||[],"string"!=typeof e||!e||1!==m&&9!==m&&11!==m)return o;if(!n&&((t?t.ownerDocument||t:j)!==P&&A(t),t=t||P,R)){if(11!==m&&(c=ve.exec(e)))if(r=c[1]){if(9===m){if(!(a=t.getElementById(r)))return o;if(a.id===r)return o.push(a),o}else if(f&&(a=f.getElementById(r))&&N(t,a)&&a.id===r)return o.push(a),o}else{if(c[2])return Z.apply(o,t.getElementsByTagName(e)),o;if((r=c[3])&&w.getElementsByClassName&&t.getElementsByClassName)return Z.apply(o,t.getElementsByClassName(r)),o}if(w.qsa&&!Y[e+" "]&&(!I||!I.test(e))){if(1!==m)f=t,h=e;else if("object"!==t.nodeName.toLowerCase()){for((s=t.getAttribute("id"))?s=s.replace(be,"\\$&"):t.setAttribute("id",s=U),u=k(e),i=u.length,l=pe.test(s)?"#"+s:"[id='"+s+"']";i--;)u[i]=l+" "+p(u[i]);h=u.join(","),f=ye.test(e)&&d(t.parentNode)||t}if(h)try{return Z.apply(o,f.querySelectorAll(h)),o}catch(e){}finally{s===U&&t.removeAttribute("id")}}}return E(e.replace(se,"$1"),t,o,n)}function o(){function e(o,n){return t.push(o+" ")>x.cacheLength&&delete e[t.shift()],e[o+" "]=n}var t=[];return e}function n(e){return e[U]=!0,e}function r(e){var t=P.createElement("div");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function i(e,t){for(var o=e.split("|"),n=o.length;n--;)x.attrHandle[o[n]]=t}function a(e,t){var o=t&&e,n=o&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||W)-(~e.sourceIndex||W);if(n)return n;if(o)for(;o=o.nextSibling;)if(o===t)return-1;return e?1:-1}function s(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function l(e){return function(t){var o=t.nodeName.toLowerCase();return("input"===o||"button"===o)&&t.type===e}}function c(e){return n(function(t){return t=+t,n(function(o,n){for(var r,i=e([],o.length,t),a=i.length;a--;)o[r=i[a]]&&(o[r]=!(n[r]=o[r]))})})}function d(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}function u(){}function p(e){for(var t=0,o=e.length,n="";t<o;t++)n+=e[t].value;return n}function h(e,t,o){var n=t.dir,r=o&&"parentNode"===n,i=B++;return t.first?function(t,o,i){for(;t=t[n];)if(1===t.nodeType||r)return e(t,o,i)}:function(t,o,a){var s,l,c,d=[H,i];if(a){for(;t=t[n];)if((1===t.nodeType||r)&&e(t,o,a))return!0}else for(;t=t[n];)if(1===t.nodeType||r){if(c=t[U]||(t[U]={}),l=c[t.uniqueID]||(c[t.uniqueID]={}),(s=l[n])&&s[0]===H&&s[1]===i)return d[2]=s[2];if(l[n]=d,d[2]=e(t,o,a))return!0}}}function f(e){return e.length>1?function(t,o,n){for(var r=e.length;r--;)if(!e[r](t,o,n))return!1;return!0}:e[0]}function m(e,o,n){for(var r=0,i=o.length;r<i;r++)t(e,o[r],n);return n}function g(e,t,o,n,r){for(var i,a=[],s=0,l=e.length,c=null!=t;s<l;s++)(i=e[s])&&(o&&!o(i,n,r)||(a.push(i),c&&t.push(s)));return a}function v(e,t,o,r,i,a){return r&&!r[U]&&(r=v(r)),i&&!i[U]&&(i=v(i,a)),n(function(n,a,s,l){var c,d,u,p=[],h=[],f=a.length,v=n||m(t||"*",s.nodeType?[s]:s,[]),y=!e||!n&&t?v:g(v,p,e,s,l),b=o?i||(n?e:f||r)?[]:a:y;if(o&&o(y,b,s,l),r)for(c=g(b,h),r(c,[],s,l),d=c.length;d--;)(u=c[d])&&(b[h[d]]=!(y[h[d]]=u));if(n){if(i||e){if(i){for(c=[],d=b.length;d--;)(u=b[d])&&c.push(y[d]=u);i(null,b=[],c,l)}for(d=b.length;d--;)(u=b[d])&&(c=i?ee(n,u):p[d])>-1&&(n[c]=!(a[c]=u))}}else b=g(b===a?b.splice(f,b.length):b),i?i(null,a,b,l):Z.apply(a,b)})}function y(e){for(var t,o,n,r=e.length,i=x.relative[e[0].type],a=i||x.relative[" "],s=i?1:0,l=h(function(e){return e===t},a,!0),c=h(function(e){return ee(t,e)>-1},a,!0),d=[function(e,o,n){var r=!i&&(n||o!==F)||((t=o).nodeType?l(e,o,n):c(e,o,n));return t=null,r}];s<r;s++)if(o=x.relative[e[s].type])d=[h(f(d),o)];else{if(o=x.filter[e[s].type].apply(null,e[s].matches),o[U]){for(n=++s;n<r&&!x.relative[e[n].type];n++);return v(s>1&&f(d),s>1&&p(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace(se,"$1"),o,s<n&&y(e.slice(s,n)),n<r&&y(e=e.slice(n)),n<r&&p(e))}d.push(o)}return f(d)}function b(e,o){var r=o.length>0,i=e.length>0,a=function(n,a,s,l,c){var d,u,p,h=0,f="0",m=n&&[],v=[],y=F,b=n||i&&x.find.TAG("*",c),C=H+=null==y?1:Math.random()||.1,w=b.length;for(c&&(F=a===P||a||c);f!==w&&null!=(d=b[f]);f++){if(i&&d){for(u=0,a||d.ownerDocument===P||(A(d),s=!R);p=e[u++];)if(p(d,a||P,s)){l.push(d);break}c&&(H=C)}r&&((d=!p&&d)&&h--,n&&m.push(d))}if(h+=f,r&&f!==h){for(u=0;p=o[u++];)p(m,v,a,s);if(n){if(h>0)for(;f--;)m[f]||v[f]||(v[f]=X.call(l));v=g(v)}Z.apply(l,v),c&&!n&&v.length>0&&h+o.length>1&&t.uniqueSort(l)}return c&&(H=C,F=y),m};return r?n(a):a}var C,w,x,S,_,k,T,E,F,D,M,A,P,L,R,I,O,$,N,U="sizzle"+1*new Date,j=e.document,H=0,B=0,z=o(),V=o(),Y=o(),G=function(e,t){return e===t&&(M=!0),0},W=1<<31,q={}.hasOwnProperty,K=[],X=K.pop,Q=K.push,Z=K.push,J=K.slice,ee=function(e,t){for(var o=0,n=e.length;o<n;o++)if(e[o]===t)return o;return-1},te="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",oe="[\\x20\\t\\r\\n\\f]",ne="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",re="\\["+oe+"*("+ne+")(?:"+oe+"*([*^$|!~]?=)"+oe+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+ne+"))|)"+oe+"*\\]",ie=":("+ne+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+re+")*)|.*)\\)|)",ae=new RegExp(oe+"+","g"),se=new RegExp("^"+oe+"+|((?:^|[^\\\\])(?:\\\\.)*)"+oe+"+$","g"),le=new RegExp("^"+oe+"*,"+oe+"*"),ce=new RegExp("^"+oe+"*([>+~]|"+oe+")"+oe+"*"),de=new RegExp("="+oe+"*([^\\]'\"]*?)"+oe+"*\\]","g"),ue=new RegExp(ie),pe=new RegExp("^"+ne+"$"),he={ID:new RegExp("^#("+ne+")"),CLASS:new RegExp("^\\.("+ne+")"),TAG:new RegExp("^("+ne+"|[*])"),ATTR:new RegExp("^"+re),PSEUDO:new RegExp("^"+ie),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+oe+"*(even|odd|(([+-]|)(\\d*)n|)"+oe+"*(?:([+-]|)"+oe+"*(\\d+)|))"+oe+"*\\)|)","i"),bool:new RegExp("^(?:"+te+")$","i"),needsContext:new RegExp("^"+oe+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+oe+"*((?:-\\d)?\\d*)"+oe+"*\\)|)(?=[^-]|$)","i")},fe=/^(?:input|select|textarea|button)$/i,me=/^h\d$/i,ge=/^[^{]+\{\s*\[native \w/,ve=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ye=/[+~]/,be=/'|\\/g,Ce=new RegExp("\\\\([\\da-f]{1,6}"+oe+"?|("+oe+")|.)","ig"),we=function(e,t,o){var n="0x"+t-65536;return n!==n||o?t:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)},xe=function(){A()};try{Z.apply(K=J.call(j.childNodes),j.childNodes),K[j.childNodes.length].nodeType}catch(e){Z={apply:K.length?function(e,t){Q.apply(e,J.call(t))}:function(e,t){for(var o=e.length,n=0;e[o++]=t[n++];);e.length=o-1}}}w=t.support={},_=t.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},A=t.setDocument=function(e){var t,o,n=e?e.ownerDocument||e:j;return n!==P&&9===n.nodeType&&n.documentElement?(P=n,L=P.documentElement,R=!_(P),(o=P.defaultView)&&o.top!==o&&(o.addEventListener?o.addEventListener("unload",xe,!1):o.attachEvent&&o.attachEvent("onunload",xe)),w.attributes=r(function(e){return e.className="i",!e.getAttribute("className")}),w.getElementsByTagName=r(function(e){return e.appendChild(P.createComment("")),!e.getElementsByTagName("*").length}),w.getElementsByClassName=ge.test(P.getElementsByClassName),w.getById=r(function(e){return L.appendChild(e).id=U,!P.getElementsByName||!P.getElementsByName(U).length}),w.getById?(x.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&R){var o=t.getElementById(e);return o?[o]:[]}},x.filter.ID=function(e){var t=e.replace(Ce,we);return function(e){return e.getAttribute("id")===t}}):(delete x.find.ID,x.filter.ID=function(e){var t=e.replace(Ce,we);return function(e){var o="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return o&&o.value===t}}),x.find.TAG=w.getElementsByTagName?function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):w.qsa?t.querySelectorAll(e):void 0}:function(e,t){var o,n=[],r=0,i=t.getElementsByTagName(e);if("*"===e){for(;o=i[r++];)1===o.nodeType&&n.push(o);return n}return i},x.find.CLASS=w.getElementsByClassName&&function(e,t){if("undefined"!=typeof t.getElementsByClassName&&R)return t.getElementsByClassName(e)},O=[],I=[],(w.qsa=ge.test(P.querySelectorAll))&&(r(function(e){L.appendChild(e).innerHTML="<a id='"+U+"'></a><select id='"+U+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&I.push("[*^$]="+oe+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||I.push("\\["+oe+"*(?:value|"+te+")"),e.querySelectorAll("[id~="+U+"-]").length||I.push("~="),e.querySelectorAll(":checked").length||I.push(":checked"),e.querySelectorAll("a#"+U+"+*").length||I.push(".#.+[+~]")}),r(function(e){var t=P.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&I.push("name"+oe+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||I.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),I.push(",.*:")})),(w.matchesSelector=ge.test($=L.matches||L.webkitMatchesSelector||L.mozMatchesSelector||L.oMatchesSelector||L.msMatchesSelector))&&r(function(e){w.disconnectedMatch=$.call(e,"div"),$.call(e,"[s!='']:x"),O.push("!=",ie)}),I=I.length&&new RegExp(I.join("|")),O=O.length&&new RegExp(O.join("|")),t=ge.test(L.compareDocumentPosition),N=t||ge.test(L.contains)?function(e,t){var o=9===e.nodeType?e.documentElement:e,n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(o.contains?o.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},G=t?function(e,t){if(e===t)return M=!0,0;var o=!e.compareDocumentPosition-!t.compareDocumentPosition;return o||(o=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&o||!w.sortDetached&&t.compareDocumentPosition(e)===o?e===P||e.ownerDocument===j&&N(j,e)?-1:t===P||t.ownerDocument===j&&N(j,t)?1:D?ee(D,e)-ee(D,t):0:4&o?-1:1)}:function(e,t){if(e===t)return M=!0,0;var o,n=0,r=e.parentNode,i=t.parentNode,s=[e],l=[t];if(!r||!i)return e===P?-1:t===P?1:r?-1:i?1:D?ee(D,e)-ee(D,t):0;if(r===i)return a(e,t);for(o=e;o=o.parentNode;)s.unshift(o);for(o=t;o=o.parentNode;)l.unshift(o);for(;s[n]===l[n];)n++;return n?a(s[n],l[n]):s[n]===j?-1:l[n]===j?1:0},P):P},t.matches=function(e,o){return t(e,null,null,o)},t.matchesSelector=function(e,o){if((e.ownerDocument||e)!==P&&A(e),o=o.replace(de,"='$1']"),w.matchesSelector&&R&&!Y[o+" "]&&(!O||!O.test(o))&&(!I||!I.test(o)))try{var n=$.call(e,o);if(n||w.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){}return t(o,P,null,[e]).length>0},t.contains=function(e,t){return(e.ownerDocument||e)!==P&&A(e),N(e,t)},t.attr=function(e,t){(e.ownerDocument||e)!==P&&A(e);var o=x.attrHandle[t.toLowerCase()],n=o&&q.call(x.attrHandle,t.toLowerCase())?o(e,t,!R):undefined;return n!==undefined?n:w.attributes||!R?e.getAttribute(t):(n=e.getAttributeNode(t))&&n.specified?n.value:null},t.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},t.uniqueSort=function(e){var t,o=[],n=0,r=0;if(M=!w.detectDuplicates,D=!w.sortStable&&e.slice(0),e.sort(G),M){for(;t=e[r++];)t===e[r]&&(n=o.push(r));for(;n--;)e.splice(o[n],1)}return D=null,e},S=t.getText=function(e){var t,o="",n=0,r=e.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)o+=S(e)}else if(3===r||4===r)return e.nodeValue}else for(;t=e[n++];)o+=S(t);return o},x=t.selectors={cacheLength:50,createPseudo:n,match:he,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(Ce,we),e[3]=(e[3]||e[4]||e[5]||"").replace(Ce,we),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||t.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&t.error(e[0]),e},PSEUDO:function(e){var t,o=!e[6]&&e[2];return he.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":o&&ue.test(o)&&(t=k(o,!0))&&(t=o.indexOf(")",o.length-t)-o.length)&&(e[0]=e[0].slice(0,t),e[2]=o.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(Ce,we).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=z[e+" "];return t||(t=new RegExp("(^|"+oe+")"+e+"("+oe+"|$)"))&&z(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,o,n){return function(r){var i=t.attr(r,e);return null==i?"!="===o:!o||(i+="","="===o?i===n:"!="===o?i!==n:"^="===o?n&&0===i.indexOf(n):"*="===o?n&&i.indexOf(n)>-1:"$="===o?n&&i.slice(-n.length)===n:"~="===o?(" "+i.replace(ae," ")+" ").indexOf(n)>-1:"|="===o&&(i===n||i.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,o,n,r){var i="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;return 1===n&&0===r?function(e){return!!e.parentNode}:function(t,o,l){var c,d,u,p,h,f,m=i!==a?"nextSibling":"previousSibling",g=t.parentNode,v=s&&t.nodeName.toLowerCase(),y=!l&&!s,b=!1;if(g){if(i){for(;m;){for(p=t;p=p[m];)if(s?p.nodeName.toLowerCase()===v:1===p.nodeType)return!1;f=m="only"===e&&!f&&"nextSibling"}return!0}if(f=[a?g.firstChild:g.lastChild],a&&y){for(p=g,u=p[U]||(p[U]={}),d=u[p.uniqueID]||(u[p.uniqueID]={}),c=d[e]||[],h=c[0]===H&&c[1],b=h&&c[2],p=h&&g.childNodes[h];p=++h&&p&&p[m]||(b=h=0)||f.pop();)if(1===p.nodeType&&++b&&p===t){d[e]=[H,h,b];break}}else if(y&&(p=t,u=p[U]||(p[U]={}),d=u[p.uniqueID]||(u[p.uniqueID]={}),c=d[e]||[],h=c[0]===H&&c[1],b=h),!1===b)for(;(p=++h&&p&&p[m]||(b=h=0)||f.pop())&&((s?p.nodeName.toLowerCase()!==v:1!==p.nodeType)||!++b||(y&&(u=p[U]||(p[U]={}),d=u[p.uniqueID]||(u[p.uniqueID]={}),d[e]=[H,b]),p!==t)););return(b-=r)===n||b%n==0&&b/n>=0}}},PSEUDO:function(e,o){var r,i=x.pseudos[e]||x.setFilters[e.toLowerCase()]||t.error("unsupported pseudo: "+e);return i[U]?i(o):i.length>1?(r=[e,e,"",o],x.setFilters.hasOwnProperty(e.toLowerCase())?n(function(e,t){for(var n,r=i(e,o),a=r.length;a--;)n=ee(e,r[a]),e[n]=!(t[n]=r[a])}):function(e){return i(e,0,r)}):i}},pseudos:{not:n(function(e){var t=[],o=[],r=T(e.replace(se,"$1"));return r[U]?n(function(e,t,o,n){for(var i,a=r(e,null,n,[]),s=e.length;s--;)(i=a[s])&&(e[s]=!(t[s]=i))}):function(e,n,i){return t[0]=e,r(t,null,i,o),t[0]=null,!o.pop()}}),has:n(function(e){return function(o){return t(e,o).length>0}}),contains:n(function(e){return e=e.replace(Ce,we),function(t){return(t.textContent||t.innerText||S(t)).indexOf(e)>-1}}),lang:n(function(e){return pe.test(e||"")||t.error("unsupported lang: "+e),e=e.replace(Ce,we).toLowerCase(),function(t){var o;do{if(o=R?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(o=o.toLowerCase())===e||0===o.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var o=e.location&&e.location.hash;return o&&o.slice(1)===t.id},root:function(e){return e===L},focus:function(e){return e===P.activeElement&&(!P.hasFocus||P.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return!1===e.disabled},disabled:function(e){return!0===e.disabled},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!x.pseudos.empty(e)},header:function(e){return me.test(e.nodeName)},input:function(e){return fe.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:c(function(){return[0]}),last:c(function(e,t){return[t-1]}),eq:c(function(e,t,o){return[o<0?o+t:o]}),even:c(function(e,t){for(var o=0;o<t;o+=2)e.push(o);return e}),odd:c(function(e,t){for(var o=1;o<t;o+=2)e.push(o);return e}),lt:c(function(e,t,o){for(var n=o<0?o+t:o;--n>=0;)e.push(n);return e}),gt:c(function(e,t,o){for(var n=o<0?o+t:o;++n<t;)e.push(n);return e})}},x.pseudos.nth=x.pseudos.eq;for(C in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})x.pseudos[C]=s(C);for(C in{submit:!0,reset:!0})x.pseudos[C]=l(C);return u.prototype=x.filters=x.pseudos,x.setFilters=new u,k=t.tokenize=function(e,o){var n,r,i,a,s,l,c,d=V[e+" "];if(d)return o?0:d.slice(0);for(s=e,l=[],c=x.preFilter;s;){n&&!(r=le.exec(s))||(r&&(s=s.slice(r[0].length)||s),l.push(i=[])),n=!1,(r=ce.exec(s))&&(n=r.shift(),i.push({value:n,type:r[0].replace(se," ")}),s=s.slice(n.length));for(a in x.filter)!(r=he[a].exec(s))||c[a]&&!(r=c[a](r))||(n=r.shift(),i.push({value:n,type:a,matches:r}),s=s.slice(n.length));if(!n)break}return o?s.length:s?t.error(e):V(e,l).slice(0)},T=t.compile=function(e,t){var o,n=[],r=[],i=Y[e+" "];if(!i){for(t||(t=k(e)),o=t.length;o--;)i=y(t[o]),i[U]?n.push(i):r.push(i);i=Y(e,b(r,n)),i.selector=e}return i},E=t.select=function(e,t,o,n){var r,i,a,s,l,c="function"==typeof e&&e,u=!n&&k(e=c.selector||e);if(o=o||[],1===u.length){if(i=u[0]=u[0].slice(0),i.length>2&&"ID"===(a=i[0]).type&&w.getById&&9===t.nodeType&&R&&x.relative[i[1].type]){if(!(t=(x.find.ID(a.matches[0].replace(Ce,we),t)||[])[0]))return o;c&&(t=t.parentNode),e=e.slice(i.shift().value.length)}for(r=he.needsContext.test(e)?0:i.length;r--&&(a=i[r],!x.relative[s=a.type]);)if((l=x.find[s])&&(n=l(a.matches[0].replace(Ce,we),ye.test(i[0].type)&&d(t.parentNode)||t))){if(i.splice(r,1),!(e=n.length&&p(i)))return Z.apply(o,n),o;break}}return(c||T(e,u))(n,t,!R,o,!t||ye.test(e)&&d(t.parentNode)||t),o},w.sortStable=U.split("").sort(G).join("")===U,w.detectDuplicates=!!M,A(),w.sortDetached=r(function(e){return 1&e.compareDocumentPosition(P.createElement("div"))}),r(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||i("type|href|height|width",function(e,t,o){if(!o)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),w.attributes&&r(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||i("value",function(e,t,o){if(!o&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),r(function(e){return null==e.getAttribute("disabled")})||i(te,function(e,t,o){var n;if(!o)return!0===e[t]?t.toLowerCase():(n=e.getAttributeNode(t))&&n.specified?n.value:null}),t}(e);he.find=ye,he.expr=ye.selectors,he.expr[":"]=he.expr.pseudos,he.uniqueSort=he.unique=ye.uniqueSort,he.text=ye.getText,he.isXMLDoc=ye.isXML,he.contains=ye.contains;var be=function(e,t,o){for(var n=[],r=o!==undefined;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(r&&he(e).is(o))break;n.push(e)}return n},Ce=function(e,t){for(var o=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&o.push(e);return o},we=he.expr.match.needsContext,xe=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,Se=/^.[^:#\[\.,]*$/;he.filter=function(e,t,o){var n=t[0];return o&&(e=":not("+e+")"),1===t.length&&1===n.nodeType?he.find.matchesSelector(n,e)?[n]:[]:he.find.matches(e,he.grep(t,function(e){return 1===e.nodeType}))},he.fn.extend({find:function(e){var t,o=[],n=this,r=n.length;if("string"!=typeof e)return this.pushStack(he(e).filter(function(){for(t=0;t<r;t++)if(he.contains(n[t],this))return!0}));for(t=0;t<r;t++)he.find(e,n[t],o);return o=this.pushStack(r>1?he.unique(o):o),o.selector=this.selector?this.selector+" "+e:e,o},filter:function(e){return this.pushStack(n(this,e||[],!1))},not:function(e){return this.pushStack(n(this,e||[],!0))},is:function(e){return!!n(this,"string"==typeof e&&we.test(e)?he(e):e||[],!1).length}});var _e,ke=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(he.fn.init=function(e,t,o){var n,r;if(!e)return this;if(o=o||_e,"string"==typeof e){if(!(n="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:ke.exec(e))||!n[1]&&t)return!t||t.jquery?(t||o).find(e):this.constructor(t).find(e);if(n[1]){if(t=t instanceof he?t[0]:t,he.merge(this,he.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:ne,!0)),xe.test(n[1])&&he.isPlainObject(t))for(n in t)he.isFunction(this[n])?this[n](t[n]):this.attr(n,t[n]);return this}if((r=ne.getElementById(n[2]))&&r.parentNode){if(r.id!==n[2])return _e.find(e);this.length=1,this[0]=r}return this.context=ne,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):he.isFunction(e)?"undefined"!=typeof o.ready?o.ready(e):e(he):(e.selector!==undefined&&(this.selector=e.selector,this.context=e.context),he.makeArray(e,this))}).prototype=he.fn,_e=he(ne);var Te=/^(?:parents|prev(?:Until|All))/,Ee={children:!0,contents:!0,next:!0,prev:!0};he.fn.extend({has:function(e){var t,o=he(e,this),n=o.length;return this.filter(function(){for(t=0;t<n;t++)if(he.contains(this,o[t]))return!0})},closest:function(e,t){for(var o,n=0,r=this.length,i=[],a=we.test(e)||"string"!=typeof e?he(e,t||this.context):0;n<r;n++)for(o=this[n];o&&o!==t;o=o.parentNode)if(o.nodeType<11&&(a?a.index(o)>-1:1===o.nodeType&&he.find.matchesSelector(o,e))){i.push(o);break}return this.pushStack(i.length>1?he.uniqueSort(i):i)},index:function(e){return e?"string"==typeof e?he.inArray(this[0],he(e)):he.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(he.uniqueSort(he.merge(this.get(),he(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),he.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return be(e,"parentNode")},parentsUntil:function(e,t,o){return be(e,"parentNode",o)},next:function(e){return r(e,"nextSibling")},prev:function(e){return r(e,"previousSibling")},nextAll:function(e){return be(e,"nextSibling")},prevAll:function(e){return be(e,"previousSibling")},nextUntil:function(e,t,o){return be(e,"nextSibling",o)},prevUntil:function(e,t,o){return be(e,"previousSibling",o)},siblings:function(e){return Ce((e.parentNode||{}).firstChild,e)},children:function(e){return Ce(e.firstChild)},contents:function(e){return he.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:he.merge([],e.childNodes)}},function(e,t){he.fn[e]=function(o,n){var r=he.map(this,t,o);return"Until"!==e.slice(-5)&&(n=o),n&&"string"==typeof n&&(r=he.filter(n,r)),this.length>1&&(Ee[e]||(r=he.uniqueSort(r)),Te.test(e)&&(r=r.reverse())),this.pushStack(r)}});var Fe=/\S+/g;he.Callbacks=function(e){e="string"==typeof e?i(e):he.extend({},e);var t,o,n,r,a=[],s=[],l=-1,c=function(){for(r=e.once,n=t=!0;s.length;l=-1)for(o=s.shift();++l<a.length;)!1===a[l].apply(o[0],o[1])&&e.stopOnFalse&&(l=a.length,o=!1);e.memory||(o=!1),t=!1,r&&(a=o?[]:"")},d={add:function(){return a&&(o&&!t&&(l=a.length-1,s.push(o)),function t(o){he.each(o,function(o,n){he.isFunction(n)?e.unique&&d.has(n)||a.push(n):n&&n.length&&"string"!==he.type(n)&&t(n)})}(arguments),o&&!t&&c()),this},remove:function(){return he.each(arguments,function(e,t){for(var o;(o=he.inArray(t,a,o))>-1;)a.splice(o,1),o<=l&&l--}),this},has:function(e){return e?he.inArray(e,a)>-1:a.length>0},empty:function(){return a&&(a=[]),this},disable:function(){return r=s=[],a=o="",this},disabled:function(){return!a},lock:function(){return r=!0,o||d.disable(),this},locked:function(){return!!r},fireWith:function(e,o){return r||(o=o||[],o=[e,o.slice?o.slice():o],s.push(o),t||c()),this},fire:function(){return d.fireWith(this,arguments),this},fired:function(){return!!n}};return d},he.extend({Deferred:function(e){var t=[["resolve","done",he.Callbacks("once memory"),"resolved"],["reject","fail",he.Callbacks("once memory"),"rejected"],["notify","progress",he.Callbacks("memory")]],o="pending",n={state:function(){return o},always:function(){return r.done(arguments).fail(arguments),this},then:function(){var e=arguments;return he.Deferred(function(o){he.each(t,function(t,i){var a=he.isFunction(e[t])&&e[t];r[i[1]](function(){var e=a&&a.apply(this,arguments);e&&he.isFunction(e.promise)?e.promise().progress(o.notify).done(o.resolve).fail(o.reject):o[i[0]+"With"](this===n?o.promise():this,a?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?he.extend(e,n):n}},r={};return n.pipe=n.then,he.each(t,function(e,i){var a=i[2],s=i[3];n[i[1]]=a.add,s&&a.add(function(){o=s},t[1^e][2].disable,t[2][2].lock),r[i[0]]=function(){return r[i[0]+"With"](this===r?n:this,arguments),this},r[i[0]+"With"]=a.fireWith}),n.promise(r),e&&e.call(r,r),r},when:function(e){var t,o,n,r=0,i=re.call(arguments),a=i.length,s=1!==a||e&&he.isFunction(e.promise)?a:0,l=1===s?e:he.Deferred(),c=function(e,o,n){return function(r){o[e]=this,n[e]=arguments.length>1?re.call(arguments):r,n===t?l.notifyWith(o,n):--s||l.resolveWith(o,n)}};if(a>1)for(t=new Array(a),o=new Array(a),n=new Array(a);r<a;r++)i[r]&&he.isFunction(i[r].promise)?i[r].promise().progress(c(r,o,t)).done(c(r,n,i)).fail(l.reject):--s;return s||l.resolveWith(n,i),l.promise()}});var De;he.fn.ready=function(e){return he.ready.promise().done(e),this},he.extend({isReady:!1,readyWait:1,holdReady:function(e){e?he.readyWait++:he.ready(!0)},ready:function(e){(!0===e?--he.readyWait:he.isReady)||(he.isReady=!0,!0!==e&&--he.readyWait>0||(De.resolveWith(ne,[he]),he.fn.triggerHandler&&(he(ne).triggerHandler("ready"),he(ne).off("ready"))))}}),he.ready.promise=function(t){if(!De)if(De=he.Deferred(),"complete"===ne.readyState||"loading"!==ne.readyState&&!ne.documentElement.doScroll)e.setTimeout(he.ready);else if(ne.addEventListener)ne.addEventListener("DOMContentLoaded",s),e.addEventListener("load",s);else{ne.attachEvent("onreadystatechange",s),e.attachEvent("onload",s);var o=!1;try{o=null==e.frameElement&&ne.documentElement}catch(e){}o&&o.doScroll&&function t(){if(!he.isReady){try{o.doScroll("left")}catch(o){return e.setTimeout(t,50)}a(),he.ready()}}()}return De.promise(t)},he.ready.promise();var Me;for(Me in he(ue))break;ue.ownFirst="0"===Me,ue.inlineBlockNeedsLayout=!1,he(function(){var e,t,o,n;(o=ne.getElementsByTagName("body")[0])&&o.style&&(t=ne.createElement("div"),n=ne.createElement("div"),n.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",o.appendChild(n).appendChild(t),"undefined"!=typeof t.style.zoom&&(t.style.cssText="display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1",ue.inlineBlockNeedsLayout=e=3===t.offsetWidth,e&&(o.style.zoom=1)),o.removeChild(n))}),function(){var e=ne.createElement("div");ue.deleteExpando=!0;try{delete e.test}catch(e){ue.deleteExpando=!1}e=null}();var Ae=function(e){var t=he.noData[(e.nodeName+" ").toLowerCase()],o=+e.nodeType||1;return(1===o||9===o)&&(!t||!0!==t&&e.getAttribute("classid")===t)},Pe=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Le=/([A-Z])/g;he.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){return!!(e=e.nodeType?he.cache[e[he.expando]]:e[he.expando])&&!c(e)},data:function(e,t,o){return d(e,t,o)},removeData:function(e,t){return u(e,t)},_data:function(e,t,o){return d(e,t,o,!0)},_removeData:function(e,t){return u(e,t,!0)}}),he.fn.extend({data:function(e,t){var o,n,r,i=this[0],a=i&&i.attributes;if(e===undefined){if(this.length&&(r=he.data(i),1===i.nodeType&&!he._data(i,"parsedAttrs"))){for(o=a.length;o--;)a[o]&&(n=a[o].name,0===n.indexOf("data-")&&(n=he.camelCase(n.slice(5)),l(i,n,r[n])));he._data(i,"parsedAttrs",!0)}return r}return"object"==typeof e?this.each(function(){he.data(this,e)}):arguments.length>1?this.each(function(){he.data(this,e,t)}):i?l(i,e,he.data(i,e)):undefined},removeData:function(e){return this.each(function(){he.removeData(this,e)})}}),he.extend({queue:function(e,t,o){var n;if(e)return t=(t||"fx")+"queue",n=he._data(e,t),o&&(!n||he.isArray(o)?n=he._data(e,t,he.makeArray(o)):n.push(o)),n||[]},dequeue:function(e,t){t=t||"fx";var o=he.queue(e,t),n=o.length,r=o.shift(),i=he._queueHooks(e,t),a=function(){he.dequeue(e,t)};"inprogress"===r&&(r=o.shift(),n--),r&&("fx"===t&&o.unshift("inprogress"),delete i.stop,r.call(e,a,i)),!n&&i&&i.empty.fire()},_queueHooks:function(e,t){var o=t+"queueHooks";return he._data(e,o)||he._data(e,o,{empty:he.Callbacks("once memory").add(function(){he._removeData(e,t+"queue"),he._removeData(e,o)})})}}),he.fn.extend({queue:function(e,t){var o=2;return"string"!=typeof e&&(t=e,e="fx",o--),arguments.length<o?he.queue(this[0],e):t===undefined?this:this.each(function(){var o=he.queue(this,e,t);he._queueHooks(this,e),"fx"===e&&"inprogress"!==o[0]&&he.dequeue(this,e)})},dequeue:function(e){return this.each(function(){he.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var o,n=1,r=he.Deferred(),i=this,a=this.length,s=function(){--n||r.resolveWith(i,[i])};for("string"!=typeof e&&(t=e,e=undefined),e=e||"fx";a--;)(o=he._data(i[a],e+"queueHooks"))&&o.empty&&(n++,o.empty.add(s));return s(),r.promise(t)}}),function(){var e;ue.shrinkWrapBlocks=function(){if(null!=e)return e;e=!1;var t,o,n;return(o=ne.getElementsByTagName("body")[0])&&o.style?(t=ne.createElement("div"),n=ne.createElement("div"),n.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",o.appendChild(n).appendChild(t),"undefined"!=typeof t.style.zoom&&(t.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:1px;width:1px;zoom:1",t.appendChild(ne.createElement("div")).style.width="5px",e=3!==t.offsetWidth),o.removeChild(n),e):void 0}}();var Re=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Ie=new RegExp("^(?:([+-])=|)("+Re+")([a-z%]*)$","i"),Oe=["Top","Right","Bottom","Left"],$e=function(e,t){return e=t||e,"none"===he.css(e,"display")||!he.contains(e.ownerDocument,e)},Ne=function(e,t,o,n,r,i,a){var s=0,l=e.length,c=null==o;if("object"===he.type(o)){r=!0;for(s in o)Ne(e,t,s,o[s],!0,i,a)}else if(n!==undefined&&(r=!0,he.isFunction(n)||(a=!0),c&&(a?(t.call(e,n),t=null):(c=t,t=function(e,t,o){return c.call(he(e),o)})),t))for(;s<l;s++)t(e[s],o,a?n:n.call(e[s],s,t(e[s],o)));return r?e:c?t.call(e):l?t(e[0],o):i},Ue=/^(?:checkbox|radio)$/i,je=/<([\w:-]+)/,He=/^$|\/(?:java|ecma)script/i,Be=/^\s+/,ze="abbr|article|aside|audio|bdi|canvas|data|datalist|details|dialog|figcaption|figure|footer|header|hgroup|main|mark|meter|nav|output|picture|progress|section|summary|template|time|video";!function(){var e=ne.createElement("div"),t=ne.createDocumentFragment(),o=ne.createElement("input");e.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",ue.leadingWhitespace=3===e.firstChild.nodeType,ue.tbody=!e.getElementsByTagName("tbody").length,ue.htmlSerialize=!!e.getElementsByTagName("link").length,ue.html5Clone="<:nav></:nav>"!==ne.createElement("nav").cloneNode(!0).outerHTML,o.type="checkbox",o.checked=!0,t.appendChild(o),ue.appendChecked=o.checked,e.innerHTML="<textarea>x</textarea>",ue.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue,t.appendChild(e),o=ne.createElement("input"),o.setAttribute("type","radio"),o.setAttribute("checked","checked"),o.setAttribute("name","t"),e.appendChild(o),ue.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,ue.noCloneEvent=!!e.addEventListener,e[he.expando]=1,ue.attributes=!e.getAttribute(he.expando)}();var Ve={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:ue.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]};Ve.optgroup=Ve.option,Ve.tbody=Ve.tfoot=Ve.colgroup=Ve.caption=Ve.thead,Ve.th=Ve.td;var Ye=/<|&#?\w+;/,Ge=/<tbody/i;!function(){var t,o,n=ne.createElement("div");for(t in{submit:!0,change:!0,focusin:!0})o="on"+t,(ue[t]=o in e)||(n.setAttribute(o,"t"),ue[t]=!1===n.attributes[o].expando);n=null}();var We=/^(?:input|select|textarea)$/i,qe=/^key/,Ke=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Xe=/^(?:focusinfocus|focusoutblur)$/,Qe=/^([^.]*)(?:\.(.+)|)/;he.event={global:{},add:function(e,t,o,n,r){var i,a,s,l,c,d,u,p,h,f,m,g=he._data(e);if(g){for(o.handler&&(l=o,o=l.handler,r=l.selector),o.guid||(o.guid=he.guid++),(a=g.events)||(a=g.events={}),(d=g.handle)||(d=g.handle=function(e){return void 0===he||e&&he.event.triggered===e.type?undefined:he.event.dispatch.apply(d.elem,arguments)},d.elem=e),t=(t||"").match(Fe)||[""],s=t.length;s--;)i=Qe.exec(t[s])||[],h=m=i[1],f=(i[2]||"").split(".").sort(),h&&(c=he.event.special[h]||{},h=(r?c.delegateType:c.bindType)||h,c=he.event.special[h]||{},u=he.extend({type:h,origType:m,data:n,handler:o,guid:o.guid,selector:r,
needsContext:r&&he.expr.match.needsContext.test(r),namespace:f.join(".")},l),(p=a[h])||(p=a[h]=[],p.delegateCount=0,c.setup&&!1!==c.setup.call(e,n,f,d)||(e.addEventListener?e.addEventListener(h,d,!1):e.attachEvent&&e.attachEvent("on"+h,d))),c.add&&(c.add.call(e,u),u.handler.guid||(u.handler.guid=o.guid)),r?p.splice(p.delegateCount++,0,u):p.push(u),he.event.global[h]=!0);e=null}},remove:function(e,t,o,n,r){var i,a,s,l,c,d,u,p,h,f,m,g=he.hasData(e)&&he._data(e);if(g&&(d=g.events)){for(t=(t||"").match(Fe)||[""],c=t.length;c--;)if(s=Qe.exec(t[c])||[],h=m=s[1],f=(s[2]||"").split(".").sort(),h){for(u=he.event.special[h]||{},h=(n?u.delegateType:u.bindType)||h,p=d[h]||[],s=s[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=i=p.length;i--;)a=p[i],!r&&m!==a.origType||o&&o.guid!==a.guid||s&&!s.test(a.namespace)||n&&n!==a.selector&&("**"!==n||!a.selector)||(p.splice(i,1),a.selector&&p.delegateCount--,u.remove&&u.remove.call(e,a));l&&!p.length&&(u.teardown&&!1!==u.teardown.call(e,f,g.handle)||he.removeEvent(e,h,g.handle),delete d[h])}else for(h in d)he.event.remove(e,h+t[c],o,n,!0);he.isEmptyObject(d)&&(delete g.handle,he._removeData(e,"events"))}},trigger:function(t,o,n,r){var i,a,s,l,c,d,u,p=[n||ne],h=de.call(t,"type")?t.type:t,f=de.call(t,"namespace")?t.namespace.split("."):[];if(s=d=n=n||ne,3!==n.nodeType&&8!==n.nodeType&&!Xe.test(h+he.event.triggered)&&(h.indexOf(".")>-1&&(f=h.split("."),h=f.shift(),f.sort()),a=h.indexOf(":")<0&&"on"+h,t=t[he.expando]?t:new he.Event(h,"object"==typeof t&&t),t.isTrigger=r?2:3,t.namespace=f.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=undefined,t.target||(t.target=n),o=null==o?[t]:he.makeArray(o,[t]),c=he.event.special[h]||{},r||!c.trigger||!1!==c.trigger.apply(n,o))){if(!r&&!c.noBubble&&!he.isWindow(n)){for(l=c.delegateType||h,Xe.test(l+h)||(s=s.parentNode);s;s=s.parentNode)p.push(s),d=s;d===(n.ownerDocument||ne)&&p.push(d.defaultView||d.parentWindow||e)}for(u=0;(s=p[u++])&&!t.isPropagationStopped();)t.type=u>1?l:c.bindType||h,i=(he._data(s,"events")||{})[t.type]&&he._data(s,"handle"),i&&i.apply(s,o),(i=a&&s[a])&&i.apply&&Ae(s)&&(t.result=i.apply(s,o),!1===t.result&&t.preventDefault());if(t.type=h,!r&&!t.isDefaultPrevented()&&(!c._default||!1===c._default.apply(p.pop(),o))&&Ae(n)&&a&&n[h]&&!he.isWindow(n)){d=n[a],d&&(n[a]=null),he.event.triggered=h;try{n[h]()}catch(e){}he.event.triggered=undefined,d&&(n[a]=d)}return t.result}},dispatch:function(e){e=he.event.fix(e);var t,o,n,r,i,a=[],s=re.call(arguments),l=(he._data(this,"events")||{})[e.type]||[],c=he.event.special[e.type]||{};if(s[0]=e,e.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,e)){for(a=he.event.handlers.call(this,e,l),t=0;(r=a[t++])&&!e.isPropagationStopped();)for(e.currentTarget=r.elem,o=0;(i=r.handlers[o++])&&!e.isImmediatePropagationStopped();)e.rnamespace&&!e.rnamespace.test(i.namespace)||(e.handleObj=i,e.data=i.data,(n=((he.event.special[i.origType]||{}).handle||i.handler).apply(r.elem,s))!==undefined&&!1===(e.result=n)&&(e.preventDefault(),e.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,e),e.result}},handlers:function(e,t){var o,n,r,i,a=[],s=t.delegateCount,l=e.target;if(s&&l.nodeType&&("click"!==e.type||isNaN(e.button)||e.button<1))for(;l!=this;l=l.parentNode||this)if(1===l.nodeType&&(!0!==l.disabled||"click"!==e.type)){for(n=[],o=0;o<s;o++)i=t[o],r=i.selector+" ",n[r]===undefined&&(n[r]=i.needsContext?he(r,this).index(l)>-1:he.find(r,this,null,[l]).length),n[r]&&n.push(i);n.length&&a.push({elem:l,handlers:n})}return s<t.length&&a.push({elem:this,handlers:t.slice(s)}),a},fix:function(e){if(e[he.expando])return e;var t,o,n,r=e.type,i=e,a=this.fixHooks[r];for(a||(this.fixHooks[r]=a=Ke.test(r)?this.mouseHooks:qe.test(r)?this.keyHooks:{}),n=a.props?this.props.concat(a.props):this.props,e=new he.Event(i),t=n.length;t--;)o=n[t],e[o]=i[o];return e.target||(e.target=i.srcElement||ne),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,a.filter?a.filter(e,i):e},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var o,n,r,i=t.button,a=t.fromElement;return null==e.pageX&&null!=t.clientX&&(n=e.target.ownerDocument||ne,r=n.documentElement,o=n.body,e.pageX=t.clientX+(r&&r.scrollLeft||o&&o.scrollLeft||0)-(r&&r.clientLeft||o&&o.clientLeft||0),e.pageY=t.clientY+(r&&r.scrollTop||o&&o.scrollTop||0)-(r&&r.clientTop||o&&o.clientTop||0)),!e.relatedTarget&&a&&(e.relatedTarget=a===e.target?t.toElement:a),e.which||i===undefined||(e.which=1&i?1:2&i?3:4&i?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==C()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){if(this===C()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if(he.nodeName(this,"input")&&"checkbox"===this.type&&this.click)return this.click(),!1},_default:function(e){return he.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==undefined&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,o){var n=he.extend(new he.Event,o,{type:e,isSimulated:!0});he.event.trigger(n,null,t),n.isDefaultPrevented()&&o.preventDefault()}},he.removeEvent=ne.removeEventListener?function(e,t,o){e.removeEventListener&&e.removeEventListener(t,o)}:function(e,t,o){var n="on"+t;e.detachEvent&&("undefined"==typeof e[n]&&(e[n]=null),e.detachEvent(n,o))},he.Event=function(e,t){if(!(this instanceof he.Event))return new he.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.defaultPrevented===undefined&&!1===e.returnValue?y:b):this.type=e,t&&he.extend(this,t),this.timeStamp=e&&e.timeStamp||he.now(),this[he.expando]=!0},he.Event.prototype={constructor:he.Event,isDefaultPrevented:b,isPropagationStopped:b,isImmediatePropagationStopped:b,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=y,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=y,e&&!this.isSimulated&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=y,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},he.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){he.event.special[e]={delegateType:t,bindType:t,handle:function(e){var o,n=this,r=e.relatedTarget,i=e.handleObj;return r&&(r===n||he.contains(n,r))||(e.type=i.origType,o=i.handler.apply(this,arguments),e.type=t),o}}}),ue.submit||(he.event.special.submit={setup:function(){if(he.nodeName(this,"form"))return!1;he.event.add(this,"click._submit keypress._submit",function(e){var t=e.target,o=he.nodeName(t,"input")||he.nodeName(t,"button")?he.prop(t,"form"):undefined;o&&!he._data(o,"submit")&&(he.event.add(o,"submit._submit",function(e){e._submitBubble=!0}),he._data(o,"submit",!0))})},postDispatch:function(e){e._submitBubble&&(delete e._submitBubble,this.parentNode&&!e.isTrigger&&he.event.simulate("submit",this.parentNode,e))},teardown:function(){if(he.nodeName(this,"form"))return!1;he.event.remove(this,"._submit")}}),ue.change||(he.event.special.change={setup:function(){if(We.test(this.nodeName))return"checkbox"!==this.type&&"radio"!==this.type||(he.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._justChanged=!0)}),he.event.add(this,"click._change",function(e){this._justChanged&&!e.isTrigger&&(this._justChanged=!1),he.event.simulate("change",this,e)})),!1;he.event.add(this,"beforeactivate._change",function(e){var t=e.target;We.test(t.nodeName)&&!he._data(t,"change")&&(he.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||he.event.simulate("change",this.parentNode,e)}),he._data(t,"change",!0))})},handle:function(e){var t=e.target;if(this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type)return e.handleObj.handler.apply(this,arguments)},teardown:function(){return he.event.remove(this,"._change"),!We.test(this.nodeName)}}),ue.focusin||he.each({focus:"focusin",blur:"focusout"},function(e,t){var o=function(e){he.event.simulate(t,e.target,he.event.fix(e))};he.event.special[t]={setup:function(){var n=this.ownerDocument||this,r=he._data(n,t);r||n.addEventListener(e,o,!0),he._data(n,t,(r||0)+1)},teardown:function(){var n=this.ownerDocument||this,r=he._data(n,t)-1;r?he._data(n,t,r):(n.removeEventListener(e,o,!0),he._removeData(n,t))}}}),he.fn.extend({on:function(e,t,o,n){return w(this,e,t,o,n)},one:function(e,t,o,n){return w(this,e,t,o,n,1)},off:function(e,t,o){var n,r;if(e&&e.preventDefault&&e.handleObj)return n=e.handleObj,he(e.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof e){for(r in e)this.off(r,t,e[r]);return this}return!1!==t&&"function"!=typeof t||(o=t,t=undefined),!1===o&&(o=b),this.each(function(){he.event.remove(this,e,o,t)})},trigger:function(e,t){return this.each(function(){he.event.trigger(e,t,this)})},triggerHandler:function(e,t){var o=this[0];if(o)return he.event.trigger(e,t,o,!0)}});var Ze=/ jQuery\d+="(?:null|\d+)"/g,Je=new RegExp("<(?:"+ze+")[\\s/>]","i"),et=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,tt=/<script|<style|<link/i,ot=/checked\s*(?:[^=]|=\s*.checked.)/i,nt=/^true\/(.*)/,rt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,it=h(ne),at=it.appendChild(ne.createElement("div"));he.extend({htmlPrefilter:function(e){return e.replace(et,"<$1></$2>")},clone:function(e,t,o){var n,r,i,a,s,l=he.contains(e.ownerDocument,e);if(ue.html5Clone||he.isXMLDoc(e)||!Je.test("<"+e.nodeName+">")?i=e.cloneNode(!0):(at.innerHTML=e.outerHTML,at.removeChild(i=at.firstChild)),!(ue.noCloneEvent&&ue.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||he.isXMLDoc(e)))for(n=f(i),s=f(e),a=0;null!=(r=s[a]);++a)n[a]&&T(r,n[a]);if(t)if(o)for(s=s||f(e),n=n||f(i),a=0;null!=(r=s[a]);a++)k(r,n[a]);else k(e,i);return n=f(i,"script"),n.length>0&&m(n,!l&&f(e,"script")),n=s=r=null,i},cleanData:function(e,t){for(var o,n,r,i,a=0,s=he.expando,l=he.cache,c=ue.attributes,d=he.event.special;null!=(o=e[a]);a++)if((t||Ae(o))&&(r=o[s],i=r&&l[r])){if(i.events)for(n in i.events)d[n]?he.event.remove(o,n):he.removeEvent(o,n,i.handle);l[r]&&(delete l[r],c||"undefined"==typeof o.removeAttribute?o[s]=undefined:o.removeAttribute(s),oe.push(r))}}}),he.fn.extend({domManip:E,detach:function(e){return F(this,e,!0)},remove:function(e){return F(this,e)},text:function(e){return Ne(this,function(e){return e===undefined?he.text(this):this.empty().append((this[0]&&this[0].ownerDocument||ne).createTextNode(e))},null,e,arguments.length)},append:function(){return E(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){x(this,e).appendChild(e)}})},prepend:function(){return E(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=x(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return E(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return E(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++){for(1===e.nodeType&&he.cleanData(f(e,!1));e.firstChild;)e.removeChild(e.firstChild);e.options&&he.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return he.clone(this,e,t)})},html:function(e){return Ne(this,function(e){var t=this[0]||{},o=0,n=this.length;if(e===undefined)return 1===t.nodeType?t.innerHTML.replace(Ze,""):undefined;if("string"==typeof e&&!tt.test(e)&&(ue.htmlSerialize||!Je.test(e))&&(ue.leadingWhitespace||!Be.test(e))&&!Ve[(je.exec(e)||["",""])[1].toLowerCase()]){e=he.htmlPrefilter(e);try{for(;o<n;o++)t=this[o]||{},1===t.nodeType&&(he.cleanData(f(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=[];return E(this,arguments,function(t){var o=this.parentNode;he.inArray(this,e)<0&&(he.cleanData(f(this)),o&&o.replaceChild(t,this))},e)}}),he.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){he.fn[e]=function(e){for(var o,n=0,r=[],i=he(e),a=i.length-1;n<=a;n++)o=n===a?this:this.clone(!0),he(i[n])[t](o),ae.apply(r,o.get());return this.pushStack(r)}});var st,lt={HTML:"block",BODY:"block"},ct=/^margin/,dt=new RegExp("^("+Re+")(?!px)[a-z%]+$","i"),ut=function(e,t,o,n){var r,i,a={};for(i in t)a[i]=e.style[i],e.style[i]=t[i];r=o.apply(e,n||[]);for(i in t)e.style[i]=a[i];return r},pt=ne.documentElement;!function(){function t(){var t,d,u=ne.documentElement;u.appendChild(l),c.style.cssText="-webkit-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",o=r=s=!1,n=a=!0,e.getComputedStyle&&(d=e.getComputedStyle(c),o="1%"!==(d||{}).top,s="2px"===(d||{}).marginLeft,r="4px"===(d||{width:"4px"}).width,c.style.marginRight="50%",n="4px"===(d||{marginRight:"4px"}).marginRight,t=c.appendChild(ne.createElement("div")),t.style.cssText=c.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",t.style.marginRight=t.style.width="0",c.style.width="1px",a=!parseFloat((e.getComputedStyle(t)||{}).marginRight),c.removeChild(t)),c.style.display="none",i=0===c.getClientRects().length,i&&(c.style.display="",c.innerHTML="<table><tr><td></td><td>t</td></tr></table>",c.childNodes[0].style.borderCollapse="separate",t=c.getElementsByTagName("td"),t[0].style.cssText="margin:0;border:0;padding:0;display:none",(i=0===t[0].offsetHeight)&&(t[0].style.display="",t[1].style.display="none",i=0===t[0].offsetHeight)),u.removeChild(l)}var o,n,r,i,a,s,l=ne.createElement("div"),c=ne.createElement("div");c.style&&(c.style.cssText="float:left;opacity:.5",ue.opacity="0.5"===c.style.opacity,ue.cssFloat=!!c.style.cssFloat,c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",ue.clearCloneStyle="content-box"===c.style.backgroundClip,l=ne.createElement("div"),l.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",c.innerHTML="",l.appendChild(c),ue.boxSizing=""===c.style.boxSizing||""===c.style.MozBoxSizing||""===c.style.WebkitBoxSizing,he.extend(ue,{reliableHiddenOffsets:function(){return null==o&&t(),i},boxSizingReliable:function(){return null==o&&t(),r},pixelMarginRight:function(){return null==o&&t(),n},pixelPosition:function(){return null==o&&t(),o},reliableMarginRight:function(){return null==o&&t(),a},reliableMarginLeft:function(){return null==o&&t(),s}}))}();var ht,ft,mt=/^(top|right|bottom|left)$/;e.getComputedStyle?(ht=function(t){var o=t.ownerDocument.defaultView;return o&&o.opener||(o=e),o.getComputedStyle(t)},ft=function(e,t,o){var n,r,i,a,s=e.style;return o=o||ht(e),a=o?o.getPropertyValue(t)||o[t]:undefined,""!==a&&a!==undefined||he.contains(e.ownerDocument,e)||(a=he.style(e,t)),o&&!ue.pixelMarginRight()&&dt.test(a)&&ct.test(t)&&(n=s.width,r=s.minWidth,i=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=o.width,s.width=n,s.minWidth=r,s.maxWidth=i),a===undefined?a:a+""}):pt.currentStyle&&(ht=function(e){return e.currentStyle},ft=function(e,t,o){var n,r,i,a,s=e.style;return o=o||ht(e),a=o?o[t]:undefined,null==a&&s&&s[t]&&(a=s[t]),dt.test(a)&&!mt.test(t)&&(n=s.left,r=e.runtimeStyle,i=r&&r.left,i&&(r.left=e.currentStyle.left),s.left="fontSize"===t?"1em":a,a=s.pixelLeft+"px",s.left=n,i&&(r.left=i)),a===undefined?a:a+""||"auto"});var gt=/alpha\([^)]*\)/i,vt=/opacity\s*=\s*([^)]*)/i,yt=/^(none|table(?!-c[ea]).+)/,bt=new RegExp("^("+Re+")(.*)$","i"),Ct={position:"absolute",visibility:"hidden",display:"block"},wt={letterSpacing:"0",fontWeight:"400"},xt=["Webkit","O","Moz","ms"],St=ne.createElement("div").style;he.extend({cssHooks:{opacity:{get:function(e,t){if(t){var o=ft(e,"opacity");return""===o?"1":o}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":ue.cssFloat?"cssFloat":"styleFloat"},style:function(e,t,o,n){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var r,i,a,s=he.camelCase(t),l=e.style;if(t=he.cssProps[s]||(he.cssProps[s]=P(s)||s),a=he.cssHooks[t]||he.cssHooks[s],o===undefined)return a&&"get"in a&&(r=a.get(e,!1,n))!==undefined?r:l[t];if(i=typeof o,"string"===i&&(r=Ie.exec(o))&&r[1]&&(o=p(e,t,r),i="number"),null!=o&&o===o&&("number"===i&&(o+=r&&r[3]||(he.cssNumber[s]?"":"px")),ue.clearCloneStyle||""!==o||0!==t.indexOf("background")||(l[t]="inherit"),!(a&&"set"in a&&(o=a.set(e,o,n))===undefined)))try{l[t]=o}catch(e){}}},css:function(e,t,o,n){var r,i,a,s=he.camelCase(t);return t=he.cssProps[s]||(he.cssProps[s]=P(s)||s),a=he.cssHooks[t]||he.cssHooks[s],a&&"get"in a&&(i=a.get(e,!0,o)),i===undefined&&(i=ft(e,t,n)),"normal"===i&&t in wt&&(i=wt[t]),""===o||o?(r=parseFloat(i),!0===o||isFinite(r)?r||0:i):i}}),he.each(["height","width"],function(e,t){he.cssHooks[t]={get:function(e,o,n){if(o)return yt.test(he.css(e,"display"))&&0===e.offsetWidth?ut(e,Ct,function(){return O(e,t,n)}):O(e,t,n)},set:function(e,o,n){var r=n&&ht(e);return R(e,o,n?I(e,t,n,ue.boxSizing&&"border-box"===he.css(e,"boxSizing",!1,r),r):0)}}}),ue.opacity||(he.cssHooks.opacity={get:function(e,t){return vt.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var o=e.style,n=e.currentStyle,r=he.isNumeric(t)?"alpha(opacity="+100*t+")":"",i=n&&n.filter||o.filter||"";o.zoom=1,(t>=1||""===t)&&""===he.trim(i.replace(gt,""))&&o.removeAttribute&&(o.removeAttribute("filter"),""===t||n&&!n.filter)||(o.filter=gt.test(i)?i.replace(gt,r):i+" "+r)}}),he.cssHooks.marginRight=A(ue.reliableMarginRight,function(e,t){if(t)return ut(e,{display:"inline-block"},ft,[e,"marginRight"])}),he.cssHooks.marginLeft=A(ue.reliableMarginLeft,function(e,t){if(t)return(parseFloat(ft(e,"marginLeft"))||(he.contains(e.ownerDocument,e)?e.getBoundingClientRect().left-ut(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}):0))+"px"}),he.each({margin:"",padding:"",border:"Width"},function(e,t){he.cssHooks[e+t]={expand:function(o){for(var n=0,r={},i="string"==typeof o?o.split(" "):[o];n<4;n++)r[e+Oe[n]+t]=i[n]||i[n-2]||i[0];return r}},ct.test(e)||(he.cssHooks[e+t].set=R)}),he.fn.extend({css:function(e,t){return Ne(this,function(e,t,o){var n,r,i={},a=0;if(he.isArray(t)){for(n=ht(e),r=t.length;a<r;a++)i[t[a]]=he.css(e,t[a],!1,n);return i}return o!==undefined?he.style(e,t,o):he.css(e,t)},e,t,arguments.length>1)},show:function(){return L(this,!0)},hide:function(){return L(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){$e(this)?he(this).show():he(this).hide()})}}),he.Tween=$,$.prototype={constructor:$,init:function(e,t,o,n,r,i){this.elem=e,this.prop=o,this.easing=r||he.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=n,this.unit=i||(he.cssNumber[o]?"":"px")},cur:function(){var e=$.propHooks[this.prop];return e&&e.get?e.get(this):$.propHooks._default.get(this)},run:function(e){var t,o=$.propHooks[this.prop];return this.options.duration?this.pos=t=he.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),o&&o.set?o.set(this):$.propHooks._default.set(this),this}},$.prototype.init.prototype=$.prototype,$.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=he.css(e.elem,e.prop,""),t&&"auto"!==t?t:0)},set:function(e){he.fx.step[e.prop]?he.fx.step[e.prop](e):1!==e.elem.nodeType||null==e.elem.style[he.cssProps[e.prop]]&&!he.cssHooks[e.prop]?e.elem[e.prop]=e.now:he.style(e.elem,e.prop,e.now+e.unit)}}},$.propHooks.scrollTop=$.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},he.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},he.fx=$.prototype.init,he.fx.step={};var _t,kt,Tt=/^(?:toggle|show|hide)$/,Et=/queueHooks$/;he.Animation=he.extend(z,{tweeners:{"*":[function(e,t){var o=this.createTween(e,t);return p(o.elem,e,Ie.exec(t),o),o}]},tweener:function(e,t){he.isFunction(e)?(t=e,e=["*"]):e=e.match(Fe);for(var o,n=0,r=e.length;n<r;n++)o=e[n],z.tweeners[o]=z.tweeners[o]||[],z.tweeners[o].unshift(t)},prefilters:[H],prefilter:function(e,t){t?z.prefilters.unshift(e):z.prefilters.push(e)}}),he.speed=function(e,t,o){var n=e&&"object"==typeof e?he.extend({},e):{complete:o||!o&&t||he.isFunction(e)&&e,duration:e,easing:o&&t||t&&!he.isFunction(t)&&t};return n.duration=he.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in he.fx.speeds?he.fx.speeds[n.duration]:he.fx.speeds._default,null!=n.queue&&!0!==n.queue||(n.queue="fx"),n.old=n.complete,n.complete=function(){he.isFunction(n.old)&&n.old.call(this),n.queue&&he.dequeue(this,n.queue)},n},he.fn.extend({fadeTo:function(e,t,o,n){return this.filter($e).css("opacity",0).show().end().animate({opacity:t},e,o,n)},animate:function(e,t,o,n){var r=he.isEmptyObject(e),i=he.speed(t,o,n),a=function(){var t=z(this,he.extend({},e),i);(r||he._data(this,"finish"))&&t.stop(!0)};return a.finish=a,r||!1===i.queue?this.each(a):this.queue(i.queue,a)},stop:function(e,t,o){var n=function(e){var t=e.stop;delete e.stop,t(o)};return"string"!=typeof e&&(o=t,t=e,e=undefined),t&&!1!==e&&this.queue(e||"fx",[]),this.each(function(){var t=!0,r=null!=e&&e+"queueHooks",i=he.timers,a=he._data(this);if(r)a[r]&&a[r].stop&&n(a[r]);else for(r in a)a[r]&&a[r].stop&&Et.test(r)&&n(a[r]);for(r=i.length;r--;)i[r].elem!==this||null!=e&&i[r].queue!==e||(i[r].anim.stop(o),t=!1,i.splice(r,1));!t&&o||he.dequeue(this,e)})},finish:function(e){return!1!==e&&(e=e||"fx"),this.each(function(){var t,o=he._data(this),n=o[e+"queue"],r=o[e+"queueHooks"],i=he.timers,a=n?n.length:0;for(o.finish=!0,he.queue(this,e,[]),r&&r.stop&&r.stop.call(this,!0),t=i.length;t--;)i[t].elem===this&&i[t].queue===e&&(i[t].anim.stop(!0),i.splice(t,1));for(t=0;t<a;t++)n[t]&&n[t].finish&&n[t].finish.call(this);delete o.finish})}}),he.each(["toggle","show","hide"],function(e,t){var o=he.fn[t];he.fn[t]=function(e,n,r){return null==e||"boolean"==typeof e?o.apply(this,arguments):this.animate(U(t,!0),e,n,r)}}),he.each({slideDown:U("show"),slideUp:U("hide"),slideToggle:U("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){he.fn[e]=function(e,o,n){return this.animate(t,e,o,n)}}),he.timers=[],he.fx.tick=function(){var e,t=he.timers,o=0;for(_t=he.now();o<t.length;o++)(e=t[o])()||t[o]!==e||t.splice(o--,1);t.length||he.fx.stop(),_t=undefined},he.fx.timer=function(e){he.timers.push(e),e()?he.fx.start():he.timers.pop()},he.fx.interval=13,he.fx.start=function(){kt||(kt=e.setInterval(he.fx.tick,he.fx.interval))},he.fx.stop=function(){e.clearInterval(kt),kt=null},he.fx.speeds={slow:600,fast:200,_default:400},he.fn.delay=function(t,o){return t=he.fx?he.fx.speeds[t]||t:t,o=o||"fx",this.queue(o,function(o,n){var r=e.setTimeout(o,t);n.stop=function(){e.clearTimeout(r)}})},function(){var e,t=ne.createElement("input"),o=ne.createElement("div"),n=ne.createElement("select"),r=n.appendChild(ne.createElement("option"));o=ne.createElement("div"),o.setAttribute("className","t"),o.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",e=o.getElementsByTagName("a")[0],t.setAttribute("type","checkbox"),o.appendChild(t),e=o.getElementsByTagName("a")[0],e.style.cssText="top:1px",ue.getSetAttribute="t"!==o.className,ue.style=/top/.test(e.getAttribute("style")),ue.hrefNormalized="/a"===e.getAttribute("href"),ue.checkOn=!!t.value,ue.optSelected=r.selected,ue.enctype=!!ne.createElement("form").enctype,n.disabled=!0,ue.optDisabled=!r.disabled,t=ne.createElement("input"),t.setAttribute("value",""),ue.input=""===t.getAttribute("value"),t.value="t",t.setAttribute("type","radio"),ue.radioValue="t"===t.value}();var Ft=/\r/g,Dt=/[\x20\t\r\n\f]+/g;he.fn.extend({val:function(e){var t,o,n,r=this[0];{if(arguments.length)return n=he.isFunction(e),this.each(function(o){var r;1===this.nodeType&&(r=n?e.call(this,o,he(this).val()):e,null==r?r="":"number"==typeof r?r+="":he.isArray(r)&&(r=he.map(r,function(e){return null==e?"":e+""})),(t=he.valHooks[this.type]||he.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&t.set(this,r,"value")!==undefined||(this.value=r))});if(r)return(t=he.valHooks[r.type]||he.valHooks[r.nodeName.toLowerCase()])&&"get"in t&&(o=t.get(r,"value"))!==undefined?o:(o=r.value,"string"==typeof o?o.replace(Ft,""):null==o?"":o)}}}),he.extend({valHooks:{option:{get:function(e){var t=he.find.attr(e,"value");return null!=t?t:he.trim(he.text(e)).replace(Dt," ")}},select:{get:function(e){for(var t,o,n=e.options,r=e.selectedIndex,i="select-one"===e.type||r<0,a=i?null:[],s=i?r+1:n.length,l=r<0?s:i?r:0;l<s;l++)if(o=n[l],(o.selected||l===r)&&(ue.optDisabled?!o.disabled:null===o.getAttribute("disabled"))&&(!o.parentNode.disabled||!he.nodeName(o.parentNode,"optgroup"))){if(t=he(o).val(),i)return t;a.push(t)}return a},set:function(e,t){for(var o,n,r=e.options,i=he.makeArray(t),a=r.length;a--;)if(n=r[a],he.inArray(he.valHooks.option.get(n),i)>-1)try{n.selected=o=!0}catch(e){n.scrollHeight}else n.selected=!1;return o||(e.selectedIndex=-1),r}}}}),he.each(["radio","checkbox"],function(){he.valHooks[this]={set:function(e,t){if(he.isArray(t))return e.checked=he.inArray(he(e).val(),t)>-1}},ue.checkOn||(he.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var Mt,At,Pt=he.expr.attrHandle,Lt=/^(?:checked|selected)$/i,Rt=ue.getSetAttribute,It=ue.input;he.fn.extend({attr:function(e,t){return Ne(this,he.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){he.removeAttr(this,e)})}}),he.extend({attr:function(e,t,o){var n,r,i=e.nodeType;if(3!==i&&8!==i&&2!==i)return"undefined"==typeof e.getAttribute?he.prop(e,t,o):(1===i&&he.isXMLDoc(e)||(t=t.toLowerCase(),r=he.attrHooks[t]||(he.expr.match.bool.test(t)?At:Mt)),o!==undefined?null===o?void he.removeAttr(e,t):r&&"set"in r&&(n=r.set(e,o,t))!==undefined?n:(e.setAttribute(t,o+""),o):r&&"get"in r&&null!==(n=r.get(e,t))?n:(n=he.find.attr(e,t),null==n?undefined:n))},attrHooks:{type:{set:function(e,t){if(!ue.radioValue&&"radio"===t&&he.nodeName(e,"input")){var o=e.value;return e.setAttribute("type",t),o&&(e.value=o),t}}}},removeAttr:function(e,t){var o,n,r=0,i=t&&t.match(Fe);if(i&&1===e.nodeType)for(;o=i[r++];)n=he.propFix[o]||o,he.expr.match.bool.test(o)?It&&Rt||!Lt.test(o)?e[n]=!1:e[he.camelCase("default-"+o)]=e[n]=!1:he.attr(e,o,""),e.removeAttribute(Rt?o:n)}}),At={set:function(e,t,o){return!1===t?he.removeAttr(e,o):It&&Rt||!Lt.test(o)?e.setAttribute(!Rt&&he.propFix[o]||o,o):e[he.camelCase("default-"+o)]=e[o]=!0,o}},he.each(he.expr.match.bool.source.match(/\w+/g),function(e,t){var o=Pt[t]||he.find.attr;It&&Rt||!Lt.test(t)?Pt[t]=function(e,t,n){var r,i;return n||(i=Pt[t],Pt[t]=r,r=null!=o(e,t,n)?t.toLowerCase():null,Pt[t]=i),r}:Pt[t]=function(e,t,o){if(!o)return e[he.camelCase("default-"+t)]?t.toLowerCase():null}}),It&&Rt||(he.attrHooks.value={set:function(e,t,o){if(!he.nodeName(e,"input"))return Mt&&Mt.set(e,t,o);e.defaultValue=t}}),Rt||(Mt={set:function(e,t,o){var n=e.getAttributeNode(o);if(n||e.setAttributeNode(n=e.ownerDocument.createAttribute(o)),n.value=t+="","value"===o||t===e.getAttribute(o))return t}},Pt.id=Pt.name=Pt.coords=function(e,t,o){var n;if(!o)return(n=e.getAttributeNode(t))&&""!==n.value?n.value:null},he.valHooks.button={get:function(e,t){var o=e.getAttributeNode(t);if(o&&o.specified)return o.value},set:Mt.set},he.attrHooks.contenteditable={set:function(e,t,o){Mt.set(e,""!==t&&t,o)}},he.each(["width","height"],function(e,t){he.attrHooks[t]={set:function(e,o){if(""===o)return e.setAttribute(t,"auto"),o}}})),ue.style||(he.attrHooks.style={get:function(e){return e.style.cssText||undefined},set:function(e,t){return e.style.cssText=t+""}});var Ot=/^(?:input|select|textarea|button|object)$/i,$t=/^(?:a|area)$/i;he.fn.extend({prop:function(e,t){return Ne(this,he.prop,e,t,arguments.length>1)},removeProp:function(e){return e=he.propFix[e]||e,this.each(function(){try{this[e]=undefined,delete this[e]}catch(e){}})}}),he.extend({prop:function(e,t,o){var n,r,i=e.nodeType;if(3!==i&&8!==i&&2!==i)return 1===i&&he.isXMLDoc(e)||(t=he.propFix[t]||t,r=he.propHooks[t]),o!==undefined?r&&"set"in r&&(n=r.set(e,o,t))!==undefined?n:e[t]=o:r&&"get"in r&&null!==(n=r.get(e,t))?n:e[t]},propHooks:{tabIndex:{get:function(e){var t=he.find.attr(e,"tabindex");return t?parseInt(t,10):Ot.test(e.nodeName)||$t.test(e.nodeName)&&e.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),ue.hrefNormalized||he.each(["href","src"],function(e,t){he.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}}),ue.optSelected||(he.propHooks.selected={get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),he.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){he.propFix[this.toLowerCase()]=this}),ue.enctype||(he.propFix.enctype="encoding");var Nt=/[\t\r\n\f]/g;he.fn.extend({addClass:function(e){var t,o,n,r,i,a,s,l=0;if(he.isFunction(e))return this.each(function(t){he(this).addClass(e.call(this,t,V(this)))});if("string"==typeof e&&e)for(t=e.match(Fe)||[];o=this[l++];)if(r=V(o),n=1===o.nodeType&&(" "+r+" ").replace(Nt," ")){for(a=0;i=t[a++];)n.indexOf(" "+i+" ")<0&&(n+=i+" ");s=he.trim(n),r!==s&&he.attr(o,"class",s)}return this},removeClass:function(e){var t,o,n,r,i,a,s,l=0;if(he.isFunction(e))return this.each(function(t){he(this).removeClass(e.call(this,t,V(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof e&&e)for(t=e.match(Fe)||[];o=this[l++];)if(r=V(o),n=1===o.nodeType&&(" "+r+" ").replace(Nt," ")){for(a=0;i=t[a++];)for(;n.indexOf(" "+i+" ")>-1;)n=n.replace(" "+i+" "," ");s=he.trim(n),r!==s&&he.attr(o,"class",s)}return this},toggleClass:function(e,t){var o=typeof e;return"boolean"==typeof t&&"string"===o?t?this.addClass(e):this.removeClass(e):he.isFunction(e)?this.each(function(o){he(this).toggleClass(e.call(this,o,V(this),t),t)}):this.each(function(){var t,n,r,i;if("string"===o)for(n=0,r=he(this),i=e.match(Fe)||[];t=i[n++];)r.hasClass(t)?r.removeClass(t):r.addClass(t);else e!==undefined&&"boolean"!==o||(t=V(this),t&&he._data(this,"__className__",t),he.attr(this,"class",t||!1===e?"":he._data(this,"__className__")||""))})},hasClass:function(e){var t,o,n=0;for(t=" "+e+" ";o=this[n++];)if(1===o.nodeType&&(" "+V(o)+" ").replace(Nt," ").indexOf(t)>-1)return!0;return!1}}),he.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){he.fn[t]=function(e,o){return arguments.length>0?this.on(t,null,e,o):this.trigger(t)}}),he.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}});var Ut=e.location,jt=he.now(),Ht=/\?/,Bt=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;he.parseJSON=function(t){if(e.JSON&&e.JSON.parse)return e.JSON.parse(t+"");var o,n=null,r=he.trim(t+"");return r&&!he.trim(r.replace(Bt,function(e,t,r,i){return o&&t&&(n=0),0===n?e:(o=r||t,n+=!i-!r,"")}))?Function("return "+r)():he.error("Invalid JSON: "+t)},he.parseXML=function(t){var o,n;if(!t||"string"!=typeof t)return null;try{e.DOMParser?(n=new e.DOMParser,o=n.parseFromString(t,"text/xml")):(o=new e.ActiveXObject("Microsoft.XMLDOM"),o.async="false",o.loadXML(t))}catch(e){o=undefined}
return o&&o.documentElement&&!o.getElementsByTagName("parsererror").length||he.error("Invalid XML: "+t),o};var zt=/#.*$/,Vt=/([?&])_=[^&]*/,Yt=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Gt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Wt=/^(?:GET|HEAD)$/,qt=/^\/\//,Kt=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Xt={},Qt={},Zt="*/".concat("*"),Jt=Ut.href,eo=Kt.exec(Jt.toLowerCase())||[];he.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Jt,type:"GET",isLocal:Gt.test(eo[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Zt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":he.parseJSON,"text xml":he.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?W(W(e,he.ajaxSettings),t):W(he.ajaxSettings,e)},ajaxPrefilter:Y(Xt),ajaxTransport:Y(Qt),ajax:function(t,o){function n(t,o,n,r){var i,u,y,b,w,S=o;2!==C&&(C=2,l&&e.clearTimeout(l),d=undefined,s=r||"",x.readyState=t>0?4:0,i=t>=200&&t<300||304===t,n&&(b=q(p,x,n)),b=K(p,b,x,i),i?(p.ifModified&&(w=x.getResponseHeader("Last-Modified"),w&&(he.lastModified[a]=w),(w=x.getResponseHeader("etag"))&&(he.etag[a]=w)),204===t||"HEAD"===p.type?S="nocontent":304===t?S="notmodified":(S=b.state,u=b.data,y=b.error,i=!y)):(y=S,!t&&S||(S="error",t<0&&(t=0))),x.status=t,x.statusText=(o||S)+"",i?m.resolveWith(h,[u,S,x]):m.rejectWith(h,[x,S,y]),x.statusCode(v),v=undefined,c&&f.trigger(i?"ajaxSuccess":"ajaxError",[x,p,i?u:y]),g.fireWith(h,[x,S]),c&&(f.trigger("ajaxComplete",[x,p]),--he.active||he.event.trigger("ajaxStop")))}"object"==typeof t&&(o=t,t=undefined),o=o||{};var r,i,a,s,l,c,d,u,p=he.ajaxSetup({},o),h=p.context||p,f=p.context&&(h.nodeType||h.jquery)?he(h):he.event,m=he.Deferred(),g=he.Callbacks("once memory"),v=p.statusCode||{},y={},b={},C=0,w="canceled",x={readyState:0,getResponseHeader:function(e){var t;if(2===C){if(!u)for(u={};t=Yt.exec(s);)u[t[1].toLowerCase()]=t[2];t=u[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===C?s:null},setRequestHeader:function(e,t){var o=e.toLowerCase();return C||(e=b[o]=b[o]||e,y[e]=t),this},overrideMimeType:function(e){return C||(p.mimeType=e),this},statusCode:function(e){var t;if(e)if(C<2)for(t in e)v[t]=[v[t],e[t]];else x.always(e[x.status]);return this},abort:function(e){var t=e||w;return d&&d.abort(t),n(0,t),this}};if(m.promise(x).complete=g.add,x.success=x.done,x.error=x.fail,p.url=((t||p.url||Jt)+"").replace(zt,"").replace(qt,eo[1]+"//"),p.type=o.method||o.type||p.method||p.type,p.dataTypes=he.trim(p.dataType||"*").toLowerCase().match(Fe)||[""],null==p.crossDomain&&(r=Kt.exec(p.url.toLowerCase()),p.crossDomain=!(!r||r[1]===eo[1]&&r[2]===eo[2]&&(r[3]||("http:"===r[1]?"80":"443"))===(eo[3]||("http:"===eo[1]?"80":"443")))),p.data&&p.processData&&"string"!=typeof p.data&&(p.data=he.param(p.data,p.traditional)),G(Xt,p,o,x),2===C)return x;c=he.event&&p.global,c&&0==he.active++&&he.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!Wt.test(p.type),a=p.url,p.hasContent||(p.data&&(a=p.url+=(Ht.test(a)?"&":"?")+p.data,delete p.data),!1===p.cache&&(p.url=Vt.test(a)?a.replace(Vt,"$1_="+jt++):a+(Ht.test(a)?"&":"?")+"_="+jt++)),p.ifModified&&(he.lastModified[a]&&x.setRequestHeader("If-Modified-Since",he.lastModified[a]),he.etag[a]&&x.setRequestHeader("If-None-Match",he.etag[a])),(p.data&&p.hasContent&&!1!==p.contentType||o.contentType)&&x.setRequestHeader("Content-Type",p.contentType),x.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+Zt+"; q=0.01":""):p.accepts["*"]);for(i in p.headers)x.setRequestHeader(i,p.headers[i]);if(p.beforeSend&&(!1===p.beforeSend.call(h,x,p)||2===C))return x.abort();w="abort";for(i in{success:1,error:1,complete:1})x[i](p[i]);if(d=G(Qt,p,o,x)){if(x.readyState=1,c&&f.trigger("ajaxSend",[x,p]),2===C)return x;p.async&&p.timeout>0&&(l=e.setTimeout(function(){x.abort("timeout")},p.timeout));try{C=1,d.send(y,n)}catch(e){if(!(C<2))throw e;n(-1,e)}}else n(-1,"No Transport");return x},getJSON:function(e,t,o){return he.get(e,t,o,"json")},getScript:function(e,t){return he.get(e,undefined,t,"script")}}),he.each(["get","post"],function(e,t){he[t]=function(e,o,n,r){return he.isFunction(o)&&(r=r||n,n=o,o=undefined),he.ajax(he.extend({url:e,type:t,dataType:r,data:o,success:n},he.isPlainObject(e)&&e))}}),he._evalUrl=function(e){return he.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,"throws":!0})},he.fn.extend({wrapAll:function(e){if(he.isFunction(e))return this.each(function(t){he(this).wrapAll(e.call(this,t))});if(this[0]){var t=he(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return he.isFunction(e)?this.each(function(t){he(this).wrapInner(e.call(this,t))}):this.each(function(){var t=he(this),o=t.contents();o.length?o.wrapAll(e):t.append(e)})},wrap:function(e){var t=he.isFunction(e);return this.each(function(o){he(this).wrapAll(t?e.call(this,o):e)})},unwrap:function(){return this.parent().each(function(){he.nodeName(this,"body")||he(this).replaceWith(this.childNodes)}).end()}}),he.expr.filters.hidden=function(e){return ue.reliableHiddenOffsets()?e.offsetWidth<=0&&e.offsetHeight<=0&&!e.getClientRects().length:Q(e)},he.expr.filters.visible=function(e){return!he.expr.filters.hidden(e)};var to=/%20/g,oo=/\[\]$/,no=/\r?\n/g,ro=/^(?:submit|button|image|reset|file)$/i,io=/^(?:input|select|textarea|keygen)/i;he.param=function(e,t){var o,n=[],r=function(e,t){t=he.isFunction(t)?t():null==t?"":t,n[n.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(t===undefined&&(t=he.ajaxSettings&&he.ajaxSettings.traditional),he.isArray(e)||e.jquery&&!he.isPlainObject(e))he.each(e,function(){r(this.name,this.value)});else for(o in e)Z(o,e[o],t,r);return n.join("&").replace(to,"+")},he.fn.extend({serialize:function(){return he.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=he.prop(this,"elements");return e?he.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!he(this).is(":disabled")&&io.test(this.nodeName)&&!ro.test(e)&&(this.checked||!Ue.test(e))}).map(function(e,t){var o=he(this).val();return null==o?null:he.isArray(o)?he.map(o,function(e){return{name:t.name,value:e.replace(no,"\r\n")}}):{name:t.name,value:o.replace(no,"\r\n")}}).get()}}),he.ajaxSettings.xhr=e.ActiveXObject!==undefined?function(){return this.isLocal?ee():ne.documentMode>8?J():/^(get|post|head|put|delete|options)$/i.test(this.type)&&J()||ee()}:J;var ao=0,so={},lo=he.ajaxSettings.xhr();e.attachEvent&&e.attachEvent("onunload",function(){for(var e in so)so[e](undefined,!0)}),ue.cors=!!lo&&"withCredentials"in lo,lo=ue.ajax=!!lo,lo&&he.ajaxTransport(function(t){if(!t.crossDomain||ue.cors){var o;return{send:function(n,r){var i,a=t.xhr(),s=++ao;if(a.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(i in t.xhrFields)a[i]=t.xhrFields[i];t.mimeType&&a.overrideMimeType&&a.overrideMimeType(t.mimeType),t.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest");for(i in n)n[i]!==undefined&&a.setRequestHeader(i,n[i]+"");a.send(t.hasContent&&t.data||null),o=function(e,n){var i,l,c;if(o&&(n||4===a.readyState))if(delete so[s],o=undefined,a.onreadystatechange=he.noop,n)4!==a.readyState&&a.abort();else{c={},i=a.status,"string"==typeof a.responseText&&(c.text=a.responseText);try{l=a.statusText}catch(e){l=""}i||!t.isLocal||t.crossDomain?1223===i&&(i=204):i=c.text?200:404}c&&r(i,l,c,a.getAllResponseHeaders())},t.async?4===a.readyState?e.setTimeout(o):a.onreadystatechange=so[s]=o:o()},abort:function(){o&&o(undefined,!0)}}}}),he.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return he.globalEval(e),e}}}),he.ajaxPrefilter("script",function(e){e.cache===undefined&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),he.ajaxTransport("script",function(e){if(e.crossDomain){var t,o=ne.head||he("head")[0]||ne.documentElement;return{send:function(n,r){t=ne.createElement("script"),t.async=!0,e.scriptCharset&&(t.charset=e.scriptCharset),t.src=e.url,t.onload=t.onreadystatechange=function(e,o){(o||!t.readyState||/loaded|complete/.test(t.readyState))&&(t.onload=t.onreadystatechange=null,t.parentNode&&t.parentNode.removeChild(t),t=null,o||r(200,"success"))},o.insertBefore(t,o.firstChild)},abort:function(){t&&t.onload(undefined,!0)}}}});var co=[],uo=/(=)\?(?=&|$)|\?\?/;he.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=co.pop()||he.expando+"_"+jt++;return this[e]=!0,e}}),he.ajaxPrefilter("json jsonp",function(t,o,n){var r,i,a,s=!1!==t.jsonp&&(uo.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&uo.test(t.data)&&"data");if(s||"jsonp"===t.dataTypes[0])return r=t.jsonpCallback=he.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,s?t[s]=t[s].replace(uo,"$1"+r):!1!==t.jsonp&&(t.url+=(Ht.test(t.url)?"&":"?")+t.jsonp+"="+r),t.converters["script json"]=function(){return a||he.error(r+" was not called"),a[0]},t.dataTypes[0]="json",i=e[r],e[r]=function(){a=arguments},n.always(function(){i===undefined?he(e).removeProp(r):e[r]=i,t[r]&&(t.jsonpCallback=o.jsonpCallback,co.push(r)),a&&he.isFunction(i)&&i(a[0]),a=i=undefined}),"script"}),he.parseHTML=function(e,t,o){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(o=t,t=!1),t=t||ne;var n=xe.exec(e),r=!o&&[];return n?[t.createElement(n[1])]:(n=v([e],t,r),r&&r.length&&he(r).remove(),he.merge([],n.childNodes))};var po=he.fn.load;he.fn.load=function(e,t,o){if("string"!=typeof e&&po)return po.apply(this,arguments);var n,r,i,a=this,s=e.indexOf(" ");return s>-1&&(n=he.trim(e.slice(s,e.length)),e=e.slice(0,s)),he.isFunction(t)?(o=t,t=undefined):t&&"object"==typeof t&&(r="POST"),a.length>0&&he.ajax({url:e,type:r||"GET",dataType:"html",data:t}).done(function(e){i=arguments,a.html(n?he("<div>").append(he.parseHTML(e)).find(n):e)}).always(o&&function(e,t){a.each(function(){o.apply(this,i||[e.responseText,t,e])})}),this},he.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){he.fn[t]=function(e){return this.on(t,e)}}),he.expr.filters.animated=function(e){return he.grep(he.timers,function(t){return e===t.elem}).length},he.offset={setOffset:function(e,t,o){var n,r,i,a,s,l,c,d=he.css(e,"position"),u=he(e),p={};"static"===d&&(e.style.position="relative"),s=u.offset(),i=he.css(e,"top"),l=he.css(e,"left"),c=("absolute"===d||"fixed"===d)&&he.inArray("auto",[i,l])>-1,c?(n=u.position(),a=n.top,r=n.left):(a=parseFloat(i)||0,r=parseFloat(l)||0),he.isFunction(t)&&(t=t.call(e,o,he.extend({},s))),null!=t.top&&(p.top=t.top-s.top+a),null!=t.left&&(p.left=t.left-s.left+r),"using"in t?t.using.call(e,p):u.css(p)}},he.fn.extend({offset:function(e){if(arguments.length)return e===undefined?this:this.each(function(t){he.offset.setOffset(this,e,t)});var t,o,n={top:0,left:0},r=this[0],i=r&&r.ownerDocument;if(i)return t=i.documentElement,he.contains(t,r)?("undefined"!=typeof r.getBoundingClientRect&&(n=r.getBoundingClientRect()),o=te(i),{top:n.top+(o.pageYOffset||t.scrollTop)-(t.clientTop||0),left:n.left+(o.pageXOffset||t.scrollLeft)-(t.clientLeft||0)}):n},position:function(){if(this[0]){var e,t,o={top:0,left:0},n=this[0];return"fixed"===he.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),he.nodeName(e[0],"html")||(o=e.offset()),o.top+=he.css(e[0],"borderTopWidth",!0),o.left+=he.css(e[0],"borderLeftWidth",!0)),{top:t.top-o.top-he.css(n,"marginTop",!0),left:t.left-o.left-he.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&!he.nodeName(e,"html")&&"static"===he.css(e,"position");)e=e.offsetParent;return e||pt})}}),he.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var o=/Y/.test(t);he.fn[e]=function(n){return Ne(this,function(e,n,r){var i=te(e);if(r===undefined)return i?t in i?i[t]:i.document.documentElement[n]:e[n];i?i.scrollTo(o?he(i).scrollLeft():r,o?r:he(i).scrollTop()):e[n]=r},e,n,arguments.length,null)}}),he.each(["top","left"],function(e,t){he.cssHooks[t]=A(ue.pixelPosition,function(e,o){if(o)return o=ft(e,t),dt.test(o)?he(e).position()[t]+"px":o})}),he.each({Height:"height",Width:"width"},function(e,t){he.each({padding:"inner"+e,content:t,"":"outer"+e},function(o,n){he.fn[n]=function(n,r){var i=arguments.length&&(o||"boolean"!=typeof n),a=o||(!0===n||!0===r?"margin":"border");return Ne(this,function(t,o,n){var r;return he.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(r=t.documentElement,Math.max(t.body["scroll"+e],r["scroll"+e],t.body["offset"+e],r["offset"+e],r["client"+e])):n===undefined?he.css(t,o,a):he.style(t,o,n,a)},t,i?n:undefined,i,null)}})}),he.fn.extend({bind:function(e,t,o){return this.on(e,null,t,o)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,o,n){return this.on(t,e,o,n)},undelegate:function(e,t,o){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",o)}}),he.fn.size=function(){return this.length},he.fn.andSelf=he.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return he});var ho=e.jQuery,fo=e.$;return he.noConflict=function(t){return e.$===he&&(e.$=fo),t&&e.jQuery===he&&(e.jQuery=ho),he},t||(e.jQuery=e.$=he),he}),function(e,t){"use strict";e.rails!==t&&e.error("jquery-ujs has already been loaded!");var o,n=e(document);e.rails=o={linkClickSelector:"a[data-confirm], a[data-method], a[data-remote]:not([disabled]), a[data-disable-with], a[data-disable]",buttonClickSelector:"button[data-remote]:not([form]):not(form button), button[data-confirm]:not([form]):not(form button)",inputChangeSelector:"select[data-remote], input[data-remote], textarea[data-remote]",formSubmitSelector:"form",formInputClickSelector:"form input[type=submit], form input[type=image], form button[type=submit], form button:not([type]), input[type=submit][form], input[type=image][form], button[type=submit][form], button[form]:not([type])",disableSelector:"input[data-disable-with]:enabled, button[data-disable-with]:enabled, textarea[data-disable-with]:enabled, input[data-disable]:enabled, button[data-disable]:enabled, textarea[data-disable]:enabled",enableSelector:"input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled, input[data-disable]:disabled, button[data-disable]:disabled, textarea[data-disable]:disabled",requiredInputSelector:"input[name][required]:not([disabled]), textarea[name][required]:not([disabled])",fileInputSelector:"input[name][type=file]:not([disabled])",linkDisableSelector:"a[data-disable-with], a[data-disable]",buttonDisableSelector:"button[data-remote][data-disable-with], button[data-remote][data-disable]",csrfToken:function(){return e("meta[name=csrf-token]").attr("content")},csrfParam:function(){return e("meta[name=csrf-param]").attr("content")},CSRFProtection:function(e){var t=o.csrfToken();t&&e.setRequestHeader("X-CSRF-Token",t)},refreshCSRFTokens:function(){e('form input[name="'+o.csrfParam()+'"]').val(o.csrfToken())},fire:function(t,o,n){var r=e.Event(o);return t.trigger(r,n),!1!==r.result},confirm:function(e){return confirm(e)},ajax:function(t){return e.ajax(t)},href:function(e){return e[0].href},isRemote:function(e){return e.data("remote")!==t&&!1!==e.data("remote")},handleRemote:function(n){var r,i,a,s,l,c;if(o.fire(n,"ajax:before")){if(s=n.data("with-credentials")||null,l=n.data("type")||e.ajaxSettings&&e.ajaxSettings.dataType,n.is("form")){r=n.data("ujs:submit-button-formmethod")||n.attr("method"),i=n.data("ujs:submit-button-formaction")||n.attr("action"),a=e(n[0]).serializeArray();var d=n.data("ujs:submit-button");d&&(a.push(d),n.data("ujs:submit-button",null)),n.data("ujs:submit-button-formmethod",null),n.data("ujs:submit-button-formaction",null)}else n.is(o.inputChangeSelector)?(r=n.data("method"),i=n.data("url"),a=n.serialize(),n.data("params")&&(a=a+"&"+n.data("params"))):n.is(o.buttonClickSelector)?(r=n.data("method")||"get",i=n.data("url"),a=n.serialize(),n.data("params")&&(a=a+"&"+n.data("params"))):(r=n.data("method"),i=o.href(n),a=n.data("params")||null);return c={type:r||"GET",data:a,dataType:l,beforeSend:function(e,r){if(r.dataType===t&&e.setRequestHeader("accept","*/*;q=0.5, "+r.accepts.script),!o.fire(n,"ajax:beforeSend",[e,r]))return!1;n.trigger("ajax:send",e)},success:function(e,t,o){n.trigger("ajax:success",[e,t,o])},complete:function(e,t){n.trigger("ajax:complete",[e,t])},error:function(e,t,o){n.trigger("ajax:error",[e,t,o])},crossDomain:o.isCrossDomain(i)},s&&(c.xhrFields={withCredentials:s}),i&&(c.url=i),o.ajax(c)}return!1},isCrossDomain:function(e){var t=document.createElement("a");t.href=location.href;var o=document.createElement("a");try{return o.href=e,o.href=o.href,!((!o.protocol||":"===o.protocol)&&!o.host||t.protocol+"//"+t.host==o.protocol+"//"+o.host)}catch(e){return!0}},handleMethod:function(n){var r=o.href(n),i=n.data("method"),a=n.attr("target"),s=o.csrfToken(),l=o.csrfParam(),c=e('<form method="post" action="'+r+'"></form>'),d='<input name="_method" value="'+i+'" type="hidden" />';l===t||s===t||o.isCrossDomain(r)||(d+='<input name="'+l+'" value="'+s+'" type="hidden" />'),a&&c.attr("target",a),c.hide().append(d).appendTo("body"),c.submit()},formElements:function(t,o){return t.is("form")?e(t[0].elements).filter(o):t.find(o)},disableFormElements:function(t){o.formElements(t,o.disableSelector).each(function(){o.disableFormElement(e(this))})},disableFormElement:function(e){var o,n;o=e.is("button")?"html":"val",n=e.data("disable-with"),n!==t&&(e.data("ujs:enable-with",e[o]()),e[o](n)),e.prop("disabled",!0),e.data("ujs:disabled",!0)},enableFormElements:function(t){o.formElements(t,o.enableSelector).each(function(){o.enableFormElement(e(this))})},enableFormElement:function(e){var o=e.is("button")?"html":"val";e.data("ujs:enable-with")!==t&&(e[o](e.data("ujs:enable-with")),e.removeData("ujs:enable-with")),e.prop("disabled",!1),e.removeData("ujs:disabled")},allowAction:function(e){var t,n=e.data("confirm"),r=!1;if(!n)return!0;if(o.fire(e,"confirm")){try{r=o.confirm(n)}catch(e){(console.error||console.log).call(console,e.stack||e)}t=o.fire(e,"confirm:complete",[r])}return r&&t},blankInputs:function(t,o,n){var r,i,a,s,l=e(),c=o||"input,textarea",d=t.find(c),u={};return d.each(function(){r=e(this),r.is("input[type=radio]")?(s=r.attr("name"),u[s]||(0===t.find('input[type=radio]:checked[name="'+s+'"]').length&&(a=t.find('input[type=radio][name="'+s+'"]'),l=l.add(a)),u[s]=s)):(i=r.is("input[type=checkbox],input[type=radio]")?r.is(":checked"):!!r.val())===n&&(l=l.add(r))}),!!l.length&&l},nonBlankInputs:function(e,t){return o.blankInputs(e,t,!0)},stopEverything:function(t){return e(t.target).trigger("ujs:everythingStopped"),t.stopImmediatePropagation(),!1},disableElement:function(e){var n=e.data("disable-with");n!==t&&(e.data("ujs:enable-with",e.html()),e.html(n)),e.bind("click.railsDisable",function(e){return o.stopEverything(e)}),e.data("ujs:disabled",!0)},enableElement:function(e){e.data("ujs:enable-with")!==t&&(e.html(e.data("ujs:enable-with")),e.removeData("ujs:enable-with")),e.unbind("click.railsDisable"),e.removeData("ujs:disabled")}},o.fire(n,"rails:attachBindings")&&(e.ajaxPrefilter(function(e,t,n){e.crossDomain||o.CSRFProtection(n)}),e(window).on("pageshow.rails",function(){e(e.rails.enableSelector).each(function(){var t=e(this);t.data("ujs:disabled")&&e.rails.enableFormElement(t)}),e(e.rails.linkDisableSelector).each(function(){var t=e(this);t.data("ujs:disabled")&&e.rails.enableElement(t)})}),n.on("ajax:complete",o.linkDisableSelector,function(){o.enableElement(e(this))}),n.on("ajax:complete",o.buttonDisableSelector,function(){o.enableFormElement(e(this))}),n.on("click.rails",o.linkClickSelector,function(t){var n=e(this),r=n.data("method"),i=n.data("params"),a=t.metaKey||t.ctrlKey;if(!o.allowAction(n))return o.stopEverything(t);if(!a&&n.is(o.linkDisableSelector)&&o.disableElement(n),o.isRemote(n)){if(a&&(!r||"GET"===r)&&!i)return!0;var s=o.handleRemote(n);return!1===s?o.enableElement(n):s.fail(function(){o.enableElement(n)}),!1}return r?(o.handleMethod(n),!1):void 0}),n.on("click.rails",o.buttonClickSelector,function(t){var n=e(this);if(!o.allowAction(n)||!o.isRemote(n))return o.stopEverything(t);n.is(o.buttonDisableSelector)&&o.disableFormElement(n);var r=o.handleRemote(n);return!1===r?o.enableFormElement(n):r.fail(function(){o.enableFormElement(n)}),!1}),n.on("change.rails",o.inputChangeSelector,function(t){var n=e(this);return o.allowAction(n)&&o.isRemote(n)?(o.handleRemote(n),!1):o.stopEverything(t)}),n.on("submit.rails",o.formSubmitSelector,function(n){var r,i,a=e(this),s=o.isRemote(a);if(!o.allowAction(a))return o.stopEverything(n);if(a.attr("novalidate")===t)if(a.data("ujs:formnovalidate-button")===t){if((r=o.blankInputs(a,o.requiredInputSelector,!1))&&o.fire(a,"ajax:aborted:required",[r]))return o.stopEverything(n)}else a.data("ujs:formnovalidate-button",t);if(s){if(i=o.nonBlankInputs(a,o.fileInputSelector)){setTimeout(function(){o.disableFormElements(a)},13);var l=o.fire(a,"ajax:aborted:file",[i]);return l||setTimeout(function(){o.enableFormElements(a)},13),l}return o.handleRemote(a),!1}setTimeout(function(){o.disableFormElements(a)},13)}),n.on("click.rails",o.formInputClickSelector,function(t){var n=e(this);if(!o.allowAction(n))return o.stopEverything(t);var r=n.attr("name"),i=r?{name:r,value:n.val()}:null,a=n.closest("form");0===a.length&&(a=e("#"+n.attr("form"))),a.data("ujs:submit-button",i),a.data("ujs:formnovalidate-button",n.attr("formnovalidate")),a.data("ujs:submit-button-formaction",n.attr("formaction")),a.data("ujs:submit-button-formmethod",n.attr("formmethod"))}),n.on("ajax:send.rails",o.formSubmitSelector,function(t){this===t.target&&o.disableFormElements(e(this))}),n.on("ajax:complete.rails",o.formSubmitSelector,function(t){this===t.target&&o.enableFormElements(e(this))}),e(function(){o.refreshCSRFTokens()}))}(jQuery),function(e){"use strict";function t(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var o in t)if(e.style[o]!==undefined)return{end:t[o]};return!1}e.fn.emulateTransitionEnd=function(t){var o=!1,n=this;e(this).one("bsTransitionEnd",function(){o=!0});var r=function(){o||e(n).trigger(e.support.transition.end)};return setTimeout(r,t),this},e(function(){e.support.transition=t(),e.support.transition&&(e.event.special.bsTransitionEnd={bindType:e.support.transition.end,delegateType:e.support.transition.end,handle:function(t){if(e(t.target).is(this))return t.handleObj.handler.apply(this,arguments)}})})}(jQuery),function(e){"use strict";function t(t){return this.each(function(){var o=e(this),r=o.data("bs.alert");r||o.data("bs.alert",r=new n(this)),"string"==typeof t&&r[t].call(o)})}var o='[data-dismiss="alert"]',n=function(t){e(t).on("click",o,this.close)};n.VERSION="3.3.7",n.TRANSITION_DURATION=150,n.prototype.close=function(t){function o(){a.detach().trigger("closed.bs.alert").remove()}var r=e(this),i=r.attr("data-target");i||(i=r.attr("href"),i=i&&i.replace(/.*(?=#[^\s]*$)/,""));var a=e("#"===i?[]:i);t&&t.preventDefault(),a.length||(a=r.closest(".alert")),a.trigger(t=e.Event("close.bs.alert")),t.isDefaultPrevented()||(a.removeClass("in"),e.support.transition&&a.hasClass("fade")?a.one("bsTransitionEnd",o).emulateTransitionEnd(n.TRANSITION_DURATION):o())};var r=e.fn.alert;e.fn.alert=t,e.fn.alert.Constructor=n,e.fn.alert.noConflict=function(){return e.fn.alert=r,this},e(document).on("click.bs.alert.data-api",o,n.prototype.close)}(jQuery),function(e){"use strict";function t(t){return this.each(function(){var n=e(this),r=n.data("bs.button"),i="object"==typeof t&&t;r||n.data("bs.button",r=new o(this,i)),"toggle"==t?r.toggle():t&&r.setState(t)})}var o=function(t,n){this.$element=e(t),this.options=e.extend({},o.DEFAULTS,n),this.isLoading=!1};o.VERSION="3.3.7",o.DEFAULTS={loadingText:"loading..."},o.prototype.setState=function(t){var o="disabled",n=this.$element,r=n.is("input")?"val":"html",i=n.data();t+="Text",null==i.resetText&&n.data("resetText",n[r]()),setTimeout(e.proxy(function(){n[r](null==i[t]?this.options[t]:i[t]),"loadingText"==t?(this.isLoading=!0,n.addClass(o).attr(o,o).prop(o,!0)):this.isLoading&&(this.isLoading=!1,n.removeClass(o).removeAttr(o).prop(o,!1))},this),0)},o.prototype.toggle=function(){var e=!0,t=this.$element.closest('[data-toggle="buttons"]');if(t.length){var o=this.$element.find("input");"radio"==o.prop("type")?(o.prop("checked")&&(e=!1),t.find(".active").removeClass("active"),this.$element.addClass("active")):"checkbox"==o.prop("type")&&(o.prop("checked")!==this.$element.hasClass("active")&&(e=!1),this.$element.toggleClass("active")),o.prop("checked",this.$element.hasClass("active")),e&&o.trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active")),this.$element.toggleClass("active")};var n=e.fn.button;e.fn.button=t,e.fn.button.Constructor=o,e.fn.button.noConflict=function(){return e.fn.button=n,this},e(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(o){var n=e(o.target).closest(".btn");t.call(n,"toggle"),e(o.target).is('input[type="radio"], input[type="checkbox"]')||(o.preventDefault(),n.is("input,button")?n.trigger("focus"):n.find("input:visible,button:visible").first().trigger("focus"))}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(t){e(t.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(t.type))})}(jQuery),function(e){"use strict";function t(t){return this.each(function(){var n=e(this),r=n.data("bs.carousel"),i=e.extend({},o.DEFAULTS,n.data(),"object"==typeof t&&t),a="string"==typeof t?t:i.slide;r||n.data("bs.carousel",r=new o(this,i)),"number"==typeof t?r.to(t):a?r[a]():i.interval&&r.pause().cycle()})}var o=function(t,o){this.$element=e(t),this.$indicators=this.$element.find(".carousel-indicators"),this.options=o,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",e.proxy(this.keydown,this)),"hover"==this.options.pause&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",e.proxy(this.pause,this)).on("mouseleave.bs.carousel",e.proxy(this.cycle,this))};o.VERSION="3.3.7",o.TRANSITION_DURATION=600,o.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},o.prototype.keydown=function(e){if(!/input|textarea/i.test(e.target.tagName)){switch(e.which){case 37:this.prev();break;case 39:this.next();break;default:return}e.preventDefault()}},o.prototype.cycle=function(t){return t||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(e.proxy(this.next,this),this.options.interval)),this},o.prototype.getItemIndex=function(e){return this.$items=e.parent().children(".item"),this.$items.index(e||this.$active)},o.prototype.getItemForDirection=function(e,t){var o=this.getItemIndex(t);if(("prev"==e&&0===o||"next"==e&&o==this.$items.length-1)&&!this.options.wrap)return t;var n="prev"==e?-1:1,r=(o+n)%this.$items.length;return this.$items.eq(r)},o.prototype.to=function(e){var t=this,o=this.getItemIndex(this.$active=this.$element.find(".item.active"));if(!(e>this.$items.length-1||e<0))return this.sliding?this.$element.one("slid.bs.carousel",function(){t.to(e)}):o==e?this.pause().cycle():this.slide(e>o?"next":"prev",this.$items.eq(e))},o.prototype.pause=function(t){return t||(this.paused=!0),this.$element.find(".next, .prev").length&&e.support.transition&&(this.$element.trigger(e.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},o.prototype.next=function(){if(!this.sliding)return this.slide("next")},o.prototype.prev=function(){if(!this.sliding)return this.slide("prev")},o.prototype.slide=function(t,n){var r=this.$element.find(".item.active"),i=n||this.getItemForDirection(t,r),a=this.interval,s="next"==t?"left":"right",l=this;if(i.hasClass("active"))return this.sliding=!1;var c=i[0],d=e.Event("slide.bs.carousel",{relatedTarget:c,direction:s});if(this.$element.trigger(d),!d.isDefaultPrevented()){if(this.sliding=!0,a&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var u=e(this.$indicators.children()[this.getItemIndex(i)]);u&&u.addClass("active")}var p=e.Event("slid.bs.carousel",{relatedTarget:c,direction:s});return e.support.transition&&this.$element.hasClass("slide")?(i.addClass(t),i[0].offsetWidth,r.addClass(s),i.addClass(s),r.one("bsTransitionEnd",function(){i.removeClass([t,s].join(" ")).addClass("active"),r.removeClass(["active",s].join(" ")),l.sliding=!1,setTimeout(function(){l.$element.trigger(p)},0)}).emulateTransitionEnd(o.TRANSITION_DURATION)):(r.removeClass("active"),i.addClass("active"),this.sliding=!1,this.$element.trigger(p)),a&&this.cycle(),this}};var n=e.fn.carousel;e.fn.carousel=t,e.fn.carousel.Constructor=o,e.fn.carousel.noConflict=function(){return e.fn.carousel=n,this};var r=function(o){var n,r=e(this),i=e(r.attr("data-target")||(n=r.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,""));if(i.hasClass("carousel")){var a=e.extend({},i.data(),r.data()),s=r.attr("data-slide-to");s&&(a.interval=!1),t.call(i,a),s&&i.data("bs.carousel").to(s),o.preventDefault()}};e(document).on("click.bs.carousel.data-api","[data-slide]",r).on("click.bs.carousel.data-api","[data-slide-to]",r),e(window).on("load",function(){e('[data-ride="carousel"]').each(function(){var o=e(this);t.call(o,o.data())})})}(jQuery),function(e){"use strict";function t(t){var o,n=t.attr("data-target")||(o=t.attr("href"))&&o.replace(/.*(?=#[^\s]+$)/,"");return e(n)}function o(t){return this.each(function(){var o=e(this),r=o.data("bs.collapse"),i=e.extend({},n.DEFAULTS,o.data(),"object"==typeof t&&t);!r&&i.toggle&&/show|hide/.test(t)&&(i.toggle=!1),r||o.data("bs.collapse",r=new n(this,i)),"string"==typeof t&&r[t]()})}var n=function(t,o){this.$element=e(t),this.options=e.extend({},n.DEFAULTS,o),this.$trigger=e('[data-toggle="collapse"][href="#'+t.id+'"],[data-toggle="collapse"][data-target="#'+t.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};n.VERSION="3.3.7",n.TRANSITION_DURATION=350,n.DEFAULTS={toggle:!0},n.prototype.dimension=function(){return this.$element.hasClass("width")?"width":"height"},n.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var t,r=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(r&&r.length&&(t=r.data("bs.collapse"))&&t.transitioning)){var i=e.Event("show.bs.collapse");if(this.$element.trigger(i),!i.isDefaultPrevented()){r&&r.length&&(o.call(r,"hide"),t||r.data("bs.collapse",null));var a=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[a](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var s=function(){this.$element.removeClass("collapsing").addClass("collapse in")[a](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!e.support.transition)return s.call(this);var l=e.camelCase(["scroll",a].join("-"));this.$element.one("bsTransitionEnd",e.proxy(s,this)).emulateTransitionEnd(n.TRANSITION_DURATION)[a](this.$element[0][l])}}}},n.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var t=e.Event("hide.bs.collapse");if(this.$element.trigger(t),!t.isDefaultPrevented()){var o=this.dimension();this.$element[o](this.$element[o]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var r=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};if(!e.support.transition)return r.call(this);this.$element[o](0).one("bsTransitionEnd",e.proxy(r,this)).emulateTransitionEnd(n.TRANSITION_DURATION)}}},
n.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},n.prototype.getParent=function(){return e(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(e.proxy(function(o,n){var r=e(n);this.addAriaAndCollapsedClass(t(r),r)},this)).end()},n.prototype.addAriaAndCollapsedClass=function(e,t){var o=e.hasClass("in");e.attr("aria-expanded",o),t.toggleClass("collapsed",!o).attr("aria-expanded",o)};var r=e.fn.collapse;e.fn.collapse=o,e.fn.collapse.Constructor=n,e.fn.collapse.noConflict=function(){return e.fn.collapse=r,this},e(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(n){var r=e(this);r.attr("data-target")||n.preventDefault();var i=t(r),a=i.data("bs.collapse"),s=a?"toggle":r.data();o.call(i,s)})}(jQuery),function(e){"use strict";function t(t){var o=t.attr("data-target");o||(o=t.attr("href"),o=o&&/#[A-Za-z]/.test(o)&&o.replace(/.*(?=#[^\s]*$)/,""));var n=o&&e(o);return n&&n.length?n:t.parent()}function o(o){o&&3===o.which||(e(r).remove(),e(i).each(function(){var n=e(this),r=t(n),i={relatedTarget:this};r.hasClass("open")&&(o&&"click"==o.type&&/input|textarea/i.test(o.target.tagName)&&e.contains(r[0],o.target)||(r.trigger(o=e.Event("hide.bs.dropdown",i)),o.isDefaultPrevented()||(n.attr("aria-expanded","false"),r.removeClass("open").trigger(e.Event("hidden.bs.dropdown",i)))))}))}function n(t){return this.each(function(){var o=e(this),n=o.data("bs.dropdown");n||o.data("bs.dropdown",n=new a(this)),"string"==typeof t&&n[t].call(o)})}var r=".dropdown-backdrop",i='[data-toggle="dropdown"]',a=function(t){e(t).on("click.bs.dropdown",this.toggle)};a.VERSION="3.3.7",a.prototype.toggle=function(n){var r=e(this);if(!r.is(".disabled, :disabled")){var i=t(r),a=i.hasClass("open");if(o(),!a){"ontouchstart"in document.documentElement&&!i.closest(".navbar-nav").length&&e(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(e(this)).on("click",o);var s={relatedTarget:this};if(i.trigger(n=e.Event("show.bs.dropdown",s)),n.isDefaultPrevented())return;r.trigger("focus").attr("aria-expanded","true"),i.toggleClass("open").trigger(e.Event("shown.bs.dropdown",s))}return!1}},a.prototype.keydown=function(o){if(/(38|40|27|32)/.test(o.which)&&!/input|textarea/i.test(o.target.tagName)){var n=e(this);if(o.preventDefault(),o.stopPropagation(),!n.is(".disabled, :disabled")){var r=t(n),a=r.hasClass("open");if(!a&&27!=o.which||a&&27==o.which)return 27==o.which&&r.find(i).trigger("focus"),n.trigger("click");var s=" li:not(.disabled):visible a",l=r.find(".dropdown-menu"+s);if(l.length){var c=l.index(o.target);38==o.which&&c>0&&c--,40==o.which&&c<l.length-1&&c++,~c||(c=0),l.eq(c).trigger("focus")}}}};var s=e.fn.dropdown;e.fn.dropdown=n,e.fn.dropdown.Constructor=a,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=s,this},e(document).on("click.bs.dropdown.data-api",o).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",i,a.prototype.toggle).on("keydown.bs.dropdown.data-api",i,a.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",a.prototype.keydown)}(jQuery),function(e){"use strict";function t(t,n){return this.each(function(){var r=e(this),i=r.data("bs.modal"),a=e.extend({},o.DEFAULTS,r.data(),"object"==typeof t&&t);i||r.data("bs.modal",i=new o(this,a)),"string"==typeof t?i[t](n):a.show&&i.show(n)})}var o=function(t,o){this.options=o,this.$body=e(document.body),this.$element=e(t),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,e.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};o.VERSION="3.3.7",o.TRANSITION_DURATION=300,o.BACKDROP_TRANSITION_DURATION=150,o.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},o.prototype.toggle=function(e){return this.isShown?this.hide():this.show(e)},o.prototype.show=function(t){var n=this,r=e.Event("show.bs.modal",{relatedTarget:t});this.$element.trigger(r),this.isShown||r.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',e.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){n.$element.one("mouseup.dismiss.bs.modal",function(t){e(t.target).is(n.$element)&&(n.ignoreBackdropClick=!0)})}),this.backdrop(function(){var r=e.support.transition&&n.$element.hasClass("fade");n.$element.parent().length||n.$element.appendTo(n.$body),n.$element.show().scrollTop(0),n.adjustDialog(),r&&n.$element[0].offsetWidth,n.$element.addClass("in"),n.enforceFocus();var i=e.Event("shown.bs.modal",{relatedTarget:t});r?n.$dialog.one("bsTransitionEnd",function(){n.$element.trigger("focus").trigger(i)}).emulateTransitionEnd(o.TRANSITION_DURATION):n.$element.trigger("focus").trigger(i)}))},o.prototype.hide=function(t){t&&t.preventDefault(),t=e.Event("hide.bs.modal"),this.$element.trigger(t),this.isShown&&!t.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),e(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),e.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",e.proxy(this.hideModal,this)).emulateTransitionEnd(o.TRANSITION_DURATION):this.hideModal())},o.prototype.enforceFocus=function(){e(document).off("focusin.bs.modal").on("focusin.bs.modal",e.proxy(function(e){document===e.target||this.$element[0]===e.target||this.$element.has(e.target).length||this.$element.trigger("focus")},this))},o.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",e.proxy(function(e){27==e.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},o.prototype.resize=function(){this.isShown?e(window).on("resize.bs.modal",e.proxy(this.handleUpdate,this)):e(window).off("resize.bs.modal")},o.prototype.hideModal=function(){var e=this;this.$element.hide(),this.backdrop(function(){e.$body.removeClass("modal-open"),e.resetAdjustments(),e.resetScrollbar(),e.$element.trigger("hidden.bs.modal")})},o.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},o.prototype.backdrop=function(t){var n=this,r=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var i=e.support.transition&&r;if(this.$backdrop=e(document.createElement("div")).addClass("modal-backdrop "+r).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",e.proxy(function(e){if(this.ignoreBackdropClick)return void(this.ignoreBackdropClick=!1);e.target===e.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide())},this)),i&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!t)return;i?this.$backdrop.one("bsTransitionEnd",t).emulateTransitionEnd(o.BACKDROP_TRANSITION_DURATION):t()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var a=function(){n.removeBackdrop(),t&&t()};e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",a).emulateTransitionEnd(o.BACKDROP_TRANSITION_DURATION):a()}else t&&t()},o.prototype.handleUpdate=function(){this.adjustDialog()},o.prototype.adjustDialog=function(){var e=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&e?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!e?this.scrollbarWidth:""})},o.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},o.prototype.checkScrollbar=function(){var e=window.innerWidth;if(!e){var t=document.documentElement.getBoundingClientRect();e=t.right-Math.abs(t.left)}this.bodyIsOverflowing=document.body.clientWidth<e,this.scrollbarWidth=this.measureScrollbar()},o.prototype.setScrollbar=function(){var e=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$body.css("padding-right",e+this.scrollbarWidth)},o.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad)},o.prototype.measureScrollbar=function(){var e=document.createElement("div");e.className="modal-scrollbar-measure",this.$body.append(e);var t=e.offsetWidth-e.clientWidth;return this.$body[0].removeChild(e),t};var n=e.fn.modal;e.fn.modal=t,e.fn.modal.Constructor=o,e.fn.modal.noConflict=function(){return e.fn.modal=n,this},e(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(o){var n=e(this),r=n.attr("href"),i=e(n.attr("data-target")||r&&r.replace(/.*(?=#[^\s]+$)/,"")),a=i.data("bs.modal")?"toggle":e.extend({remote:!/#/.test(r)&&r},i.data(),n.data());n.is("a")&&o.preventDefault(),i.one("show.bs.modal",function(e){e.isDefaultPrevented()||i.one("hidden.bs.modal",function(){n.is(":visible")&&n.trigger("focus")})}),t.call(i,a,this)})}(jQuery),function(e){"use strict";function t(t){return this.each(function(){var n=e(this),r=n.data("bs.tab");r||n.data("bs.tab",r=new o(this)),"string"==typeof t&&r[t]()})}var o=function(t){this.element=e(t)};o.VERSION="3.3.7",o.TRANSITION_DURATION=150,o.prototype.show=function(){var t=this.element,o=t.closest("ul:not(.dropdown-menu)"),n=t.data("target");if(n||(n=t.attr("href"),n=n&&n.replace(/.*(?=#[^\s]*$)/,"")),!t.parent("li").hasClass("active")){var r=o.find(".active:last a"),i=e.Event("hide.bs.tab",{relatedTarget:t[0]}),a=e.Event("show.bs.tab",{relatedTarget:r[0]});if(r.trigger(i),t.trigger(a),!a.isDefaultPrevented()&&!i.isDefaultPrevented()){var s=e(n);this.activate(t.closest("li"),o),this.activate(s,s.parent(),function(){r.trigger({type:"hidden.bs.tab",relatedTarget:t[0]}),t.trigger({type:"shown.bs.tab",relatedTarget:r[0]})})}}},o.prototype.activate=function(t,n,r){function i(){a.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),t.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),s?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu").length&&t.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),r&&r()}var a=n.find("> .active"),s=r&&e.support.transition&&(a.length&&a.hasClass("fade")||!!n.find("> .fade").length);a.length&&s?a.one("bsTransitionEnd",i).emulateTransitionEnd(o.TRANSITION_DURATION):i(),a.removeClass("in")};var n=e.fn.tab;e.fn.tab=t,e.fn.tab.Constructor=o,e.fn.tab.noConflict=function(){return e.fn.tab=n,this};var r=function(o){o.preventDefault(),t.call(e(this),"show")};e(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',r).on("click.bs.tab.data-api",'[data-toggle="pill"]',r)}(jQuery),function(e){"use strict";function t(t){return this.each(function(){var n=e(this),r=n.data("bs.affix"),i="object"==typeof t&&t;r||n.data("bs.affix",r=new o(this,i)),"string"==typeof t&&r[t]()})}var o=function(t,n){this.options=e.extend({},o.DEFAULTS,n),this.$target=e(this.options.target).on("scroll.bs.affix.data-api",e.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",e.proxy(this.checkPositionWithEventLoop,this)),this.$element=e(t),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};o.VERSION="3.3.7",o.RESET="affix affix-top affix-bottom",o.DEFAULTS={offset:0,target:window},o.prototype.getState=function(e,t,o,n){var r=this.$target.scrollTop(),i=this.$element.offset(),a=this.$target.height();if(null!=o&&"top"==this.affixed)return r<o&&"top";if("bottom"==this.affixed)return null!=o?!(r+this.unpin<=i.top)&&"bottom":!(r+a<=e-n)&&"bottom";var s=null==this.affixed,l=s?r:i.top,c=s?a:t;return null!=o&&r<=o?"top":null!=n&&l+c>=e-n&&"bottom"},o.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(o.RESET).addClass("affix");var e=this.$target.scrollTop(),t=this.$element.offset();return this.pinnedOffset=t.top-e},o.prototype.checkPositionWithEventLoop=function(){setTimeout(e.proxy(this.checkPosition,this),1)},o.prototype.checkPosition=function(){if(this.$element.is(":visible")){var t=this.$element.height(),n=this.options.offset,r=n.top,i=n.bottom,a=Math.max(e(document).height(),e(document.body).height());"object"!=typeof n&&(i=r=n),"function"==typeof r&&(r=n.top(this.$element)),"function"==typeof i&&(i=n.bottom(this.$element));var s=this.getState(a,t,r,i);if(this.affixed!=s){null!=this.unpin&&this.$element.css("top","");var l="affix"+(s?"-"+s:""),c=e.Event(l+".bs.affix");if(this.$element.trigger(c),c.isDefaultPrevented())return;this.affixed=s,this.unpin="bottom"==s?this.getPinnedOffset():null,this.$element.removeClass(o.RESET).addClass(l).trigger(l.replace("affix","affixed")+".bs.affix")}"bottom"==s&&this.$element.offset({top:a-t-i})}};var n=e.fn.affix;e.fn.affix=t,e.fn.affix.Constructor=o,e.fn.affix.noConflict=function(){return e.fn.affix=n,this},e(window).on("load",function(){e('[data-spy="affix"]').each(function(){var o=e(this),n=o.data();n.offset=n.offset||{},null!=n.offsetBottom&&(n.offset.bottom=n.offsetBottom),null!=n.offsetTop&&(n.offset.top=n.offsetTop),t.call(o,n)})})}(jQuery),function(e){"use strict";function t(o,n){this.$body=e(document.body),this.$scrollElement=e(e(o).is(document.body)?window:o),this.options=e.extend({},t.DEFAULTS,n),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",e.proxy(this.process,this)),this.refresh(),this.process()}function o(o){return this.each(function(){var n=e(this),r=n.data("bs.scrollspy"),i="object"==typeof o&&o;r||n.data("bs.scrollspy",r=new t(this,i)),"string"==typeof o&&r[o]()})}t.VERSION="3.3.7",t.DEFAULTS={offset:10},t.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},t.prototype.refresh=function(){var t=this,o="offset",n=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),e.isWindow(this.$scrollElement[0])||(o="position",n=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var t=e(this),r=t.data("target")||t.attr("href"),i=/^#./.test(r)&&e(r);return i&&i.length&&i.is(":visible")&&[[i[o]().top+n,r]]||null}).sort(function(e,t){return e[0]-t[0]}).each(function(){t.offsets.push(this[0]),t.targets.push(this[1])})},t.prototype.process=function(){var e,t=this.$scrollElement.scrollTop()+this.options.offset,o=this.getScrollHeight(),n=this.options.offset+o-this.$scrollElement.height(),r=this.offsets,i=this.targets,a=this.activeTarget;if(this.scrollHeight!=o&&this.refresh(),t>=n)return a!=(e=i[i.length-1])&&this.activate(e);if(a&&t<r[0])return this.activeTarget=null,this.clear();for(e=r.length;e--;)a!=i[e]&&t>=r[e]&&(r[e+1]===undefined||t<r[e+1])&&this.activate(i[e])},t.prototype.activate=function(t){this.activeTarget=t,this.clear();var o=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',n=e(o).parents("li").addClass("active");n.parent(".dropdown-menu").length&&(n=n.closest("li.dropdown").addClass("active")),n.trigger("activate.bs.scrollspy")},t.prototype.clear=function(){e(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var n=e.fn.scrollspy;e.fn.scrollspy=o,e.fn.scrollspy.Constructor=t,e.fn.scrollspy.noConflict=function(){return e.fn.scrollspy=n,this},e(window).on("load.bs.scrollspy.data-api",function(){e('[data-spy="scroll"]').each(function(){var t=e(this);o.call(t,t.data())})})}(jQuery),function(e){"use strict";function t(t){return this.each(function(){var n=e(this),r=n.data("bs.tooltip"),i="object"==typeof t&&t;!r&&/destroy|hide/.test(t)||(r||n.data("bs.tooltip",r=new o(this,i)),"string"==typeof t&&r[t]())})}var o=function(e,t){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",e,t)};o.VERSION="3.3.7",o.TRANSITION_DURATION=150,o.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},o.prototype.init=function(t,o,n){if(this.enabled=!0,this.type=t,this.$element=e(o),this.options=this.getOptions(n),this.$viewport=this.options.viewport&&e(e.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var r=this.options.trigger.split(" "),i=r.length;i--;){var a=r[i];if("click"==a)this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this));else if("manual"!=a){var s="hover"==a?"mouseenter":"focusin",l="hover"==a?"mouseleave":"focusout";this.$element.on(s+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(l+"."+this.type,this.options.selector,e.proxy(this.leave,this))}}this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},o.prototype.getDefaults=function(){return o.DEFAULTS},o.prototype.getOptions=function(t){return t=e.extend({},this.getDefaults(),this.$element.data(),t),t.delay&&"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),t},o.prototype.getDelegateOptions=function(){var t={},o=this.getDefaults();return this._options&&e.each(this._options,function(e,n){o[e]!=n&&(t[e]=n)}),t},o.prototype.enter=function(t){var o=t instanceof this.constructor?t:e(t.currentTarget).data("bs."+this.type);return o||(o=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,o)),t instanceof e.Event&&(o.inState["focusin"==t.type?"focus":"hover"]=!0),o.tip().hasClass("in")||"in"==o.hoverState?void(o.hoverState="in"):(clearTimeout(o.timeout),o.hoverState="in",o.options.delay&&o.options.delay.show?void(o.timeout=setTimeout(function(){"in"==o.hoverState&&o.show()},o.options.delay.show)):o.show())},o.prototype.isInStateTrue=function(){for(var e in this.inState)if(this.inState[e])return!0;return!1},o.prototype.leave=function(t){var o=t instanceof this.constructor?t:e(t.currentTarget).data("bs."+this.type);if(o||(o=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,o)),t instanceof e.Event&&(o.inState["focusout"==t.type?"focus":"hover"]=!1),!o.isInStateTrue()){if(clearTimeout(o.timeout),o.hoverState="out",!o.options.delay||!o.options.delay.hide)return o.hide();o.timeout=setTimeout(function(){"out"==o.hoverState&&o.hide()},o.options.delay.hide)}},o.prototype.show=function(){var t=e.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(t);var n=e.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(t.isDefaultPrevented()||!n)return;var r=this,i=this.tip(),a=this.getUID(this.type);this.setContent(),i.attr("id",a),this.$element.attr("aria-describedby",a),this.options.animation&&i.addClass("fade");var s="function"==typeof this.options.placement?this.options.placement.call(this,i[0],this.$element[0]):this.options.placement,l=/\s?auto?\s?/i,c=l.test(s);c&&(s=s.replace(l,"")||"top"),i.detach().css({top:0,left:0,display:"block"}).addClass(s).data("bs."+this.type,this),this.options.container?i.appendTo(this.options.container):i.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var d=this.getPosition(),u=i[0].offsetWidth,p=i[0].offsetHeight;if(c){var h=s,f=this.getPosition(this.$viewport);s="bottom"==s&&d.bottom+p>f.bottom?"top":"top"==s&&d.top-p<f.top?"bottom":"right"==s&&d.right+u>f.width?"left":"left"==s&&d.left-u<f.left?"right":s,i.removeClass(h).addClass(s)}var m=this.getCalculatedOffset(s,d,u,p);this.applyPlacement(m,s);var g=function(){var e=r.hoverState;r.$element.trigger("shown.bs."+r.type),r.hoverState=null,"out"==e&&r.leave(r)};e.support.transition&&this.$tip.hasClass("fade")?i.one("bsTransitionEnd",g).emulateTransitionEnd(o.TRANSITION_DURATION):g()}},o.prototype.applyPlacement=function(t,o){var n=this.tip(),r=n[0].offsetWidth,i=n[0].offsetHeight,a=parseInt(n.css("margin-top"),10),s=parseInt(n.css("margin-left"),10);isNaN(a)&&(a=0),isNaN(s)&&(s=0),t.top+=a,t.left+=s,e.offset.setOffset(n[0],e.extend({using:function(e){n.css({top:Math.round(e.top),left:Math.round(e.left)})}},t),0),n.addClass("in");var l=n[0].offsetWidth,c=n[0].offsetHeight;"top"==o&&c!=i&&(t.top=t.top+i-c);var d=this.getViewportAdjustedDelta(o,t,l,c);d.left?t.left+=d.left:t.top+=d.top;var u=/top|bottom/.test(o),p=u?2*d.left-r+l:2*d.top-i+c,h=u?"offsetWidth":"offsetHeight";n.offset(t),this.replaceArrow(p,n[0][h],u)},o.prototype.replaceArrow=function(e,t,o){this.arrow().css(o?"left":"top",50*(1-e/t)+"%").css(o?"top":"left","")},o.prototype.setContent=function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},o.prototype.hide=function(t){function n(){"in"!=r.hoverState&&i.detach(),r.$element&&r.$element.removeAttr("aria-describedby").trigger("hidden.bs."+r.type),t&&t()}var r=this,i=e(this.$tip),a=e.Event("hide.bs."+this.type);if(this.$element.trigger(a),!a.isDefaultPrevented())return i.removeClass("in"),e.support.transition&&i.hasClass("fade")?i.one("bsTransitionEnd",n).emulateTransitionEnd(o.TRANSITION_DURATION):n(),this.hoverState=null,this},o.prototype.fixTitle=function(){var e=this.$element;(e.attr("title")||"string"!=typeof e.attr("data-original-title"))&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},o.prototype.hasContent=function(){return this.getTitle()},o.prototype.getPosition=function(t){t=t||this.$element;var o=t[0],n="BODY"==o.tagName,r=o.getBoundingClientRect();null==r.width&&(r=e.extend({},r,{width:r.right-r.left,height:r.bottom-r.top}));var i=window.SVGElement&&o instanceof window.SVGElement,a=n?{top:0,left:0}:i?null:t.offset(),s={scroll:n?document.documentElement.scrollTop||document.body.scrollTop:t.scrollTop()},l=n?{width:e(window).width(),height:e(window).height()}:null;return e.extend({},r,s,l,a)},o.prototype.getCalculatedOffset=function(e,t,o,n){return"bottom"==e?{top:t.top+t.height,left:t.left+t.width/2-o/2}:"top"==e?{top:t.top-n,left:t.left+t.width/2-o/2}:"left"==e?{top:t.top+t.height/2-n/2,left:t.left-o}:{top:t.top+t.height/2-n/2,left:t.left+t.width}},o.prototype.getViewportAdjustedDelta=function(e,t,o,n){var r={top:0,left:0};if(!this.$viewport)return r;var i=this.options.viewport&&this.options.viewport.padding||0,a=this.getPosition(this.$viewport);if(/right|left/.test(e)){var s=t.top-i-a.scroll,l=t.top+i-a.scroll+n;s<a.top?r.top=a.top-s:l>a.top+a.height&&(r.top=a.top+a.height-l)}else{var c=t.left-i,d=t.left+i+o;c<a.left?r.left=a.left-c:d>a.right&&(r.left=a.left+a.width-d)}return r},o.prototype.getTitle=function(){var e=this.$element,t=this.options;return e.attr("data-original-title")||("function"==typeof t.title?t.title.call(e[0]):t.title)},o.prototype.getUID=function(e){do{e+=~~(1e6*Math.random())}while(document.getElementById(e));return e},o.prototype.tip=function(){if(!this.$tip&&(this.$tip=e(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},o.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},o.prototype.enable=function(){this.enabled=!0},o.prototype.disable=function(){this.enabled=!1},o.prototype.toggleEnabled=function(){this.enabled=!this.enabled},o.prototype.toggle=function(t){var o=this;t&&((o=e(t.currentTarget).data("bs."+this.type))||(o=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,o))),t?(o.inState.click=!o.inState.click,o.isInStateTrue()?o.enter(o):o.leave(o)):o.tip().hasClass("in")?o.leave(o):o.enter(o)},o.prototype.destroy=function(){var e=this;clearTimeout(this.timeout),this.hide(function(){e.$element.off("."+e.type).removeData("bs."+e.type),e.$tip&&e.$tip.detach(),e.$tip=null,e.$arrow=null,e.$viewport=null,e.$element=null})};var n=e.fn.tooltip;e.fn.tooltip=t,e.fn.tooltip.Constructor=o,e.fn.tooltip.noConflict=function(){return e.fn.tooltip=n,this}}(jQuery),function(e){"use strict";function t(t){return this.each(function(){var n=e(this),r=n.data("bs.popover"),i="object"==typeof t&&t;!r&&/destroy|hide/.test(t)||(r||n.data("bs.popover",r=new o(this,i)),"string"==typeof t&&r[t]())})}var o=function(e,t){this.init("popover",e,t)};if(!e.fn.tooltip)throw new Error("Popover requires tooltip.js");o.VERSION="3.3.7",o.DEFAULTS=e.extend({},e.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),o.prototype=e.extend({},e.fn.tooltip.Constructor.prototype),o.prototype.constructor=o,o.prototype.getDefaults=function(){return o.DEFAULTS},o.prototype.setContent=function(){var e=this.tip(),t=this.getTitle(),o=this.getContent();e.find(".popover-title")[this.options.html?"html":"text"](t),e.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof o?"html":"append":"text"](o),e.removeClass("fade top bottom left right in"),e.find(".popover-title").html()||e.find(".popover-title").hide()},o.prototype.hasContent=function(){return this.getTitle()||this.getContent()},o.prototype.getContent=function(){var e=this.$element,t=this.options;return e.attr("data-content")||("function"==typeof t.content?t.content.call(e[0]):t.content)},o.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var n=e.fn.popover;e.fn.popover=t,e.fn.popover.Constructor=o,e.fn.popover.noConflict=function(){return e.fn.popover=n,this}}(jQuery),function(){!function(e){e.fn.modal_success=function(){this.modal("hide"),this.find('form input[type="text"], form input[type="number"]').val(""),this.clear_previous_errors()},e.fn.render_form_errors=function(t){var o;this.clear_previous_errors(),o=this.data("model"),e.each(t,function(t,n){var r;r=e('input[name="'+o+"["+t+']"]'),r.closest(".form-group").addClass("has-error").find(".help-block").html(n.join(" & "))})},e.fn.clear_previous_errors=function(){e(".form-group.has-error",this).each(function(){e(".help-block",e(this)).html(""),e(this).removeClass("has-error")})}}(jQuery),$(function(){return $("select").select2({language:"ru",minimumResultsForSearch:10,allowClear:!0,placeholder:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435"}),$(".clockpicker").clockpicker({autoclose:!0}),$(".multiselect2").each(function(){return function(e,t){var o,n;return n=$(t),o={language:"ru",placeholder:n.data("placeholder"),allowClear:!0,templateResult:function(e,t){return $(e.element).data("active")||$(t).addClass("bg-red"),e.text},dropdownCssClass:"bigdrop"},n.select2(o)}}()),$(".select2-tags").select2({language:"ru",minimumResultsForSearch:0,allowClear:!0,placeholder:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435",tags:!0,createTag:function(e){var t;return t=$.trim(e.term),""===t?null:{id:t,text:t,newTag:!0}}}),$(".autoselect2").each(function(){return function(e,t){var o,n;return n=$(t),o={language:"ru",placeholder:n.data("placeholder"),minimumInputLength:2,allowClear:!0,ajax:{url:n.data("source"),dataType:"json",delay:250,data:function(e){return{q:e.term}},processResults:function(e){return{results:e.resources}}},templateResult:function(e,t){return e.is_active||$(t).addClass("bg-red"),e.text},dropdownCssClass:"bigdrop"},n.select2(o)}}()),$(".datepicker").datepicker({format:"dd.mm.yyyy",todayHighlight:!0,weekStart:1,language:"ru",autoclose:!0}),$("#modal-submit").on("click",function(){return $(this).closest("form").submit()}),$("form#new_position").bind("ajaxError",function(e,t){return $(e.data).render_form_errors($.parseJSON(t.responseText))}),$(document).on("change","#per_page_select",function(){var e,t;return t=$(this).find(":selected").data("url"),e="&",-1===t.indexOf("?")&&(e="?"),window.location.href=t+e+"per_page="+$(this).val()}),$(document).on("click",'[data-toggle="lightbox"]',function(e){return e.preventDefault(),$(this).ekkoLightbox()})})}.call(this),"undefined"!=typeof CKEDITOR&&(CKEDITOR.editorConfig=function(e){e.toolbarGroups=[{name:"document",groups:["mode","document","doctools"]},{name:"clipboard",groups:["clipboard","undo"]},{name:"editing",groups:["find","selection","spellchecker","editing"]},{name:"forms",groups:["forms"]},{name:"basicstyles",groups:["basicstyles","cleanup"]},{name:"paragraph",groups:["list","indent","blocks","align","bidi","paragraph"]},{name:"links",groups:["links"]},{name:"insert",groups:["insert"]},{name:"styles",groups:["styles"]},{name:"colors",groups:["colors"]},{name:"tools",groups:["tools"]},{name:"others",groups:["others"]},{name:"about",groups:["about"]}],e.removeButtons="Source,Save,Templates,NewPage,Preview,Print,Replace,Find,SelectAll,Scayt,Form,Checkbox,Radio,TextField,Textarea,Select,Button,ImageButton,HiddenField,Superscript,Subscript,CreateDiv,BidiLtr,BidiRtl,Language,Flash,Smiley,Iframe,Anchor,Styles,Font,FontSize,ShowBlocks,About,Outdent,Indent,Blockquote",e.extraPlugins="embed,autoembed"}),function(){$(function(){var e,t,o,n;return null,$("#export_to_excel").on("click",function(){return location.href=$(this).data("url")+"?"+$("#filterrific_filter").serialize()}),$("#daily_timesheet_employee_id").on("change",function(){return $.get("/employees/"+$(this).val()+".json",function(e){var t,o,n,r;return r=0,e.salary&&(r=e.salary),$("#daily_timesheet_salary").val(r),o=1,e.salary_ratio&&(o=e.salary_ratio),$("#daily_timesheet_ratio").val(o),t=0,e.probation_period&&(t=e.probation_period),n=moment().isBefore(moment(e.hire_date).add(t,"day")),$("#daily_timesheet_probation_period").prop("checked",n),$("#daily_timesheet_probation_period_h").val(n),e&&7===e.position_id&&($("#daily_timesheet_additional_payment_value").val(300),$("#daily_timesheet_additional_payment_reason").val("\u0411\u0440\u0438\u0433\u0430\u0434\u0438\u0440")),$("form.simple_form").trigger("bms:change")})}),$("#daily_timesheet_date").on("change",function(){var e,t,o;return e=moment($(this).val(),"DD.MM.YYYY"),t=moment($(this).val(),"DD.MM.YYYY").startOf("month").add(2,"w"),o=moment($(this).val(),"DD.MM.YYYY").startOf("month"),e.isBetween(o,t,null,"[]")?$("#daily_timesheet_salary_period_id").val(1).trigger("change"):$("#daily_timesheet_salary_period_id").val(2).trigger("change")}),$("#daily_timesheet_no_work").on("click",function(){return $(this).prop("checked")?$(".no-work").hide():$(".no-work").show()}),o=$(".work_fields, .penalties"),o.on("cocoon:after-remove",function(){return $("form.simple_form").trigger("bms:change")}),e=function(){function e(){}return e.prototype.hpd=10,e.prototype.ratio="#daily_timesheet_ratio",e.prototype.salary="#daily_timesheet_salary",e.prototype.salary_type="#daily_timesheet_payment_type_id",e.prototype.probation="#daily_timesheet_probation_period",e.prototype.start_time="#daily_timesheet_start_time",e.prototype.end_time="#daily_timesheet_end_time",e.prototype.overtime="#daily_timesheet_overtime",e.prototype.nested_select=".nested-fields select",e.prototype.nested_input=".nested-fields input.s-amount",e.prototype.total="#daily_timesheet_total_amount",e.prototype.penalties=".penalty-select",e.prototype.employee="#daily_timesheet_employee_id",e.prototype.additional="#daily_timesheet_additional_payment_value",e.prototype.getSalaryType=function(){return parseInt($(this.salary_type).val())||1},e.prototype.parseTime=function(e){return moment($(e).val(),"HH:mm:ss")},e.prototype.getTotalHours=function(){var e,t;return t=this.parseTime(this.start_time),e=this.parseTime(this.end_time),t.isAfter(e)&&(e=e.add(24,"hours")),moment.duration(e.diff(t)).asHours()},e.prototype.getSelectVal=function(e){return parseFloat($(e).find(":selected").data("price"))||0},e.prototype.getRatio=function(e){return null==e&&(e=this.ratio),parseFloat($(e).val())||1},e.prototype.getTotal=function(){var e,t,o,n,r,i,a,s;return a=0,$(".work_fields > .nested-fields").each(function(e){return function(t,o){var n
;return n=parseFloat($(o).find("input.s-amount").val()),isNaN(n)&&(n=0),a+=e.getSelectVal(o)*n}}(this)),i=0,$(this.penalties).each(function(e){return function(t,o){return i+=e.getSelectVal(o)}}(this)),s=Math.floor($(this.salary).val()/this.hpd),t=this.getTotalHours(),n=this.getRatio(),o=1,r=0,2===this.getSalaryType()&&(o=0,r=1),e=parseFloat($(this.additional).val()),isNaN(e)&&(e=0),(a*o+s*t*r)*n+e-i},e.prototype.setTotal=function(){return $(this.total).val(this.getTotal())},e}(),$(document).on("bms:change","form.simple_form",function(){var t;return t=new e,t.setTotal()}),n=[],n.push(e.prototype.ratio),n.push(e.prototype.salary),n.push(e.prototype.start_time),n.push(e.prototype.end_time),n.push(e.prototype.nested_input),n.push(e.prototype.additional),t=[],t.push(e.prototype.nested_select),t.push(e.prototype.salary_type),t.push(e.prototype.penalties),t.push(e.prototype.employee),t.push(e.prototype.start_time),t.push(e.prototype.end_time),$("form.simple_form").on("keyup",n.toString(),function(){return $(this).trigger("bms:change")}),$("form.simple_form").on("change",t.toString(),function(){return $(this).trigger("bms:change")}),$("form.simple_form").on("click",".recalculate",function(){return $(this).trigger("bms:change")}),!1})}.call(this),function(){$(function(){var e;return e=$(".kpi_fields"),e.on("cocoon:before-insert",function(e,t){return t.fadeIn("slow")}),e.on("cocoon:after-insert",function(e,t){return $(t).find("select").select2({minimumResultsForSearch:20})}),e.on("cocoon:before-remove",function(e,t){return $(this).data("remove-timeout",1e3),t.fadeOut("slow")})})}.call(this),function(){}.call(this),function(){$(function(){var e,t,o;return $(document).on("click","a.delivery-name-suggestion",function(e){return e.preventDefault(),$("#delivery_name").val($(this).text()),t()}),$("#delivery_name").on("input",function(){if(t(),$(".delivery-name-autocomplete").text(""),$(this).val().length>=3)return fetch("/deliveries/autocomplete_name?name="+$(this).val()).then(function(e){return e.json()}).then(function(t){var o,n,r,i;for(i=[],n=0,r=t.length;n<r;n++)o=t[n],i.push(e(o));return i})}),e=function(e){return $(".delivery-name-autocomplete").append("<li><a href='#' class='delivery-name-suggestion'>"+e+"</a></li>")},t=function(){return $(".delivery-name-autocomplete").text("")},$("#delivery_delivery_needed").prop("checked")?$(".delivery-fields").show():$(".delivery-fields").hide(),$("#delivery_delivery_needed").on("click",function(){return $(this).prop("checked")?$(".delivery-fields").show():$(".delivery-fields").hide()}),$("form.simple_form").on("keyup","#delivery_count, #delivery_price_per_unit",function(){var e,t;return e=parseFloat($("#delivery_count").val()),isNaN(e)&&(e=0),t=parseFloat($("#delivery_price_per_unit").val()),isNaN(t)&&(t=0),$("#delivery_cost").val((e*t).toFixed(2))}),o=null,$("body").popover({selector:".delivery_row",html:!0,placement:"auto",container:"body",content:function(){return $.ajax({url:$(this).data("delivery-details-url"),async:!1}).responseText}}),$(document).on("shown.bs.popover",function(e){var t;return t=$(e.target),o&&o.get(0)!==t.get(0)&&(o.data("bs.popover").inState={click:!1,hover:!1,focus:!1},o.popover("hide")),o=t}),$(document).on("hidden.bs.popover",function(e){if(o&&o.get(0)===$(e.target).get(0))return o=null})})}.call(this),function(){$(function(){return $(".diff_link").on("click",function(){var e,t,o,n,r;return r=$(this),o=$(".diffoutput-"+r.data("version-id")),o.is(":empty")?(e=difflib.stringAsLines(r.find(".diff_content_from").text()),t=difflib.stringAsLines(r.find(".diff_content_to").text()),n=new difflib.SequenceMatcher(e,t),o.empty().append(diffview.buildView({baseTextLines:e,newTextLines:t,opcodes:n.get_opcodes(),baseTextName:r.data("label-old"),newTextName:r.data("label-new"),contextSize:5,viewType:0}))):o.empty(),!1})})}.call(this),function(){$(document).ready(function(){var e,t,o,n,r,i;if(t=$("#document_document_type"),e=$(".document_content"),r=$("#js-spreadsheet"),$(".document_sheet_content"),$("#sheet_content"),$("#document-form"),n=function(){return Boolean(window.location.href.match(/new/)||window.location.href.match(/edit/))},i=function(t){if(n())switch(t){case"text":return r.hide(),e.show();case"sheet":return e.hide(),r.show();default:return e.hide(),r.hide()}},o=function(){return $("#js-spreadsheet").socialcalc({form:"#document-form",content:"#sheet_content",width:700})},i(t.val()),t.on("change",function(e){return i(e.target.value)}),!Boolean(window.location.href.match(/edit/))||"text"!==t.val())return o()})}.call(this),function(){$(function(){return $("#employee_felony_false").prop("checked")?$(".employee_felony_notes_wrapper").hide():$(".employee_felony_notes_wrapper").show(),$('input[name="employee[felony]"]').on("click",function(){return"true"===$(this).val()?$(".employee_felony_notes_wrapper").show():$(".employee_felony_notes_wrapper").hide()}),$(document).on("change","#employee_avatar",function(){return $("#upload_form").submit()}),$("#crop_submit").on("click",function(){return $("#crop_form").submit()})})}.call(this),function(){$(function(){var e,t,o,n,r,i;return i=null,n=function(e){var t,o;if(e)return o=parseFloat(e.find(".s-object").find(":selected").data("price")),o||(o=0),t=parseFloat(e.find(".s-amount").val()),t||(t=0),e.find(".s-total").val((o*t).toFixed(2))},r=$(".adoc_fields, .cost_fields, .material_fields, .tool_fields, .work_fields, .other_fields, .additional_fields, .d_name_fields"),r.on("cocoon:before-insert",function(e,t){return t.fadeIn("slow")}),r.on("cocoon:after-insert",function(e,t){var o,r;return i&&(r=$(t).find(".s-object"),o=$(t).find(".s-amount"),i.tool_id?r.val(i.tool_id):i.material_id?r.val(i.material_id):i.other_id?r.val(i.other_id):i.additional_id?r.val(i.additional_id):i.work_type_id&&r.val(i.work_type_id),i.amount?o.val(i.work_amount*i.amount):o.val(1),n($(t)),i=null),$(t).find("select:not(.select2-tags)").select2({language:"ru",minimumResultsForSearch:20,allowClear:!0,placeholder:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435"}),$(t).find("select.select2-tags").select2({language:"ru",minimumResultsForSearch:0,allowClear:!0,placeholder:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435",tags:!0,createTag:function(e){var t;return t=$.trim(e.term),""===t?null:{id:t,text:t,newTag:!0}}}),$(t).find(".datepicker").datepicker({format:"dd.mm.yyyy",todayHighlight:!0,weekStart:1,language:"ru",autoclose:!0})}),r.on("cocoon:before-remove",function(e,t){return $(this).data("remove-timeout",1e3),t.fadeOut("slow")}),$(document).on("change",".work_fields > .nested-fields select.s-object, .work_fields > .nested-fields input.s-amount, .material_fields > .nested-fields select.s-object, .material_fields > .nested-fields input.s-amount, .other_fields > .nested-fields select.s-object, .other_fields > .nested-fields input.s-amount, .additional_fields > .nested-fields select.s-object, .additional_fields > .nested-fields input.s-amount",function(e){return n($(e.target).closest(".nested-fields"))}),o=function(o,n,r,i){var a,s,l,c,d,u,p,h,f;for(s=0,c=n.length;s<c;s++)u=n[s],e(o,u,r,i);for(p=$(".work-category"),h=[],a=l=0,d=p.length;l<d;a=++l)f=p[a],h.push(t(i,f,a));return h},e=function(e,t,o){return i=t,i.work_amount=parseFloat(e)||1,$(o).click()},t=function(e,t,o){return t.textContent=o+1+". "+e},$("#calc_tools, #calc_materials, #calc_others, #calc_additionals").on("click",function(e){var t,n,r,i,a,s;for(e.preventDefault(),a=e.target,r=$(".work_fields > .nested-fields select.s-object"),i=[],t=0,n=r.length;t<n;t++)s=r[t],i.push(function(e){var t;if(t=$(e).parents(".nested-fields").find(".s-amount").val(),"calc_tools"===a.id&&o(t,$(e).find(":selected").data("tools"),".add-tool"),"calc_materials"===a.id&&o(t,$(e).find(":selected").data("materials"),".add-material"),"calc_others"===a.id&&o(t,$(e).find(":selected").data("others"),".add-other"),"calc_additionals"===a.id)return o(t,$(e).find(":selected").data("additionals"),".add-additional")}(s));return i}),$("#clear_tools, #clear_materials, #clear_others, #clear_additionals, #clear_works").on("click",function(e){var t;if(e.preventDefault(),t=e.target,"clear_tools"===t.id&&$(".tool_fields a.remove_fields").click(),"clear_materials"===t.id&&$(".material_fields a.remove_fields").click(),"clear_others"===t.id&&$(".other_fields a.remove_fields").click(),"clear_additionals"===t.id&&$(".additional_fields a.remove_fields").click(),"clear_works"===t.id)return $(".work_fields a.remove_fields").click()}),$("#calc_works").on("click",function(e){return e.preventDefault(),o($("#work_amount").val(),$("#work_category_id").find(":selected").data("works"),".add-work",$("#work_category_id").find(":selected").text())}),!1})}.call(this),function(){$(function(){return $(".btn-file-del").on("click",function(){return $(this).next().val(1),$(this).parent().parent().hide()})})}.call(this),function(){$(function(){return $("#main-content").on("click",".btn-export, .btn-preview",function(){var e;return e=$(".form"),$(this).hasClass("btn-export")?(e.removeAttr("data-remote"),e.removeData("remote")):e.attr("data-remote","true"),e.attr("action",$(this).data("action-url")),e.submit()}),$("input.daterange").daterangepicker({autoUpdateInput:!1,alwaysShowCalendars:!0,opens:"left",locale:{format:"DD.MM.YYYY",separator:" - ",applyLabel:"\u041f\u0440\u0438\u043c\u0435\u043d\u0438\u0442\u044c",cancelLabel:"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c",weekLabel:"\u041d",customRangeLabel:"\u0412\u044b\u0431\u043e\u0440 \u0432\u0440\u0443\u0447\u043d\u0443\u044e",daysOfWeek:["\u0412\u0441","\u041f\u043d","\u0412\u0442","\u0421\u0440","\u0427\u0442","\u041f\u0442","\u0421\u0431"],monthNames:["\u042f\u043d\u0432","\u0424\u0435\u0432","\u041c\u0430\u0440","\u0410\u043f\u0440","\u041c\u0430\u0439","\u0418\u044e\u043d","\u0418\u044e\u043b","\u0410\u0432\u0433","\u0421\u0435\u043d","\u041e\u043a\u0442","\u041d\u043e\u044f","\u0414\u0435\u043a"],firstDay:1},ranges:{"1-15 \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0438\u0439":[moment().subtract(1,"month").startOf("month"),moment().subtract(1,"month").startOf("month").add(14,"days")],"16-31 \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0438\u0439":[moment().subtract(1,"month").startOf("month").add(15,"days"),moment().subtract(1,"month").endOf("month")],"\u041f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0438\u0439 \u043c\u0435\u0441\u044f\u0446":[moment().subtract(1,"month").startOf("month"),moment().subtract(1,"month").endOf("month")],"1-15 \u0442\u0435\u043a\u0443\u0449\u0438\u0439":[moment().startOf("month"),moment().startOf("month").add(14,"days")],"16-31 \u0442\u0435\u043a\u0443\u0449\u0438\u0439":[moment().startOf("month").add(15,"days"),moment().endOf("month")],"\u0422\u0435\u043a\u0443\u0449\u0438\u0439 \u043c\u0435\u0441\u044f\u0446":[moment().startOf("month"),moment().endOf("month")]}}),$("input.daterange").on("apply.daterangepicker",function(e,t){return $(this).val(t.startDate.format("DD.MM.YYYY")+" - "+t.endDate.format("DD.MM.YYYY"))}),$("input.daterange").on("cancel.daterangepicker",function(){return $(this).val("")}),$("#btn-preview").on("click",function(){var e,t,o;return e=$("#calc_preview").empty(),o=$("<table/>").addClass("table"),e.append($("<h4/>").text("\u0420\u0430\u0431\u043e\u0442\u044b")),t=$("<tr/>"),t.append($("<th/>").text("\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435")),t.append($("<th/>").text("\u041a\u043e\u043b-\u0432\u043e")),t.append($("<th/>").text("\u0421\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c")),o.append(t),$(".work_fields").find(".nested-fields").each(function(){return t=$("<tr/>"),t.append($("<td/>").text($(this).find(".facility_facility_work_types_work_type select option:selected").text())),t.append($("<td/>").text($(this).find(".facility_facility_work_types_amount input").val())),t.append($("<td/>").text($(this).find(".facility_facility_work_types_total_price input").val())),o.append(t)}),e.append(o),e.append($("<h4/>").addClass("break-before").text("\u0418\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u044b")),o=$("<table/>").addClass("table"),t=$("<tr/>"),t.append($("<th/>").text("\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435")),t.append($("<th/>").text("\u041a\u043e\u043b-\u0432\u043e")),o.append(t),$(".tool_fields").find(".nested-fields").each(function(){return t=$("<tr/>"),t.append($("<td/>").text($(this).find(".facility_facility_tools_tool select option:selected").text())),t.append($("<td/>").text($(this).find(".facility_facility_tools_amount input").val())),o.append(t)}),e.append(o),e.append($("<h4/>").addClass("break-before").text("\u041c\u0430\u0442\u0435\u0440\u0438\u0430\u043b\u044b")),o=$("<table/>").addClass("table"),t=$("<tr/>"),t.append($("<th/>").text("\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435")),t.append($("<th/>").text("\u041a\u043e\u043b-\u0432\u043e")),t.append($("<th/>").text("\u0421\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c")),o.append(t),$(".material_fields").find(".nested-fields").each(function(){return t=$("<tr/>"),t.append($("<td/>").text($(this).find(".facility_facility_materials_material select option:selected").text())),t.append($("<td/>").text($(this).find(".facility_facility_materials_amount input").val())),t.append($("<td/>").text($(this).find(".facility_facility_materials_total_price input").val())),o.append(t)}),e.append(o),e.append($("<h4/>").addClass("break-before").text("\u0418\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u044c")),o=$("<table/>").addClass("table"),t=$("<tr/>"),t.append($("<th/>").text("\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435")),t.append($("<th/>").text("\u041a\u043e\u043b-\u0432\u043e")),t.append($("<th/>").text("\u0421\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c")),o.append(t),$(".other_fields").find(".nested-fields").each(function(){return t=$("<tr/>"),t.append($("<td/>").text($(this).find(".facility_facility_others_other select option:selected").text())),t.append($("<td/>").text($(this).find(".facility_facility_others_amount input").val())),t.append($("<td/>").text($(this).find(".facility_facility_others_total_price input").val())),o.append(t)}),e.append(o),e.append($("<h4/>").addClass("break-before").text("\u041f\u0440\u043e\u0447\u0435\u0435")),o=$("<table/>").addClass("table"),t=$("<tr/>"),t.append($("<th/>").text("\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435")),t.append($("<th/>").text("\u041a\u043e\u043b-\u0432\u043e")),t.append($("<th/>").text("\u0421\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c")),o.append(t),$(".additional_fields").find(".nested-fields").each(function(){return t=$("<tr/>"),t.append($("<td/>").text($(this).find(".facility_facility_additionals_additional select option:selected").text())),t.append($("<td/>").text($(this).find(".facility_facility_additionals_amount input").val())),t.append($("<td/>").text($(this).find(".facility_facility_additionals_total_price input").val())),o.append(t)}),e.append(o)})})}.call(this),function(){$(function(){var e,t;return e=null,$(document).on("click",".transaction_row",function(e){var t;if(!$(e.target).closest("td").is(".no-popover"))return t=$(e.target).closest("tr"),t.popover({html:!0,placement:"auto",container:"body",content:function(){return $.ajax({url:$(this).data("transaction-details-url"),async:!1}).responseText}}),t.popover("show")}),$("select.s-tool").change(function(){return function(e){if(e.target.value)return t(e.target.value,e.target.parentNode.childNodes[4])}}()),t=function(){return function(e,t){return $.ajax({url:"/s_tools/"+e+"/get_current_location",type:"GET",datatype:"json",success:function(e){return t.textContent="\u0422\u0435\u043a\u0443\u0449\u0435\u0435 \u043c\u0435\u0441\u0442\u043e\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u0435: "+e.location}})}}(),$("select.s-tool").trigger("change"),$(document).on("shown.bs.popover",function(t){var o;return o=$(t.target),e&&e.get(0)!==o.get(0)&&(e.data("bs.popover").inState={click:!1,hover:!1,focus:!1},e.popover("hide")),e=o}),$(document).on("hidden.bs.popover",function(t){if(e&&e.get(0)===$(t.target).get(0))return e=null}),$(document).on("click",function(e){if(0===$(e.target).parents(".transaction_row").length)return $(".transaction_row").popover("hide")}),$(".radio_buttons").change(function(){if($("#s_transaction_operation_type_income").prop("checked")&&($(".s-tools-fields").show(),$(".s_transaction_destination").hide(),$(".s_transaction_source").show()),$("#s_transaction_operation_type_outcome").prop("checked")&&($(".s-tools-fields").show(),$(".s_transaction_source").hide(),$(".s_transaction_destination").show()),$("#s_transaction_operation_type_transfer").prop("checked")&&($(".s-tools-fields").show(),$(".s_transaction_destination").show(),$(".s_transaction_source").show()),$("#s_transaction_operation_type_entrance").prop("checked")&&($(".s-tools-fields").hide(),$(".s_transaction_destination").hide(),$(".s_transaction_source").hide()),$("#s_transaction_operation_type_exit").prop("checked"))return $(".s-tools-fields").show(),$(".s_transaction_destination").hide(),$(".s_transaction_source").hide()})})}.call(this),function(){$(function(){var e;return $.rails.allowAction=function(e){return!e.attr("data-confirm")||($.rails.showConfirmDialog(e),!1)},$.rails.confirmed=function(e){return e.removeAttr("data-confirm"),e.trigger("click.rails")},$.rails.showConfirmDialog=function(e){var t,o,n;return n=e.attr("data-title"),o=e.attr("data-text"),n||(n=e.attr("title")),o||(o=e.attr("data-confirm")),t='<div class="modal" id="confirmationDialog">\n<div class="modal-dialog">\n<div class="modal-content">\n  <div class="modal-header">\n    <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n    <span aria-hidden="true">\xd7</span></button>\n    <h4 class="modal-title">'+n+'</h4>\n  </div>\n  <div class="modal-body">\n    <p>'+o+'</p>\n  </div>\n  <div class="modal-footer">\n    <button type="button" class="btn btn-link" data-dismiss="modal">Cancel</a>\n    <button type="button" class="btn btn-primary confirm">OK</button>\n  </div>\n</div>\n</div>\n</div>',$(t).modal(),$("#confirmationDialog .confirm").on("click",function(){return $.rails.confirmed(e)})},e=function(){return $("#task_regularly").prop("checked")?$(".finish_date_wrapper").hide():$(".finish_date_wrapper").show()},$('input[name="task[regularly]"]').on("click",function(){return e()}),e(),$(".history-table-title").on("click",function(e){return e.preventDefault(),$(this).next(".history-table-changes").toggle()})})}.call(this),function(){$(function(){var e;return e=$(".tool_fields, .material_fields, .work_type_categories_fields"),e.on("cocoon:before-insert",function(e,t){return t.fadeIn("slow")}),e.on("cocoon:after-insert",function(e,t){return $(t).find("select").select2({language:"ru",minimumResultsForSearch:20,allowClear:!0,placeholder:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435"})}),e.on("cocoon:before-remove",function(e,t){return $(this).data("remove-timeout",1e3),t.fadeOut("slow")})})}.call(this),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.moment=t()}(this,function(){"use strict";function e(){return sn.apply(null,arguments)}function t(e){sn=e}function o(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function n(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function r(e,t){var o,n=[];for(o=0;o<e.length;++o)n.push(t(e[o],o));return n}function i(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function a(e,t){for(var o in t)i(t,o)&&(e[o]=t[o]);return i(t,"toString")&&(e.toString=t.toString),i(t,"valueOf")&&(e.valueOf=t.valueOf),e}function s(e,t,o,n){return Ie(e,t,o,n,!0).utc()}function l(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null}}function c(e){return null==e._pf&&(e._pf=l()),e._pf}function d(e){if(null==e._isValid){var t=c(e),o=ln.call(t.parsedDateParts,function(e){return null!=e});e._isValid=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&o),e._strict&&(e._isValid=e._isValid&&0===t.charsLeftOver&&0===t.unusedTokens.length&&t.bigHour===undefined)}return e._isValid}function u(e){var t=s(NaN);return null!=e?a(c(t),e):c(t).userInvalidated=!0,t}function p(e){return void 0===e}function h(e,t){var o,n,r;if(p(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),p(t._i)||(e._i=t._i),p(t._f)||(e._f=t._f),p(t._l)||(e._l=t._l),p(t._strict)||(e._strict=t._strict),p(t._tzm)||(e._tzm=t._tzm),p(t._isUTC)||(e._isUTC=t._isUTC),p(t._offset)||(e._offset=t._offset),p(t._pf)||(e._pf=c(t)),p(t._locale)||(e._locale=t._locale),cn.length>0)for(o in cn)n=cn[o],r=t[n],p(r)||(e[n]=r);return e}function f(t){h(this,t),this._d=new Date(null!=t._d?t._d.getTime():NaN),!1===dn&&(dn=!0,e.updateOffset(this),dn=!1)}function m(e){return e instanceof f||null!=e&&null!=e._isAMomentObject}function g(e){return e<0?Math.ceil(e):Math.floor(e)}function v(e){var t=+e,o=0;return 0!==t&&isFinite(t)&&(o=g(t)),o}function y(e,t,o){var n,r=Math.min(e.length,t.length),i=Math.abs(e.length-t.length),a=0;for(n=0;n<r;n++)(o&&e[n]!==t[n]||!o&&v(e[n])!==v(t[n]))&&a++;return a+i}function b(t){!1===e.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+t)}function C(t,o){var n=!0;return a(function(){return null!=e.deprecationHandler&&e.deprecationHandler(null,t),n&&(b(t+"\nArguments: "+Array.prototype.slice.call(arguments).join(", ")+"\n"+(new Error).stack),n=!1),o.apply(this,arguments)},o)}function w(t,o){null!=e.deprecationHandler&&e.deprecationHandler(t,o),un[t]||(b(o),un[t]=!0)}function x(e){return e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function S(e){return"[object Object]"===Object.prototype.toString.call(e)}function _(e){var t,o;for(o in e)t=e[o],x(t)?this[o]=t:this["_"+o]=t;this._config=e,this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)}function k(e,t){var o,n=a({},e);for(o in t)i(t,o)&&(S(e[o])&&S(t[o])?(n[o]={},a(n[o],e[o]),a(n[o],t[o])):null!=t[o]?n[o]=t[o]:delete n[o]);return n}function T(e){null!=e&&this.set(e)}function E(e){return e?e.toLowerCase().replace("_","-"):e}function F(e){for(var t,o,n,r,i=0;i<e.length;){for(r=E(e[i]).split("-"),t=r.length,o=E(e[i+1]),o=o?o.split("-"):null;t>0;){if(n=D(r.slice(0,t).join("-")))return n;if(o&&o.length>=t&&y(r,o,!0)>=t-1)break;t--}i++}return null}function D(e){var t=null;if(!mn[e]&&"undefined"!=typeof module&&module&&module.exports)try{t=hn._abbr,require("./locale/"+e),M(t)}catch(e){}return mn[e]}function M(e,t){var o;return e&&(o=p(t)?L(e):A(e,t))&&(hn=o),hn._abbr}function A(e,t){return null!==t?(t.abbr=e,null!=mn[e]?(w("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale"),t=k(mn[e]._config,t)):null!=t.parentLocale&&(null!=mn[t.parentLocale]?t=k(mn[t.parentLocale]._config,t):w("parentLocaleUndefined","specified parentLocale is not defined yet")),mn[e]=new T(t),M(e),mn[e]):(delete mn[e],null)}function P(e,t){if(null!=t){var o;null!=mn[e]&&(t=k(mn[e]._config,t)),o=new T(t),o.parentLocale=mn[e],mn[e]=o,M(e)}else null!=mn[e]&&(null!=mn[e].parentLocale?mn[e]=mn[e].parentLocale:null!=mn[e]&&delete mn[e]);return mn[e]}function L(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return hn;if(!o(e)){if(t=D(e))return t;e=[e]}return F(e)}function R(){return pn(mn)}function I(e,t){var o=e.toLowerCase();gn[o]=gn[o+"s"]=gn[t]=e}function O(e){return"string"==typeof e?gn[e]||gn[e.toLowerCase()]:undefined}function $(e){var t,o,n={};for(o in e)i(e,o)&&(t=O(o))&&(n[t]=e[o]);return n}function N(t,o){return function(n){return null!=n?(j(this,t,n),e.updateOffset(this,o),this):U(this,t)}}function U(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function j(e,t,o){e.isValid()&&e._d["set"+(e._isUTC?"UTC":"")+t](o)}function H(e,t){var o;if("object"==typeof e)for(o in e)this.set(o,e[o]);else if(e=O(e),x(this[e]))return this[e](t);return this}function B(e,t,o){var n=""+Math.abs(e),r=t-n.length;return(e>=0?o?"+":"":"-")+Math.pow(10,Math.max(0,r)).toString().substr(1)+n}function z(e,t,o,n){var r=n;"string"==typeof n&&(r=function(){return this[n]()}),e&&(Cn[e]=r),t&&(Cn[t[0]]=function(){return B(r.apply(this,arguments),t[1],t[2])}),o&&(Cn[o]=function(){return this.localeData().ordinal(r.apply(this,arguments),e)})}function V(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function Y(e){var t,o,n=e.match(vn);for(t=0,o=n.length;t<o;t++)Cn[n[t]]?n[t]=Cn[n[t]]:n[t]=V(n[t]);return function(t){var r,i="";for(r=0;r<o;r++)i+=n[r]instanceof Function?n[r].call(t,e):n[r];return i}}function G(e,t){return e.isValid()?(t=W(t,e.localeData()),bn[t]=bn[t]||Y(t),bn[t](e)):e.localeData().invalidDate()}function W(e,t){function o(e){return t.longDateFormat(e)||e}var n=5;for(yn.lastIndex=0;n>=0&&yn.test(e);)e=e.replace(yn,o),yn.lastIndex=0,n-=1;return e}function q(e,t,o){Nn[e]=x(t)?t:function(e){return e&&o?o:t}}function K(e,t){return i(Nn,e)?Nn[e](t._strict,t._locale):new RegExp(X(e))}function X(e){return Q(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,o,n,r){return t||o||n||r}))}function Q(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Z(e,t){var o,n=t;for("string"==typeof e&&(e=[e]),"number"==typeof t&&(n=function(e,o){o[t]=v(e)}),o=0;o<e.length;o++)Un[e[o]]=n}function J(e,t){Z(e,function(e,o,n,r){n._w=n._w||{},t(e,n._w,n,r)})}function ee(e,t,o){null!=t&&i(Un,e)&&Un[e](t,o._a,o,e)}function te(e,t){return new Date(Date.UTC(e,t+1,0)).getUTCDate()}function oe(e,t){return o(this._months)?this._months[e.month()]:this._months[Kn.test(t)?"format":"standalone"][e.month()]}function ne(e,t){return o(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[Kn.test(t)?"format":"standalone"][e.month()]}function re(e,t,o){var n,r,i,a=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)i=s([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(i,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(i,"").toLocaleLowerCase();return o?"MMM"===t?(r=fn.call(this._shortMonthsParse,a),-1!==r?r:null):(r=fn.call(this._longMonthsParse,a),-1!==r?r:null):"MMM"===t?-1!==(r=fn.call(this._shortMonthsParse,a))?r:(r=fn.call(this._longMonthsParse,a),-1!==r?r:null):-1!==(r=fn.call(this._longMonthsParse,a))?r:(r=fn.call(this._shortMonthsParse,a),-1!==r?r:null)}function ie(e,t,o){var n,r,i;if(this._monthsParseExact)return re.call(this,e,t,o);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(r=s([2e3,n]),o&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(r,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(r,"").replace(".","")+"$","i")),o||this._monthsParse[n]||(i="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[n]=new RegExp(i.replace(".",""),"i")),o&&"MMMM"===t&&this._longMonthsParse[n].test(e))return n;if(o&&"MMM"===t&&this._shortMonthsParse[n].test(e))return n;if(!o&&this._monthsParse[n].test(e))return n}}function ae(e,t){var o;if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=v(t);else if("number"!=typeof(t=e.localeData().monthsParse(t)))return e;return o=Math.min(e.date(),te(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,o),e}function se(t){return null!=t?(ae(this,t),e.updateOffset(this,!0),this):U(this,"Month")}function le(){return te(this.year(),this.month())}function ce(e){return this._monthsParseExact?(i(this,"_monthsRegex")||ue.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex}function de(e){return this._monthsParseExact?(i(this,"_monthsRegex")||ue.call(this),e?this._monthsStrictRegex:this._monthsRegex):this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex}function ue(){function e(e,t){return t.length-e.length}var t,o,n=[],r=[],i=[];for(t=0;t<12;t++)o=s([2e3,t]),n.push(this.monthsShort(o,"")),r.push(this.months(o,"")),i.push(this.months(o,"")),i.push(this.monthsShort(o,""));for(n.sort(e),r.sort(e),i.sort(e),t=0;t<12;t++)n[t]=Q(n[t]),r[t]=Q(r[t]),i[t]=Q(i[t]);this._monthsRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+n.join("|")+")","i")}function pe(e){var t,o=e._a;return o&&-2===c(e).overflow&&(t=o[Hn]<0||o[Hn]>11?Hn:o[Bn]<1||o[Bn]>te(o[jn],o[Hn])?Bn:o[zn]<0||o[zn]>24||24===o[zn]&&(0!==o[Vn]||0!==o[Yn]||0!==o[Gn])?zn:o[Vn]<0||o[Vn]>59?Vn:o[Yn]<0||o[Yn]>59?Yn:o[Gn]<0||o[Gn]>999?Gn:-1,c(e)._overflowDayOfYear&&(t<jn||t>Bn)&&(t=Bn),c(e)._overflowWeeks&&-1===t&&(t=Wn),c(e)._overflowWeekday&&-1===t&&(t=qn),c(e).overflow=t),e}function he(e){var t,o,n,r,i,a,s=e._i,l=er.exec(s)||tr.exec(s);if(l){for(c(e).iso=!0,t=0,o=nr.length;t<o;t++)if(nr[t][1].exec(l[1])){r=nr[t][0],n=!1!==nr[t][2];break}if(null==r)return void(e._isValid=!1);if(l[3]){for(t=0,o=rr.length;t<o;t++)if(rr[t][1].exec(l[3])){i=(l[2]||" ")+rr[t][0];break}if(null==i)return void(e._isValid=!1)}if(!n&&null!=i)return void(e._isValid=!1);if(l[4]){if(!or.exec(l[4]))return void(e._isValid=!1);a="Z"}e._f=r+(i||"")+(a||""),Fe(e)}else e._isValid=!1}function fe(t){var o=ir.exec(t._i);if(null!==o)return void(t._d=new Date(+o[1]));he(t),!1===t._isValid&&(delete t._isValid,e.createFromInputFallback(t))}function me(e,t,o,n,r,i,a){var s=new Date(e,t,o,n,r,i,a);return e<100&&e>=0&&isFinite(s.getFullYear())&&s.setFullYear(e),s}function ge(e){var t=new Date(Date.UTC.apply(null,arguments));return e<100&&e>=0&&isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e),t}function ve(e){return ye(e)?366:365}function ye(e){return e%4==0&&e%100!=0||e%400==0}function be(){return ye(this.year())}function Ce(e,t,o){var n=7+t-o;return-(7+ge(e,0,n).getUTCDay()-t)%7+n-1}function we(e,t,o,n,r){var i,a,s=(7+o-n)%7,l=Ce(e,n,r),c=1+7*(t-1)+s+l;return c<=0?(i=e-1,a=ve(i)+c):c>ve(e)?(i=e+1,a=c-ve(e)):(i=e,a=c),{year:i,dayOfYear:a}}function xe(e,t,o){var n,r,i=Ce(e.year(),t,o),a=Math.floor((e.dayOfYear()-i-1)/7)+1;return a<1?(r=e.year()-1,n=a+Se(r,t,o)):a>Se(e.year(),t,o)?(n=a-Se(e.year(),t,o),r=e.year()+1):(r=e.year(),n=a),{week:n,year:r}}function Se(e,t,o){var n=Ce(e,t,o),r=Ce(e+1,t,o);return(ve(e)-n+r)/7}function _e(e,t,o){return null!=e?e:null!=t?t:o}function ke(t){var o=new Date(e.now());return t._useUTC?[o.getUTCFullYear(),o.getUTCMonth(),o.getUTCDate()]:[o.getFullYear(),o.getMonth(),o.getDate()]}function Te(e){var t,o,n,r,i=[];if(!e._d){for(n=ke(e),e._w&&null==e._a[Bn]&&null==e._a[Hn]&&Ee(e),e._dayOfYear&&(r=_e(e._a[jn],n[jn]),e._dayOfYear>ve(r)&&(c(e)._overflowDayOfYear=!0),o=ge(r,0,e._dayOfYear),e._a[Hn]=o.getUTCMonth(),e._a[Bn]=o.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=i[t]=n[t];for(;t<7;t++)e._a[t]=i[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[zn]&&0===e._a[Vn]&&0===e._a[Yn]&&0===e._a[Gn]&&(e._nextDay=!0,e._a[zn]=0),e._d=(e._useUTC?ge:me).apply(null,i),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[zn]=24)}}function Ee(e){var t,o,n,r,i,a,s,l;t=e._w,null!=t.GG||null!=t.W||null!=t.E?(i=1,a=4,o=_e(t.GG,e._a[jn],xe(Oe(),1,4).year),n=_e(t.W,1),((r=_e(t.E,1))<1||r>7)&&(l=!0)):(i=e._locale._week.dow,a=e._locale._week.doy,o=_e(t.gg,e._a[jn],xe(Oe(),i,a).year),n=_e(t.w,1),null!=t.d?((r=t.d)<0||r>6)&&(l=!0):null!=t.e?(r=t.e+i,(t.e<0||t.e>6)&&(l=!0)):r=i),n<1||n>Se(o,i,a)?c(e)._overflowWeeks=!0:null!=l?c(e)._overflowWeekday=!0:(s=we(o,n,r,i,a),e._a[jn]=s.year,e._dayOfYear=s.dayOfYear)}function Fe(t){if(t._f===e.ISO_8601)return void he(t);t._a=[],c(t).empty=!0;var o,n,r,i,a,s=""+t._i,l=s.length,d=0;for(r=W(t._f,t._locale).match(vn)||[],o=0;o<r.length;o++)i=r[o],n=(s.match(K(i,t))||[])[0],n&&(a=s.substr(0,s.indexOf(n)),a.length>0&&c(t).unusedInput.push(a),s=s.slice(s.indexOf(n)+n.length),d+=n.length),Cn[i]?(n?c(t).empty=!1:c(t).unusedTokens.push(i),ee(i,n,t)):t._strict&&!n&&c(t).unusedTokens.push(i);c(t).charsLeftOver=l-d,s.length>0&&c(t).unusedInput.push(s),!0===c(t).bigHour&&t._a[zn]<=12&&t._a[zn]>0&&(c(t).bigHour=undefined),
c(t).parsedDateParts=t._a.slice(0),c(t).meridiem=t._meridiem,t._a[zn]=De(t._locale,t._a[zn],t._meridiem),Te(t),pe(t)}function De(e,t,o){var n;return null==o?t:null!=e.meridiemHour?e.meridiemHour(t,o):null!=e.isPM?(n=e.isPM(o),n&&t<12&&(t+=12),n||12!==t||(t=0),t):t}function Me(e){var t,o,n,r,i;if(0===e._f.length)return c(e).invalidFormat=!0,void(e._d=new Date(NaN));for(r=0;r<e._f.length;r++)i=0,t=h({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[r],Fe(t),d(t)&&(i+=c(t).charsLeftOver,i+=10*c(t).unusedTokens.length,c(t).score=i,(null==n||i<n)&&(n=i,o=t));a(e,o||t)}function Ae(e){if(!e._d){var t=$(e._i);e._a=r([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],function(e){return e&&parseInt(e,10)}),Te(e)}}function Pe(e){var t=new f(pe(Le(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=undefined),t}function Le(e){var t=e._i,r=e._f;return e._locale=e._locale||L(e._l),null===t||r===undefined&&""===t?u({nullInput:!0}):("string"==typeof t&&(e._i=t=e._locale.preparse(t)),m(t)?new f(pe(t)):(o(r)?Me(e):r?Fe(e):n(t)?e._d=t:Re(e),d(e)||(e._d=null),e))}function Re(t){var i=t._i;i===undefined?t._d=new Date(e.now()):n(i)?t._d=new Date(i.valueOf()):"string"==typeof i?fe(t):o(i)?(t._a=r(i.slice(0),function(e){return parseInt(e,10)}),Te(t)):"object"==typeof i?Ae(t):"number"==typeof i?t._d=new Date(i):e.createFromInputFallback(t)}function Ie(e,t,o,n,r){var i={};return"boolean"==typeof o&&(n=o,o=undefined),i._isAMomentObject=!0,i._useUTC=i._isUTC=r,i._l=o,i._i=e,i._f=t,i._strict=n,Pe(i)}function Oe(e,t,o,n){return Ie(e,t,o,n,!1)}function $e(e,t){var n,r;if(1===t.length&&o(t[0])&&(t=t[0]),!t.length)return Oe();for(n=t[0],r=1;r<t.length;++r)t[r].isValid()&&!t[r][e](n)||(n=t[r]);return n}function Ne(){return $e("isBefore",[].slice.call(arguments,0))}function Ue(){return $e("isAfter",[].slice.call(arguments,0))}function je(e){var t=$(e),o=t.year||0,n=t.quarter||0,r=t.month||0,i=t.week||0,a=t.day||0,s=t.hour||0,l=t.minute||0,c=t.second||0,d=t.millisecond||0;this._milliseconds=+d+1e3*c+6e4*l+1e3*s*60*60,this._days=+a+7*i,this._months=+r+3*n+12*o,this._data={},this._locale=L(),this._bubble()}function He(e){return e instanceof je}function Be(e,t){z(e,0,0,function(){var e=this.utcOffset(),o="+";return e<0&&(e=-e,o="-"),o+B(~~(e/60),2)+t+B(~~e%60,2)})}function ze(e,t){var o=(t||"").match(e)||[],n=o[o.length-1]||[],r=(n+"").match(dr)||["-",0,0],i=60*r[1]+v(r[2]);return"+"===r[0]?i:-i}function Ve(t,o){var r,i;return o._isUTC?(r=o.clone(),i=(m(t)||n(t)?t.valueOf():Oe(t).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+i),e.updateOffset(r,!1),r):Oe(t).local()}function Ye(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function Ge(t,o){var n,r=this._offset||0;return this.isValid()?null!=t?("string"==typeof t?t=ze(In,t):Math.abs(t)<16&&(t*=60),!this._isUTC&&o&&(n=Ye(this)),this._offset=t,this._isUTC=!0,null!=n&&this.add(n,"m"),r!==t&&(!o||this._changeInProgress?ct(this,nt(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,e.updateOffset(this,!0),this._changeInProgress=null)),this):this._isUTC?r:Ye(this):null!=t?this:NaN}function We(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function qe(e){return this.utcOffset(0,e)}function Ke(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Ye(this),"m")),this}function Xe(){return this._tzm?this.utcOffset(this._tzm):"string"==typeof this._i&&this.utcOffset(ze(Rn,this._i)),this}function Qe(e){return!!this.isValid()&&(e=e?Oe(e).utcOffset():0,(this.utcOffset()-e)%60==0)}function Ze(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Je(){if(!p(this._isDSTShifted))return this._isDSTShifted;var e={};if(h(e,this),e=Le(e),e._a){var t=e._isUTC?s(e._a):Oe(e._a);this._isDSTShifted=this.isValid()&&y(e._a,t.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}function et(){return!!this.isValid()&&!this._isUTC}function tt(){return!!this.isValid()&&this._isUTC}function ot(){return!!this.isValid()&&(this._isUTC&&0===this._offset)}function nt(e,t){var o,n,r,a=e,s=null;return He(e)?a={ms:e._milliseconds,d:e._days,M:e._months}:"number"==typeof e?(a={},t?a[t]=e:a.milliseconds=e):(s=ur.exec(e))?(o="-"===s[1]?-1:1,a={y:0,d:v(s[Bn])*o,h:v(s[zn])*o,m:v(s[Vn])*o,s:v(s[Yn])*o,ms:v(s[Gn])*o}):(s=pr.exec(e))?(o="-"===s[1]?-1:1,a={y:rt(s[2],o),M:rt(s[3],o),w:rt(s[4],o),d:rt(s[5],o),h:rt(s[6],o),m:rt(s[7],o),s:rt(s[8],o)}):null==a?a={}:"object"==typeof a&&("from"in a||"to"in a)&&(r=at(Oe(a.from),Oe(a.to)),a={},a.ms=r.milliseconds,a.M=r.months),n=new je(a),He(e)&&i(e,"_locale")&&(n._locale=e._locale),n}function rt(e,t){var o=e&&parseFloat(e.replace(",","."));return(isNaN(o)?0:o)*t}function it(e,t){var o={milliseconds:0,months:0};return o.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(o.months,"M").isAfter(t)&&--o.months,o.milliseconds=+t-+e.clone().add(o.months,"M"),o}function at(e,t){var o;return e.isValid()&&t.isValid()?(t=Ve(t,e),e.isBefore(t)?o=it(e,t):(o=it(t,e),o.milliseconds=-o.milliseconds,o.months=-o.months),o):{milliseconds:0,months:0}}function st(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function lt(e,t){return function(o,n){var r,i;return null===n||isNaN(+n)||(w(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period)."),i=o,o=n,n=i),o="string"==typeof o?+o:o,r=nt(o,n),ct(this,r,e),this}}function ct(t,o,n,r){var i=o._milliseconds,a=st(o._days),s=st(o._months);t.isValid()&&(r=null==r||r,i&&t._d.setTime(t._d.valueOf()+i*n),a&&j(t,"Date",U(t,"Date")+a*n),s&&ae(t,U(t,"Month")+s*n),r&&e.updateOffset(t,a||s))}function dt(e,t){var o=e||Oe(),n=Ve(o,this).startOf("day"),r=this.diff(n,"days",!0),i=r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse",a=t&&(x(t[i])?t[i]():t[i]);return this.format(a||this.localeData().calendar(i,this,Oe(o)))}function ut(){return new f(this)}function pt(e,t){var o=m(e)?e:Oe(e);return!(!this.isValid()||!o.isValid())&&(t=O(p(t)?"millisecond":t),"millisecond"===t?this.valueOf()>o.valueOf():o.valueOf()<this.clone().startOf(t).valueOf())}function ht(e,t){var o=m(e)?e:Oe(e);return!(!this.isValid()||!o.isValid())&&(t=O(p(t)?"millisecond":t),"millisecond"===t?this.valueOf()<o.valueOf():this.clone().endOf(t).valueOf()<o.valueOf())}function ft(e,t,o,n){return n=n||"()",("("===n[0]?this.isAfter(e,o):!this.isBefore(e,o))&&(")"===n[1]?this.isBefore(t,o):!this.isAfter(t,o))}function mt(e,t){var o,n=m(e)?e:Oe(e);return!(!this.isValid()||!n.isValid())&&(t=O(t||"millisecond"),"millisecond"===t?this.valueOf()===n.valueOf():(o=n.valueOf(),this.clone().startOf(t).valueOf()<=o&&o<=this.clone().endOf(t).valueOf()))}function gt(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function vt(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function yt(e,t,o){var n,r,i,a;return this.isValid()?(n=Ve(e,this),n.isValid()?(r=6e4*(n.utcOffset()-this.utcOffset()),t=O(t),"year"===t||"month"===t||"quarter"===t?(a=bt(this,n),"quarter"===t?a/=3:"year"===t&&(a/=12)):(i=this-n,a="second"===t?i/1e3:"minute"===t?i/6e4:"hour"===t?i/36e5:"day"===t?(i-r)/864e5:"week"===t?(i-r)/6048e5:i),o?a:g(a)):NaN):NaN}function bt(e,t){var o,n,r=12*(t.year()-e.year())+(t.month()-e.month()),i=e.clone().add(r,"months");return t-i<0?(o=e.clone().add(r-1,"months"),n=(t-i)/(i-o)):(o=e.clone().add(r+1,"months"),n=(t-i)/(o-i)),-(r+n)||0}function Ct(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function wt(){var e=this.clone().utc();return 0<e.year()&&e.year()<=9999?x(Date.prototype.toISOString)?this.toDate().toISOString():G(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):G(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function xt(t){t||(t=this.isUtc()?e.defaultFormatUtc:e.defaultFormat);var o=G(this,t);return this.localeData().postformat(o)}function St(e,t){return this.isValid()&&(m(e)&&e.isValid()||Oe(e).isValid())?nt({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function _t(e){return this.from(Oe(),e)}function kt(e,t){return this.isValid()&&(m(e)&&e.isValid()||Oe(e).isValid())?nt({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function Tt(e){return this.to(Oe(),e)}function Et(e){var t;return e===undefined?this._locale._abbr:(t=L(e),null!=t&&(this._locale=t),this)}function Ft(){return this._locale}function Dt(e){switch(e=O(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e&&this.weekday(0),"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this}function Mt(e){return(e=O(e))===undefined||"millisecond"===e?this:("date"===e&&(e="day"),this.startOf(e).add(1,"isoWeek"===e?"week":e).subtract(1,"ms"))}function At(){return this._d.valueOf()-6e4*(this._offset||0)}function Pt(){return Math.floor(this.valueOf()/1e3)}function Lt(){return this._offset?new Date(this.valueOf()):this._d}function Rt(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function It(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function Ot(){return this.isValid()?this.toISOString():null}function $t(){return d(this)}function Nt(){return a({},c(this))}function Ut(){return c(this).overflow}function jt(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function Ht(e,t){z(0,[e,e.length],0,t)}function Bt(e){return Gt.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function zt(e){return Gt.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function Vt(){return Se(this.year(),1,4)}function Yt(){var e=this.localeData()._week;return Se(this.year(),e.dow,e.doy)}function Gt(e,t,o,n,r){var i;return null==e?xe(this,n,r).year:(i=Se(e,n,r),t>i&&(t=i),Wt.call(this,e,t,o,n,r))}function Wt(e,t,o,n,r){var i=we(e,t,o,n,r),a=ge(i.year,0,i.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}function qt(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)}function Kt(e){return xe(e,this._week.dow,this._week.doy).week}function Xt(){return this._week.dow}function Qt(){return this._week.doy}function Zt(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")}function Jt(e){var t=xe(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")}function eo(e,t){return"string"!=typeof e?e:isNaN(e)?(e=t.weekdaysParse(e),"number"==typeof e?e:null):parseInt(e,10)}function to(e,t){return o(this._weekdays)?this._weekdays[e.day()]:this._weekdays[this._weekdays.isFormat.test(t)?"format":"standalone"][e.day()]}function oo(e){return this._weekdaysShort[e.day()]}function no(e){return this._weekdaysMin[e.day()]}function ro(e,t,o){var n,r,i,a=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)i=s([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(i,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(i,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(i,"").toLocaleLowerCase();return o?"dddd"===t?(r=fn.call(this._weekdaysParse,a),-1!==r?r:null):"ddd"===t?(r=fn.call(this._shortWeekdaysParse,a),-1!==r?r:null):(r=fn.call(this._minWeekdaysParse,a),-1!==r?r:null):"dddd"===t?-1!==(r=fn.call(this._weekdaysParse,a))?r:-1!==(r=fn.call(this._shortWeekdaysParse,a))?r:(r=fn.call(this._minWeekdaysParse,a),-1!==r?r:null):"ddd"===t?-1!==(r=fn.call(this._shortWeekdaysParse,a))?r:-1!==(r=fn.call(this._weekdaysParse,a))?r:(r=fn.call(this._minWeekdaysParse,a),-1!==r?r:null):-1!==(r=fn.call(this._minWeekdaysParse,a))?r:-1!==(r=fn.call(this._weekdaysParse,a))?r:(r=fn.call(this._shortWeekdaysParse,a),-1!==r?r:null)}function io(e,t,o){var n,r,i;if(this._weekdaysParseExact)return ro.call(this,e,t,o);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(r=s([2e3,1]).day(n),o&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(r,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(r,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(r,"").replace(".",".?")+"$","i")),this._weekdaysParse[n]||(i="^"+this.weekdays(r,"")+"|^"+this.weekdaysShort(r,"")+"|^"+this.weekdaysMin(r,""),this._weekdaysParse[n]=new RegExp(i.replace(".",""),"i")),o&&"dddd"===t&&this._fullWeekdaysParse[n].test(e))return n;if(o&&"ddd"===t&&this._shortWeekdaysParse[n].test(e))return n;if(o&&"dd"===t&&this._minWeekdaysParse[n].test(e))return n;if(!o&&this._weekdaysParse[n].test(e))return n}}function ao(e){if(!this.isValid())return null!=e?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=eo(e,this.localeData()),this.add(e-t,"d")):t}function so(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")}function lo(e){return this.isValid()?null==e?this.day()||7:this.day(this.day()%7?e:e-7):null!=e?this:NaN}function co(e){return this._weekdaysParseExact?(i(this,"_weekdaysRegex")||ho.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex}function uo(e){return this._weekdaysParseExact?(i(this,"_weekdaysRegex")||ho.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex}function po(e){return this._weekdaysParseExact?(i(this,"_weekdaysRegex")||ho.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex}function ho(){function e(e,t){return t.length-e.length}var t,o,n,r,i,a=[],l=[],c=[],d=[];for(t=0;t<7;t++)o=s([2e3,1]).day(t),n=this.weekdaysMin(o,""),r=this.weekdaysShort(o,""),i=this.weekdays(o,""),a.push(n),l.push(r),c.push(i),d.push(n),d.push(r),d.push(i);for(a.sort(e),l.sort(e),c.sort(e),d.sort(e),t=0;t<7;t++)l[t]=Q(l[t]),c[t]=Q(c[t]),d[t]=Q(d[t]);this._weekdaysRegex=new RegExp("^("+d.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+c.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+a.join("|")+")","i")}function fo(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")}function mo(){return this.hours()%12||12}function go(){return this.hours()||24}function vo(e,t){z(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function yo(e,t){return t._meridiemParse}function bo(e){return"p"===(e+"").toLowerCase().charAt(0)}function Co(e,t,o){return e>11?o?"pm":"PM":o?"am":"AM"}function wo(e,t){t[Gn]=v(1e3*("0."+e))}function xo(){return this._isUTC?"UTC":""}function So(){return this._isUTC?"Coordinated Universal Time":""}function _o(e){return Oe(1e3*e)}function ko(){return Oe.apply(null,arguments).parseZone()}function To(e,t,o){var n=this._calendar[e];return x(n)?n.call(t,o):n}function Eo(e){var t=this._longDateFormat[e],o=this._longDateFormat[e.toUpperCase()];return t||!o?t:(this._longDateFormat[e]=o.replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e])}function Fo(){return this._invalidDate}function Do(e){return this._ordinal.replace("%d",e)}function Mo(e){return e}function Ao(e,t,o,n){var r=this._relativeTime[o];return x(r)?r(e,t,o,n):r.replace(/%d/i,e)}function Po(e,t){var o=this._relativeTime[e>0?"future":"past"];return x(o)?o(t):o.replace(/%s/i,t)}function Lo(e,t,o,n){var r=L(),i=s().set(n,t);return r[o](i,e)}function Ro(e,t,o){if("number"==typeof e&&(t=e,e=undefined),e=e||"",null!=t)return Lo(e,t,o,"month");var n,r=[];for(n=0;n<12;n++)r[n]=Lo(e,n,o,"month");return r}function Io(e,t,o,n){"boolean"==typeof e?("number"==typeof t&&(o=t,t=undefined),t=t||""):(t=e,o=t,e=!1,"number"==typeof t&&(o=t,t=undefined),t=t||"");var r=L(),i=e?r._week.dow:0;if(null!=o)return Lo(t,(o+i)%7,n,"day");var a,s=[];for(a=0;a<7;a++)s[a]=Lo(t,(a+i)%7,n,"day");return s}function Oo(e,t){return Ro(e,t,"months")}function $o(e,t){return Ro(e,t,"monthsShort")}function No(e,t,o){return Io(e,t,o,"weekdays")}function Uo(e,t,o){return Io(e,t,o,"weekdaysShort")}function jo(e,t,o){return Io(e,t,o,"weekdaysMin")}function Ho(){var e=this._data;return this._milliseconds=$r(this._milliseconds),this._days=$r(this._days),this._months=$r(this._months),e.milliseconds=$r(e.milliseconds),e.seconds=$r(e.seconds),e.minutes=$r(e.minutes),e.hours=$r(e.hours),e.months=$r(e.months),e.years=$r(e.years),this}function Bo(e,t,o,n){var r=nt(t,o);return e._milliseconds+=n*r._milliseconds,e._days+=n*r._days,e._months+=n*r._months,e._bubble()}function zo(e,t){return Bo(this,e,t,1)}function Vo(e,t){return Bo(this,e,t,-1)}function Yo(e){return e<0?Math.floor(e):Math.ceil(e)}function Go(){var e,t,o,n,r,i=this._milliseconds,a=this._days,s=this._months,l=this._data;return i>=0&&a>=0&&s>=0||i<=0&&a<=0&&s<=0||(i+=864e5*Yo(qo(s)+a),a=0,s=0),l.milliseconds=i%1e3,e=g(i/1e3),l.seconds=e%60,t=g(e/60),l.minutes=t%60,o=g(t/60),l.hours=o%24,a+=g(o/24),r=g(Wo(a)),s+=r,a-=Yo(qo(r)),n=g(s/12),s%=12,l.days=a,l.months=s,l.years=n,this}function Wo(e){return 4800*e/146097}function qo(e){return 146097*e/4800}function Ko(e){var t,o,n=this._milliseconds;if("month"===(e=O(e))||"year"===e)return t=this._days+n/864e5,o=this._months+Wo(t),"month"===e?o:o/12;switch(t=this._days+Math.round(qo(this._months)),e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return 24*t+n/36e5;case"minute":return 1440*t+n/6e4;case"second":return 86400*t+n/1e3;case"millisecond":return Math.floor(864e5*t)+n;default:throw new Error("Unknown unit "+e)}}function Xo(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*v(this._months/12)}function Qo(e){return function(){return this.as(e)}}function Zo(e){return e=O(e),this[e+"s"]()}function Jo(e){return function(){return this._data[e]}}function en(){return g(this.days()/7)}function tn(e,t,o,n,r){return r.relativeTime(t||1,!!o,e,n)}function on(e,t,o){var n=nt(e).abs(),r=Jr(n.as("s")),i=Jr(n.as("m")),a=Jr(n.as("h")),s=Jr(n.as("d")),l=Jr(n.as("M")),c=Jr(n.as("y")),d=r<ei.s&&["s",r]||i<=1&&["m"]||i<ei.m&&["mm",i]||a<=1&&["h"]||a<ei.h&&["hh",a]||s<=1&&["d"]||s<ei.d&&["dd",s]||l<=1&&["M"]||l<ei.M&&["MM",l]||c<=1&&["y"]||["yy",c];return d[2]=t,d[3]=+e>0,d[4]=o,tn.apply(null,d)}function nn(e,t){return ei[e]!==undefined&&(t===undefined?ei[e]:(ei[e]=t,!0))}function rn(e){var t=this.localeData(),o=on(this,!e,t);return e&&(o=t.pastFuture(+this,o)),t.postformat(o)}function an(){var e,t,o,n=ti(this._milliseconds)/1e3,r=ti(this._days),i=ti(this._months);e=g(n/60),t=g(e/60),n%=60,e%=60,o=g(i/12),i%=12;var a=o,s=i,l=r,c=t,d=e,u=n,p=this.asSeconds();return p?(p<0?"-":"")+"P"+(a?a+"Y":"")+(s?s+"M":"")+(l?l+"D":"")+(c||d||u?"T":"")+(c?c+"H":"")+(d?d+"M":"")+(u?u+"S":""):"P0D"}var sn,ln;ln=Array.prototype.some?Array.prototype.some:function(e){for(var t=Object(this),o=t.length>>>0,n=0;n<o;n++)if(n in t&&e.call(this,t[n],n,t))return!0;return!1};var cn=e.momentProperties=[],dn=!1,un={};e.suppressDeprecationWarnings=!1,e.deprecationHandler=null;var pn;pn=Object.keys?Object.keys:function(e){var t,o=[];for(t in e)i(e,t)&&o.push(t);return o};var hn,fn,mn={},gn={},vn=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,yn=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,bn={},Cn={},wn=/\d/,xn=/\d\d/,Sn=/\d{3}/,_n=/\d{4}/,kn=/[+-]?\d{6}/,Tn=/\d\d?/,En=/\d\d\d\d?/,Fn=/\d\d\d\d\d\d?/,Dn=/\d{1,3}/,Mn=/\d{1,4}/,An=/[+-]?\d{1,6}/,Pn=/\d+/,Ln=/[+-]?\d+/,Rn=/Z|[+-]\d\d:?\d\d/gi,In=/Z|[+-]\d\d(?::?\d\d)?/gi,On=/[+-]?\d+(\.\d{1,3})?/,$n=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Nn={},Un={},jn=0,Hn=1,Bn=2,zn=3,Vn=4,Yn=5,Gn=6,Wn=7,qn=8;fn=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1},z("M",["MM",2],"Mo",function(){return this.month()+1}),z("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),z("MMMM",0,0,function(e){return this.localeData().months(this,e)}),I("month","M"),q("M",Tn),q("MM",Tn,xn),q("MMM",function(e,t){return t.monthsShortRegex(e)}),q("MMMM",function(e,t){return t.monthsRegex(e)}),Z(["M","MM"],function(e,t){t[Hn]=v(e)-1}),Z(["MMM","MMMM"],function(e,t,o,n){var r=o._locale.monthsParse(e,n,o._strict);null!=r?t[Hn]=r:c(o).invalidMonth=e});var Kn=/D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/,Xn="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Qn="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Zn=$n,Jn=$n,er=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,tr=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,or=/Z|[+-]\d\d(?::?\d\d)?/,nr=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],rr=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],ir=/^\/?Date\((\-?\d+)/i;e.createFromInputFallback=C("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),z("Y",0,0,function(){var e=this.year();return e<=9999?""+e:"+"+e}),z(0,["YY",2],0,function(){return this.year()%100}),z(0,["YYYY",4],0,"year"),z(0,["YYYYY",5],0,"year"),z(0,["YYYYYY",6,!0],0,"year"),I("year","y"),q("Y",Ln),q("YY",Tn,xn),q("YYYY",Mn,_n),q("YYYYY",An,kn),q("YYYYYY",An,kn),Z(["YYYYY","YYYYYY"],jn),Z("YYYY",function(t,o){o[jn]=2===t.length?e.parseTwoDigitYear(t):v(t)}),Z("YY",function(t,o){o[jn]=e.parseTwoDigitYear(t)}),Z("Y",function(e,t){t[jn]=parseInt(e,10)}),e.parseTwoDigitYear=function(e){return v(e)+(v(e)>68?1900:2e3)};var ar=N("FullYear",!0);e.ISO_8601=function(){};var sr=C("moment().min is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(){var e=Oe.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:u()}),lr=C("moment().max is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(){var e=Oe.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:u()}),cr=function(){return Date.now?Date.now():+new Date};Be("Z",":"),Be("ZZ",""),q("Z",In),q("ZZ",In),Z(["Z","ZZ"],function(e,t,o){o._useUTC=!0,o._tzm=ze(In,e)});var dr=/([\+\-]|\d\d)/gi;e.updateOffset=function(){};var ur=/^(\-)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?\d*)?$/,pr=/^(-)?P(?:(-?[0-9,.]*)Y)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)W)?(?:(-?[0-9,.]*)D)?(?:T(?:(-?[0-9,.]*)H)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)S)?)?$/;nt.fn=je.prototype;var hr=lt(1,"add"),fr=lt(-1,"subtract");e.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",e.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var mr=C("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===undefined?this.localeData():this.locale(e)});z(0,["gg",2],0,function(){return this.weekYear()%100}),z(0,["GG",2],0,function(){return this.isoWeekYear()%100}),Ht("gggg","weekYear"),Ht("ggggg","weekYear"),Ht("GGGG","isoWeekYear"),Ht("GGGGG","isoWeekYear"),I("weekYear","gg"),I("isoWeekYear","GG"),q("G",Ln),q("g",Ln),q("GG",Tn,xn),q("gg",Tn,xn),q("GGGG",Mn,_n),q("gggg",Mn,_n),q("GGGGG",An,kn),q("ggggg",An,kn),J(["gggg","ggggg","GGGG","GGGGG"],function(e,t,o,n){t[n.substr(0,2)]=v(e)}),J(["gg","GG"],function(t,o,n,r){o[r]=e.parseTwoDigitYear(t)}),z("Q",0,"Qo","quarter"),I("quarter","Q"),q("Q",wn),Z("Q",function(e,t){t[Hn]=3*(v(e)-1)}),z("w",["ww",2],"wo","week"),z("W",["WW",2],"Wo","isoWeek"),I("week","w"),I("isoWeek","W"),q("w",Tn),q("ww",Tn,xn),q("W",Tn),q("WW",Tn,xn),J(["w","ww","W","WW"],function(e,t,o,n){t[n.substr(0,1)]=v(e)});var gr={dow:0,doy:6};z("D",["DD",2],"Do","date"),I("date","D"),q("D",Tn),q("DD",Tn,xn),q("Do",function(e,t){return e?t._ordinalParse:t._ordinalParseLenient}),Z(["D","DD"],Bn),Z("Do",function(e,t){t[Bn]=v(e.match(Tn)[0],10)});var vr=N("Date",!0);z("d",0,"do","day"),z("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),z("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),z("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),z("e",0,0,"weekday"),z("E",0,0,"isoWeekday"),I("day","d"),I("weekday","e"),I("isoWeekday","E"),q("d",Tn),q("e",Tn),q("E",Tn),q("dd",function(e,t){return t.weekdaysMinRegex(e)}),q("ddd",function(e,t){return t.weekdaysShortRegex(e)}),q("dddd",function(e,t){return t.weekdaysRegex(e)}),J(["dd","ddd","dddd"],function(e,t,o,n){var r=o._locale.weekdaysParse(e,n,o._strict);null!=r?t.d=r:c(o).invalidWeekday=e}),J(["d","e","E"],function(e,t,o,n){t[n]=v(e)});var yr="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),br="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Cr="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),wr=$n,xr=$n,Sr=$n;z("DDD",["DDDD",3],"DDDo","dayOfYear"),I("dayOfYear","DDD"),q("DDD",Dn),q("DDDD",Sn),Z(["DDD","DDDD"],function(e,t,o){o._dayOfYear=v(e)}),z("H",["HH",2],0,"hour"),z("h",["hh",2],0,mo),z("k",["kk",2],0,go),z("hmm",0,0,function(){return""+mo.apply(this)+B(this.minutes(),2)}),z("hmmss",0,0,function(){return""+mo.apply(this)+B(this.minutes(),2)+B(this.seconds(),2)}),z("Hmm",0,0,function(){return""+this.hours()+B(this.minutes(),2)}),z("Hmmss",0,0,function(){return""+this.hours()+B(this.minutes(),2)+B(this.seconds(),2)}),vo("a",!0),vo("A",!1),I("hour","h"),q("a",yo),q("A",yo),q("H",Tn),q("h",Tn),q("HH",Tn,xn),q("hh",Tn,xn),q("hmm",En),q("hmmss",Fn),q("Hmm",En),q("Hmmss",Fn),Z(["H","HH"],zn),Z(["a","A"],function(e,t,o){o._isPm=o._locale.isPM(e),o._meridiem=e}),Z(["h","hh"],function(e,t,o){t[zn]=v(e),c(o).bigHour=!0}),Z("hmm",function(e,t,o){var n=e.length-2;t[zn]=v(e.substr(0,n)),t[Vn]=v(e.substr(n)),c(o).bigHour=!0}),Z("hmmss",function(e,t,o){var n=e.length-4,r=e.length-2;t[zn]=v(e.substr(0,n)),t[Vn]=v(e.substr(n,2)),t[Yn]=v(e.substr(r)),c(o).bigHour=!0}),Z("Hmm",function(e,t){var o=e.length-2;t[zn]=v(e.substr(0,o)),t[Vn]=v(e.substr(o))}),Z("Hmmss",function(e,t){var o=e.length-4,n=e.length-2;t[zn]=v(e.substr(0,o)),t[Vn]=v(e.substr(o,2)),t[Yn]=v(e.substr(n))});var _r=/[ap]\.?m?\.?/i,kr=N("Hours",!0);z("m",["mm",2],0,"minute"),I("minute","m"),q("m",Tn),q("mm",Tn,xn),Z(["m","mm"],Vn);var Tr=N("Minutes",!1);z("s",["ss",2],0,"second"),I("second","s"),q("s",Tn),q("ss",Tn,xn),Z(["s","ss"],Yn);var Er=N("Seconds",!1);z("S",0,0,function(){return~~(this.millisecond()/100)}),z(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),z(0,["SSS",3],0,"millisecond"),z(0,["SSSS",4],0,function(){return 10*this.millisecond()}),z(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),z(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),z(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),z(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),z(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),I("millisecond","ms"),q("S",Dn,wn),q("SS",Dn,xn),q("SSS",Dn,Sn);var Fr;for(Fr="SSSS";Fr.length<=9;Fr+="S")q(Fr,Pn);for(Fr="S";Fr.length<=9;Fr+="S")Z(Fr,wo);var Dr=N("Milliseconds",!1);z("z",0,0,"zoneAbbr"),z("zz",0,0,"zoneName");var Mr=f.prototype;Mr.add=hr,Mr.calendar=dt,Mr.clone=ut,Mr.diff=yt,Mr.endOf=Mt,Mr.format=xt,Mr.from=St,Mr.fromNow=_t,Mr.to=kt,Mr.toNow=Tt,Mr.get=H,Mr.invalidAt=Ut,Mr.isAfter=pt,Mr.isBefore=ht,Mr.isBetween=ft,Mr.isSame=mt,Mr.isSameOrAfter=gt,Mr.isSameOrBefore=vt,Mr.isValid=$t,Mr.lang=mr,Mr.locale=Et,Mr.localeData=Ft,Mr.max=lr,Mr.min=sr,Mr.parsingFlags=Nt,Mr.set=H,Mr.startOf=Dt,Mr.subtract=fr,Mr.toArray=Rt,Mr.toObject=It,Mr.toDate=Lt,Mr.toISOString=wt,Mr.toJSON=Ot,Mr.toString=Ct,Mr.unix=Pt,Mr.valueOf=At,Mr.creationData=jt,Mr.year=ar,Mr.isLeapYear=be,Mr.weekYear=Bt,Mr.isoWeekYear=zt,Mr.quarter=Mr.quarters=qt,Mr.month=se,Mr.daysInMonth=le,Mr.week=Mr.weeks=Zt,Mr.isoWeek=Mr.isoWeeks=Jt,Mr.weeksInYear=Yt,Mr.isoWeeksInYear=Vt,Mr.date=vr,Mr.day=Mr.days=ao,Mr.weekday=so,Mr.isoWeekday=lo,Mr.dayOfYear=fo,Mr.hour=Mr.hours=kr,Mr.minute=Mr.minutes=Tr,Mr.second=Mr.seconds=Er,Mr.millisecond=Mr.milliseconds=Dr,Mr.utcOffset=Ge,Mr.utc=qe,Mr.local=Ke,Mr.parseZone=Xe,Mr.hasAlignedHourOffset=Qe,Mr.isDST=Ze,Mr.isDSTShifted=Je,Mr.isLocal=et,Mr.isUtcOffset=tt,Mr.isUtc=ot,Mr.isUTC=ot,Mr.zoneAbbr=xo,Mr.zoneName=So,Mr.dates=C("dates accessor is deprecated. Use date instead.",vr),Mr.months=C("months accessor is deprecated. Use month instead",se),Mr.years=C("years accessor is deprecated. Use year instead",ar),Mr.zone=C("moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779",We);var Ar=Mr,Pr={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},Lr={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},Rr=/\d{1,2}/,Ir={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},Or=T.prototype;Or._calendar=Pr,Or.calendar=To,Or._longDateFormat=Lr,Or.longDateFormat=Eo,Or._invalidDate="Invalid date",Or.invalidDate=Fo,Or._ordinal="%d",Or.ordinal=Do,Or._ordinalParse=Rr,Or.preparse=Mo,Or.postformat=Mo,Or._relativeTime=Ir,Or.relativeTime=Ao,Or.pastFuture=Po,Or.set=_,Or.months=oe,Or._months=Xn,Or.monthsShort=ne,Or._monthsShort=Qn,Or.monthsParse=ie,Or._monthsRegex=Jn,Or.monthsRegex=de,Or._monthsShortRegex=Zn,Or.monthsShortRegex=ce,Or.week=Kt,Or._week=gr,Or.firstDayOfYear=Qt,Or.firstDayOfWeek=Xt,Or.weekdays=to,Or._weekdays=yr,Or.weekdaysMin=no,Or._weekdaysMin=Cr,Or.weekdaysShort=oo,Or._weekdaysShort=br,Or.weekdaysParse=io,Or._weekdaysRegex=wr,Or.weekdaysRegex=co,Or._weekdaysShortRegex=xr,Or.weekdaysShortRegex=uo,Or._weekdaysMinRegex=Sr,Or.weekdaysMinRegex=po,Or.isPM=bo,Or._meridiemParse=_r,Or.meridiem=Co,M("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===v(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}}),e.lang=C("moment.lang is deprecated. Use moment.locale instead.",M),e.langData=C("moment.langData is deprecated. Use moment.localeData instead.",L);var $r=Math.abs,Nr=Qo("ms"),Ur=Qo("s"),jr=Qo("m"),Hr=Qo("h"),Br=Qo("d"),zr=Qo("w"),Vr=Qo("M"),Yr=Qo("y"),Gr=Jo("milliseconds"),Wr=Jo("seconds"),qr=Jo("minutes"),Kr=Jo("hours"),Xr=Jo("days"),Qr=Jo("months"),Zr=Jo("years"),Jr=Math.round,ei={s:45,m:45,h:22,d:26,M:11},ti=Math.abs,oi=je.prototype;return oi.abs=Ho,oi.add=zo,oi.subtract=Vo,oi.as=Ko,oi.asMilliseconds=Nr,oi.asSeconds=Ur,oi.asMinutes=jr,oi.asHours=Hr,oi.asDays=Br,oi.asWeeks=zr,oi.asMonths=Vr,oi.asYears=Yr,oi.valueOf=Xo,oi._bubble=Go,oi.get=Zo,oi.milliseconds=Gr,oi.seconds=Wr,oi.minutes=qr,oi.hours=Kr,oi.days=Xr,oi.weeks=en,oi.months=Qr,oi.years=Zr,oi.humanize=rn,oi.toISOString=an,oi.toString=an,oi.toJSON=an,oi.locale=Et,oi.localeData=Ft,oi.toIsoString=C("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",an),oi.lang=mr,z("X",0,0,"unix"),z("x",0,0,"valueOf"),q("x",Ln),q("X",On),Z("X",function(e,t,o){o._d=new Date(1e3*parseFloat(e,10))}),Z("x",function(e,t,o){o._d=new Date(v(e))}),e.version="2.13.0",t(Oe),e.fn=Ar,e.min=Ne,e.max=Ue,e.now=cr,e.utc=s,e.unix=_o,e.months=Oo,e.isDate=n,e.locale=M,e.invalid=u,e.duration=nt,e.isMoment=m,e.weekdays=No,e.parseZone=ko,e.localeData=L,e.isDuration=He,e.monthsShort=$o,
e.weekdaysMin=jo,e.defineLocale=A,e.updateLocale=P,e.locales=R,e.weekdaysShort=Uo,e.normalizeUnits=O,e.relativeTimeThreshold=nn,e.prototype=Ar,e}),"undefined"==typeof jQuery)throw new Error("AdminLTE requires jQuery");if($.AdminLTE={},$.AdminLTE.options={navbarMenuSlimscroll:!0,navbarMenuSlimscrollWidth:"3px",navbarMenuHeight:"200px",animationSpeed:500,sidebarToggleSelector:"[data-toggle='offcanvas']",sidebarPushMenu:!0,sidebarSlimScroll:!0,sidebarExpandOnHover:!1,enableBoxRefresh:!0,enableBSToppltip:!0,BSTooltipSelector:"[data-toggle='tooltip']",enableFastclick:!0,enableControlSidebar:!0,controlSidebarOptions:{toggleBtnSelector:"[data-toggle='control-sidebar']",selector:".control-sidebar",slide:!0},enableBoxWidget:!0,boxWidgetOptions:{boxWidgetIcons:{collapse:"fa-minus",open:"fa-plus",remove:"fa-times"},boxWidgetSelectors:{remove:'[data-widget="remove"]',collapse:'[data-widget="collapse"]'}},directChat:{enable:!0,contactToggleSelector:'[data-widget="chat-pane-toggle"]'},colors:{lightBlue:"#3c8dbc",red:"#f56954",green:"#00a65a",aqua:"#00c0ef",yellow:"#f39c12",blue:"#0073b7",navy:"#001F3F",teal:"#39CCCC",olive:"#3D9970",lime:"#01FF70",orange:"#FF851B",fuchsia:"#F012BE",purple:"#8E24AA",maroon:"#D81B60",black:"#222222",gray:"#d2d6de"},screenSizes:{xs:480,sm:768,md:992,lg:1200}},$(function(){"use strict";$("body").removeClass("hold-transition"),"undefined"!=typeof AdminLTEOptions&&$.extend(!0,$.AdminLTE.options,AdminLTEOptions);var e=$.AdminLTE.options;_init(),$.AdminLTE.layout.activate(),$.AdminLTE.tree(".sidebar"),e.enableControlSidebar&&$.AdminLTE.controlSidebar.activate(),e.navbarMenuSlimscroll&&"undefined"!=typeof $.fn.slimscroll&&$(".navbar .menu").slimscroll({height:e.navbarMenuHeight,alwaysVisible:!1,size:e.navbarMenuSlimscrollWidth}).css("width","100%"),e.sidebarPushMenu&&$.AdminLTE.pushMenu.activate(e.sidebarToggleSelector),e.enableBSToppltip&&$("body").tooltip({selector:e.BSTooltipSelector}),e.enableBoxWidget&&$.AdminLTE.boxWidget.activate(),e.enableFastclick&&"undefined"!=typeof FastClick&&FastClick.attach(document.body),e.directChat.enable&&$(document).on("click",e.directChat.contactToggleSelector,function(){$(this).parents(".direct-chat").first().toggleClass("direct-chat-contacts-open")}),$('.btn-group[data-toggle="btn-toggle"]').each(function(){var e=$(this);$(this).find(".btn").on("click",function(t){e.find(".btn.active").removeClass("active"),$(this).addClass("active"),t.preventDefault()})})}),function(e){"use strict";e.fn.boxRefresh=function(t){function o(e){e.append(i),r.onLoadStart.call(e)}function n(e){e.find(i).remove(),r.onLoadDone.call(e)}var r=e.extend({trigger:".refresh-btn",source:"",onLoadStart:function(e){return e},onLoadDone:function(e){return e}},t),i=e('<div class="overlay"><div class="fa fa-refresh fa-spin"></div></div>');return this.each(function(){if(""===r.source)return void(window.console&&window.console.log("Please specify a source first - boxRefresh()"));var t=e(this);t.find(r.trigger).first().on("click",function(e){e.preventDefault(),o(t),t.find(".box-body").load(r.source,function(){n(t)})})})}}(jQuery),function(e){"use strict";e.fn.activateBox=function(){e.AdminLTE.boxWidget.activate(this)}}(jQuery),function(e){"use strict";e.fn.todolist=function(t){var o=e.extend({onCheck:function(e){return e},onUncheck:function(e){return e}},t);return this.each(function(){"undefined"!=typeof e.fn.iCheck?(e("input",this).on("ifChecked",function(){var t=e(this).parents("li").first();t.toggleClass("done"),o.onCheck.call(t)}),e("input",this).on("ifUnchecked",function(){var t=e(this).parents("li").first();t.toggleClass("done"),o.onUncheck.call(t)})):e("input",this).on("change",function(){var t=e(this).parents("li").first();t.toggleClass("done"),e("input",t).is(":checked")?o.onCheck.call(t):o.onUncheck.call(t)})})}}(jQuery),function(e,t){function o(){return new Date(Date.UTC.apply(Date,arguments))}function n(){var e=new Date;return o(e.getFullYear(),e.getMonth(),e.getDate())}function r(e){return function(){return this[e].apply(this,arguments)}}function i(t,o){function n(e,t){return t.toLowerCase()}var r,i=e(t).data(),a={},s=new RegExp("^"+o.toLowerCase()+"([A-Z])");o=new RegExp("^"+o.toLowerCase());for(var l in i)o.test(l)&&(r=l.replace(s,n),a[r]=i[l]);return a}function a(t){var o={};if(f[t]||(t=t.split("-")[0],f[t])){var n=f[t];return e.each(h,function(e,t){t in n&&(o[t]=n[t])}),o}}var s=e(window),l=function(){var t={get:function(e){return this.slice(e)[0]},contains:function(e){for(var t=e&&e.valueOf(),o=0,n=this.length;o<n;o++)if(this[o].valueOf()===t)return o;return-1},remove:function(e){this.splice(e,1)},replace:function(t){t&&(e.isArray(t)||(t=[t]),this.clear(),this.push.apply(this,t))},clear:function(){this.splice(0)},copy:function(){var e=new l;return e.replace(this),e}};return function(){var o=[];return o.push.apply(o,arguments),e.extend(o,t),o}}(),c=function(t,o){this.dates=new l,this.viewDate=n(),this.focusDate=null,this._process_options(o),this.element=e(t),this.isInline=!1,this.isInput=this.element.is("input"),this.component=!!this.element.is(".date")&&this.element.find(".add-on, .input-group-addon, .btn"),this.hasInput=this.component&&this.element.find("input").length,this.component&&0===this.component.length&&(this.component=!1),this.picker=e(m.template),this._buildEvents(),this._attachEvents(),this.isInline?this.picker.addClass("datepicker-inline").appendTo(this.element):this.picker.addClass("datepicker-dropdown dropdown-menu"),this.o.rtl&&this.picker.addClass("datepicker-rtl"),this.viewMode=this.o.startView,this.o.calendarWeeks&&this.picker.find("tfoot th.today").attr("colspan",function(e,t){return parseInt(t)+1}),this._allow_update=!1,this.setStartDate(this._o.startDate),this.setEndDate(this._o.endDate),this.setDaysOfWeekDisabled(this.o.daysOfWeekDisabled),this.fillDow(),this.fillMonths(),this._allow_update=!0,this.update(),this.showMode(),this.isInline&&this.show()};c.prototype={constructor:c,_process_options:function(t){this._o=e.extend({},this._o,t);var o=this.o=e.extend({},this._o),n=o.language;switch(f[n]||(n=n.split("-")[0],f[n]||(n=p.language)),o.language=n,o.startView){case 2:case"decade":o.startView=2;break;case 1:case"year":o.startView=1;break;default:o.startView=0}switch(o.minViewMode){case 1:case"months":o.minViewMode=1;break;case 2:case"years":o.minViewMode=2;break;default:o.minViewMode=0}o.startView=Math.max(o.startView,o.minViewMode),!0!==o.multidate&&(o.multidate=Number(o.multidate)||!1,!1!==o.multidate?o.multidate=Math.max(0,o.multidate):o.multidate=1),o.multidateSeparator=String(o.multidateSeparator),o.weekStart%=7,o.weekEnd=(o.weekStart+6)%7;var r=m.parseFormat(o.format);o.startDate!==-Infinity&&(o.startDate?o.startDate instanceof Date?o.startDate=this._local_to_utc(this._zero_time(o.startDate)):o.startDate=m.parseDate(o.startDate,r,o.language):o.startDate=-Infinity),o.endDate!==Infinity&&(o.endDate?o.endDate instanceof Date?o.endDate=this._local_to_utc(this._zero_time(o.endDate)):o.endDate=m.parseDate(o.endDate,r,o.language):o.endDate=Infinity),o.daysOfWeekDisabled=o.daysOfWeekDisabled||[],e.isArray(o.daysOfWeekDisabled)||(o.daysOfWeekDisabled=o.daysOfWeekDisabled.split(/[,\s]*/)),o.daysOfWeekDisabled=e.map(o.daysOfWeekDisabled,function(e){return parseInt(e,10)});var i=String(o.orientation).toLowerCase().split(/\s+/g),a=o.orientation.toLowerCase();if(i=e.grep(i,function(e){return/^auto|left|right|top|bottom$/.test(e)}),o.orientation={x:"auto",y:"auto"},a&&"auto"!==a)if(1===i.length)switch(i[0]){case"top":case"bottom":o.orientation.y=i[0];break;case"left":case"right":o.orientation.x=i[0]}else a=e.grep(i,function(e){return/^left|right$/.test(e)}),o.orientation.x=a[0]||"auto",a=e.grep(i,function(e){return/^top|bottom$/.test(e)}),o.orientation.y=a[0]||"auto";else;},_events:[],_secondaryEvents:[],_applyEvents:function(e){for(var o,n,r,i=0;i<e.length;i++)o=e[i][0],2===e[i].length?(n=t,r=e[i][1]):3===e[i].length&&(n=e[i][1],r=e[i][2]),o.on(r,n)},_unapplyEvents:function(e){for(var o,n,r,i=0;i<e.length;i++)o=e[i][0],2===e[i].length?(r=t,n=e[i][1]):3===e[i].length&&(r=e[i][1],n=e[i][2]),o.off(n,r)},_buildEvents:function(){this.isInput?this._events=[[this.element,{focus:e.proxy(this.show,this),keyup:e.proxy(function(t){-1===e.inArray(t.keyCode,[27,37,39,38,40,32,13,9])&&this.update()},this),keydown:e.proxy(this.keydown,this)}]]:this.component&&this.hasInput?this._events=[[this.element.find("input"),{focus:e.proxy(this.show,this),keyup:e.proxy(function(t){-1===e.inArray(t.keyCode,[27,37,39,38,40,32,13,9])&&this.update()},this),keydown:e.proxy(this.keydown,this)}],[this.component,{click:e.proxy(this.show,this)}]]:this.element.is("div")?this.isInline=!0:this._events=[[this.element,{click:e.proxy(this.show,this)}]],this._events.push([this.element,"*",{blur:e.proxy(function(e){this._focused_from=e.target},this)}],[this.element,{blur:e.proxy(function(e){this._focused_from=e.target},this)}]),this._secondaryEvents=[[this.picker,{click:e.proxy(this.click,this)}],[e(window),{resize:e.proxy(this.place,this)}],[e(document),{"mousedown touchstart":e.proxy(function(e){this.element.is(e.target)||this.element.find(e.target).length||this.picker.is(e.target)||this.picker.find(e.target).length||this.hide()},this)}]]},_attachEvents:function(){this._detachEvents(),this._applyEvents(this._events)},_detachEvents:function(){this._unapplyEvents(this._events)},_attachSecondaryEvents:function(){this._detachSecondaryEvents(),this._applyEvents(this._secondaryEvents)},_detachSecondaryEvents:function(){this._unapplyEvents(this._secondaryEvents)},_trigger:function(t,o){var n=o||this.dates.get(-1),r=this._utc_to_local(n);this.element.trigger({type:t,date:r,dates:e.map(this.dates,this._utc_to_local),format:e.proxy(function(e,t){0===arguments.length?(e=this.dates.length-1,t=this.o.format):"string"==typeof e&&(t=e,e=this.dates.length-1),t=t||this.o.format;var o=this.dates.get(e);return m.formatDate(o,t,this.o.language)},this)})},show:function(){this.isInline||this.picker.appendTo("body"),this.picker.show(),this.place(),this._attachSecondaryEvents(),this._trigger("show")},hide:function(){this.isInline||this.picker.is(":visible")&&(this.focusDate=null,this.picker.hide().detach(),this._detachSecondaryEvents(),this.viewMode=this.o.startView,this.showMode(),this.o.forceParse&&(this.isInput&&this.element.val()||this.hasInput&&this.element.find("input").val())&&this.setValue(),this._trigger("hide"))},remove:function(){this.hide(),this._detachEvents(),this._detachSecondaryEvents(),this.picker.remove(),delete this.element.data().datepicker,this.isInput||delete this.element.data().date},_utc_to_local:function(e){return e&&new Date(e.getTime()+6e4*e.getTimezoneOffset())},_local_to_utc:function(e){return e&&new Date(e.getTime()-6e4*e.getTimezoneOffset())},_zero_time:function(e){return e&&new Date(e.getFullYear(),e.getMonth(),e.getDate())},_zero_utc_time:function(e){return e&&new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()))},getDates:function(){return e.map(this.dates,this._utc_to_local)},getUTCDates:function(){return e.map(this.dates,function(e){return new Date(e)})},getDate:function(){return this._utc_to_local(this.getUTCDate())},getUTCDate:function(){return new Date(this.dates.get(-1))},setDates:function(){var t=e.isArray(arguments[0])?arguments[0]:arguments;this.update.apply(this,t),this._trigger("changeDate"),this.setValue()},setUTCDates:function(){var t=e.isArray(arguments[0])?arguments[0]:arguments;this.update.apply(this,e.map(t,this._utc_to_local)),this._trigger("changeDate"),this.setValue()},setDate:r("setDates"),setUTCDate:r("setUTCDates"),setValue:function(){var e=this.getFormattedDate();this.isInput?this.element.val(e).change():this.component&&this.element.find("input").val(e).change()},getFormattedDate:function(o){o===t&&(o=this.o.format);var n=this.o.language;return e.map(this.dates,function(e){return m.formatDate(e,o,n)}).join(this.o.multidateSeparator)},setStartDate:function(e){this._process_options({startDate:e}),this.update(),this.updateNavArrows()},setEndDate:function(e){this._process_options({endDate:e}),this.update(),this.updateNavArrows()},setDaysOfWeekDisabled:function(e){this._process_options({daysOfWeekDisabled:e}),this.update(),this.updateNavArrows()},place:function(){if(!this.isInline){var t=this.picker.outerWidth(),o=this.picker.outerHeight(),n=10,r=s.width(),i=s.height(),a=s.scrollTop(),l=parseInt(this.element.parents().filter(function(){return"auto"!==e(this).css("z-index")}).first().css("z-index"))+10,c=this.component?this.component.parent().offset():this.element.offset(),d=this.component?this.component.outerHeight(!0):this.element.outerHeight(!1),u=this.component?this.component.outerWidth(!0):this.element.outerWidth(!1),p=c.left,h=c.top;this.picker.removeClass("datepicker-orient-top datepicker-orient-bottom datepicker-orient-right datepicker-orient-left"),"auto"!==this.o.orientation.x?(this.picker.addClass("datepicker-orient-"+this.o.orientation.x),"right"===this.o.orientation.x&&(p-=t-u)):(this.picker.addClass("datepicker-orient-left"),c.left<0?p-=c.left-n:c.left+t>r&&(p=r-t-n));var f,m,g=this.o.orientation.y;"auto"===g&&(f=-a+c.top-o,m=a+i-(c.top+d+o),g=Math.max(f,m)===m?"top":"bottom"),this.picker.addClass("datepicker-orient-"+g),"top"===g?h+=d:h-=o+parseInt(this.picker.css("padding-top")),this.picker.css({top:h,left:p,zIndex:l})}},_allow_update:!0,update:function(){if(this._allow_update){var t=this.dates.copy(),o=[],n=!1;arguments.length?(e.each(arguments,e.proxy(function(e,t){t instanceof Date&&(t=this._local_to_utc(t)),o.push(t)},this)),n=!0):(o=this.isInput?this.element.val():this.element.data("date")||this.element.find("input").val(),o=o&&this.o.multidate?o.split(this.o.multidateSeparator):[o],delete this.element.data().date),o=e.map(o,e.proxy(function(e){return m.parseDate(e,this.o.format,this.o.language)},this)),o=e.grep(o,e.proxy(function(e){return e<this.o.startDate||e>this.o.endDate||!e},this),!0),this.dates.replace(o),this.dates.length?this.viewDate=new Date(this.dates.get(-1)):this.viewDate<this.o.startDate?this.viewDate=new Date(this.o.startDate):this.viewDate>this.o.endDate&&(this.viewDate=new Date(this.o.endDate)),n?this.setValue():o.length&&String(t)!==String(this.dates)&&this._trigger("changeDate"),!this.dates.length&&t.length&&this._trigger("clearDate"),this.fill()}},fillDow:function(){var e=this.o.weekStart,t="<tr>";if(this.o.calendarWeeks){var o='<th class="cw">&nbsp;</th>';t+=o,this.picker.find(".datepicker-days thead tr:first-child").prepend(o)}for(;e<this.o.weekStart+7;)t+='<th class="dow">'+f[this.o.language].daysMin[e++%7]+"</th>";t+="</tr>",this.picker.find(".datepicker-days thead").append(t)},fillMonths:function(){for(var e="",t=0;t<12;)e+='<span class="month">'+f[this.o.language].monthsShort[t++]+"</span>";this.picker.find(".datepicker-months td").html(e)},setRange:function(t){t&&t.length?this.range=e.map(t,function(e){return e.valueOf()}):delete this.range,this.fill()},getClassNames:function(t){var o=[],n=this.viewDate.getUTCFullYear(),r=this.viewDate.getUTCMonth(),i=new Date;return t.getUTCFullYear()<n||t.getUTCFullYear()===n&&t.getUTCMonth()<r?o.push("old"):(t.getUTCFullYear()>n||t.getUTCFullYear()===n&&t.getUTCMonth()>r)&&o.push("new"),this.focusDate&&t.valueOf()===this.focusDate.valueOf()&&o.push("focused"),this.o.todayHighlight&&t.getUTCFullYear()===i.getFullYear()&&t.getUTCMonth()===i.getMonth()&&t.getUTCDate()===i.getDate()&&o.push("today"),-1!==this.dates.contains(t)&&o.push("active"),(t.valueOf()<this.o.startDate||t.valueOf()>this.o.endDate||-1!==e.inArray(t.getUTCDay(),this.o.daysOfWeekDisabled))&&o.push("disabled"),this.range&&(t>this.range[0]&&t<this.range[this.range.length-1]&&o.push("range"),-1!==e.inArray(t.valueOf(),this.range)&&o.push("selected")),o},fill:function(){var n,r=new Date(this.viewDate),i=r.getUTCFullYear(),a=r.getUTCMonth(),s=this.o.startDate!==-Infinity?this.o.startDate.getUTCFullYear():-Infinity,l=this.o.startDate!==-Infinity?this.o.startDate.getUTCMonth():-Infinity,c=this.o.endDate!==Infinity?this.o.endDate.getUTCFullYear():Infinity,d=this.o.endDate!==Infinity?this.o.endDate.getUTCMonth():Infinity,u=f[this.o.language].today||f.en.today||"",p=f[this.o.language].clear||f.en.clear||"";this.picker.find(".datepicker-days thead th.datepicker-switch").text(f[this.o.language].months[a]+" "+i),this.picker.find("tfoot th.today").text(u).toggle(!1!==this.o.todayBtn),this.picker.find("tfoot th.clear").text(p).toggle(!1!==this.o.clearBtn),this.updateNavArrows(),this.fillMonths();var h=o(i,a-1,28),g=m.getDaysInMonth(h.getUTCFullYear(),h.getUTCMonth());h.setUTCDate(g),h.setUTCDate(g-(h.getUTCDay()-this.o.weekStart+7)%7);var v=new Date(h);v.setUTCDate(v.getUTCDate()+42),v=v.valueOf();for(var y,b=[];h.valueOf()<v;){if(h.getUTCDay()===this.o.weekStart&&(b.push("<tr>"),this.o.calendarWeeks)){var C=new Date(+h+(this.o.weekStart-h.getUTCDay()-7)%7*864e5),w=new Date(Number(C)+(11-C.getUTCDay())%7*864e5),x=new Date(Number(x=o(w.getUTCFullYear(),0,1))+(11-x.getUTCDay())%7*864e5),S=(w-x)/864e5/7+1;b.push('<td class="cw">'+S+"</td>")}if(y=this.getClassNames(h),y.push("day"),this.o.beforeShowDay!==e.noop){var _=this.o.beforeShowDay(this._utc_to_local(h));_===t?_={}:"boolean"==typeof _?_={enabled:_}:"string"==typeof _&&(_={classes:_}),!1===_.enabled&&y.push("disabled"),_.classes&&(y=y.concat(_.classes.split(/\s+/))),_.tooltip&&(n=_.tooltip)}y=e.unique(y),b.push('<td class="'+y.join(" ")+'"'+(n?' title="'+n+'"':"")+">"+h.getUTCDate()+"</td>"),h.getUTCDay()===this.o.weekEnd&&b.push("</tr>"),h.setUTCDate(h.getUTCDate()+1)}this.picker.find(".datepicker-days tbody").empty().append(b.join(""));var k=this.picker.find(".datepicker-months").find("th:eq(1)").text(i).end().find("span").removeClass("active");e.each(this.dates,function(e,t){t.getUTCFullYear()===i&&k.eq(t.getUTCMonth()).addClass("active")}),(i<s||i>c)&&k.addClass("disabled"),i===s&&k.slice(0,l).addClass("disabled"),i===c&&k.slice(d+1).addClass("disabled"),b="",i=10*parseInt(i/10,10);var T=this.picker.find(".datepicker-years").find("th:eq(1)").text(i+"-"+(i+9)).end().find("td");i-=1;for(var E,F=e.map(this.dates,function(e){return e.getUTCFullYear()}),D=-1;D<11;D++)E=["year"],-1===D?E.push("old"):10===D&&E.push("new"),-1!==e.inArray(i,F)&&E.push("active"),(i<s||i>c)&&E.push("disabled"),b+='<span class="'+E.join(" ")+'">'+i+"</span>",i+=1;T.html(b)},updateNavArrows:function(){if(this._allow_update){var e=new Date(this.viewDate),t=e.getUTCFullYear(),o=e.getUTCMonth();switch(this.viewMode){case 0:this.o.startDate!==-Infinity&&t<=this.o.startDate.getUTCFullYear()&&o<=this.o.startDate.getUTCMonth()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.o.endDate!==Infinity&&t>=this.o.endDate.getUTCFullYear()&&o>=this.o.endDate.getUTCMonth()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"});break;case 1:case 2:this.o.startDate!==-Infinity&&t<=this.o.startDate.getUTCFullYear()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.o.endDate!==Infinity&&t>=this.o.endDate.getUTCFullYear()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"})}}},click:function(t){t.preventDefault();var n,r,i,a=e(t.target).closest("span, td, th");if(1===a.length)switch(a[0].nodeName.toLowerCase()){case"th":switch(a[0].className){case"datepicker-switch":this.showMode(1);break;case"prev":case"next":var s=m.modes[this.viewMode].navStep*("prev"===a[0].className?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveMonth(this.viewDate,s),this._trigger("changeMonth",this.viewDate);break;case 1:case 2:this.viewDate=this.moveYear(this.viewDate,s),1===this.viewMode&&this._trigger("changeYear",this.viewDate)}this.fill();break;case"today":var l=new Date;l=o(l.getFullYear(),l.getMonth(),l.getDate(),0,0,0),this.showMode(-2);var c="linked"===this.o.todayBtn?null:"view";this._setDate(l,c);break;case"clear":var d;this.isInput?d=this.element:this.component&&(d=this.element.find("input")),d&&d.val("").change(),this.update(),this._trigger("changeDate"),this.o.autoclose&&this.hide()}break;case"span":a.is(".disabled")||(this.viewDate.setUTCDate(1),a.is(".month")?(i=1,r=a.parent().find("span").index(a),n=this.viewDate.getUTCFullYear(),this.viewDate.setUTCMonth(r),this._trigger("changeMonth",this.viewDate),1===this.o.minViewMode&&this._setDate(o(n,r,i))):(i=1,r=0,n=parseInt(a.text(),10)||0,this.viewDate.setUTCFullYear(n),this._trigger("changeYear",this.viewDate),2===this.o.minViewMode&&this._setDate(o(n,r,i))),this.showMode(-1),this.fill());break;case"td":a.is(".day")&&!a.is(".disabled")&&(i=parseInt(a.text(),10)||1,n=this.viewDate.getUTCFullYear(),r=this.viewDate.getUTCMonth(),a.is(".old")?0===r?(r=11,n-=1):r-=1:a.is(".new")&&(11===r?(r=0,n+=1):r+=1),this._setDate(o(n,r,i)))}this.picker.is(":visible")&&this._focused_from&&e(this._focused_from).focus(),delete this._focused_from},_toggle_multidate:function(e){var t=this.dates.contains(e);if(e?-1!==t?this.dates.remove(t):this.dates.push(e):this.dates.clear(),"number"==typeof this.o.multidate)for(;this.dates.length>this.o.multidate;)this.dates.remove(0)},_setDate:function(e,t){t&&"date"!==t||this._toggle_multidate(e&&new Date(e)),t&&"view"!==t||(this.viewDate=e&&new Date(e)),this.fill(),this.setValue(),this._trigger("changeDate");var o;this.isInput?o=this.element:this.component&&(o=this.element.find("input")),o&&o.change(),!this.o.autoclose||t&&"date"!==t||this.hide()},moveMonth:function(e,o){if(!e)return t;if(!o)return e;var n,r,i=new Date(e.valueOf()),a=i.getUTCDate(),s=i.getUTCMonth(),l=Math.abs(o);if(o=o>0?1:-1,1===l)r=-1===o?function(){return i.getUTCMonth()===s}:function(){return i.getUTCMonth()!==n},n=s+o,i.setUTCMonth(n),(n<0||n>11)&&(n=(n+12)%12);else{for(var c=0;c<l;c++)i=this.moveMonth(i,o);n=i.getUTCMonth(),i.setUTCDate(a),r=function(){return n!==i.getUTCMonth()}}for(;r();)i.setUTCDate(--a),i.setUTCMonth(n);return i},moveYear:function(e,t){return this.moveMonth(e,12*t)},dateWithinRange:function(e){return e>=this.o.startDate&&e<=this.o.endDate},keydown:function(e){if(this.picker.is(":not(:visible)"))return void(27===e.keyCode&&this.show());var t,o,r,i=!1,a=this.focusDate||this.viewDate;switch(e.keyCode){case 27:this.focusDate?(this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill()):this.hide(),e.preventDefault();break;case 37:case 39:if(!this.o.keyboardNavigation)break;t=37===e.keyCode?-1:1,e.ctrlKey?(o=this.moveYear(this.dates.get(-1)||n(),t),r=this.moveYear(a,t),this._trigger("changeYear",this.viewDate)):e.shiftKey?(o=this.moveMonth(this.dates.get(-1)||n(),t),r=this.moveMonth(a,t),this._trigger("changeMonth",this.viewDate)):(o=new Date(this.dates.get(-1)||n()),o.setUTCDate(o.getUTCDate()+t),r=new Date(a),r.setUTCDate(a.getUTCDate()+t)),this.dateWithinRange(o)&&(this.focusDate=this.viewDate=r,this.setValue(),this.fill(),e.preventDefault());break;case 38:case 40:if(!this.o.keyboardNavigation)break;t=38===e.keyCode?-1:1,e.ctrlKey?(o=this.moveYear(this.dates.get(-1)||n(),t),r=this.moveYear(a,t),this._trigger("changeYear",this.viewDate)):e.shiftKey?(o=this.moveMonth(this.dates.get(-1)||n(),t),r=this.moveMonth(a,t),this._trigger("changeMonth",this.viewDate)):(o=new Date(this.dates.get(-1)||n()),o.setUTCDate(o.getUTCDate()+7*t),r=new Date(a),r.setUTCDate(a.getUTCDate()+7*t)),this.dateWithinRange(o)&&(this.focusDate=this.viewDate=r,this.setValue(),this.fill(),e.preventDefault());break;case 32:break;case 13:a=this.focusDate||this.dates.get(-1)||this.viewDate,this._toggle_multidate(a),i=!0,this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.setValue(),this.fill(),this.picker.is(":visible")&&(e.preventDefault(),this.o.autoclose&&this.hide());break;case 9:this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill(),this.hide()}if(i){this.dates.length?this._trigger("changeDate"):this._trigger("clearDate");var s;this.isInput?s=this.element:this.component&&(s=this.element.find("input")),s&&s.change()}},showMode:function(e){e&&(this.viewMode=Math.max(this.o.minViewMode,Math.min(2,this.viewMode+e))),this.picker.find(">div").hide().filter(".datepicker-"+m.modes[this.viewMode].clsName).css("display","block"),this.updateNavArrows()}};var d=function(t,o){this.element=e(t),this.inputs=e.map(o.inputs,function(e){return e.jquery?e[0]:e}),delete o.inputs,e(this.inputs).datepicker(o).bind("changeDate",e.proxy(this.dateUpdated,this)),this.pickers=e.map(this.inputs,function(t){return e(t).data("datepicker")}),this.updateDates()};d.prototype={updateDates:function(){this.dates=e.map(this.pickers,function(e){return e.getUTCDate()}),this.updateRanges()},updateRanges:function(){var t=e.map(this.dates,function(e){return e.valueOf()});e.each(this.pickers,function(e,o){o.setRange(t)})},dateUpdated:function(t){if(!this.updating){this.updating=!0;var o=e(t.target).data("datepicker"),n=o.getUTCDate(),r=e.inArray(t.target,this.inputs),i=this.inputs.length;if(-1!==r){if(e.each(this.pickers,function(e,t){t.getUTCDate()||t.setUTCDate(n)}),n<this.dates[r])for(;r>=0&&n<this.dates[r];)this.pickers[r--].setUTCDate(n);else if(n>this.dates[r])for(;r<i&&n>this.dates[r];)this.pickers[r++].setUTCDate(n);this.updateDates(),delete this.updating}}},remove:function(){e.map(this.pickers,function(e){e.remove()}),delete this.element.data().datepicker}};var u=e.fn.datepicker;e.fn.datepicker=function(o){var n=Array.apply(null,arguments);n.shift();var r;return this.each(function(){var s=e(this),l=s.data("datepicker"),u="object"==typeof o&&o;if(!l){var h=i(this,"date"),f=e.extend({},p,h,u),m=a(f.language),g=e.extend({},p,m,h,u);if(s.is(".input-daterange")||g.inputs){var v={inputs:g.inputs||s.find("input").toArray()};s.data("datepicker",l=new d(this,e.extend(g,v)))}else s.data("datepicker",l=new c(this,g))}if("string"==typeof o&&"function"==typeof l[o]&&(r=l[o].apply(l,n))!==t)return!1}),r!==t?r:this};var p=e.fn.datepicker.defaults={autoclose:!1,beforeShowDay:e.noop,calendarWeeks:!1,clearBtn:!1,daysOfWeekDisabled:[],endDate:Infinity,forceParse:!0,format:"mm/dd/yyyy",keyboardNavigation:!0,language:"en",minViewMode:0,multidate:!1,multidateSeparator:",",orientation:"auto",rtl:!1,startDate:-Infinity,startView:0,todayBtn:!1,todayHighlight:!1,weekStart:0},h=e.fn.datepicker.locale_opts=["format","rtl","weekStart"];e.fn.datepicker.Constructor=c;var f=e.fn.datepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear"}},m={modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],isLeapYear:function(e){return e%4==0&&e%100!=0||e%400==0},getDaysInMonth:function(e,t){return[31,m.isLeapYear(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\[\u3400-\u9fff-`{-~\t\n\r]+/g,parseFormat:function(e){var t=e.replace(this.validParts,"\0").split("\0"),o=e.match(this.validParts);if(!t||!t.length||!o||0===o.length)throw new Error("Invalid date format.");return{separators:t,parts:o}},parseDate:function(n,r,i){function a(){var e=this.slice(0,p[d].length);return e===p[d].slice(0,e.length)}if(!n)return t;if(n instanceof Date)return n;"string"==typeof r&&(r=m.parseFormat(r));var s,l,d,u=/([\-+]\d+)([dmwy])/,p=n.match(/([\-+]\d+)([dmwy])/g);if(/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/.test(n)){for(n=new Date,d=0;d<p.length;d++)switch(s=u.exec(p[d]),l=parseInt(s[1]),s[2]){case"d":n.setUTCDate(n.getUTCDate()+l);break;case"m":n=c.prototype.moveMonth.call(c.prototype,n,l);break;case"w":n.setUTCDate(n.getUTCDate()+7*l);break;case"y":n=c.prototype.moveYear.call(c.prototype,n,l)}return o(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),0,0,0)}p=n&&n.match(this.nonpunctuation)||[],n=new Date;var h,g,v={},y=["yyyy","yy","M","MM","m","mm","d","dd"],b={yyyy:function(e,t){return e.setUTCFullYear(t)},yy:function(e,t){return e.setUTCFullYear(2e3+t)},m:function(e,t){if(isNaN(e))return e;for(t-=1;t<0;)t+=12;for(t%=12,e.setUTCMonth(t);e.getUTCMonth()!==t;)e.setUTCDate(e.getUTCDate()-1);return e},d:function(e,t){return e.setUTCDate(t)}};b.M=b.MM=b.mm=b.m,b.dd=b.d,n=o(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0);var C=r.parts.slice();if(p.length!==C.length&&(C=e(C).filter(function(t,o){return-1!==e.inArray(o,y)}).toArray()),p.length===C.length){var w;for(d=0,w=C.length;d<w;d++){if(h=parseInt(p[d],10),s=C[d],isNaN(h))switch(s){case"MM":g=e(f[i].months).filter(a),h=e.inArray(g[0],f[i].months)+1;break;case"M":g=e(f[i].monthsShort).filter(a),h=e.inArray(g[0],f[i].monthsShort)+1}v[s]=h}var x,S;for(d=0;d<y.length;d++)(S=y[d])in v&&!isNaN(v[S])&&(x=new Date(n),b[S](x,v[S]),isNaN(x)||(n=x))}return n},formatDate:function(t,o,n){if(!t)return"";"string"==typeof o&&(o=m.parseFormat(o));var r={d:t.getUTCDate(),D:f[n].daysShort[t.getUTCDay()],DD:f[n].days[t.getUTCDay()],m:t.getUTCMonth()+1,M:f[n].monthsShort[t.getUTCMonth()],MM:f[n].months[t.getUTCMonth()],yy:t.getUTCFullYear().toString().substring(2),yyyy:t.getUTCFullYear()};r.dd=(r.d<10?"0":"")+r.d,r.mm=(r.m<10?"0":"")+r.m,t=[];for(var i=e.extend([],o.separators),a=0,s=o.parts.length;a<=s;a++)i.length&&t.push(i.shift()),t.push(r[o.parts[a]]);return t.join("")},headTemplate:'<thead><tr><th class="prev">&laquo;</th><th colspan="5" class="datepicker-switch"></th><th class="next">&raquo;</th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"></th></tr><tr><th colspan="7" class="clear"></th></tr></tfoot>'};m.template='<div class="datepicker"><div class="datepicker-days"><table class="table table-condensed">'+m.headTemplate+"<tbody></tbody>"+m.footTemplate+'</table></div><div class="datepicker-months"><table class="table table-condensed">'+m.headTemplate+m.contTemplate+m.footTemplate+'</table></div><div class="datepicker-years"><table class="table table-condensed">'+m.headTemplate+m.contTemplate+m.footTemplate+"</table></div></div>",e.fn.datepicker.DPGlobal=m,e.fn.datepicker.noConflict=function(){return e.fn.datepicker=u,this},e(document).on("focus.datepicker.data-api click.datepicker.data-api",'[data-provide="datepicker"]',function(t){var o=e(this);o.data("datepicker")||(t.preventDefault(),o.datepicker("show"))}),e(function(){e('[data-provide="datepicker-inline"]').datepicker()})}(window.jQuery),function(e){e.fn.datepicker.dates.ru={days:["\u0412\u043e\u0441\u043a\u0440\u0435\u0441\u0435\u043d\u044c\u0435","\u041f\u043e\u043d\u0435\u0434\u0435\u043b\u044c\u043d\u0438\u043a","\u0412\u0442\u043e\u0440\u043d\u0438\u043a","\u0421\u0440\u0435\u0434\u0430","\u0427\u0435\u0442\u0432\u0435\u0440\u0433","\u041f\u044f\u0442\u043d\u0438\u0446\u0430","\u0421\u0443\u0431\u0431\u043e\u0442\u0430","\u0412\u043e\u0441\u043a\u0440\u0435\u0441\u0435\u043d\u044c\u0435"],daysShort:["\u0412\u0441\u043a","\u041f\u043d\u0434","\u0412\u0442\u0440","\u0421\u0440\u0434","\u0427\u0442\u0432","\u041f\u0442\u043d","\u0421\u0443\u0431","\u0412\u0441\u043a"],daysMin:["\u0412\u0441","\u041f\u043d","\u0412\u0442","\u0421\u0440","\u0427\u0442","\u041f\u0442","\u0421\u0431","\u0412\u0441"],months:["\u042f\u043d\u0432\u0430\u0440\u044c","\u0424\u0435\u0432\u0440\u0430\u043b\u044c","\u041c\u0430\u0440\u0442","\u0410\u043f\u0440\u0435\u043b\u044c","\u041c\u0430\u0439","\u0418\u044e\u043d\u044c","\u0418\u044e\u043b\u044c","\u0410\u0432\u0433\u0443\u0441\u0442","\u0421\u0435\u043d\u0442\u044f\u0431\u0440\u044c","\u041e\u043a\u0442\u044f\u0431\u0440\u044c","\u041d\u043e\u044f\u0431\u0440\u044c","\u0414\u0435\u043a\u0430\u0431\u0440\u044c"],monthsShort:["\u042f\u043d\u0432","\u0424\u0435\u0432","\u041c\u0430\u0440","\u0410\u043f\u0440","\u041c\u0430\u0439","\u0418\u044e\u043d","\u0418\u044e\u043b","\u0410\u0432\u0433","\u0421\u0435\u043d","\u041e\u043a\u0442","\u041d\u043e\u044f","\u0414\u0435\u043a"],today:"\u0421\u0435\u0433\u043e\u0434\u043d\u044f",weekStart:1}}(jQuery),/**
* @version: 2.1.19
* @author: Dan Grossman http://www.dangrossman.info/
* @copyright: Copyright (c) 2012-2015 Dan Grossman. All rights reserved.
* @license: Licensed under the MIT license. See http://www.opensource.org/licenses/mit-license.php
* @website: https://www.improvely.com/
*/
function(e,t){if("function"==typeof define&&define.amd)define(["moment","jquery","exports"],function(o,n,r){e.daterangepicker=t(e,r,o,n)});else if("undefined"!=typeof exports){var o=require("moment"),n="undefined"!=typeof window?window.jQuery:undefined;if(!n)try{n=require("jquery"),n.fn||(n.fn={})}catch(e){if(!n)throw new Error("jQuery dependency not found")}t(e,exports,o,n)}else e.daterangepicker=t(e,{},e.moment||moment,e.jQuery||e.Zepto||e.ender||e.$)}(this||{},function(e,t,o,n){var r=function(e,t,r){if(this.parentEl="body",this.element=n(e),this.startDate=o().startOf("day"),this.endDate=o().endOf("day"),this.minDate=!1,this.maxDate=!1,this.dateLimit=!1,this.autoApply=!1,this.singleDatePicker=!1,this.showDropdowns=!1,this.showWeekNumbers=!1,this.showISOWeekNumbers=!1,this.timePicker=!1,this.timePicker24Hour=!1,this.timePickerIncrement=1,this.timePickerSeconds=!1,this.linkedCalendars=!0,this.autoUpdateInput=!0,this.alwaysShowCalendars=!1,this.ranges={},this.opens="right",this.element.hasClass("pull-right")&&(this.opens="left"),this.drops="down",this.element.hasClass("dropup")&&(this.drops="up"),this.buttonClasses="btn btn-sm",this.applyClass="btn-success",this.cancelClass="btn-default",this.locale={format:"MM/DD/YYYY",separator:" - ",applyLabel:"Apply",cancelLabel:"Cancel",weekLabel:"W",customRangeLabel:"Custom Range",daysOfWeek:o.weekdaysMin(),monthNames:o.monthsShort(),firstDay:o.localeData().firstDayOfWeek()},this.callback=function(){},this.isShowing=!1,this.leftCalendar={},this.rightCalendar={},"object"==typeof t&&null!==t||(t={}),t=n.extend(this.element.data(),t),"string"==typeof t.template||t.template instanceof n||(t.template='<div class="daterangepicker dropdown-menu"><div class="calendar left"><div class="daterangepicker_input"><input class="input-mini" type="text" name="daterangepicker_start" value="" /><i class="fa fa-calendar glyphicon glyphicon-calendar"></i><div class="calendar-time"><div></div><i class="fa fa-clock-o glyphicon glyphicon-time"></i></div></div><div class="calendar-table"></div></div><div class="calendar right"><div class="daterangepicker_input"><input class="input-mini" type="text" name="daterangepicker_end" value="" /><i class="fa fa-calendar glyphicon glyphicon-calendar"></i><div class="calendar-time"><div></div><i class="fa fa-clock-o glyphicon glyphicon-time"></i></div></div><div class="calendar-table"></div></div><div class="ranges"><div class="range_inputs"><button class="applyBtn" disabled="disabled" type="button"></button> <button class="cancelBtn" type="button"></button></div></div></div>'),this.parentEl=n(t.parentEl&&n(t.parentEl).length?t.parentEl:this.parentEl),this.container=n(t.template).appendTo(this.parentEl),"object"==typeof t.locale&&("string"==typeof t.locale.format&&(this.locale.format=t.locale.format),"string"==typeof t.locale.separator&&(this.locale.separator=t.locale.separator),"object"==typeof t.locale.daysOfWeek&&(this.locale.daysOfWeek=t.locale.daysOfWeek.slice()),"object"==typeof t.locale.monthNames&&(this.locale.monthNames=t.locale.monthNames.slice()),"number"==typeof t.locale.firstDay&&(this.locale.firstDay=t.locale.firstDay),"string"==typeof t.locale.applyLabel&&(this.locale.applyLabel=t.locale.applyLabel),"string"==typeof t.locale.cancelLabel&&(this.locale.cancelLabel=t.locale.cancelLabel),"string"==typeof t.locale.weekLabel&&(this.locale.weekLabel=t.locale.weekLabel),"string"==typeof t.locale.customRangeLabel&&(this.locale.customRangeLabel=t.locale.customRangeLabel)),"string"==typeof t.startDate&&(this.startDate=o(t.startDate,this.locale.format)),"string"==typeof t.endDate&&(this.endDate=o(t.endDate,this.locale.format)),"string"==typeof t.minDate&&(this.minDate=o(t.minDate,this.locale.format)),"string"==typeof t.maxDate&&(this.maxDate=o(t.maxDate,this.locale.format)),"object"==typeof t.startDate&&(this.startDate=o(t.startDate)),"object"==typeof t.endDate&&(this.endDate=o(t.endDate)),"object"==typeof t.minDate&&(this.minDate=o(t.minDate)),"object"==typeof t.maxDate&&(this.maxDate=o(t.maxDate)),this.minDate&&this.startDate.isBefore(this.minDate)&&(this.startDate=this.minDate.clone()),this.maxDate&&this.endDate.isAfter(this.maxDate)&&(this.endDate=this.maxDate.clone()),"string"==typeof t.applyClass&&(this.applyClass=t.applyClass),"string"==typeof t.cancelClass&&(this.cancelClass=t.cancelClass),"object"==typeof t.dateLimit&&(this.dateLimit=t.dateLimit),"string"==typeof t.opens&&(this.opens=t.opens),"string"==typeof t.drops&&(this.drops=t.drops),"boolean"==typeof t.showWeekNumbers&&(this.showWeekNumbers=t.showWeekNumbers),"boolean"==typeof t.showISOWeekNumbers&&(this.showISOWeekNumbers=t.showISOWeekNumbers),"string"==typeof t.buttonClasses&&(this.buttonClasses=t.buttonClasses),"object"==typeof t.buttonClasses&&(this.buttonClasses=t.buttonClasses.join(" ")),"boolean"==typeof t.showDropdowns&&(this.showDropdowns=t.showDropdowns),"boolean"==typeof t.singleDatePicker&&(this.singleDatePicker=t.singleDatePicker,this.singleDatePicker&&(this.endDate=this.startDate.clone())),"boolean"==typeof t.timePicker&&(this.timePicker=t.timePicker),"boolean"==typeof t.timePickerSeconds&&(this.timePickerSeconds=t.timePickerSeconds),"number"==typeof t.timePickerIncrement&&(this.timePickerIncrement=t.timePickerIncrement),"boolean"==typeof t.timePicker24Hour&&(this.timePicker24Hour=t.timePicker24Hour),"boolean"==typeof t.autoApply&&(this.autoApply=t.autoApply),"boolean"==typeof t.autoUpdateInput&&(this.autoUpdateInput=t.autoUpdateInput),"boolean"==typeof t.linkedCalendars&&(this.linkedCalendars=t.linkedCalendars),"function"==typeof t.isInvalidDate&&(this.isInvalidDate=t.isInvalidDate),"boolean"==typeof t.alwaysShowCalendars&&(this.alwaysShowCalendars=t.alwaysShowCalendars),0!=this.locale.firstDay)for(var i=this.locale.firstDay;i>0;)this.locale.daysOfWeek.push(this.locale.daysOfWeek.shift()),i--;var a,s,l;if("undefined"==typeof t.startDate&&"undefined"==typeof t.endDate&&n(this.element).is("input[type=text]")){var c=n(this.element).val(),d=c.split(this.locale.separator);a=s=null,2==d.length?(a=o(d[0],this.locale.format),s=o(d[1],this.locale.format)):this.singleDatePicker&&""!==c&&(a=o(c,this.locale.format),s=o(c,this.locale.format)),null!==a&&null!==s&&(this.setStartDate(a),this.setEndDate(s))}if("object"==typeof t.ranges){for(l in t.ranges){a="string"==typeof t.ranges[l][0]?o(t.ranges[l][0],this.locale.format):o(t.ranges[l][0]),s="string"==typeof t.ranges[l][1]?o(t.ranges[l][1],this.locale.format):o(t.ranges[l][1]),this.minDate&&a.isBefore(this.minDate)&&(a=this.minDate.clone());var u=this.maxDate;if(this.dateLimit&&a.clone().add(this.dateLimit).isAfter(u)&&(u=a.clone().add(this.dateLimit)),u&&s.isAfter(u)&&(s=u.clone()),!(this.minDate&&s.isBefore(this.minDate)||u&&a.isAfter(u))){var p=document.createElement("textarea");p.innerHTML=l;var h=p.value;this.ranges[h]=[a,s]}}var f="<ul>";for(l in this.ranges)f+="<li>"+l+"</li>";f+="<li>"+this.locale.customRangeLabel+"</li>",f+="</ul>",this.container.find(".ranges").prepend(f)}if("function"==typeof r&&(this.callback=r),this.timePicker||(this.startDate=this.startDate.startOf("day"),this.endDate=this.endDate.endOf("day"),this.container.find(".calendar-time").hide()),this.timePicker&&this.autoApply&&(this.autoApply=!1),this.autoApply&&"object"!=typeof t.ranges?this.container.find(".ranges").hide():this.autoApply&&this.container.find(".applyBtn, .cancelBtn").addClass("hide"),this.singleDatePicker&&(this.container.addClass("single"),this.container.find(".calendar.left").addClass("single"),this.container.find(".calendar.left").show(),this.container.find(".calendar.right").hide(),this.container.find(".daterangepicker_input input, .daterangepicker_input i").hide(),this.timePicker||this.container.find(".ranges").hide()),("undefined"==typeof t.ranges&&!this.singleDatePicker||this.alwaysShowCalendars)&&this.container.addClass("show-calendar"),this.container.addClass("opens"+this.opens),"undefined"!=typeof t.ranges&&"right"==this.opens){var m=this.container.find(".ranges"),g=m.clone();m.remove(),this.container.find(".calendar.left").parent().prepend(g)}this.container.find(".applyBtn, .cancelBtn").addClass(this.buttonClasses),this.applyClass.length&&this.container.find(".applyBtn").addClass(this.applyClass),this.cancelClass.length&&this.container.find(".cancelBtn").addClass(this.cancelClass),this.container.find(".applyBtn").html(this.locale.applyLabel),this.container.find(".cancelBtn").html(this.locale.cancelLabel),this.container.find(".calendar").on("click.daterangepicker",".prev",n.proxy(this.clickPrev,this)).on("click.daterangepicker",".next",n.proxy(this.clickNext,this)).on("click.daterangepicker","td.available",n.proxy(this.clickDate,this)).on("mouseenter.daterangepicker","td.available",n.proxy(this.hoverDate,this)).on("mouseleave.daterangepicker","td.available",n.proxy(this.updateFormInputs,this)).on("change.daterangepicker","select.yearselect",n.proxy(this.monthOrYearChanged,this)).on("change.daterangepicker","select.monthselect",n.proxy(this.monthOrYearChanged,this)).on("change.daterangepicker","select.hourselect,select.minuteselect,select.secondselect,select.ampmselect",n.proxy(this.timeChanged,this)).on("click.daterangepicker",".daterangepicker_input input",n.proxy(this.showCalendars,this)).on("change.daterangepicker",".daterangepicker_input input",n.proxy(this.formInputsChanged,this)),this.container.find(".ranges").on("click.daterangepicker","button.applyBtn",n.proxy(this.clickApply,this)).on("click.daterangepicker","button.cancelBtn",n.proxy(this.clickCancel,this)).on("click.daterangepicker","li",n.proxy(this.clickRange,this)).on("mouseenter.daterangepicker","li",n.proxy(this.hoverRange,this)).on("mouseleave.daterangepicker","li",n.proxy(this.updateFormInputs,this)),this.element.is("input")?this.element.on({"click.daterangepicker":n.proxy(this.show,this),"focus.daterangepicker":n.proxy(this.show,this),"keyup.daterangepicker":n.proxy(this.elementChanged,this),"keydown.daterangepicker":n.proxy(this.keydown,this)}):this.element.on("click.daterangepicker",n.proxy(this.toggle,this)),this.element.is("input")&&!this.singleDatePicker&&this.autoUpdateInput?(this.element.val(this.startDate.format(this.locale.format)+this.locale.separator+this.endDate.format(this.locale.format)),this.element.trigger("change")):this.element.is("input")&&this.autoUpdateInput&&(this.element.val(this.startDate.format(this.locale.format)),this.element.trigger("change"))};return r.prototype={constructor:r,setStartDate:function(e){"string"==typeof e&&(this.startDate=o(e,this.locale.format)),"object"==typeof e&&(this.startDate=o(e)),this.timePicker||(this.startDate=this.startDate.startOf("day")),this.timePicker&&this.timePickerIncrement&&this.startDate.minute(Math.round(this.startDate.minute()/this.timePickerIncrement)*this.timePickerIncrement),this.minDate&&this.startDate.isBefore(this.minDate)&&(this.startDate=this.minDate),this.maxDate&&this.startDate.isAfter(this.maxDate)&&(this.startDate=this.maxDate),this.isShowing||this.updateElement(),this.updateMonthsInView()},setEndDate:function(e){"string"==typeof e&&(this.endDate=o(e,this.locale.format)),"object"==typeof e&&(this.endDate=o(e)),this.timePicker||(this.endDate=this.endDate.endOf("day")),this.timePicker&&this.timePickerIncrement&&this.endDate.minute(Math.round(this.endDate.minute()/this.timePickerIncrement)*this.timePickerIncrement),this.endDate.isBefore(this.startDate)&&(this.endDate=this.startDate.clone()),this.maxDate&&this.endDate.isAfter(this.maxDate)&&(this.endDate=this.maxDate),this.dateLimit&&this.startDate.clone().add(this.dateLimit).isBefore(this.endDate)&&(this.endDate=this.startDate.clone().add(this.dateLimit)),this.previousRightTime=this.endDate.clone(),this.isShowing||this.updateElement(),this.updateMonthsInView()},isInvalidDate:function(){return!1},updateView:function(){this.timePicker&&(this.renderTimePicker("left"),this.renderTimePicker("right"),this.endDate?this.container.find(".right .calendar-time select").removeAttr("disabled").removeClass("disabled"):this.container.find(".right .calendar-time select").attr("disabled","disabled").addClass("disabled")),this.endDate?(this.container.find('input[name="daterangepicker_end"]').removeClass("active"),this.container.find('input[name="daterangepicker_start"]').addClass("active")):(this.container.find('input[name="daterangepicker_end"]').addClass("active"),this.container.find('input[name="daterangepicker_start"]').removeClass("active")),this.updateMonthsInView(),this.updateCalendars(),this.updateFormInputs()},updateMonthsInView:function(){if(this.endDate){if(!this.singleDatePicker&&this.leftCalendar.month&&this.rightCalendar.month&&(this.startDate.format("YYYY-MM")==this.leftCalendar.month.format("YYYY-MM")||this.startDate.format("YYYY-MM")==this.rightCalendar.month.format("YYYY-MM"))&&(this.endDate.format("YYYY-MM")==this.leftCalendar.month.format("YYYY-MM")||this.endDate.format("YYYY-MM")==this.rightCalendar.month.format("YYYY-MM")))return;this.leftCalendar.month=this.startDate.clone().date(2),this.linkedCalendars||this.endDate.month()==this.startDate.month()&&this.endDate.year()==this.startDate.year()?this.rightCalendar.month=this.startDate.clone().date(2).add(1,"month"):this.rightCalendar.month=this.endDate.clone().date(2)}else this.leftCalendar.month.format("YYYY-MM")!=this.startDate.format("YYYY-MM")&&this.rightCalendar.month.format("YYYY-MM")!=this.startDate.format("YYYY-MM")&&(this.leftCalendar.month=this.startDate.clone().date(2),this.rightCalendar.month=this.startDate.clone().date(2).add(1,"month"))},updateCalendars:function(){if(this.timePicker){var e,t,o;if(this.endDate){if(e=parseInt(this.container.find(".left .hourselect").val(),10),t=parseInt(this.container.find(".left .minuteselect").val(),10),o=this.timePickerSeconds?parseInt(this.container.find(".left .secondselect").val(),10):0,!this.timePicker24Hour){var n=this.container.find(".left .ampmselect").val();"PM"===n&&e<12&&(e+=12),"AM"===n&&12===e&&(e=0)}}else if(e=parseInt(this.container.find(".right .hourselect").val(),10),t=parseInt(this.container.find(".right .minuteselect").val(),10),o=this.timePickerSeconds?parseInt(this.container.find(".right .secondselect").val(),10):0,!this.timePicker24Hour){var n=this.container.find(".right .ampmselect").val();"PM"===n&&e<12&&(e+=12),"AM"===n&&12===e&&(e=0)}this.leftCalendar.month.hour(e).minute(t).second(o),this.rightCalendar.month.hour(e).minute(t).second(o)}this.renderCalendar("left"),this.renderCalendar("right"),this.container.find(".ranges li").removeClass("active"),null!=this.endDate&&this.calculateChosenLabel()},renderCalendar:function(e){var t="left"==e?this.leftCalendar:this.rightCalendar,r=t.month.month(),i=t.month.year(),a=t.month.hour(),s=t.month.minute(),l=t.month.second(),c=o([i,r]).daysInMonth(),d=o([i,r,1]),u=o([i,r,c]),p=o(d).subtract(1,"month").month(),h=o(d).subtract(1,"month").year(),f=o([h,p]).daysInMonth(),m=d.day(),t=[];t.firstDay=d,t.lastDay=u;for(var g=0;g<6;g++)t[g]=[];var v=f-m+this.locale.firstDay+1;v>f&&(v-=7),m==this.locale.firstDay&&(v=f-6);for(var y,b,C=o([h,p,v,12,s,l]),g=0,y=0,b=0;g<42;g++,y++,C=o(C).add(24,"hour"))g>0&&y%7==0&&(y=0,b++),t[b][y]=C.clone().hour(a).minute(s).second(l),C.hour(12),this.minDate&&t[b][y].format("YYYY-MM-DD")==this.minDate.format("YYYY-MM-DD")&&t[b][y].isBefore(this.minDate)&&"left"==e&&(t[b][y]=this.minDate.clone()),this.maxDate&&t[b][y].format("YYYY-MM-DD")==this.maxDate.format("YYYY-MM-DD")&&t[b][y].isAfter(this.maxDate)&&"right"==e&&(t[b][y]=this.maxDate.clone());"left"==e?this.leftCalendar.calendar=t:this.rightCalendar.calendar=t;var w="left"==e?this.minDate:this.startDate,x=this.maxDate,S=("left"==e?this.startDate:this.endDate,'<table class="table-condensed">');S+="<thead>",S+="<tr>",(this.showWeekNumbers||this.showISOWeekNumbers)&&(S+="<th></th>"),w&&!w.isBefore(t.firstDay)||this.linkedCalendars&&"left"!=e?S+="<th></th>":S+='<th class="prev available"><i class="fa fa-chevron-left glyphicon glyphicon-chevron-left"></i></th>';var _=this.locale.monthNames[t[1][1].month()]+t[1][1].format(" YYYY");if(this.showDropdowns){for(var k=t[1][1].month(),T=t[1][1].year(),E=x&&x.year()||T+5,F=w&&w.year()||T-50,D=T==F,M=T==E,A='<select class="monthselect">',P=0;P<12;P++)(!D||P>=w.month())&&(!M||P<=x.month())?A+="<option value='"+P+"'"+(P===k?" selected='selected'":"")+">"+this.locale.monthNames[P]+"</option>":A+="<option value='"+P+"'"+(P===k?" selected='selected'":"")+" disabled='disabled'>"+this.locale.monthNames[P]+"</option>";A+="</select>";for(var L='<select class="yearselect">',R=F;R<=E;R++)L+='<option value="'+R+'"'+(R===T?' selected="selected"':"")+">"+R+"</option>";L+="</select>",_=A+L}if(S+='<th colspan="5" class="month">'+_+"</th>",x&&!x.isAfter(t.lastDay)||this.linkedCalendars&&"right"!=e&&!this.singleDatePicker?S+="<th></th>":S+='<th class="next available"><i class="fa fa-chevron-right glyphicon glyphicon-chevron-right"></i></th>',S+="</tr>",S+="<tr>",(this.showWeekNumbers||this.showISOWeekNumbers)&&(S+='<th class="week">'+this.locale.weekLabel+"</th>"),n.each(this.locale.daysOfWeek,function(e,t){S+="<th>"+t+"</th>"}),S+="</tr>",S+="</thead>",S+="<tbody>",null==this.endDate&&this.dateLimit){var I=this.startDate.clone().add(this.dateLimit).endOf("day");x&&!I.isBefore(x)||(x=I)}for(var b=0;b<6;b++){S+="<tr>",this.showWeekNumbers?S+='<td class="week">'+t[b][0].week()+"</td>":this.showISOWeekNumbers&&(S+='<td class="week">'+t[b][0].isoWeek()+"</td>");for(var y=0;y<7;y++){var O=[];t[b][y].isSame(new Date,"day")&&O.push("today"),t[b][y].isoWeekday()>5&&O.push("weekend"),t[b][y].month()!=t[1][1].month()&&O.push("off"),this.minDate&&t[b][y].isBefore(this.minDate,"day")&&O.push("off","disabled"),x&&t[b][y].isAfter(x,"day")&&O.push("off","disabled"),this.isInvalidDate(t[b][y])&&O.push("off","disabled"),t[b][y].format("YYYY-MM-DD")==this.startDate.format("YYYY-MM-DD")&&O.push("active","start-date"),null!=this.endDate&&t[b][y].format("YYYY-MM-DD")==this.endDate.format("YYYY-MM-DD")&&O.push("active","end-date"),null!=this.endDate&&t[b][y]>this.startDate&&t[b][y]<this.endDate&&O.push("in-range");for(var $="",N=!1,g=0;g<O.length;g++)$+=O[g]+" ","disabled"==O[g]&&(N=!0);N||($+="available"),S+='<td class="'+$.replace(/^\s+|\s+$/g,"")+'" data-title="r'+b+"c"+y+'">'+t[b][y].date()+"</td>"}S+="</tr>"}S+="</tbody>",S+="</table>",this.container.find(".calendar."+e+" .calendar-table").html(S)},renderTimePicker:function(e){var t,o,n,r=this.maxDate;if(!this.dateLimit||this.maxDate&&!this.startDate.clone().add(this.dateLimit).isAfter(this.maxDate)||(r=this.startDate.clone().add(this.dateLimit)),"left"==e)o=this.startDate.clone(),n=this.minDate;else if("right"==e){o=this.endDate?this.endDate.clone():this.previousRightTime.clone(),n=this.startDate;var i=this.container.find(".calendar.right .calendar-time div");if(""!=i.html()){if(o.hour(i.find(".hourselect option:selected").val()||o.hour()),o.minute(i.find(".minuteselect option:selected").val()||o.minute()),o.second(i.find(".secondselect option:selected").val()||o.second()),!this.timePicker24Hour){var a=i.find(".ampmselect option:selected").val();"PM"===a&&o.hour()<12&&o.hour(o.hour()+12),"AM"===a&&12===o.hour()&&o.hour(0)}o.isBefore(this.startDate)&&(o=this.startDate.clone()),o.isAfter(r)&&(o=r.clone())}}t='<select class="hourselect">';for(var s=this.timePicker24Hour?0:1,l=this.timePicker24Hour?23:12,c=s;c<=l;c++){var d=c;this.timePicker24Hour||(d=o.hour()>=12?12==c?12:c+12:12==c?0:c);var u=o.clone().hour(d),p=!1;n&&u.minute(59).isBefore(n)&&(p=!0),r&&u.minute(0).isAfter(r)&&(p=!0),d!=o.hour()||p?t+=p?'<option value="'+c+'" disabled="disabled" class="disabled">'+c+"</option>":'<option value="'+c+'">'+c+"</option>":t+='<option value="'+c+'" selected="selected">'+c+"</option>"}t+="</select> ",t+=': <select class="minuteselect">';for(var c=0;c<60;c+=this.timePickerIncrement){var h=c<10?"0"+c:c,u=o.clone().minute(c),p=!1;n&&u.second(59).isBefore(n)&&(p=!0),r&&u.second(0).isAfter(r)&&(p=!0),o.minute()!=c||p?t+=p?'<option value="'+c+'" disabled="disabled" class="disabled">'+h+"</option>":'<option value="'+c+'">'+h+"</option>":t+='<option value="'+c+'" selected="selected">'+h+"</option>"}if(t+="</select> ",this.timePickerSeconds){t+=': <select class="secondselect">';for(var c=0;c<60;c++){var h=c<10?"0"+c:c,u=o.clone().second(c),p=!1;n&&u.isBefore(n)&&(p=!0),r&&u.isAfter(r)&&(p=!0),o.second()!=c||p?t+=p?'<option value="'+c+'" disabled="disabled" class="disabled">'+h+"</option>":'<option value="'+c+'">'+h+"</option>":t+='<option value="'+c+'" selected="selected">'+h+"</option>"}t+="</select> "}if(!this.timePicker24Hour){t+='<select class="ampmselect">';var f="",m="";n&&o.clone().hour(12).minute(0).second(0).isBefore(n)&&(f=' disabled="disabled" class="disabled"'),r&&o.clone().hour(0).minute(0).second(0).isAfter(r)&&(m=' disabled="disabled" class="disabled"'),o.hour()>=12?t+='<option value="AM"'+f+'>AM</option><option value="PM" selected="selected"'+m+">PM</option>":t+='<option value="AM" selected="selected"'+f+'>AM</option><option value="PM"'+m+">PM</option>",t+="</select>"}this.container.find(".calendar."+e+" .calendar-time div").html(t)},updateFormInputs:function(){this.container.find("input[name=daterangepicker_start]").is(":focus")||this.container.find("input[name=daterangepicker_end]").is(":focus")||(this.container.find("input[name=daterangepicker_start]").val(this.startDate.format(this.locale.format)),this.endDate&&this.container.find("input[name=daterangepicker_end]").val(this.endDate.format(this.locale.format)),this.singleDatePicker||this.endDate&&(this.startDate.isBefore(this.endDate)||this.startDate.isSame(this.endDate))?this.container.find("button.applyBtn").removeAttr("disabled"):this.container.find("button.applyBtn").attr("disabled","disabled"))},move:function(){var e,t={top:0,left:0},o=n(window).width();this.parentEl.is("body")||(t={top:this.parentEl.offset().top-this.parentEl.scrollTop(),left:this.parentEl.offset().left-this.parentEl.scrollLeft()},o=this.parentEl[0].clientWidth+this.parentEl.offset().left),e="up"==this.drops?this.element.offset().top-this.container.outerHeight()-t.top:this.element.offset().top+this.element.outerHeight()-t.top,this.container["up"==this.drops?"addClass":"removeClass"]("dropup"),"left"==this.opens?(this.container.css({top:e,right:o-this.element.offset().left-this.element.outerWidth(),left:"auto"}),this.container.offset().left<0&&this.container.css({right:"auto",left:9})):"center"==this.opens?(this.container.css({top:e,left:this.element.offset().left-t.left+this.element.outerWidth()/2-this.container.outerWidth()/2,right:"auto"}),this.container.offset().left<0&&this.container.css({right:"auto",left:9})):(this.container.css({top:e,left:this.element.offset().left-t.left,right:"auto"}),this.container.offset().left+this.container.outerWidth()>n(window).width()&&this.container.css({left:"auto",right:0}))},show:function(){this.isShowing||(this._outsideClickProxy=n.proxy(function(e){this.outsideClick(e)},this),n(document).on("mousedown.daterangepicker",this._outsideClickProxy).on("touchend.daterangepicker",this._outsideClickProxy).on("click.daterangepicker","[data-toggle=dropdown]",this._outsideClickProxy).on("focusin.daterangepicker",this._outsideClickProxy),n(window).on("resize.daterangepicker",n.proxy(function(e){this.move(e)},this)),this.oldStartDate=this.startDate.clone(),this.oldEndDate=this.endDate.clone(),this.previousRightTime=this.endDate.clone(),this.updateView(),this.container.show(),this.move(),this.element.trigger("show.daterangepicker",this),this.isShowing=!0)},hide:function(){this.isShowing&&(this.endDate||(this.startDate=this.oldStartDate.clone(),this.endDate=this.oldEndDate.clone()),this.startDate.isSame(this.oldStartDate)&&this.endDate.isSame(this.oldEndDate)||this.callback(this.startDate,this.endDate,this.chosenLabel),this.updateElement(),n(document).off(".daterangepicker"),n(window).off(".daterangepicker"),this.container.hide(),this.element.trigger("hide.daterangepicker",this),this.isShowing=!1)},toggle:function(){this.isShowing?this.hide():this.show()},outsideClick:function(e){var t=n(e.target);"focusin"==e.type||t.closest(this.element).length||t.closest(this.container).length||t.closest(".calendar-table").length||this.hide()},showCalendars:function(){this.container.addClass("show-calendar"),this.move(),this.element.trigger("showCalendar.daterangepicker",this)},hideCalendars:function(){this.container.removeClass("show-calendar"),this.element.trigger("hideCalendar.daterangepicker",this)},hoverRange:function(e){if(!this.container.find("input[name=daterangepicker_start]").is(":focus")&&!this.container.find("input[name=daterangepicker_end]").is(":focus")){var t=e.target.innerHTML;if(t==this.locale.customRangeLabel)this.updateView();else{var o=this.ranges[t];this.container.find("input[name=daterangepicker_start]").val(o[0].format(this.locale.format)),this.container.find("input[name=daterangepicker_end]").val(o[1].format(this.locale.format))}}},clickRange:function(e){var t=e.target.innerHTML;if(this.chosenLabel=t,t==this.locale.customRangeLabel)this.showCalendars();else{var o=this.ranges[t];this.startDate=o[0],this.endDate=o[1],this.timePicker||(this.startDate.startOf("day"),this.endDate.endOf("day")),this.alwaysShowCalendars||this.hideCalendars(),this.clickApply()}},clickPrev:function(e){n(e.target).parents(".calendar").hasClass("left")?(this.leftCalendar.month.subtract(1,"month"),this.linkedCalendars&&this.rightCalendar.month.subtract(1,"month")):this.rightCalendar.month.subtract(1,"month"),this.updateCalendars()},clickNext:function(e){n(e.target).parents(".calendar").hasClass("left")?this.leftCalendar.month.add(1,"month"):(this.rightCalendar.month.add(1,"month"),this.linkedCalendars&&this.leftCalendar.month.add(1,"month")),this.updateCalendars()},hoverDate:function(e){if(!this.container.find("input[name=daterangepicker_start]").is(":focus")&&!this.container.find("input[name=daterangepicker_end]").is(":focus")&&n(e.target).hasClass("available")){var t=n(e.target).attr("data-title"),o=t.substr(1,1),r=t.substr(3,1),i=n(e.target).parents(".calendar"),a=i.hasClass("left")?this.leftCalendar.calendar[o][r]:this.rightCalendar.calendar[o][r];this.endDate?this.container.find("input[name=daterangepicker_start]").val(a.format(this.locale.format)):this.container.find("input[name=daterangepicker_end]").val(a.format(this.locale.format));var s=this.leftCalendar,l=this.rightCalendar,c=this.startDate;this.endDate||this.container.find(".calendar td").each(function(e,t){if(!n(t).hasClass("week")){var o=n(t).attr("data-title"),r=o.substr(1,1),i=o.substr(3,1),d=n(t).parents(".calendar"),u=d.hasClass("left")?s.calendar[r][i]:l.calendar[r][i];u.isAfter(c)&&u.isBefore(a)?n(t).addClass("in-range"):n(t).removeClass("in-range")}})}},clickDate:function(e){if(n(e.target).hasClass("available")){var t=n(e.target).attr("data-title"),o=t.substr(1,1),r=t.substr(3,1),i=n(e.target).parents(".calendar"),a=i.hasClass("left")?this.leftCalendar.calendar[o][r]:this.rightCalendar.calendar[o][r];if(this.endDate||a.isBefore(this.startDate,"day")){if(this.timePicker){var s=parseInt(this.container.find(".left .hourselect").val(),10);if(!this.timePicker24Hour){var l=this.container.find(".left .ampmselect").val();"PM"===l&&s<12&&(s+=12),"AM"===l&&12===s&&(s=0)}var c=parseInt(this.container.find(".left .minuteselect").val(),10),d=this.timePickerSeconds?parseInt(this.container.find(".left .secondselect").val(),10):0;a=a.clone().hour(s).minute(c).second(d)}this.endDate=null,this.setStartDate(a.clone())}else if(!this.endDate&&a.isBefore(this.startDate))this.setEndDate(this.startDate.clone());else{if(this.timePicker){var s=parseInt(this.container.find(".right .hourselect").val(),10);if(!this.timePicker24Hour){var l=this.container.find(".right .ampmselect").val();"PM"===l&&s<12&&(s+=12),"AM"===l&&12===s&&(s=0)}var c=parseInt(this.container.find(".right .minuteselect").val(),10),d=this.timePickerSeconds?parseInt(this.container.find(".right .secondselect").val(),10):0;a=a.clone().hour(s).minute(c).second(d)}this.setEndDate(a.clone()),this.autoApply&&(this.calculateChosenLabel(),this.clickApply())}this.singleDatePicker&&(this.setEndDate(this.startDate),this.timePicker||this.clickApply()),this.updateView()}},calculateChosenLabel:function(){var e=!0,t=0;for(var o in this.ranges){if(this.timePicker){if(this.startDate.isSame(this.ranges[o][0])&&this.endDate.isSame(this.ranges[o][1])){e=!1,this.chosenLabel=this.container.find(".ranges li:eq("+t+")").addClass("active").html();break}}else if(this.startDate.format("YYYY-MM-DD")==this.ranges[o][0].format("YYYY-MM-DD")&&this.endDate.format("YYYY-MM-DD")==this.ranges[o][1].format("YYYY-MM-DD")){e=!1,this.chosenLabel=this.container.find(".ranges li:eq("+t+")").addClass("active").html();break}t++}e&&(this.chosenLabel=this.container.find(".ranges li:last").addClass("active").html(),this.showCalendars())},clickApply:function(){this.hide(),this.element.trigger("apply.daterangepicker",this)},clickCancel:function(){this.startDate=this.oldStartDate,this.endDate=this.oldEndDate,this.hide(),this.element.trigger("cancel.daterangepicker",this)},monthOrYearChanged:function(e){var t=n(e.target).closest(".calendar").hasClass("left"),o=t?"left":"right",r=this.container.find(".calendar."+o),i=parseInt(r.find(".monthselect").val(),10),a=r.find(".yearselect").val();t||(a<this.startDate.year()||a==this.startDate.year()&&i<this.startDate.month())&&(i=this.startDate.month(),a=this.startDate.year()),this.minDate&&(a<this.minDate.year()||a==this.minDate.year()&&i<this.minDate.month())&&(i=this.minDate.month(),a=this.minDate.year()),this.maxDate&&(a>this.maxDate.year()||a==this.maxDate.year()&&i>this.maxDate.month())&&(i=this.maxDate.month(),a=this.maxDate.year()),t?(this.leftCalendar.month.month(i).year(a),this.linkedCalendars&&(this.rightCalendar.month=this.leftCalendar.month.clone().add(1,"month"))):(this.rightCalendar.month.month(i).year(a),this.linkedCalendars&&(this.leftCalendar.month=this.rightCalendar.month.clone().subtract(1,"month"))),this.updateCalendars()},timeChanged:function(e){var t=n(e.target).closest(".calendar"),o=t.hasClass("left"),r=parseInt(t.find(".hourselect").val(),10),i=parseInt(t.find(".minuteselect").val(),10),a=this.timePickerSeconds?parseInt(t.find(".secondselect").val(),10):0;if(!this.timePicker24Hour){var s=t.find(".ampmselect").val();"PM"===s&&r<12&&(r+=12),"AM"===s&&12===r&&(r=0)}if(o){var l=this.startDate.clone();l.hour(r),l.minute(i),l.second(a),this.setStartDate(l),this.singleDatePicker?this.endDate=this.startDate.clone():this.endDate&&this.endDate.format("YYYY-MM-DD")==l.format("YYYY-MM-DD")&&this.endDate.isBefore(l)&&this.setEndDate(l.clone())}else if(this.endDate){var c=this.endDate.clone();c.hour(r),c.minute(i),c.second(a),this.setEndDate(c)}this.updateCalendars(),this.updateFormInputs(),this.renderTimePicker("left"),this.renderTimePicker("right")},formInputsChanged:function(e){var t=n(e.target).closest(".calendar").hasClass("right"),r=o(this.container.find('input[name="daterangepicker_start"]').val(),this.locale.format),i=o(this.container.find('input[name="daterangepicker_end"]').val(),this.locale.format);r.isValid()&&i.isValid()&&(t&&i.isBefore(r)&&(r=i.clone()),this.setStartDate(r),this.setEndDate(i),t?this.container.find('input[name="daterangepicker_start"]').val(this.startDate.format(this.locale.format)):this.container.find('input[name="daterangepicker_end"]').val(this.endDate.format(this.locale.format))),this.updateCalendars(),this.timePicker&&(this.renderTimePicker("left"),this.renderTimePicker("right"))},elementChanged:function(){if(this.element.is("input")&&this.element.val().length&&!(this.element.val().length<this.locale.format.length)){var e=this.element.val().split(this.locale.separator),t=null,n=null;2===e.length&&(t=o(e[0],this.locale.format),n=o(e[1],this.locale.format)),(this.singleDatePicker||null===t||null===n)&&(t=o(this.element.val(),this.locale.format),n=t),t.isValid()&&n.isValid()&&(this.setStartDate(t),this.setEndDate(n),this.updateView())}},keydown:function(e){9!==e.keyCode&&13!==e.keyCode||this.hide()},updateElement:function(){this.element.is("input")&&!this.singleDatePicker&&this.autoUpdateInput?(this.element.val(this.startDate.format(this.locale.format)+this.locale.separator+this.endDate.format(this.locale.format)),this.element.trigger("change")):this.element.is("input")&&this.autoUpdateInput&&(this.element.val(this.startDate.format(this.locale.format)),this.element.trigger("change"))},remove:function(){this.container.remove(),this.element.off(".daterangepicker"),this.element.removeData()}},n.fn.daterangepicker=function(e,t){return this.each(function(){var o=n(this);o.data("daterangepicker")&&o.data("daterangepicker").remove(),o.data("daterangepicker",new r(o,e,t))}),this},r}),function(){function e(e){
return document.createElementNS(c,e)}function t(e){return(e<10?"0":"")+e}function o(e){var t=++v+"";return e?e+t:t}function n(n,s){function c(e,t){var o=p.offset(),n=/^touch/.test(e.type),r=o.left+y,a=o.top+y,c=(n?e.originalEvent.touches[0]:e).pageX-r,u=(n?e.originalEvent.touches[0]:e).pageY-a,h=Math.sqrt(c*c+u*u),g=!1;if(!t||!(h<b-w||h>b+w)){e.preventDefault();var v=setTimeout(function(){i.addClass("clockpicker-moving")},200);d&&p.append(D.canvas),D.setHand(c,u,!t,!0),l.off(f).on(f,function(e){e.preventDefault();var t=/^touch/.test(e.type),o=(t?e.originalEvent.touches[0]:e).pageX-r,n=(t?e.originalEvent.touches[0]:e).pageY-a;(g||o!==c||n!==u)&&(g=!0,D.setHand(o,n,!1,!0))}),l.off(m).on(m,function(e){l.off(m),e.preventDefault();var o=/^touch/.test(e.type),n=(o?e.originalEvent.changedTouches[0]:e).pageX-r,d=(o?e.originalEvent.changedTouches[0]:e).pageY-a;(t||g)&&n===c&&d===u&&D.setHand(n,d),"hours"===D.currentView?D.toggleView("minutes",S/2):s.autoclose&&(D.minutesView.addClass("clockpicker-dial-out"),setTimeout(function(){D.done()},S/2)),p.prepend($),clearTimeout(v),i.removeClass("clockpicker-moving"),l.off(f)})}}var u=a(_),p=u.find(".clockpicker-plate"),g=u.find(".clockpicker-hours"),v=u.find(".clockpicker-minutes"),k=u.find(".clockpicker-am-pm-block"),T="INPUT"===n.prop("tagName"),E=T?n:n.find("input"),F=n.find(".input-group-addon"),D=this;if(this.id=o("cp"),this.element=n,this.options=s,this.isAppended=!1,this.isShown=!1,this.currentView="hours",this.isInput=T,this.input=E,this.addon=F,this.popover=u,this.plate=p,this.hoursView=g,this.minutesView=v,this.amPmBlock=k,this.spanHours=u.find(".clockpicker-span-hours"),this.spanMinutes=u.find(".clockpicker-span-minutes"),this.spanAmPm=u.find(".clockpicker-span-am-pm"),this.amOrPm="PM",s.twelvehour){var M=['<div class="clockpicker-am-pm-block">','<button type="button" class="btn btn-sm btn-default clockpicker-button clockpicker-am-button">',"AM</button>",'<button type="button" class="btn btn-sm btn-default clockpicker-button clockpicker-pm-button">',"PM</button>","</div>"].join("");a(M);a('<button type="button" class="btn btn-sm btn-default clockpicker-button am-button">AM</button>').on("click",function(){D.amOrPm="AM",a(".clockpicker-span-am-pm").empty().append("AM")}).appendTo(this.amPmBlock),a('<button type="button" class="btn btn-sm btn-default clockpicker-button pm-button">PM</button>').on("click",function(){D.amOrPm="PM",a(".clockpicker-span-am-pm").empty().append("PM")}).appendTo(this.amPmBlock)}s.autoclose||a('<button type="button" class="btn btn-sm btn-default btn-block clockpicker-button">'+s.donetext+"</button>").click(a.proxy(this.done,this)).appendTo(u),"top"!==s.placement&&"bottom"!==s.placement||"top"!==s.align&&"bottom"!==s.align||(s.align="left"),"left"!==s.placement&&"right"!==s.placement||"left"!==s.align&&"right"!==s.align||(s.align="top"),u.addClass(s.placement),u.addClass("clockpicker-align-"+s.align),this.spanHours.click(a.proxy(this.toggleView,this,"hours")),this.spanMinutes.click(a.proxy(this.toggleView,this,"minutes")),E.on("focus.clockpicker click.clockpicker",a.proxy(this.show,this)),F.on("click.clockpicker",a.proxy(this.toggle,this));var A,P,L,R,I=a('<div class="clockpicker-tick"></div>');if(s.twelvehour)for(A=1;A<13;A+=1)P=I.clone(),L=A/6*Math.PI,R=b,P.css("font-size","120%"),P.css({left:y+Math.sin(L)*R-w,top:y-Math.cos(L)*R-w}),P.html(0===A?"00":A),g.append(P),P.on(h,c);else for(A=0;A<24;A+=1){P=I.clone(),L=A/6*Math.PI;var O=A>0&&A<13;R=O?C:b,P.css({left:y+Math.sin(L)*R-w,top:y-Math.cos(L)*R-w}),O&&P.css("font-size","120%"),P.html(0===A?"00":A),g.append(P),P.on(h,c)}for(A=0;A<60;A+=5)P=I.clone(),L=A/30*Math.PI,P.css({left:y+Math.sin(L)*b-w,top:y-Math.cos(L)*b-w}),P.css("font-size","120%"),P.html(t(A)),v.append(P),P.on(h,c);if(p.on(h,function(e){0===a(e.target).closest(".clockpicker-tick").length&&c(e,!0)}),d){var $=u.find(".clockpicker-canvas"),N=e("svg");N.setAttribute("class","clockpicker-svg"),N.setAttribute("width",x),N.setAttribute("height",x);var U=e("g");U.setAttribute("transform","translate("+y+","+y+")");var j=e("circle");j.setAttribute("class","clockpicker-canvas-bearing"),j.setAttribute("cx",0),j.setAttribute("cy",0),j.setAttribute("r",2);var H=e("line");H.setAttribute("x1",0),H.setAttribute("y1",0);var B=e("circle");B.setAttribute("class","clockpicker-canvas-bg"),B.setAttribute("r",w);var z=e("circle");z.setAttribute("class","clockpicker-canvas-fg"),z.setAttribute("r",3.5),U.appendChild(H),U.appendChild(B),U.appendChild(z),U.appendChild(j),N.appendChild(U),$.append(N),this.hand=H,this.bg=B,this.fg=z,this.bearing=j,this.g=U,this.canvas=$}r(this.options.init)}function r(e){e&&"function"==typeof e&&e()}var i,a=window.jQuery,s=a(window),l=a(document),c="http://www.w3.org/2000/svg",d="SVGAngle"in window&&function(){var e,t=document.createElement("div");return t.innerHTML="<svg/>",e=(t.firstChild&&t.firstChild.namespaceURI)==c,t.innerHTML="",e}(),u=function(){var e=document.createElement("div").style;return"transition"in e||"WebkitTransition"in e||"MozTransition"in e||"msTransition"in e||"OTransition"in e}(),p="ontouchstart"in window,h="mousedown"+(p?" touchstart":""),f="mousemove.clockpicker"+(p?" touchmove.clockpicker":""),m="mouseup.clockpicker"+(p?" touchend.clockpicker":""),g=navigator.vibrate?"vibrate":navigator.webkitVibrate?"webkitVibrate":null,v=0,y=100,b=80,C=54,w=13,x=2*y,S=u?350:1,_=['<div class="popover clockpicker-popover">','<div class="arrow"></div>','<div class="popover-title">','<span class="clockpicker-span-hours text-primary"></span>'," : ",'<span class="clockpicker-span-minutes"></span>','<span class="clockpicker-span-am-pm"></span>',"</div>",'<div class="popover-content">','<div class="clockpicker-plate">','<div class="clockpicker-canvas"></div>','<div class="clockpicker-dial clockpicker-hours"></div>','<div class="clockpicker-dial clockpicker-minutes clockpicker-dial-out"></div>',"</div>",'<span class="clockpicker-am-pm-block">',"</span>","</div>","</div>"].join("");n.DEFAULTS={"default":"",fromnow:0,placement:"bottom",align:"left",donetext:"Done",autoclose:!1,twelvehour:!1,vibrate:!0},n.prototype.toggle=function(){this[this.isShown?"hide":"show"]()},n.prototype.locate=function(){var e=this.element,t=this.popover,o=e.offset(),n=e.outerWidth(),r=e.outerHeight(),i=this.options.placement,a=this.options.align,s={};switch(t.show(),i){case"bottom":s.top=o.top+r;break;case"right":s.left=o.left+n;break;case"top":s.top=o.top-t.outerHeight();break;case"left":s.left=o.left-t.outerWidth()}switch(a){case"left":s.left=o.left;break;case"right":s.left=o.left+n-t.outerWidth();break;case"top":s.top=o.top;break;case"bottom":s.top=o.top+r-t.outerHeight()}t.css(s)},n.prototype.show=function(){if(!this.isShown){r(this.options.beforeShow);var e=this;this.isAppended||(i=a(document.body).append(this.popover),s.on("resize.clockpicker"+this.id,function(){e.isShown&&e.locate()}),this.isAppended=!0);var o=((this.input.prop("value")||this.options["default"]||"")+"").split(":");if("now"===o[0]){var n=new Date(+new Date+this.options.fromnow);o=[n.getHours(),n.getMinutes()]}this.hours=+o[0]||0,this.minutes=+o[1]||0,this.spanHours.html(t(this.hours)),this.spanMinutes.html(t(this.minutes)),this.toggleView("hours"),this.locate(),this.isShown=!0,l.on("click.clockpicker."+this.id+" focusin.clockpicker."+this.id,function(t){var o=a(t.target);0===o.closest(e.popover).length&&0===o.closest(e.addon).length&&0===o.closest(e.input).length&&e.hide()}),l.on("keyup.clockpicker."+this.id,function(t){27===t.keyCode&&e.hide()}),r(this.options.afterShow)}},n.prototype.hide=function(){r(this.options.beforeHide),this.isShown=!1,l.off("click.clockpicker."+this.id+" focusin.clockpicker."+this.id),l.off("keyup.clockpicker."+this.id),this.popover.hide(),r(this.options.afterHide)},n.prototype.toggleView=function(e,t){var o=!1;"minutes"===e&&"visible"===a(this.hoursView).css("visibility")&&(r(this.options.beforeHourSelect),o=!0);var n="hours"===e,i=n?this.hoursView:this.minutesView,s=n?this.minutesView:this.hoursView;this.currentView=e,this.spanHours.toggleClass("text-primary",n),this.spanMinutes.toggleClass("text-primary",!n),s.addClass("clockpicker-dial-out"),i.css("visibility","visible").removeClass("clockpicker-dial-out"),this.resetClock(t),clearTimeout(this.toggleViewTimer),this.toggleViewTimer=setTimeout(function(){s.css("visibility","hidden")},S),o&&r(this.options.afterHourSelect)},n.prototype.resetClock=function(e){var t=this.currentView,o=this[t],n="hours"===t,r=Math.PI/(n?6:30),i=o*r,a=n&&o>0&&o<13?C:b,s=Math.sin(i)*a,l=-Math.cos(i)*a,c=this;d&&e?(c.canvas.addClass("clockpicker-canvas-out"),setTimeout(function(){c.canvas.removeClass("clockpicker-canvas-out"),c.setHand(s,l)},e)):this.setHand(s,l)},n.prototype.setHand=function(e,o,n,r){var i,s=Math.atan2(e,-o),l="hours"===this.currentView,c=Math.PI/(l||n?6:30),u=Math.sqrt(e*e+o*o),p=this.options,h=l&&u<(b+C)/2,f=h?C:b;if(p.twelvehour&&(f=b),s<0&&(s=2*Math.PI+s),i=Math.round(s/c),s=i*c,p.twelvehour?l?0===i&&(i=12):(n&&(i*=5),60===i&&(i=0)):l?(12===i&&(i=0),i=h?0===i?12:i:0===i?0:i+12):(n&&(i*=5),60===i&&(i=0)),this[this.currentView]!==i&&g&&this.options.vibrate&&(this.vibrateTimer||(navigator[g](10),this.vibrateTimer=setTimeout(a.proxy(function(){this.vibrateTimer=null},this),100))),this[this.currentView]=i,this[l?"spanHours":"spanMinutes"].html(t(i)),!d)return void this[l?"hoursView":"minutesView"].find(".clockpicker-tick").each(function(){var e=a(this);e.toggleClass("active",i===+e.html())});r||!l&&i%5?(this.g.insertBefore(this.hand,this.bearing),this.g.insertBefore(this.bg,this.fg),this.bg.setAttribute("class","clockpicker-canvas-bg clockpicker-canvas-bg-trans")):(this.g.insertBefore(this.hand,this.bg),this.g.insertBefore(this.fg,this.bg),this.bg.setAttribute("class","clockpicker-canvas-bg"));var m=Math.sin(s)*f,v=-Math.cos(s)*f;this.hand.setAttribute("x2",m),this.hand.setAttribute("y2",v),this.bg.setAttribute("cx",m),this.bg.setAttribute("cy",v),this.fg.setAttribute("cx",m),this.fg.setAttribute("cy",v)},n.prototype.done=function(){r(this.options.beforeDone),this.hide();var e=this.input.prop("value"),o=t(this.hours)+":"+t(this.minutes);this.options.twelvehour&&(o+=this.amOrPm),this.input.prop("value",o),o!==e&&(this.input.trigger("change"),this.isInput||this.element.trigger("change")),this.options.autoclose&&this.input.trigger("blur"),r(this.options.afterDone)},n.prototype.remove=function(){this.element.removeData("clockpicker"),this.input.off("focus.clockpicker click.clockpicker"),this.addon.off("click.clockpicker"),this.isShown&&this.hide(),this.isAppended&&(s.off("resize.clockpicker"+this.id),this.popover.remove())},a.fn.clockpicker=function(e){var t=Array.prototype.slice.call(arguments,1);return this.each(function(){var o=a(this),r=o.data("clockpicker");if(r)"function"==typeof r[e]&&r[e].apply(r,t);else{var i=a.extend({},n.DEFAULTS,o.data(),"object"==typeof e&&e);o.data("clockpicker",new n(o,i))}})}}(),/*!
 * Select2 4.0.2
 * https://select2.github.io
 *
 * Released under the MIT license
 * https://github.com/select2/select2/blob/master/LICENSE.md
 */
function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof exports?require("jquery"):jQuery)}(function(e){var t=function(){if(e&&e.fn&&e.fn.select2&&e.fn.select2.amd)var t=e.fn.select2.amd;var t;/*!
 * jQuery Mousewheel 3.1.13
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 */
return function(){if(!t||!t.requirejs){t?o=t:t={};/**
 * @license almond 0.3.1 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */
var e,o,n;!function(t){function r(e,t){return C.call(e,t)}function i(e,t){var o,n,r,i,a,s,l,c,d,u,p,h=t&&t.split("/"),f=y.map,m=f&&f["*"]||{};if(e&&"."===e.charAt(0))if(t){for(e=e.split("/"),a=e.length-1,y.nodeIdCompat&&x.test(e[a])&&(e[a]=e[a].replace(x,"")),e=h.slice(0,h.length-1).concat(e),d=0;d<e.length;d+=1)if("."===(p=e[d]))e.splice(d,1),d-=1;else if(".."===p){if(1===d&&(".."===e[2]||".."===e[0]))break;d>0&&(e.splice(d-1,2),d-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((h||m)&&f){for(o=e.split("/"),d=o.length;d>0;d-=1){if(n=o.slice(0,d).join("/"),h)for(u=h.length;u>0;u-=1)if((r=f[h.slice(0,u).join("/")])&&(r=r[n])){i=r,s=d;break}if(i)break;!l&&m&&m[n]&&(l=m[n],c=d)}!i&&l&&(i=l,s=c),i&&(o.splice(0,s,i),e=o.join("/"))}return e}function a(e,o){return function(){var n=w.call(arguments,0);return"string"!=typeof n[0]&&1===n.length&&n.push(null),h.apply(t,n.concat([e,o]))}}function s(e){return function(t){return i(t,e)}}function l(e){return function(t){g[e]=t}}function c(e){if(r(v,e)){var o=v[e];delete v[e],b[e]=!0,p.apply(t,o)}if(!r(g,e)&&!r(b,e))throw new Error("No "+e);return g[e]}function d(e){var t,o=e?e.indexOf("!"):-1;return o>-1&&(t=e.substring(0,o),e=e.substring(o+1,e.length)),[t,e]}function u(e){return function(){return y&&y.config&&y.config[e]||{}}}var p,h,f,m,g={},v={},y={},b={},C=Object.prototype.hasOwnProperty,w=[].slice,x=/\.js$/;f=function(e,t){var o,n=d(e),r=n[0];return e=n[1],r&&(r=i(r,t),o=c(r)),r?e=o&&o.normalize?o.normalize(e,s(t)):i(e,t):(e=i(e,t),n=d(e),r=n[0],e=n[1],r&&(o=c(r))),{f:r?r+"!"+e:e,n:e,pr:r,p:o}},m={require:function(e){return a(e)},exports:function(e){var t=g[e];return void 0!==t?t:g[e]={}},module:function(e){return{id:e,uri:"",exports:g[e],config:u(e)}}},p=function(e,o,n,i){var s,d,u,p,h,y,C=[],w=typeof n;if(i=i||e,"undefined"===w||"function"===w){for(o=!o.length&&n.length?["require","exports","module"]:o,h=0;h<o.length;h+=1)if(p=f(o[h],i),"require"===(d=p.f))C[h]=m.require(e);else if("exports"===d)C[h]=m.exports(e),y=!0;else if("module"===d)s=C[h]=m.module(e);else if(r(g,d)||r(v,d)||r(b,d))C[h]=c(d);else{if(!p.p)throw new Error(e+" missing "+d);p.p.load(p.n,a(i,!0),l(d),{}),C[h]=g[d]}u=n?n.apply(g[e],C):undefined,e&&(s&&s.exports!==t&&s.exports!==g[e]?g[e]=s.exports:u===t&&y||(g[e]=u))}else e&&(g[e]=n)},e=o=h=function(e,o,n,r,i){if("string"==typeof e)return m[e]?m[e](o):c(f(e,o).f);if(!e.splice){if(y=e,y.deps&&h(y.deps,y.callback),!o)return;o.splice?(e=o,o=n,n=null):e=t}return o=o||function(){},"function"==typeof n&&(n=r,r=i),r?p(t,e,o,n):setTimeout(function(){p(t,e,o,n)},4),h},h.config=function(e){return h(e)},e._defined=g,n=function(e,t,o){if("string"!=typeof e)throw new Error("See almond README: incorrect module build, no module name");t.splice||(o=t,t=[]),r(g,e)||r(v,e)||(v[e]=[e,t,o])},n.amd={jQuery:!0}}(),t.requirejs=e,t.require=o,t.define=n}}(),t.define("almond",function(){}),t.define("jquery",[],function(){var t=e||$;return null==t&&console&&console.error&&console.error("Select2: An instance of jQuery or a jQuery-compatible library was not found. Make sure that you are including jQuery before Select2 on your web page."),t}),t.define("select2/utils",["jquery"],function(e){function t(e){var t=e.prototype,o=[];for(var n in t){"function"==typeof t[n]&&("constructor"!==n&&o.push(n))}return o}var o={};o.Extend=function(e,t){function o(){this.constructor=e}var n={}.hasOwnProperty;for(var r in t)n.call(t,r)&&(e[r]=t[r]);return o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype,e},o.Decorate=function(e,o){function n(){var t=Array.prototype.unshift,n=o.prototype.constructor.length,r=e.prototype.constructor;n>0&&(t.call(arguments,e.prototype.constructor),r=o.prototype.constructor),r.apply(this,arguments)}function r(){this.constructor=n}var i=t(o),a=t(e);o.displayName=e.displayName,n.prototype=new r;for(var s=0;s<a.length;s++){var l=a[s];n.prototype[l]=e.prototype[l]}for(var c=(function(e){var t=function(){};e in n.prototype&&(t=n.prototype[e]);var r=o.prototype[e];return function(){return Array.prototype.unshift.call(arguments,t),r.apply(this,arguments)}}),d=0;d<i.length;d++){var u=i[d];n.prototype[u]=c(u)}return n};var n=function(){this.listeners={}};return n.prototype.on=function(e,t){this.listeners=this.listeners||{},e in this.listeners?this.listeners[e].push(t):this.listeners[e]=[t]},n.prototype.trigger=function(e){var t=Array.prototype.slice;this.listeners=this.listeners||{},e in this.listeners&&this.invoke(this.listeners[e],t.call(arguments,1)),"*"in this.listeners&&this.invoke(this.listeners["*"],arguments)},n.prototype.invoke=function(e,t){for(var o=0,n=e.length;o<n;o++)e[o].apply(this,t)},o.Observable=n,o.generateChars=function(e){for(var t="",o=0;o<e;o++){t+=Math.floor(36*Math.random()).toString(36)}return t},o.bind=function(e,t){return function(){e.apply(t,arguments)}},o._convertData=function(e){for(var t in e){var o=t.split("-"),n=e;if(1!==o.length){for(var r=0;r<o.length;r++){var i=o[r];i=i.substring(0,1).toLowerCase()+i.substring(1),i in n||(n[i]={}),r==o.length-1&&(n[i]=e[t]),n=n[i]}delete e[t]}}return e},o.hasScroll=function(t,o){var n=e(o),r=o.style.overflowX,i=o.style.overflowY;return(r!==i||"hidden"!==i&&"visible"!==i)&&("scroll"===r||"scroll"===i||(n.innerHeight()<o.scrollHeight||n.innerWidth()<o.scrollWidth))},o.escapeMarkup=function(e){var t={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return"string"!=typeof e?e:String(e).replace(/[&<>"'\/\\]/g,function(e){return t[e]})},o.appendMany=function(t,o){if("1.7"===e.fn.jquery.substr(0,3)){var n=e();e.map(o,function(e){n=n.add(e)}),o=n}t.append(o)},o}),t.define("select2/results",["jquery","./utils"],function(e,t){function o(e,t,n){this.$element=e,this.data=n,this.options=t,o.__super__.constructor.call(this)}return t.Extend(o,t.Observable),o.prototype.render=function(){var t=e('<ul class="select2-results__options" role="tree"></ul>');return this.options.get("multiple")&&t.attr("aria-multiselectable","true"),this.$results=t,t},o.prototype.clear=function(){this.$results.empty()},o.prototype.displayMessage=function(t){var o=this.options.get("escapeMarkup");this.clear(),this.hideLoading();var n=e('<li role="treeitem" aria-live="assertive" class="select2-results__option"></li>'),r=this.options.get("translations").get(t.message);n.append(o(r(t.args))),n[0].className+=" select2-results__message",this.$results.append(n)},o.prototype.hideMessages=function(){this.$results.find(".select2-results__message").remove()},o.prototype.append=function(e){this.hideLoading();var t=[];if(null==e.results||0===e.results.length)return void(0===this.$results.children().length&&this.trigger("results:message",{message:"noResults"}));e.results=this.sort(e.results);for(var o=0;o<e.results.length;o++){var n=e.results[o],r=this.option(n);t.push(r)}this.$results.append(t)},o.prototype.position=function(e,t){t.find(".select2-results").append(e)},o.prototype.sort=function(e){return this.options.get("sorter")(e)},o.prototype.setClasses=function(){var t=this;this.data.current(function(o){var n=e.map(o,function(e){return e.id.toString()}),r=t.$results.find(".select2-results__option[aria-selected]");r.each(function(){var t=e(this),o=e.data(this,"data"),r=""+o.id;null!=o.element&&o.element.selected||null==o.element&&e.inArray(r,n)>-1?t.attr("aria-selected","true"):t.attr("aria-selected","false")});var i=r.filter("[aria-selected=true]");i.length>0?i.first().trigger("mouseenter"):r.first().trigger("mouseenter")})},o.prototype.showLoading=function(e){this.hideLoading();var t=this.options.get("translations").get("searching"),o={disabled:!0,loading:!0,text:t(e)},n=this.option(o);n.className+=" loading-results",this.$results.prepend(n)},o.prototype.hideLoading=function(){this.$results.find(".loading-results").remove()},o.prototype.option=function(t){var o=document.createElement("li");o.className="select2-results__option";var n={role:"treeitem","aria-selected":"false"};t.disabled&&(delete n["aria-selected"],n["aria-disabled"]="true"),null==t.id&&delete n["aria-selected"],null!=t._resultId&&(o.id=t._resultId),t.title&&(o.title=t.title),t.children&&(n.role="group",n["aria-label"]=t.text,delete n["aria-selected"]);for(var r in n){var i=n[r];o.setAttribute(r,i)}if(t.children){var a=e(o),s=document.createElement("strong");s.className="select2-results__group";e(s);this.template(t,s);for(var l=[],c=0;c<t.children.length;c++){var d=t.children[c],u=this.option(d);l.push(u)}var p=e("<ul></ul>",{"class":"select2-results__options select2-results__options--nested"});p.append(l),a.append(s),a.append(p)}else this.template(t,o);return e.data(o,"data",t),o},o.prototype.bind=function(t){var o=this,n=t.id+"-results";this.$results.attr("id",n),t.on("results:all",function(e){o.clear(),o.append(e.data),t.isOpen()&&o.setClasses()}),t.on("results:append",function(e){o.append(e.data),t.isOpen()&&o.setClasses()}),t.on("query",function(e){o.hideMessages(),o.showLoading(e)}),t.on("select",function(){t.isOpen()&&o.setClasses()}),t.on("unselect",function(){t.isOpen()&&o.setClasses()}),t.on("open",function(){o.$results.attr("aria-expanded","true"),o.$results.attr("aria-hidden","false"),o.setClasses(),o.ensureHighlightVisible()}),t.on("close",function(){o.$results.attr("aria-expanded","false"),o.$results.attr("aria-hidden","true"),o.$results.removeAttr("aria-activedescendant")}),t.on("results:toggle",function(){var e=o.getHighlightedResults();0!==e.length&&e.trigger("mouseup")}),t.on("results:select",function(){var e=o.getHighlightedResults();if(0!==e.length){var t=e.data("data");"true"==e.attr("aria-selected")?o.trigger("close",{}):o.trigger("select",{data:t})}}),t.on("results:previous",function(){var e=o.getHighlightedResults(),t=o.$results.find("[aria-selected]"),n=t.index(e);if(0!==n){var r=n-1;0===e.length&&(r=0);var i=t.eq(r);i.trigger("mouseenter");var a=o.$results.offset().top,s=i.offset().top,l=o.$results.scrollTop()+(s-a);0===r?o.$results.scrollTop(0):s-a<0&&o.$results.scrollTop(l)}}),t.on("results:next",function(){var e=o.getHighlightedResults(),t=o.$results.find("[aria-selected]"),n=t.index(e),r=n+1;if(!(r>=t.length)){var i=t.eq(r);i.trigger("mouseenter");var a=o.$results.offset().top+o.$results.outerHeight(!1),s=i.offset().top+i.outerHeight(!1),l=o.$results.scrollTop()+s-a;0===r?o.$results.scrollTop(0):s>a&&o.$results.scrollTop(l)}}),t.on("results:focus",function(e){e.element.addClass("select2-results__option--highlighted")}),t.on("results:message",function(e){o.displayMessage(e)}),e.fn.mousewheel&&this.$results.on("mousewheel",function(e){var t=o.$results.scrollTop(),n=o.$results.get(0).scrollHeight-t+e.deltaY,r=e.deltaY>0&&t-e.deltaY<=0,i=e.deltaY<0&&n<=o.$results.height();r?(o.$results.scrollTop(0),e.preventDefault(),e.stopPropagation()):i&&(o.$results.scrollTop(o.$results.get(0).scrollHeight-o.$results.height()),e.preventDefault(),e.stopPropagation())}),this.$results.on("mouseup",".select2-results__option[aria-selected]",function(t){var n=e(this),r=n.data("data");if("true"===n.attr("aria-selected"))return void(o.options.get("multiple")?o.trigger("unselect",{originalEvent:t,data:r}):o.trigger("close",{}));o.trigger("select",{originalEvent:t,data:r})}),this.$results.on("mouseenter",".select2-results__option[aria-selected]",function(){var t=e(this).data("data");o.getHighlightedResults().removeClass("select2-results__option--highlighted"),o.trigger("results:focus",{data:t,element:e(this)})})},o.prototype.getHighlightedResults=function(){return this.$results.find(".select2-results__option--highlighted")},o.prototype.destroy=function(){this.$results.remove()},o.prototype.ensureHighlightVisible=function(){var e=this.getHighlightedResults();if(0!==e.length){var t=this.$results.find("[aria-selected]"),o=t.index(e),n=this.$results.offset().top,r=e.offset().top,i=this.$results.scrollTop()+(r-n),a=r-n;i-=2*e.outerHeight(!1),o<=2?this.$results.scrollTop(0):(a>this.$results.outerHeight()||a<0)&&this.$results.scrollTop(i)}},o.prototype.template=function(t,o){var n=this.options.get("templateResult"),r=this.options.get("escapeMarkup"),i=n(t,o);null==i?o.style.display="none":"string"==typeof i?o.innerHTML=r(i):e(o).append(i)},o}),t.define("select2/keys",[],function(){return{BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46}}),t.define("select2/selection/base",["jquery","../utils","../keys"],function(e,t,o){function n(e,t){this.$element=e,this.options=t,n.__super__.constructor.call(this)}return t.Extend(n,t.Observable),n.prototype.render=function(){var t=e('<span class="select2-selection" role="combobox"  aria-haspopup="true" aria-expanded="false"></span>');return this._tabindex=0,null!=this.$element.data("old-tabindex")?this._tabindex=this.$element.data("old-tabindex"):null!=this.$element.attr("tabindex")&&(this._tabindex=this.$element.attr("tabindex")),t.attr("title",this.$element.attr("title")),t.attr("tabindex",this._tabindex),this.$selection=t,t},n.prototype.bind=function(e){var t=this,n=(e.id,e.id+"-results");this.container=e,this.$selection.on("focus",function(e){t.trigger("focus",e)}),this.$selection.on("blur",function(e){t._handleBlur(e)}),this.$selection.on("keydown",function(e){t.trigger("keypress",e),e.which===o.SPACE&&e.preventDefault()}),e.on("results:focus",function(e){t.$selection.attr("aria-activedescendant",e.data._resultId)}),e.on("selection:update",function(e){t.update(e.data)}),e.on("open",function(){t.$selection.attr("aria-expanded","true"),t.$selection.attr("aria-owns",n),t._attachCloseHandler(e)}),e.on("close",function(){t.$selection.attr("aria-expanded","false"),t.$selection.removeAttr("aria-activedescendant"),t.$selection.removeAttr("aria-owns"),t.$selection.focus(),t._detachCloseHandler(e)}),e.on("enable",function(){t.$selection.attr("tabindex",t._tabindex)}),e.on("disable",function(){t.$selection.attr("tabindex","-1")})},n.prototype._handleBlur=function(t){var o=this;window.setTimeout(function(){document.activeElement==o.$selection[0]||e.contains(o.$selection[0],document.activeElement)||o.trigger("blur",t)},1)},n.prototype._attachCloseHandler=function(t){e(document.body).on("mousedown.select2."+t.id,function(t){var o=e(t.target),n=o.closest(".select2");e(".select2.select2-container--open").each(function(){var t=e(this);this!=n[0]&&t.data("element").select2("close")})})},n.prototype._detachCloseHandler=function(t){e(document.body).off("mousedown.select2."+t.id)},n.prototype.position=function(e,t){t.find(".selection").append(e)},n.prototype.destroy=function(){this._detachCloseHandler(this.container)},n.prototype.update=function(){throw new Error("The `update` method must be defined in child classes.")},n}),t.define("select2/selection/single",["jquery","./base","../utils","../keys"],function(e,t,o){function n(){n.__super__.constructor.apply(this,arguments)}return o.Extend(n,t),n.prototype.render=function(){var e=n.__super__.render.call(this);return e.addClass("select2-selection--single"),e.html('<span class="select2-selection__rendered"></span><span class="select2-selection__arrow" role="presentation"><b role="presentation"></b></span>'),e},n.prototype.bind=function(e){var t=this;n.__super__.bind.apply(this,arguments);var o=e.id+"-container";this.$selection.find(".select2-selection__rendered").attr("id",o),this.$selection.attr("aria-labelledby",o),this.$selection.on("mousedown",function(e){1===e.which&&t.trigger("toggle",{originalEvent:e})}),this.$selection.on("focus",function(){}),this.$selection.on("blur",function(){}),e.on("selection:update",function(e){t.update(e.data)})},n.prototype.clear=function(){this.$selection.find(".select2-selection__rendered").empty()},n.prototype.display=function(e,t){var o=this.options.get("templateSelection");return this.options.get("escapeMarkup")(o(e,t))},n.prototype.selectionContainer=function(){return e("<span></span>")},n.prototype.update=function(e){if(0===e.length)return void this.clear();var t=e[0],o=this.$selection.find(".select2-selection__rendered"),n=this.display(t,o);o.empty().append(n),o.prop("title",t.title||t.text)},n}),t.define("select2/selection/multiple",["jquery","./base","../utils"],function(e,t,o){function n(){n.__super__.constructor.apply(this,arguments)}return o.Extend(n,t),n.prototype.render=function(){var e=n.__super__.render.call(this);return e.addClass("select2-selection--multiple"),e.html('<ul class="select2-selection__rendered"></ul>'),e},n.prototype.bind=function(){var t=this;n.__super__.bind.apply(this,arguments),this.$selection.on("click",function(e){t.trigger("toggle",{originalEvent:e})}),this.$selection.on("click",".select2-selection__choice__remove",function(o){if(!t.options.get("disabled")){var n=e(this),r=n.parent(),i=r.data("data");t.trigger("unselect",{originalEvent:o,data:i})}})},n.prototype.clear=function(){this.$selection.find(".select2-selection__rendered").empty()},n.prototype.display=function(e,t){var o=this.options.get("templateSelection");return this.options.get("escapeMarkup")(o(e,t))},n.prototype.selectionContainer=function(){return e('<li class="select2-selection__choice"><span class="select2-selection__choice__remove" role="presentation">&times;</span></li>')},n.prototype.update=function(e){if(this.clear(),0!==e.length){for(var t=[],n=0;n<e.length;n++){var r=e[n],i=this.selectionContainer(),a=this.display(r,i);i.append(a),i.prop("title",r.title||r.text),i.data("data",r),t.push(i)}var s=this.$selection.find(".select2-selection__rendered");o.appendMany(s,t)}},n}),t.define("select2/selection/placeholder",["../utils"],function(){function e(e,t,o){this.placeholder=this.normalizePlaceholder(o.get("placeholder")),e.call(this,t,o)}return e.prototype.normalizePlaceholder=function(e,t){return"string"==typeof t&&(t={id:"",text:t}),t},e.prototype.createPlaceholder=function(e,t){var o=this.selectionContainer();return o.html(this.display(t)),o.addClass("select2-selection__placeholder").removeClass("select2-selection__choice"),o},e.prototype.update=function(e,t){var o=1==t.length&&t[0].id!=this.placeholder.id;if(t.length>1||o)return e.call(this,t);this.clear();var n=this.createPlaceholder(this.placeholder);this.$selection.find(".select2-selection__rendered").append(n)},e}),t.define("select2/selection/allowClear",["jquery","../keys"],function(e,t){function o(){}return o.prototype.bind=function(e,t,o){var n=this;e.call(this,t,o),null==this.placeholder&&this.options.get("debug")&&window.console&&console.error&&console.error("Select2: The `allowClear` option should be used in combination with the `placeholder` option."),this.$selection.on("mousedown",".select2-selection__clear",function(e){n._handleClear(e)}),t.on("keypress",function(e){n._handleKeyboardClear(e,t)})},o.prototype._handleClear=function(e,t){if(!this.options.get("disabled")){var o=this.$selection.find(".select2-selection__clear");if(0!==o.length){t.stopPropagation();for(var n=o.data("data"),r=0;r<n.length;r++){var i={data:n[r]};if(this.trigger("unselect",i),i.prevented)return}this.$element.val(this.placeholder.id).trigger("change"),this.trigger("toggle",{})}}},o.prototype._handleKeyboardClear=function(e,o,n){n.isOpen()||o.which!=t.DELETE&&o.which!=t.BACKSPACE||this._handleClear(o)},o.prototype.update=function(t,o){if(t.call(this,o),!(this.$selection.find(".select2-selection__placeholder").length>0||0===o.length)){var n=e('<span class="select2-selection__clear">&times;</span>');n.data("data",o),this.$selection.find(".select2-selection__rendered").prepend(n)}},o}),t.define("select2/selection/search",["jquery","../utils","../keys"],function(e,t,o){function n(e,t,o){e.call(this,t,o)}return n.prototype.render=function(t){var o=e('<li class="select2-search select2-search--inline"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="textbox" aria-autocomplete="list" /></li>');this.$searchContainer=o,this.$search=o.find("input");var n=t.call(this);return this._transferTabIndex(),n},n.prototype.bind=function(e,t,n){var r=this;e.call(this,t,n),t.on("open",function(){r.$search.trigger("focus")}),t.on("close",function(){r.$search.val(""),r.$search.removeAttr("aria-activedescendant"),r.$search.trigger("focus")}),t.on("enable",function(){r.$search.prop("disabled",!1),r._transferTabIndex()}),t.on("disable",function(){r.$search.prop("disabled",!0)}),t.on("focus",function(){r.$search.trigger("focus")}),t.on("results:focus",function(e){r.$search.attr("aria-activedescendant",e.id)}),this.$selection.on("focusin",".select2-search--inline",function(e){r.trigger("focus",e)}),this.$selection.on("focusout",".select2-search--inline",function(e){r._handleBlur(e)}),this.$selection.on("keydown",".select2-search--inline",function(e){if(e.stopPropagation(),r.trigger("keypress",e),r._keyUpPrevented=e.isDefaultPrevented(),e.which===o.BACKSPACE&&""===r.$search.val()){var t=r.$searchContainer.prev(".select2-selection__choice");if(t.length>0){var n=t.data("data");r.searchRemoveChoice(n),e.preventDefault()}}});var i=document.documentMode,a=i&&i<=11;this.$selection.on("input.searchcheck",".select2-search--inline",function(){if(a)return void r.$selection.off("input.search input.searchcheck");r.$selection.off("keyup.search")}),this.$selection.on("keyup.search input.search",".select2-search--inline",function(e){if(a&&"input"===e.type)return void r.$selection.off("input.search input.searchcheck");var t=e.which;t!=o.SHIFT&&t!=o.CTRL&&t!=o.ALT&&t!=o.TAB&&r.handleSearch(e)})},n.prototype._transferTabIndex=function(){this.$search.attr("tabindex",this.$selection.attr("tabindex")),this.$selection.attr("tabindex","-1")},n.prototype.createPlaceholder=function(e,t){this.$search.attr("placeholder",t.text)},n.prototype.update=function(e,t){var o=this.$search[0]==document.activeElement;this.$search.attr("placeholder",""),e.call(this,t),this.$selection.find(".select2-selection__rendered").append(this.$searchContainer),this.resizeSearch(),o&&this.$search.focus()},n.prototype.handleSearch=function(){if(this.resizeSearch(),!this._keyUpPrevented){var e=this.$search.val();this.trigger("query",{term:e})}this._keyUpPrevented=!1},n.prototype.searchRemoveChoice=function(e,t){this.trigger("unselect",{data:t}),this.$search.val(t.text),this.handleSearch()},n.prototype.resizeSearch=function(){this.$search.css("width","25px");var e="";if(""!==this.$search.attr("placeholder"))e=this.$selection.find(".select2-selection__rendered").innerWidth();else{e=.75*(this.$search.val().length+1)+"em"}this.$search.css("width",e)},n}),t.define("select2/selection/eventRelay",["jquery"],function(e){function t(){}return t.prototype.bind=function(t,o,n){var r=this,i=["open","opening","close","closing","select","selecting","unselect","unselecting"],a=["opening","closing","selecting","unselecting"];t.call(this,o,n),o.on("*",function(t,o){if(-1!==e.inArray(t,i)){o=o||{};var n=e.Event("select2:"+t,{params:o});r.$element.trigger(n),-1!==e.inArray(t,a)&&(o.prevented=n.isDefaultPrevented())}})},t}),t.define("select2/translation",["jquery","require"],function(e,t){function o(e){this.dict=e||{}}return o.prototype.all=function(){return this.dict},o.prototype.get=function(e){return this.dict[e]},o.prototype.extend=function(t){this.dict=e.extend({},t.all(),this.dict)},o._cache={},o.loadPath=function(e){if(!(e in o._cache)){var n=t(e);o._cache[e]=n}return new o(o._cache[e])},o}),t.define("select2/diacritics",[],function(){return{"\u24b6":"A","\uff21":"A","\xc0":"A","\xc1":"A","\xc2":"A","\u1ea6":"A","\u1ea4":"A","\u1eaa":"A","\u1ea8":"A","\xc3":"A","\u0100":"A","\u0102":"A","\u1eb0":"A","\u1eae":"A","\u1eb4":"A","\u1eb2":"A","\u0226":"A","\u01e0":"A","\xc4":"A","\u01de":"A","\u1ea2":"A","\xc5":"A","\u01fa":"A","\u01cd":"A","\u0200":"A","\u0202":"A","\u1ea0":"A","\u1eac":"A","\u1eb6":"A","\u1e00":"A","\u0104":"A","\u023a":"A","\u2c6f":"A","\ua732":"AA","\xc6":"AE","\u01fc":"AE","\u01e2":"AE","\ua734":"AO","\ua736":"AU","\ua738":"AV","\ua73a":"AV","\ua73c":"AY","\u24b7":"B","\uff22":"B","\u1e02":"B","\u1e04":"B","\u1e06":"B","\u0243":"B","\u0182":"B","\u0181":"B","\u24b8":"C","\uff23":"C","\u0106":"C","\u0108":"C","\u010a":"C","\u010c":"C","\xc7":"C","\u1e08":"C","\u0187":"C","\u023b":"C","\ua73e":"C","\u24b9":"D","\uff24":"D","\u1e0a":"D","\u010e":"D","\u1e0c":"D","\u1e10":"D","\u1e12":"D","\u1e0e":"D","\u0110":"D","\u018b":"D","\u018a":"D","\u0189":"D","\ua779":"D","\u01f1":"DZ","\u01c4":"DZ","\u01f2":"Dz","\u01c5":"Dz","\u24ba":"E","\uff25":"E","\xc8":"E","\xc9":"E","\xca":"E","\u1ec0":"E","\u1ebe":"E","\u1ec4":"E","\u1ec2":"E","\u1ebc":"E","\u0112":"E","\u1e14":"E","\u1e16":"E","\u0114":"E","\u0116":"E","\xcb":"E","\u1eba":"E","\u011a":"E","\u0204":"E","\u0206":"E","\u1eb8":"E","\u1ec6":"E","\u0228":"E","\u1e1c":"E","\u0118":"E","\u1e18":"E","\u1e1a":"E","\u0190":"E","\u018e":"E","\u24bb":"F","\uff26":"F","\u1e1e":"F","\u0191":"F","\ua77b":"F","\u24bc":"G","\uff27":"G","\u01f4":"G","\u011c":"G","\u1e20":"G","\u011e":"G","\u0120":"G","\u01e6":"G","\u0122":"G","\u01e4":"G","\u0193":"G","\ua7a0":"G","\ua77d":"G","\ua77e":"G","\u24bd":"H","\uff28":"H","\u0124":"H","\u1e22":"H","\u1e26":"H","\u021e":"H","\u1e24":"H","\u1e28":"H","\u1e2a":"H","\u0126":"H","\u2c67":"H","\u2c75":"H","\ua78d":"H","\u24be":"I","\uff29":"I","\xcc":"I","\xcd":"I","\xce":"I","\u0128":"I","\u012a":"I","\u012c":"I","\u0130":"I","\xcf":"I","\u1e2e":"I","\u1ec8":"I","\u01cf":"I","\u0208":"I","\u020a":"I","\u1eca":"I","\u012e":"I","\u1e2c":"I","\u0197":"I","\u24bf":"J","\uff2a":"J","\u0134":"J","\u0248":"J","\u24c0":"K","\uff2b":"K","\u1e30":"K","\u01e8":"K","\u1e32":"K","\u0136":"K","\u1e34":"K","\u0198":"K","\u2c69":"K","\ua740":"K","\ua742":"K","\ua744":"K","\ua7a2":"K","\u24c1":"L","\uff2c":"L","\u013f":"L","\u0139":"L","\u013d":"L","\u1e36":"L","\u1e38":"L","\u013b":"L","\u1e3c":"L","\u1e3a":"L","\u0141":"L","\u023d":"L","\u2c62":"L","\u2c60":"L","\ua748":"L","\ua746":"L","\ua780":"L","\u01c7":"LJ","\u01c8":"Lj","\u24c2":"M","\uff2d":"M","\u1e3e":"M","\u1e40":"M","\u1e42":"M","\u2c6e":"M","\u019c":"M","\u24c3":"N","\uff2e":"N","\u01f8":"N","\u0143":"N","\xd1":"N","\u1e44":"N","\u0147":"N","\u1e46":"N","\u0145":"N","\u1e4a":"N","\u1e48":"N","\u0220":"N","\u019d":"N","\ua790":"N","\ua7a4":"N","\u01ca":"NJ","\u01cb":"Nj","\u24c4":"O","\uff2f":"O","\xd2":"O","\xd3":"O","\xd4":"O","\u1ed2":"O","\u1ed0":"O","\u1ed6":"O","\u1ed4":"O","\xd5":"O","\u1e4c":"O","\u022c":"O","\u1e4e":"O","\u014c":"O","\u1e50":"O","\u1e52":"O","\u014e":"O","\u022e":"O","\u0230":"O","\xd6":"O","\u022a":"O","\u1ece":"O","\u0150":"O","\u01d1":"O","\u020c":"O","\u020e":"O","\u01a0":"O","\u1edc":"O","\u1eda":"O","\u1ee0":"O","\u1ede":"O","\u1ee2":"O","\u1ecc":"O","\u1ed8":"O","\u01ea":"O","\u01ec":"O","\xd8":"O","\u01fe":"O","\u0186":"O","\u019f":"O","\ua74a":"O","\ua74c":"O","\u01a2":"OI","\ua74e":"OO","\u0222":"OU","\u24c5":"P","\uff30":"P","\u1e54":"P","\u1e56":"P","\u01a4":"P","\u2c63":"P","\ua750":"P","\ua752":"P","\ua754":"P","\u24c6":"Q","\uff31":"Q","\ua756":"Q","\ua758":"Q","\u024a":"Q","\u24c7":"R","\uff32":"R","\u0154":"R","\u1e58":"R","\u0158":"R","\u0210":"R","\u0212":"R","\u1e5a":"R","\u1e5c":"R","\u0156":"R","\u1e5e":"R","\u024c":"R","\u2c64":"R","\ua75a":"R","\ua7a6":"R","\ua782":"R","\u24c8":"S","\uff33":"S","\u1e9e":"S","\u015a":"S","\u1e64":"S","\u015c":"S","\u1e60":"S","\u0160":"S","\u1e66":"S","\u1e62":"S","\u1e68":"S","\u0218":"S","\u015e":"S","\u2c7e":"S","\ua7a8":"S","\ua784":"S","\u24c9":"T","\uff34":"T","\u1e6a":"T","\u0164":"T","\u1e6c":"T","\u021a":"T","\u0162":"T","\u1e70":"T","\u1e6e":"T","\u0166":"T","\u01ac":"T","\u01ae":"T","\u023e":"T","\ua786":"T","\ua728":"TZ","\u24ca":"U","\uff35":"U","\xd9":"U","\xda":"U","\xdb":"U","\u0168":"U","\u1e78":"U","\u016a":"U","\u1e7a":"U","\u016c":"U","\xdc":"U","\u01db":"U","\u01d7":"U","\u01d5":"U","\u01d9":"U","\u1ee6":"U","\u016e":"U","\u0170":"U","\u01d3":"U","\u0214":"U","\u0216":"U","\u01af":"U","\u1eea":"U","\u1ee8":"U","\u1eee":"U","\u1eec":"U","\u1ef0":"U","\u1ee4":"U","\u1e72":"U","\u0172":"U","\u1e76":"U","\u1e74":"U","\u0244":"U","\u24cb":"V","\uff36":"V","\u1e7c":"V","\u1e7e":"V","\u01b2":"V","\ua75e":"V","\u0245":"V","\ua760":"VY","\u24cc":"W","\uff37":"W","\u1e80":"W","\u1e82":"W","\u0174":"W","\u1e86":"W","\u1e84":"W","\u1e88":"W","\u2c72":"W","\u24cd":"X","\uff38":"X","\u1e8a":"X","\u1e8c":"X","\u24ce":"Y","\uff39":"Y","\u1ef2":"Y","\xdd":"Y","\u0176":"Y","\u1ef8":"Y","\u0232":"Y","\u1e8e":"Y","\u0178":"Y","\u1ef6":"Y","\u1ef4":"Y","\u01b3":"Y","\u024e":"Y","\u1efe":"Y","\u24cf":"Z","\uff3a":"Z","\u0179":"Z","\u1e90":"Z","\u017b":"Z","\u017d":"Z","\u1e92":"Z","\u1e94":"Z","\u01b5":"Z","\u0224":"Z","\u2c7f":"Z","\u2c6b":"Z","\ua762":"Z","\u24d0":"a","\uff41":"a","\u1e9a":"a","\xe0":"a","\xe1":"a","\xe2":"a","\u1ea7":"a","\u1ea5":"a","\u1eab":"a","\u1ea9":"a","\xe3":"a","\u0101":"a","\u0103":"a","\u1eb1":"a","\u1eaf":"a","\u1eb5":"a","\u1eb3":"a","\u0227":"a","\u01e1":"a","\xe4":"a","\u01df":"a","\u1ea3":"a","\xe5":"a","\u01fb":"a","\u01ce":"a","\u0201":"a","\u0203":"a","\u1ea1":"a","\u1ead":"a","\u1eb7":"a","\u1e01":"a","\u0105":"a","\u2c65":"a","\u0250":"a","\ua733":"aa","\xe6":"ae","\u01fd":"ae","\u01e3":"ae","\ua735":"ao","\ua737":"au","\ua739":"av","\ua73b":"av","\ua73d":"ay","\u24d1":"b","\uff42":"b","\u1e03":"b","\u1e05":"b","\u1e07":"b","\u0180":"b","\u0183":"b","\u0253":"b","\u24d2":"c","\uff43":"c","\u0107":"c","\u0109":"c","\u010b":"c","\u010d":"c","\xe7":"c","\u1e09":"c","\u0188":"c","\u023c":"c","\ua73f":"c","\u2184":"c","\u24d3":"d","\uff44":"d","\u1e0b":"d","\u010f":"d","\u1e0d":"d","\u1e11":"d","\u1e13":"d","\u1e0f":"d","\u0111":"d","\u018c":"d","\u0256":"d","\u0257":"d","\ua77a":"d","\u01f3":"dz","\u01c6":"dz","\u24d4":"e","\uff45":"e","\xe8":"e","\xe9":"e","\xea":"e","\u1ec1":"e","\u1ebf":"e","\u1ec5":"e","\u1ec3":"e","\u1ebd":"e","\u0113":"e","\u1e15":"e","\u1e17":"e","\u0115":"e","\u0117":"e","\xeb":"e","\u1ebb":"e","\u011b":"e","\u0205":"e","\u0207":"e","\u1eb9":"e","\u1ec7":"e","\u0229":"e","\u1e1d":"e","\u0119":"e","\u1e19":"e","\u1e1b":"e","\u0247":"e","\u025b":"e","\u01dd":"e","\u24d5":"f","\uff46":"f","\u1e1f":"f","\u0192":"f","\ua77c":"f","\u24d6":"g","\uff47":"g","\u01f5":"g","\u011d":"g","\u1e21":"g","\u011f":"g","\u0121":"g","\u01e7":"g","\u0123":"g","\u01e5":"g","\u0260":"g","\ua7a1":"g","\u1d79":"g","\ua77f":"g","\u24d7":"h","\uff48":"h","\u0125":"h","\u1e23":"h","\u1e27":"h","\u021f":"h","\u1e25":"h","\u1e29":"h","\u1e2b":"h","\u1e96":"h","\u0127":"h","\u2c68":"h","\u2c76":"h","\u0265":"h","\u0195":"hv","\u24d8":"i","\uff49":"i","\xec":"i","\xed":"i","\xee":"i","\u0129":"i","\u012b":"i","\u012d":"i","\xef":"i","\u1e2f":"i","\u1ec9":"i","\u01d0":"i","\u0209":"i","\u020b":"i","\u1ecb":"i","\u012f":"i","\u1e2d":"i","\u0268":"i","\u0131":"i","\u24d9":"j","\uff4a":"j","\u0135":"j","\u01f0":"j","\u0249":"j","\u24da":"k","\uff4b":"k","\u1e31":"k","\u01e9":"k","\u1e33":"k","\u0137":"k","\u1e35":"k","\u0199":"k","\u2c6a":"k","\ua741":"k","\ua743":"k","\ua745":"k","\ua7a3":"k","\u24db":"l","\uff4c":"l","\u0140":"l","\u013a":"l","\u013e":"l","\u1e37":"l","\u1e39":"l","\u013c":"l","\u1e3d":"l","\u1e3b":"l","\u017f":"l","\u0142":"l","\u019a":"l","\u026b":"l","\u2c61":"l","\ua749":"l","\ua781":"l","\ua747":"l","\u01c9":"lj","\u24dc":"m","\uff4d":"m","\u1e3f":"m","\u1e41":"m","\u1e43":"m","\u0271":"m","\u026f":"m","\u24dd":"n","\uff4e":"n","\u01f9":"n","\u0144":"n","\xf1":"n","\u1e45":"n","\u0148":"n","\u1e47":"n","\u0146":"n","\u1e4b":"n","\u1e49":"n","\u019e":"n","\u0272":"n","\u0149":"n","\ua791":"n","\ua7a5":"n","\u01cc":"nj","\u24de":"o","\uff4f":"o","\xf2":"o","\xf3":"o","\xf4":"o","\u1ed3":"o","\u1ed1":"o","\u1ed7":"o","\u1ed5":"o","\xf5":"o","\u1e4d":"o","\u022d":"o","\u1e4f":"o","\u014d":"o","\u1e51":"o","\u1e53":"o","\u014f":"o","\u022f":"o","\u0231":"o","\xf6":"o","\u022b":"o","\u1ecf":"o","\u0151":"o","\u01d2":"o","\u020d":"o","\u020f":"o","\u01a1":"o","\u1edd":"o","\u1edb":"o","\u1ee1":"o","\u1edf":"o","\u1ee3":"o","\u1ecd":"o","\u1ed9":"o","\u01eb":"o","\u01ed":"o","\xf8":"o","\u01ff":"o","\u0254":"o","\ua74b":"o","\ua74d":"o","\u0275":"o","\u01a3":"oi","\u0223":"ou","\ua74f":"oo","\u24df":"p","\uff50":"p","\u1e55":"p","\u1e57":"p","\u01a5":"p","\u1d7d":"p","\ua751":"p","\ua753":"p","\ua755":"p","\u24e0":"q","\uff51":"q","\u024b":"q","\ua757":"q","\ua759":"q","\u24e1":"r","\uff52":"r","\u0155":"r","\u1e59":"r","\u0159":"r","\u0211":"r","\u0213":"r","\u1e5b":"r","\u1e5d":"r","\u0157":"r","\u1e5f":"r","\u024d":"r","\u027d":"r","\ua75b":"r","\ua7a7":"r","\ua783":"r","\u24e2":"s","\uff53":"s","\xdf":"s","\u015b":"s","\u1e65":"s","\u015d":"s","\u1e61":"s","\u0161":"s","\u1e67":"s","\u1e63":"s","\u1e69":"s","\u0219":"s","\u015f":"s","\u023f":"s","\ua7a9":"s","\ua785":"s","\u1e9b":"s","\u24e3":"t","\uff54":"t","\u1e6b":"t","\u1e97":"t","\u0165":"t",
"\u1e6d":"t","\u021b":"t","\u0163":"t","\u1e71":"t","\u1e6f":"t","\u0167":"t","\u01ad":"t","\u0288":"t","\u2c66":"t","\ua787":"t","\ua729":"tz","\u24e4":"u","\uff55":"u","\xf9":"u","\xfa":"u","\xfb":"u","\u0169":"u","\u1e79":"u","\u016b":"u","\u1e7b":"u","\u016d":"u","\xfc":"u","\u01dc":"u","\u01d8":"u","\u01d6":"u","\u01da":"u","\u1ee7":"u","\u016f":"u","\u0171":"u","\u01d4":"u","\u0215":"u","\u0217":"u","\u01b0":"u","\u1eeb":"u","\u1ee9":"u","\u1eef":"u","\u1eed":"u","\u1ef1":"u","\u1ee5":"u","\u1e73":"u","\u0173":"u","\u1e77":"u","\u1e75":"u","\u0289":"u","\u24e5":"v","\uff56":"v","\u1e7d":"v","\u1e7f":"v","\u028b":"v","\ua75f":"v","\u028c":"v","\ua761":"vy","\u24e6":"w","\uff57":"w","\u1e81":"w","\u1e83":"w","\u0175":"w","\u1e87":"w","\u1e85":"w","\u1e98":"w","\u1e89":"w","\u2c73":"w","\u24e7":"x","\uff58":"x","\u1e8b":"x","\u1e8d":"x","\u24e8":"y","\uff59":"y","\u1ef3":"y","\xfd":"y","\u0177":"y","\u1ef9":"y","\u0233":"y","\u1e8f":"y","\xff":"y","\u1ef7":"y","\u1e99":"y","\u1ef5":"y","\u01b4":"y","\u024f":"y","\u1eff":"y","\u24e9":"z","\uff5a":"z","\u017a":"z","\u1e91":"z","\u017c":"z","\u017e":"z","\u1e93":"z","\u1e95":"z","\u01b6":"z","\u0225":"z","\u0240":"z","\u2c6c":"z","\ua763":"z","\u0386":"\u0391","\u0388":"\u0395","\u0389":"\u0397","\u038a":"\u0399","\u03aa":"\u0399","\u038c":"\u039f","\u038e":"\u03a5","\u03ab":"\u03a5","\u038f":"\u03a9","\u03ac":"\u03b1","\u03ad":"\u03b5","\u03ae":"\u03b7","\u03af":"\u03b9","\u03ca":"\u03b9","\u0390":"\u03b9","\u03cc":"\u03bf","\u03cd":"\u03c5","\u03cb":"\u03c5","\u03b0":"\u03c5","\u03c9":"\u03c9","\u03c2":"\u03c3"}}),t.define("select2/data/base",["../utils"],function(e){function t(){t.__super__.constructor.call(this)}return e.Extend(t,e.Observable),t.prototype.current=function(){throw new Error("The `current` method must be defined in child classes.")},t.prototype.query=function(){throw new Error("The `query` method must be defined in child classes.")},t.prototype.bind=function(){},t.prototype.destroy=function(){},t.prototype.generateResultId=function(t,o){var n=t.id+"-result-";return n+=e.generateChars(4),null!=o.id?n+="-"+o.id.toString():n+="-"+e.generateChars(4),n},t}),t.define("select2/data/select",["./base","../utils","jquery"],function(e,t,o){function n(e,t){this.$element=e,this.options=t,n.__super__.constructor.call(this)}return t.Extend(n,e),n.prototype.current=function(e){var t=[],n=this;this.$element.find(":selected").each(function(){var e=o(this),r=n.item(e);t.push(r)}),e(t)},n.prototype.select=function(e){var t=this;if(e.selected=!0,o(e.element).is("option"))return e.element.selected=!0,void this.$element.trigger("change");if(this.$element.prop("multiple"))this.current(function(n){var r=[];e=[e],e.push.apply(e,n);for(var i=0;i<e.length;i++){var a=e[i].id;-1===o.inArray(a,r)&&r.push(a)}t.$element.val(r),t.$element.trigger("change")});else{var n=e.id;this.$element.val(n),this.$element.trigger("change")}},n.prototype.unselect=function(e){var t=this;if(this.$element.prop("multiple")){if(e.selected=!1,o(e.element).is("option"))return e.element.selected=!1,void this.$element.trigger("change");this.current(function(n){for(var r=[],i=0;i<n.length;i++){var a=n[i].id;a!==e.id&&-1===o.inArray(a,r)&&r.push(a)}t.$element.val(r),t.$element.trigger("change")})}},n.prototype.bind=function(e){var t=this;this.container=e,e.on("select",function(e){t.select(e.data)}),e.on("unselect",function(e){t.unselect(e.data)})},n.prototype.destroy=function(){this.$element.find("*").each(function(){o.removeData(this,"data")})},n.prototype.query=function(e,t){var n=[],r=this;this.$element.children().each(function(){var t=o(this);if(t.is("option")||t.is("optgroup")){var i=r.item(t),a=r.matches(e,i);null!==a&&n.push(a)}}),t({results:n})},n.prototype.addOptions=function(e){t.appendMany(this.$element,e)},n.prototype.option=function(e){var t;e.children?(t=document.createElement("optgroup"),t.label=e.text):(t=document.createElement("option"),t.textContent!==undefined?t.textContent=e.text:t.innerText=e.text),e.id&&(t.value=e.id),e.disabled&&(t.disabled=!0),e.selected&&(t.selected=!0),e.title&&(t.title=e.title);var n=o(t),r=this._normalizeItem(e);return r.element=t,o.data(t,"data",r),n},n.prototype.item=function(e){var t={};if(null!=(t=o.data(e[0],"data")))return t;if(e.is("option"))t={id:e.val(),text:e.text(),disabled:e.prop("disabled"),selected:e.prop("selected"),title:e.prop("title")};else if(e.is("optgroup")){t={text:e.prop("label"),children:[],title:e.prop("title")};for(var n=e.children("option"),r=[],i=0;i<n.length;i++){var a=o(n[i]),s=this.item(a);r.push(s)}t.children=r}return t=this._normalizeItem(t),t.element=e[0],o.data(e[0],"data",t),t},n.prototype._normalizeItem=function(e){o.isPlainObject(e)||(e={id:e,text:e}),e=o.extend({},{text:""},e);var t={selected:!1,disabled:!1};return null!=e.id&&(e.id=e.id.toString()),null!=e.text&&(e.text=e.text.toString()),null==e._resultId&&e.id&&null!=this.container&&(e._resultId=this.generateResultId(this.container,e)),o.extend({},t,e)},n.prototype.matches=function(e,t){return this.options.get("matcher")(e,t)},n}),t.define("select2/data/array",["./select","../utils","jquery"],function(e,t,o){function n(e,t){var o=t.get("data")||[];n.__super__.constructor.call(this,e,t),this.addOptions(this.convertToOptions(o))}return t.Extend(n,e),n.prototype.select=function(e){var t=this.$element.find("option").filter(function(t,o){return o.value==e.id.toString()});0===t.length&&(t=this.option(e),this.addOptions(t)),n.__super__.select.call(this,e)},n.prototype.convertToOptions=function(e){function n(e){return function(){return o(this).val()==e.id}}for(var r=this,i=this.$element.find("option"),a=i.map(function(){return r.item(o(this)).id}).get(),s=[],l=0;l<e.length;l++){var c=this._normalizeItem(e[l]);if(o.inArray(c.id,a)>=0){var d=i.filter(n(c)),u=this.item(d),p=o.extend(!0,{},c,u),h=this.option(p);d.replaceWith(h)}else{var f=this.option(c);if(c.children){var m=this.convertToOptions(c.children);t.appendMany(f,m)}s.push(f)}}return s},n}),t.define("select2/data/ajax",["./array","../utils","jquery"],function(e,t,o){function n(e,t){this.ajaxOptions=this._applyDefaults(t.get("ajax")),null!=this.ajaxOptions.processResults&&(this.processResults=this.ajaxOptions.processResults),n.__super__.constructor.call(this,e,t)}return t.Extend(n,e),n.prototype._applyDefaults=function(e){var t={data:function(e){return o.extend({},e,{q:e.term})},transport:function(e,t,n){var r=o.ajax(e);return r.then(t),r.fail(n),r}};return o.extend({},t,e,!0)},n.prototype.processResults=function(e){return e},n.prototype.query=function(e,t){function n(){var n=i.transport(i,function(n){var i=r.processResults(n,e);r.options.get("debug")&&window.console&&console.error&&(i&&i.results&&o.isArray(i.results)||console.error("Select2: The AJAX results did not return an array in the `results` key of the response.")),t(i)},function(){r.trigger("results:message",{message:"errorLoading"})});r._request=n}var r=this;null!=this._request&&(o.isFunction(this._request.abort)&&this._request.abort(),this._request=null);var i=o.extend({type:"GET"},this.ajaxOptions);"function"==typeof i.url&&(i.url=i.url.call(this.$element,e)),"function"==typeof i.data&&(i.data=i.data.call(this.$element,e)),this.ajaxOptions.delay&&""!==e.term?(this._queryTimeout&&window.clearTimeout(this._queryTimeout),this._queryTimeout=window.setTimeout(n,this.ajaxOptions.delay)):n()},n}),t.define("select2/data/tags",["jquery"],function(e){function t(t,o,n){var r=n.get("tags"),i=n.get("createTag");i!==undefined&&(this.createTag=i);var a=n.get("insertTag");if(a!==undefined&&(this.insertTag=a),t.call(this,o,n),e.isArray(r))for(var s=0;s<r.length;s++){var l=r[s],c=this._normalizeItem(l),d=this.option(c);this.$element.append(d)}}return t.prototype.query=function(e,t,o){function n(e,i){for(var a=e.results,s=0;s<a.length;s++){var l=a[s],c=null!=l.children&&!n({results:l.children},!0);if(l.text===t.term||c)return!i&&(e.data=a,void o(e))}if(i)return!0;var d=r.createTag(t);if(null!=d){var u=r.option(d);u.attr("data-select2-tag",!0),r.addOptions([u]),r.insertTag(a,d)}e.results=a,o(e)}var r=this;if(this._removeOldTags(),null==t.term||null!=t.page)return void e.call(this,t,o);e.call(this,t,n)},t.prototype.createTag=function(t,o){var n=e.trim(o.term);return""===n?null:{id:n,text:n}},t.prototype.insertTag=function(e,t,o){t.unshift(o)},t.prototype._removeOldTags=function(){this._lastTag;this.$element.find("option[data-select2-tag]").each(function(){this.selected||e(this).remove()})},t}),t.define("select2/data/tokenizer",["jquery"],function(e){function t(e,t,o){var n=o.get("tokenizer");n!==undefined&&(this.tokenizer=n),e.call(this,t,o)}return t.prototype.bind=function(e,t,o){e.call(this,t,o),this.$search=t.dropdown.$search||t.selection.$search||o.find(".select2-search__field")},t.prototype.query=function(e,t,o){function n(e){r.trigger("select",{data:e})}var r=this;t.term=t.term||"";var i=this.tokenizer(t,this.options,n);i.term!==t.term&&(this.$search.length&&(this.$search.val(i.term),this.$search.focus()),t.term=i.term),e.call(this,t,o)},t.prototype.tokenizer=function(t,o,n,r){for(var i=n.get("tokenSeparators")||[],a=o.term,s=0,l=this.createTag||function(e){return{id:e.term,text:e.term}};s<a.length;){var c=a[s];if(-1!==e.inArray(c,i)){var d=a.substr(0,s),u=e.extend({},o,{term:d}),p=l(u);null!=p?(r(p),a=a.substr(s+1)||"",s=0):s++}else s++}return{term:a}},t}),t.define("select2/data/minimumInputLength",[],function(){function e(e,t,o){this.minimumInputLength=o.get("minimumInputLength"),e.call(this,t,o)}return e.prototype.query=function(e,t,o){if(t.term=t.term||"",t.term.length<this.minimumInputLength)return void this.trigger("results:message",{message:"inputTooShort",args:{minimum:this.minimumInputLength,input:t.term,params:t}});e.call(this,t,o)},e}),t.define("select2/data/maximumInputLength",[],function(){function e(e,t,o){this.maximumInputLength=o.get("maximumInputLength"),e.call(this,t,o)}return e.prototype.query=function(e,t,o){if(t.term=t.term||"",this.maximumInputLength>0&&t.term.length>this.maximumInputLength)return void this.trigger("results:message",{message:"inputTooLong",args:{maximum:this.maximumInputLength,input:t.term,params:t}});e.call(this,t,o)},e}),t.define("select2/data/maximumSelectionLength",[],function(){function e(e,t,o){this.maximumSelectionLength=o.get("maximumSelectionLength"),e.call(this,t,o)}return e.prototype.query=function(e,t,o){var n=this;this.current(function(r){var i=null!=r?r.length:0;if(n.maximumSelectionLength>0&&i>=n.maximumSelectionLength)return void n.trigger("results:message",{message:"maximumSelected",args:{maximum:n.maximumSelectionLength}});e.call(n,t,o)})},e}),t.define("select2/dropdown",["jquery","./utils"],function(e,t){function o(e,t){this.$element=e,this.options=t,o.__super__.constructor.call(this)}return t.Extend(o,t.Observable),o.prototype.render=function(){var t=e('<span class="select2-dropdown"><span class="select2-results"></span></span>');return t.attr("dir",this.options.get("dir")),this.$dropdown=t,t},o.prototype.bind=function(){},o.prototype.position=function(){},o.prototype.destroy=function(){this.$dropdown.remove()},o}),t.define("select2/dropdown/search",["jquery","../utils"],function(e){function t(){}return t.prototype.render=function(t){var o=t.call(this),n=e('<span class="select2-search select2-search--dropdown"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="textbox" /></span>');return this.$searchContainer=n,this.$search=n.find("input"),o.prepend(n),o},t.prototype.bind=function(t,o,n){var r=this;t.call(this,o,n),this.$search.on("keydown",function(e){r.trigger("keypress",e),r._keyUpPrevented=e.isDefaultPrevented()}),this.$search.on("input",function(){e(this).off("keyup")}),this.$search.on("keyup input",function(e){r.handleSearch(e)}),o.on("open",function(){r.$search.attr("tabindex",0),r.$search.focus(),window.setTimeout(function(){r.$search.focus()},0)}),o.on("close",function(){r.$search.attr("tabindex",-1),r.$search.val("")}),o.on("results:all",function(e){if(null==e.query.term||""===e.query.term){r.showSearch(e)?r.$searchContainer.removeClass("select2-search--hide"):r.$searchContainer.addClass("select2-search--hide")}})},t.prototype.handleSearch=function(){if(!this._keyUpPrevented){var e=this.$search.val();this.trigger("query",{term:e})}this._keyUpPrevented=!1},t.prototype.showSearch=function(){return!0},t}),t.define("select2/dropdown/hidePlaceholder",[],function(){function e(e,t,o,n){this.placeholder=this.normalizePlaceholder(o.get("placeholder")),e.call(this,t,o,n)}return e.prototype.append=function(e,t){t.results=this.removePlaceholder(t.results),e.call(this,t)},e.prototype.normalizePlaceholder=function(e,t){return"string"==typeof t&&(t={id:"",text:t}),t},e.prototype.removePlaceholder=function(e,t){for(var o=t.slice(0),n=t.length-1;n>=0;n--){var r=t[n];this.placeholder.id===r.id&&o.splice(n,1)}return o},e}),t.define("select2/dropdown/infiniteScroll",["jquery"],function(e){function t(e,t,o,n){this.lastParams={},e.call(this,t,o,n),this.$loadingMore=this.createLoadingMore(),this.loading=!1}return t.prototype.append=function(e,t){this.$loadingMore.remove(),this.loading=!1,e.call(this,t),this.showLoadingMore(t)&&this.$results.append(this.$loadingMore)},t.prototype.bind=function(t,o,n){var r=this;t.call(this,o,n),o.on("query",function(e){r.lastParams=e,r.loading=!0}),o.on("query:append",function(e){r.lastParams=e,r.loading=!0}),this.$results.on("scroll",function(){var t=e.contains(document.documentElement,r.$loadingMore[0]);if(!r.loading&&t){r.$results.offset().top+r.$results.outerHeight(!1)+50>=r.$loadingMore.offset().top+r.$loadingMore.outerHeight(!1)&&r.loadMore()}})},t.prototype.loadMore=function(){this.loading=!0;var t=e.extend({},{page:1},this.lastParams);t.page++,this.trigger("query:append",t)},t.prototype.showLoadingMore=function(e,t){return t.pagination&&t.pagination.more},t.prototype.createLoadingMore=function(){var t=e('<li class="select2-results__option select2-results__option--load-more"role="treeitem" aria-disabled="true"></li>'),o=this.options.get("translations").get("loadingMore");return t.html(o(this.lastParams)),t},t}),t.define("select2/dropdown/attachBody",["jquery","../utils"],function(e,t){function o(t,o,n){this.$dropdownParent=n.get("dropdownParent")||e(document.body),t.call(this,o,n)}return o.prototype.bind=function(e,t,o){var n=this,r=!1;e.call(this,t,o),t.on("open",function(){n._showDropdown(),n._attachPositioningHandler(t),r||(r=!0,t.on("results:all",function(){n._positionDropdown(),n._resizeDropdown()}),t.on("results:append",function(){n._positionDropdown(),n._resizeDropdown()}))}),t.on("close",function(){n._hideDropdown(),n._detachPositioningHandler(t)}),this.$dropdownContainer.on("mousedown",function(e){e.stopPropagation()})},o.prototype.destroy=function(e){e.call(this),this.$dropdownContainer.remove()},o.prototype.position=function(e,t,o){t.attr("class",o.attr("class")),t.removeClass("select2"),t.addClass("select2-container--open"),t.css({position:"absolute",top:-999999}),this.$container=o},o.prototype.render=function(t){var o=e("<span></span>"),n=t.call(this);return o.append(n),this.$dropdownContainer=o,o},o.prototype._hideDropdown=function(){this.$dropdownContainer.detach()},o.prototype._attachPositioningHandler=function(o,n){var r=this,i="scroll.select2."+n.id,a="resize.select2."+n.id,s="orientationchange.select2."+n.id,l=this.$container.parents().filter(t.hasScroll);l.each(function(){e(this).data("select2-scroll-position",{x:e(this).scrollLeft(),y:e(this).scrollTop()})}),l.on(i,function(){var t=e(this).data("select2-scroll-position");e(this).scrollTop(t.y)}),e(window).on(i+" "+a+" "+s,function(){r._positionDropdown(),r._resizeDropdown()})},o.prototype._detachPositioningHandler=function(o,n){var r="scroll.select2."+n.id,i="resize.select2."+n.id,a="orientationchange.select2."+n.id;this.$container.parents().filter(t.hasScroll).off(r),e(window).off(r+" "+i+" "+a)},o.prototype._positionDropdown=function(){var t=e(window),o=this.$dropdown.hasClass("select2-dropdown--above"),n=this.$dropdown.hasClass("select2-dropdown--below"),r=null,i=this.$container.offset();i.bottom=i.top+this.$container.outerHeight(!1);var a={height:this.$container.outerHeight(!1)};a.top=i.top,a.bottom=i.top+a.height;var s={height:this.$dropdown.outerHeight(!1)},l={top:t.scrollTop(),bottom:t.scrollTop()+t.height()},c=l.top<i.top-s.height,d=l.bottom>i.bottom+s.height,u={left:i.left,top:a.bottom},p=this.$dropdownParent;"static"===p.css("position")&&(p=p.offsetParent());var h=p.offset();u.top-=h.top,u.left-=h.left,o||n||(r="below"),d||!c||o?!c&&d&&o&&(r="below"):r="above",("above"==r||o&&"below"!==r)&&(u.top=a.top-s.height),null!=r&&(this.$dropdown.removeClass("select2-dropdown--below select2-dropdown--above").addClass("select2-dropdown--"+r),this.$container.removeClass("select2-container--below select2-container--above").addClass("select2-container--"+r)),this.$dropdownContainer.css(u)},o.prototype._resizeDropdown=function(){var e={width:this.$container.outerWidth(!1)+"px"};this.options.get("dropdownAutoWidth")&&(e.minWidth=e.width,e.width="auto"),this.$dropdown.css(e)},o.prototype._showDropdown=function(){this.$dropdownContainer.appendTo(this.$dropdownParent),this._positionDropdown(),this._resizeDropdown()},o}),t.define("select2/dropdown/minimumResultsForSearch",[],function(){function e(t){for(var o=0,n=0;n<t.length;n++){var r=t[n];r.children?o+=e(r.children):o++}return o}function t(e,t,o,n){this.minimumResultsForSearch=o.get("minimumResultsForSearch"),this.minimumResultsForSearch<0&&(this.minimumResultsForSearch=Infinity),e.call(this,t,o,n)}return t.prototype.showSearch=function(t,o){return!(e(o.data.results)<this.minimumResultsForSearch)&&t.call(this,o)},t}),t.define("select2/dropdown/selectOnClose",[],function(){function e(){}return e.prototype.bind=function(e,t,o){var n=this;e.call(this,t,o),t.on("close",function(){n._handleSelectOnClose()})},e.prototype._handleSelectOnClose=function(){var e=this.getHighlightedResults();if(!(e.length<1)){var t=e.data("data");null!=t.element&&t.element.selected||null==t.element&&t.selected||this.trigger("select",{data:t})}},e}),t.define("select2/dropdown/closeOnSelect",[],function(){function e(){}return e.prototype.bind=function(e,t,o){var n=this;e.call(this,t,o),t.on("select",function(e){n._selectTriggered(e)}),t.on("unselect",function(e){n._selectTriggered(e)})},e.prototype._selectTriggered=function(e,t){var o=t.originalEvent;o&&o.ctrlKey||this.trigger("close",{})},e}),t.define("select2/i18n/en",[],function(){return{errorLoading:function(){return"The results could not be loaded."},inputTooLong:function(e){var t=e.input.length-e.maximum,o="Please delete "+t+" character";return 1!=t&&(o+="s"),o},inputTooShort:function(e){return"Please enter "+(e.minimum-e.input.length)+" or more characters"},loadingMore:function(){return"Loading more results\u2026"},maximumSelected:function(e){var t="You can only select "+e.maximum+" item";return 1!=e.maximum&&(t+="s"),t},noResults:function(){return"No results found"},searching:function(){return"Searching\u2026"}}}),t.define("select2/defaults",["jquery","require","./results","./selection/single","./selection/multiple","./selection/placeholder","./selection/allowClear","./selection/search","./selection/eventRelay","./utils","./translation","./diacritics","./data/select","./data/array","./data/ajax","./data/tags","./data/tokenizer","./data/minimumInputLength","./data/maximumInputLength","./data/maximumSelectionLength","./dropdown","./dropdown/search","./dropdown/hidePlaceholder","./dropdown/infiniteScroll","./dropdown/attachBody","./dropdown/minimumResultsForSearch","./dropdown/selectOnClose","./dropdown/closeOnSelect","./i18n/en"],function(e,t,o,n,r,i,a,s,l,c,d,u,p,h,f,m,g,v,y,b,C,w,x,S,_,k,T,E,F){function D(){this.reset()}return D.prototype.apply=function(u){if(u=e.extend(!0,{},this.defaults,u),null==u.dataAdapter){if(null!=u.ajax?u.dataAdapter=f:null!=u.data?u.dataAdapter=h:u.dataAdapter=p,u.minimumInputLength>0&&(u.dataAdapter=c.Decorate(u.dataAdapter,v)),u.maximumInputLength>0&&(u.dataAdapter=c.Decorate(u.dataAdapter,y)),u.maximumSelectionLength>0&&(u.dataAdapter=c.Decorate(u.dataAdapter,b)),u.tags&&(u.dataAdapter=c.Decorate(u.dataAdapter,m)),null==u.tokenSeparators&&null==u.tokenizer||(u.dataAdapter=c.Decorate(u.dataAdapter,g)),null!=u.query){var F=t(u.amdBase+"compat/query");u.dataAdapter=c.Decorate(u.dataAdapter,F)}if(null!=u.initSelection){var D=t(u.amdBase+"compat/initSelection");u.dataAdapter=c.Decorate(u.dataAdapter,D)}}if(null==u.resultsAdapter&&(u.resultsAdapter=o,null!=u.ajax&&(u.resultsAdapter=c.Decorate(u.resultsAdapter,S)),null!=u.placeholder&&(u.resultsAdapter=c.Decorate(u.resultsAdapter,x)),u.selectOnClose&&(u.resultsAdapter=c.Decorate(u.resultsAdapter,T))),null==u.dropdownAdapter){if(u.multiple)u.dropdownAdapter=C;else{var M=c.Decorate(C,w);u.dropdownAdapter=M}if(0!==u.minimumResultsForSearch&&(u.dropdownAdapter=c.Decorate(u.dropdownAdapter,k)),u.closeOnSelect&&(u.dropdownAdapter=c.Decorate(u.dropdownAdapter,E)),null!=u.dropdownCssClass||null!=u.dropdownCss||null!=u.adaptDropdownCssClass){var A=t(u.amdBase+"compat/dropdownCss");u.dropdownAdapter=c.Decorate(u.dropdownAdapter,A)}u.dropdownAdapter=c.Decorate(u.dropdownAdapter,_)}if(null==u.selectionAdapter){if(u.multiple?u.selectionAdapter=r:u.selectionAdapter=n,null!=u.placeholder&&(u.selectionAdapter=c.Decorate(u.selectionAdapter,i)),u.allowClear&&(u.selectionAdapter=c.Decorate(u.selectionAdapter,a)),u.multiple&&(u.selectionAdapter=c.Decorate(u.selectionAdapter,s)),null!=u.containerCssClass||null!=u.containerCss||null!=u.adaptContainerCssClass){var P=t(u.amdBase+"compat/containerCss");u.selectionAdapter=c.Decorate(u.selectionAdapter,P)}u.selectionAdapter=c.Decorate(u.selectionAdapter,l)}if("string"==typeof u.language)if(u.language.indexOf("-")>0){var L=u.language.split("-"),R=L[0];u.language=[u.language,R]}else u.language=[u.language];if(e.isArray(u.language)){var I=new d;u.language.push("en");for(var O=u.language,$=0;$<O.length;$++){var N=O[$],U={};try{U=d.loadPath(N)}catch(e){try{N=this.defaults.amdLanguageBase+N,U=d.loadPath(N)}catch(e){u.debug&&window.console&&console.warn&&console.warn('Select2: The language file for "'+N+'" could not be automatically loaded. A fallback will be used instead.');continue}}I.extend(U)}u.translations=I}else{var j=d.loadPath(this.defaults.amdLanguageBase+"en"),H=new d(u.language);H.extend(j),u.translations=H}return u},D.prototype.reset=function(){function t(e){function t(e){return u[e]||e}return e.replace(/[^\u0000-\u007E]/g,t)}function o(n,r){if(""===e.trim(n.term))return r;if(r.children&&r.children.length>0){for(var i=e.extend(!0,{},r),a=r.children.length-1;a>=0;a--){null==o(n,r.children[a])&&i.children.splice(a,1)}return i.children.length>0?i:o(n,i)}var s=t(r.text).toUpperCase(),l=t(n.term).toUpperCase();return s.indexOf(l)>-1?r:null}this.defaults={amdBase:"./",amdLanguageBase:"./i18n/",closeOnSelect:!0,debug:!1,dropdownAutoWidth:!1,escapeMarkup:c.escapeMarkup,language:F,matcher:o,minimumInputLength:0,maximumInputLength:0,maximumSelectionLength:0,minimumResultsForSearch:0,selectOnClose:!1,sorter:function(e){return e},templateResult:function(e){return e.text},templateSelection:function(e){return e.text},theme:"default",width:"resolve"}},D.prototype.set=function(t,o){var n=e.camelCase(t),r={};r[n]=o;var i=c._convertData(r);e.extend(this.defaults,i)},new D}),t.define("select2/options",["require","jquery","./defaults","./utils"],function(e,t,o,n){function r(t,r){if(this.options=t,null!=r&&this.fromElement(r),this.options=o.apply(this.options),r&&r.is("input")){var i=e(this.get("amdBase")+"compat/inputData");this.options.dataAdapter=n.Decorate(this.options.dataAdapter,i)}}return r.prototype.fromElement=function(e){var o=["select2"];null==this.options.multiple&&(this.options.multiple=e.prop("multiple")),null==this.options.disabled&&(this.options.disabled=e.prop("disabled")),null==this.options.language&&(e.prop("lang")?this.options.language=e.prop("lang").toLowerCase():e.closest("[lang]").prop("lang")&&(this.options.language=e.closest("[lang]").prop("lang"))),null==this.options.dir&&(e.prop("dir")?this.options.dir=e.prop("dir"):e.closest("[dir]").prop("dir")?this.options.dir=e.closest("[dir]").prop("dir"):this.options.dir="ltr"),e.prop("disabled",this.options.disabled),e.prop("multiple",this.options.multiple),e.data("select2Tags")&&(this.options.debug&&window.console&&console.warn&&console.warn('Select2: The `data-select2-tags` attribute has been changed to use the `data-data` and `data-tags="true"` attributes and will be removed in future versions of Select2.'),e.data("data",e.data("select2Tags")),e.data("tags",!0)),e.data("ajaxUrl")&&(this.options.debug&&window.console&&console.warn&&console.warn("Select2: The `data-ajax-url` attribute has been changed to `data-ajax--url` and support for the old attribute will be removed in future versions of Select2."),e.attr("ajax--url",e.data("ajaxUrl")),e.data("ajax--url",e.data("ajaxUrl")));var r={};r=t.fn.jquery&&"1."==t.fn.jquery.substr(0,2)&&e[0].dataset?t.extend(!0,{},e[0].dataset,e.data()):e.data();var i=t.extend(!0,{},r);i=n._convertData(i);for(var a in i)t.inArray(a,o)>-1||(t.isPlainObject(this.options[a])?t.extend(this.options[a],i[a]):this.options[a]=i[a]);return this},r.prototype.get=function(e){return this.options[e]},r.prototype.set=function(e,t){this.options[e]=t},r}),t.define("select2/core",["jquery","./options","./utils","./keys"],function(e,t,o,n){var r=function(e,o){null!=e.data("select2")&&e.data("select2").destroy(),this.$element=e,this.id=this._generateId(e),o=o||{},this.options=new t(o,e),r.__super__.constructor.call(this);var n=e.attr("tabindex")||0;e.data("old-tabindex",n),e.attr("tabindex","-1");var i=this.options.get("dataAdapter");this.dataAdapter=new i(e,this.options);var a=this.render();this._placeContainer(a);var s=this.options.get("selectionAdapter");this.selection=new s(e,this.options),this.$selection=this.selection.render(),this.selection.position(this.$selection,a);var l=this.options.get("dropdownAdapter");this.dropdown=new l(e,this.options),this.$dropdown=this.dropdown.render(),this.dropdown.position(this.$dropdown,a);var c=this.options.get("resultsAdapter");this.results=new c(e,this.options,this.dataAdapter),this.$results=this.results.render(),this.results.position(this.$results,this.$dropdown);var d=this;this._bindAdapters(),this._registerDomEvents(),this._registerDataEvents(),this._registerSelectionEvents(),this._registerDropdownEvents(),this._registerResultsEvents(),this._registerEvents(),this.dataAdapter.current(function(e){d.trigger("selection:update",{data:e})}),e.addClass("select2-hidden-accessible"),e.attr("aria-hidden","true"),this._syncAttributes(),e.data("select2",this)};return o.Extend(r,o.Observable),r.prototype._generateId=function(e){var t="";return t=null!=e.attr("id")?e.attr("id"):null!=e.attr("name")?e.attr("name")+"-"+o.generateChars(2):o.generateChars(4),t=t.replace(/(:|\.|\[|\]|,)/g,""),t="select2-"+t},r.prototype._placeContainer=function(e){e.insertAfter(this.$element);var t=this._resolveWidth(this.$element,this.options.get("width"));null!=t&&e.css("width",t)},r.prototype._resolveWidth=function(e,t){var o=/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i;if("resolve"==t){var n=this._resolveWidth(e,"style");return null!=n?n:this._resolveWidth(e,"element")}if("element"==t){var r=e.outerWidth(!1);return r<=0?"auto":r+"px"}if("style"==t){var i=e.attr("style");if("string"!=typeof i)return null;for(var a=i.split(";"),s=0,l=a.length;s<l;s+=1){var c=a[s].replace(/\s/g,""),d=c.match(o);if(null!==d&&d.length>=1)return d[1]}return null}return t},r.prototype._bindAdapters=function(){this.dataAdapter.bind(this,this.$container),this.selection.bind(this,this.$container),this.dropdown.bind(this,this.$container),this.results.bind(this,this.$container)},r.prototype._registerDomEvents=function(){var t=this;this.$element.on("change.select2",function(){t.dataAdapter.current(function(e){t.trigger("selection:update",{data:e})})}),this._sync=o.bind(this._syncAttributes,this),this.$element[0].attachEvent&&this.$element[0].attachEvent("onpropertychange",this._sync);var n=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;null!=n?(this._observer=new n(function(o){e.each(o,t._sync)}),this._observer.observe(this.$element[0],{attributes:!0,subtree:!1})):this.$element[0].addEventListener&&this.$element[0].addEventListener("DOMAttrModified",t._sync,!1)},r.prototype._registerDataEvents=function(){var e=this;this.dataAdapter.on("*",function(t,o){e.trigger(t,o)})},r.prototype._registerSelectionEvents=function(){var t=this,o=["toggle","focus"];this.selection.on("toggle",function(){t.toggleDropdown()}),this.selection.on("focus",function(e){t.focus(e)}),this.selection.on("*",function(n,r){-1===e.inArray(n,o)&&t.trigger(n,r)})},r.prototype._registerDropdownEvents=function(){var e=this;this.dropdown.on("*",function(t,o){e.trigger(t,o)})},r.prototype._registerResultsEvents=function(){var e=this;this.results.on("*",function(t,o){e.trigger(t,o)})},r.prototype._registerEvents=function(){var e=this;this.on("open",function(){e.$container.addClass("select2-container--open")}),this.on("close",function(){e.$container.removeClass("select2-container--open")}),this.on("enable",function(){e.$container.removeClass("select2-container--disabled")}),this.on("disable",function(){e.$container.addClass("select2-container--disabled")}),this.on("blur",function(){e.$container.removeClass("select2-container--focus")}),this.on("query",function(t){e.isOpen()||e.trigger("open",{}),this.dataAdapter.query(t,function(o){e.trigger("results:all",{data:o,query:t})})}),this.on("query:append",function(t){this.dataAdapter.query(t,function(o){e.trigger("results:append",{data:o,query:t})})}),this.on("keypress",function(t){var o=t.which;e.isOpen()?o===n.ESC||o===n.TAB||o===n.UP&&t.altKey?(e.close(),t.preventDefault()):o===n.ENTER?(e.trigger("results:select",{}),t.preventDefault()):o===n.SPACE&&t.ctrlKey?(e.trigger("results:toggle",{}),t.preventDefault()):o===n.UP?(e.trigger("results:previous",{}),t.preventDefault()):o===n.DOWN&&(e.trigger("results:next",{}),t.preventDefault()):(o===n.ENTER||o===n.SPACE||o===n.DOWN&&t.altKey)&&(e.open(),t.preventDefault())})},r.prototype._syncAttributes=function(){this.options.set("disabled",this.$element.prop("disabled")),this.options.get("disabled")?(this.isOpen()&&this.close(),this.trigger("disable",{})):this.trigger("enable",{})},r.prototype.trigger=function(e,t){var o=r.__super__.trigger,n={open:"opening",close:"closing",select:"selecting",unselect:"unselecting"};if(t===undefined&&(t={}),e in n){var i=n[e],a={prevented:!1,name:e,args:t};if(o.call(this,i,a),a.prevented)return void(t.prevented=!0)}o.call(this,e,t)},r.prototype.toggleDropdown=function(){this.options.get("disabled")||(this.isOpen()?this.close():this.open())},r.prototype.open=function(){this.isOpen()||this.trigger("query",{})},r.prototype.close=function(){this.isOpen()&&this.trigger("close",{})},r.prototype.isOpen=function(){return this.$container.hasClass("select2-container--open")},r.prototype.hasFocus=function(){return this.$container.hasClass("select2-container--focus")},r.prototype.focus=function(){this.hasFocus()||(this.$container.addClass("select2-container--focus"),this.trigger("focus",{}))},r.prototype.enable=function(e){this.options.get("debug")&&window.console&&console.warn&&console.warn('Select2: The `select2("enable")` method has been deprecated and will be removed in later Select2 versions. Use $element.prop("disabled") instead.'),null!=e&&0!==e.length||(e=[!0]);var t=!e[0];this.$element.prop("disabled",t)},r.prototype.data=function(){this.options.get("debug")&&arguments.length>0&&window.console&&console.warn&&console.warn('Select2: Data can no longer be set using `select2("data")`. You should consider setting the value instead using `$element.val()`.');var e=[];return this.dataAdapter.current(function(t){e=t}),e},r.prototype.val=function(t){if(this.options.get("debug")&&window.console&&console.warn&&console.warn('Select2: The `select2("val")` method has been deprecated and will be removed in later Select2 versions. Use $element.val() instead.'),null==t||0===t.length)return this.$element.val();var o=t[0];e.isArray(o)&&(o=e.map(o,function(e){return e.toString()})),this.$element.val(o).trigger("change")},r.prototype.destroy=function(){this.$container.remove(),this.$element[0].detachEvent&&this.$element[0].detachEvent("onpropertychange",this._sync),null!=this._observer?(this._observer.disconnect(),
this._observer=null):this.$element[0].removeEventListener&&this.$element[0].removeEventListener("DOMAttrModified",this._sync,!1),this._sync=null,this.$element.off(".select2"),this.$element.attr("tabindex",this.$element.data("old-tabindex")),this.$element.removeClass("select2-hidden-accessible"),this.$element.attr("aria-hidden","false"),this.$element.removeData("select2"),this.dataAdapter.destroy(),this.selection.destroy(),this.dropdown.destroy(),this.results.destroy(),this.dataAdapter=null,this.selection=null,this.dropdown=null,this.results=null},r.prototype.render=function(){var t=e('<span class="select2 select2-container"><span class="selection"></span><span class="dropdown-wrapper" aria-hidden="true"></span></span>');return t.attr("dir",this.options.get("dir")),this.$container=t,this.$container.addClass("select2-container--"+this.options.get("theme")),t.data("element",this.$element),t},r}),t.define("select2/compat/utils",["jquery"],function(e){function t(t,o,n){var r,i,a=[];r=e.trim(t.attr("class")),r&&(r=""+r,e(r.split(/\s+/)).each(function(){0===this.indexOf("select2-")&&a.push(this)})),r=e.trim(o.attr("class")),r&&(r=""+r,e(r.split(/\s+/)).each(function(){0!==this.indexOf("select2-")&&null!=(i=n(this))&&a.push(i)})),t.attr("class",a.join(" "))}return{syncCssClasses:t}}),t.define("select2/compat/containerCss",["jquery","./utils"],function(e,t){function o(){return null}function n(){}return n.prototype.render=function(n){var r=n.call(this),i=this.options.get("containerCssClass")||"";e.isFunction(i)&&(i=i(this.$element));var a=this.options.get("adaptContainerCssClass");if(a=a||o,-1!==i.indexOf(":all:")){i=i.replace(":all:","");var s=a;a=function(e){var t=s(e);return null!=t?t+" "+e:e}}var l=this.options.get("containerCss")||{};return e.isFunction(l)&&(l=l(this.$element)),t.syncCssClasses(r,this.$element,a),r.css(l),r.addClass(i),r},n}),t.define("select2/compat/dropdownCss",["jquery","./utils"],function(e,t){function o(){return null}function n(){}return n.prototype.render=function(n){var r=n.call(this),i=this.options.get("dropdownCssClass")||"";e.isFunction(i)&&(i=i(this.$element));var a=this.options.get("adaptDropdownCssClass");if(a=a||o,-1!==i.indexOf(":all:")){i=i.replace(":all:","");var s=a;a=function(e){var t=s(e);return null!=t?t+" "+e:e}}var l=this.options.get("dropdownCss")||{};return e.isFunction(l)&&(l=l(this.$element)),t.syncCssClasses(r,this.$element,a),r.css(l),r.addClass(i),r},n}),t.define("select2/compat/initSelection",["jquery"],function(e){function t(e,t,o){o.get("debug")&&window.console&&console.warn&&console.warn("Select2: The `initSelection` option has been deprecated in favor of a custom data adapter that overrides the `current` method. This method is now called multiple times instead of a single time when the instance is initialized. Support will be removed for the `initSelection` option in future versions of Select2"),this.initSelection=o.get("initSelection"),this._isInitialized=!1,e.call(this,t,o)}return t.prototype.current=function(t,o){var n=this;if(this._isInitialized)return void t.call(this,o);this.initSelection.call(null,this.$element,function(t){n._isInitialized=!0,e.isArray(t)||(t=[t]),o(t)})},t}),t.define("select2/compat/inputData",["jquery"],function(e){function t(e,t,o){this._currentData=[],this._valueSeparator=o.get("valueSeparator")||",","hidden"===t.prop("type")&&o.get("debug")&&console&&console.warn&&console.warn("Select2: Using a hidden input with Select2 is no longer supported and may stop working in the future. It is recommended to use a `<select>` element instead."),e.call(this,t,o)}return t.prototype.current=function(t,o){function n(t,o){var r=[];return t.selected||-1!==e.inArray(t.id,o)?(t.selected=!0,r.push(t)):t.selected=!1,t.children&&r.push.apply(r,n(t.children,o)),r}for(var r=[],i=0;i<this._currentData.length;i++){var a=this._currentData[i];r.push.apply(r,n(a,this.$element.val().split(this._valueSeparator)))}o(r)},t.prototype.select=function(t,o){if(this.options.get("multiple")){var n=this.$element.val();n+=this._valueSeparator+o.id,this.$element.val(n),this.$element.trigger("change")}else this.current(function(t){e.map(t,function(e){e.selected=!1})}),this.$element.val(o.id),this.$element.trigger("change")},t.prototype.unselect=function(e,t){var o=this;t.selected=!1,this.current(function(e){for(var n=[],r=0;r<e.length;r++){var i=e[r];t.id!=i.id&&n.push(i.id)}o.$element.val(n.join(o._valueSeparator)),o.$element.trigger("change")})},t.prototype.query=function(e,t,o){for(var n=[],r=0;r<this._currentData.length;r++){var i=this._currentData[r],a=this.matches(t,i);null!==a&&n.push(a)}o({results:n})},t.prototype.addOptions=function(t,o){var n=e.map(o,function(t){return e.data(t[0],"data")});this._currentData.push.apply(this._currentData,n)},t}),t.define("select2/compat/matcher",["jquery"],function(e){function t(t){function o(o,n){var r=e.extend(!0,{},n);if(null==o.term||""===e.trim(o.term))return r;if(n.children){for(var i=n.children.length-1;i>=0;i--){var a=n.children[i];t(o.term,a.text,a)||r.children.splice(i,1)}if(r.children.length>0)return r}return t(o.term,n.text,n)?r:null}return o}return t}),t.define("select2/compat/query",[],function(){function e(e,t,o){o.get("debug")&&window.console&&console.warn&&console.warn("Select2: The `query` option has been deprecated in favor of a custom data adapter that overrides the `query` method. Support will be removed for the `query` option in future versions of Select2."),e.call(this,t,o)}return e.prototype.query=function(e,t,o){t.callback=o,this.options.get("query").call(null,t)},e}),t.define("select2/dropdown/attachContainer",[],function(){function e(e,t,o){e.call(this,t,o)}return e.prototype.position=function(e,t,o){o.find(".dropdown-wrapper").append(t),t.addClass("select2-dropdown--below"),o.addClass("select2-container--below")},e}),t.define("select2/dropdown/stopPropagation",[],function(){function e(){}return e.prototype.bind=function(e,t,o){e.call(this,t,o);var n=["blur","change","click","dblclick","focus","focusin","focusout","input","keydown","keyup","keypress","mousedown","mouseenter","mouseleave","mousemove","mouseover","mouseup","search","touchend","touchstart"];this.$dropdown.on(n.join(" "),function(e){e.stopPropagation()})},e}),t.define("select2/selection/stopPropagation",[],function(){function e(){}return e.prototype.bind=function(e,t,o){e.call(this,t,o);var n=["blur","change","click","dblclick","focus","focusin","focusout","input","keydown","keyup","keypress","mousedown","mouseenter","mouseleave","mousemove","mouseover","mouseup","search","touchend","touchstart"];this.$selection.on(n.join(" "),function(e){e.stopPropagation()})},e}),function(o){"function"==typeof t.define&&t.define.amd?t.define("jquery-mousewheel",["jquery"],o):"object"==typeof exports?module.exports=o:o(e)}(function(e){function t(t){var a=t||window.event,s=l.call(arguments,1),c=0,u=0,p=0,h=0,f=0,m=0;if(t=e.event.fix(a),t.type="mousewheel","detail"in a&&(p=-1*a.detail),"wheelDelta"in a&&(p=a.wheelDelta),"wheelDeltaY"in a&&(p=a.wheelDeltaY),"wheelDeltaX"in a&&(u=-1*a.wheelDeltaX),"axis"in a&&a.axis===a.HORIZONTAL_AXIS&&(u=-1*p,p=0),c=0===p?u:p,"deltaY"in a&&(p=-1*a.deltaY,c=p),"deltaX"in a&&(u=a.deltaX,0===p&&(c=-1*u)),0!==p||0!==u){if(1===a.deltaMode){var g=e.data(this,"mousewheel-line-height");c*=g,p*=g,u*=g}else if(2===a.deltaMode){var v=e.data(this,"mousewheel-page-height");c*=v,p*=v,u*=v}if(h=Math.max(Math.abs(p),Math.abs(u)),(!i||h<i)&&(i=h,n(a,h)&&(i/=40)),n(a,h)&&(c/=40,u/=40,p/=40),c=Math[c>=1?"floor":"ceil"](c/i),u=Math[u>=1?"floor":"ceil"](u/i),p=Math[p>=1?"floor":"ceil"](p/i),d.settings.normalizeOffset&&this.getBoundingClientRect){var y=this.getBoundingClientRect();f=t.clientX-y.left,m=t.clientY-y.top}return t.deltaX=u,t.deltaY=p,t.deltaFactor=i,t.offsetX=f,t.offsetY=m,t.deltaMode=0,s.unshift(t,c,u,p),r&&clearTimeout(r),r=setTimeout(o,200),(e.event.dispatch||e.event.handle).apply(this,s)}}function o(){i=null}function n(e,t){return d.settings.adjustOldDeltas&&"mousewheel"===e.type&&t%120==0}var r,i,a=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],s="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],l=Array.prototype.slice;if(e.event.fixHooks)for(var c=a.length;c;)e.event.fixHooks[a[--c]]=e.event.mouseHooks;var d=e.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var o=s.length;o;)this.addEventListener(s[--o],t,!1);else this.onmousewheel=t;e.data(this,"mousewheel-line-height",d.getLineHeight(this)),e.data(this,"mousewheel-page-height",d.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var o=s.length;o;)this.removeEventListener(s[--o],t,!1);else this.onmousewheel=null;e.removeData(this,"mousewheel-line-height"),e.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var o=e(t),n=o["offsetParent"in e.fn?"offsetParent":"parent"]();return n.length||(n=e("body")),parseInt(n.css("fontSize"),10)||parseInt(o.css("fontSize"),10)||16},getPageHeight:function(t){return e(t).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}),t.define("jquery.select2",["jquery","jquery-mousewheel","./select2/core","./select2/defaults"],function(e,t,o,n){if(null==e.fn.select2){var r=["open","close","destroy"];e.fn.select2=function(t){if("object"==typeof(t=t||{}))return this.each(function(){var n=e.extend(!0,{},t);new o(e(this),n)}),this;if("string"==typeof t){var n;return this.each(function(){var o=e(this).data("select2");null==o&&window.console&&console.error&&console.error("The select2('"+t+"') method was called on an element that is not using Select2.");var r=Array.prototype.slice.call(arguments,1);n=o[t].apply(o,r)}),e.inArray(t,r)>-1?this:n}throw new Error("Invalid arguments for Select2: "+t)}}return null==e.fn.select2.defaults&&(e.fn.select2.defaults=n),o}),{define:t.define,require:t.require}}(),o=t.require("jquery.select2");return e.fn.select2.amd=t,o}),/*! Select2 4.0.2 | https://github.com/select2/select2/blob/master/LICENSE.md */
function(){if(jQuery&&jQuery.fn&&jQuery.fn.select2&&jQuery.fn.select2.amd)var e=jQuery.fn.select2.amd;e.define("select2/i18n/ru",[],function(){function e(e,t,o,n){return e%10<5&&e%10>0&&e%100<5||e%100>20?e%10>1?o:t:n}return{errorLoading:function(){return"\u041d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b"},inputTooLong:function(t){var o=t.input.length-t.maximum,n="\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430 "+o+" \u0441\u0438\u043c\u0432\u043e\u043b";return n+=e(o,"","a","\u043e\u0432"),n+=" \u043c\u0435\u043d\u044c\u0448\u0435"},inputTooShort:function(t){var o=t.minimum-t.input.length,n="\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0435\u0449\u0435 \u0445\u043e\u0442\u044f \u0431\u044b "+o+" \u0441\u0438\u043c\u0432\u043e\u043b";return n+=e(o,"","a","\u043e\u0432")},loadingMore:function(){return"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445\u2026"},maximumSelected:function(t){var o="\u0412\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u0432\u044b\u0431\u0440\u0430\u0442\u044c \u043d\u0435 \u0431\u043e\u043b\u0435\u0435 "+t.maximum+" \u044d\u043b\u0435\u043c\u0435\u043d\u0442";return o+=e(t.maximum,"","a","\u043e\u0432")},noResults:function(){return"\u0421\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0439 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e"},searching:function(){return"\u041f\u043e\u0438\u0441\u043a\u2026"}}}),e.define,e.require}(),/**
 * jquery.Jcrop.min.js v0.9.10 (build:20130117)
 * jQuery Image Cropping Plugin - released under MIT License
 * Copyright (c) 2008-2012 Tapmodo Interactive LLC
 * https://github.com/tapmodo/Jcrop
 */
function(e){e.Jcrop=function(t,o){function n(e){return Math.round(e)+"px"}function r(e){return I.baseClass+"-"+e}function i(){return e.fx.step.hasOwnProperty("backgroundColor")}function a(t){var o=e(t).offset();return[o.left,o.top]}function s(e){return[e.pageX-R[0],e.pageY-R[1]]}function l(t){"object"!=typeof t&&(t={}),I=e.extend(I,t),e.each(["onChange","onSelect","onRelease","onDblClick"],function(e,t){"function"!=typeof I[t]&&(I[t]=function(){})})}function c(e,t,o){if(R=a(z),fe.setCursor("move"===e?e:e+"-resize"),"move"===e)return fe.activateHandlers(u(t),g,o);var n=ue.getFixed(),r=p(e),i=ue.getCorner(p(r));ue.setPressed(ue.getCorner(r)),ue.setCurrent(i),fe.activateHandlers(d(e,n),g,o)}function d(e,t){return function(o){if(I.aspectRatio)switch(e){case"e":case"w":o[1]=t.y+1;break;case"n":o[0]=t.x+1;break;case"s":o[0]=t.x+1}else switch(e){case"e":case"w":o[1]=t.y2;break;case"n":o[0]=t.x2;break;case"s":o[0]=t.x2}ue.setCurrent(o),he.update()}}function u(e){var t=e;return me.watchKeys(),function(e){ue.moveOffset([e[0]-t[0],e[1]-t[1]]),t=e,he.update()}}function p(e){switch(e){case"n":return"sw";case"s":case"e":return"nw";case"w":return"ne";case"ne":return"sw";case"nw":return"se";case"se":return"nw";case"sw":return"ne"}}function h(e){return function(t){return!I.disabled&&(!("move"===e&&!I.allowMove)&&(R=a(z),ne=!0,c(e,s(t)),t.stopPropagation(),t.preventDefault(),!1))}}function f(e,t,o){var n=e.width(),r=e.height();n>t&&t>0&&(n=t,r=t/e.width()*e.height()),r>o&&o>0&&(r=o,n=o/e.height()*e.width()),te=e.width()/n,oe=e.height()/r,e.width(n).height(r)}function m(e){return{x:e.x*te,y:e.y*oe,x2:e.x2*te,y2:e.y2*oe,w:e.w*te,h:e.h*oe}}function g(){var e=ue.getFixed();e.w>I.minSelect[0]&&e.h>I.minSelect[1]?(he.enableHandles(),he.done()):he.release(),fe.setCursor(I.allowSelect?"crosshair":"default")}function v(e){if(I.disabled)return!1;if(!I.allowSelect)return!1;ne=!0,R=a(z),he.disableHandles(),fe.setCursor("crosshair");var t=s(e);return ue.setPressed(t),he.update(),fe.activateHandlers(y,g,"touch"===e.type.substring(0,5)),me.watchKeys(),e.stopPropagation(),e.preventDefault(),!1}function y(e){ue.setCurrent(e),he.update()}function b(){var t=e("<div></div>").addClass(r("tracker"));return $&&t.css({opacity:0,backgroundColor:"white"}),t}function C(e){G.removeClass().addClass(r("holder")).addClass(e)}function w(e,t){function o(){window.setTimeout(y,u)}var n=e[0]/te,r=e[1]/oe,i=e[2]/te,a=e[3]/oe;if(!re){var s=ue.flipCoords(n,r,i,a),l=ue.getFixed(),c=[l.x,l.y,l.x2,l.y2],d=c,u=I.animationDelay,p=s[0]-c[0],h=s[1]-c[1],f=s[2]-c[2],m=s[3]-c[3],g=0,v=I.swingSpeed;n=d[0],r=d[1],i=d[2],a=d[3],he.animMode(!0);var y=function(){return function(){g+=(100-g)/v,d[0]=Math.round(n+g/100*p),d[1]=Math.round(r+g/100*h),d[2]=Math.round(i+g/100*f),d[3]=Math.round(a+g/100*m),g>=99.8&&(g=100),g<100?(S(d),o()):(he.done(),he.animMode(!1),"function"==typeof t&&t.call(ge))}}();o()}}function x(e){S([e[0]/te,e[1]/oe,e[2]/te,e[3]/oe]),I.onSelect.call(ge,m(ue.getFixed())),he.enableHandles()}function S(e){ue.setPressed([e[0],e[1]]),ue.setCurrent([e[2],e[3]]),he.update()}function _(){return m(ue.getFixed())}function k(){return ue.getFixed()}function T(e){l(e),L()}function E(){I.disabled=!0,he.disableHandles(),he.setCursor("default"),fe.setCursor("default")}function F(){I.disabled=!1,L()}function D(){he.done(),fe.activateHandlers(null,null)}function M(){G.remove(),j.show(),j.css("visibility","visible"),e(t).removeData("Jcrop")}function A(e,t){he.release(),E();var o=new Image;o.onload=function(){var n=o.width,r=o.height,i=I.boxWidth,a=I.boxHeight;z.width(n).height(r),z.attr("src",e),W.attr("src",e),f(z,i,a),V=z.width(),Y=z.height(),W.width(V).height(Y),se.width(V+2*ae).height(Y+2*ae),G.width(V).height(Y),pe.resize(V,Y),F(),"function"==typeof t&&t.call(ge)},o.src=e}function P(e,t,o){var n=t||I.bgColor;I.bgFade&&i()&&I.fadeTime&&!o?e.animate({backgroundColor:n},{queue:!1,duration:I.fadeTime}):e.css("backgroundColor",n)}function L(e){I.allowResize?e?he.enableOnly():he.enableHandles():he.disableHandles(),fe.setCursor(I.allowSelect?"crosshair":"default"),he.setCursor(I.allowMove?"move":"default"),I.hasOwnProperty("trueSize")&&(te=I.trueSize[0]/V,oe=I.trueSize[1]/Y),I.hasOwnProperty("setSelect")&&(x(I.setSelect),he.done(),delete I.setSelect),pe.refresh(),I.bgColor!=le&&(P(I.shade?pe.getShades():G,I.shade?I.shadeColor||I.bgColor:I.bgColor),le=I.bgColor),ce!=I.bgOpacity&&(ce=I.bgOpacity,I.shade?pe.refresh():he.setBgOpacity(ce)),Q=I.maxSize[0]||0,Z=I.maxSize[1]||0,J=I.minSize[0]||0,ee=I.minSize[1]||0,I.hasOwnProperty("outerImage")&&(z.attr("src",I.outerImage),delete I.outerImage),he.refresh()}var R,I=e.extend({},e.Jcrop.defaults),O=navigator.userAgent.toLowerCase(),$=/msie/.test(O),N=/msie [1-6]\./.test(O);"object"!=typeof t&&(t=e(t)[0]),"object"!=typeof o&&(o={}),l(o);var U={border:"none",visibility:"visible",margin:0,padding:0,position:"absolute",top:0,left:0},j=e(t),H=!0;if("IMG"==t.tagName){if(0!=j[0].width&&0!=j[0].height)j.width(j[0].width),j.height(j[0].height);else{var B=new Image;B.src=j[0].src,j.width(B.width),j.height(B.height)}var z=j.clone().removeAttr("id").css(U).show();z.width(j.width()),z.height(j.height()),j.after(z).hide()}else z=j.css(U).show(),H=!1,null===I.shade&&(I.shade=!0);f(z,I.boxWidth,I.boxHeight);var V=z.width(),Y=z.height(),G=e("<div />").width(V).height(Y).addClass(r("holder")).css({position:"relative",backgroundColor:I.bgColor}).insertAfter(j).append(z);I.addClass&&G.addClass(I.addClass);var W=e("<div />"),q=e("<div />").width("100%").height("100%").css({zIndex:310,position:"absolute",overflow:"hidden"}),K=e("<div />").width("100%").height("100%").css("zIndex",320),X=e("<div />").css({position:"absolute",zIndex:600}).dblclick(function(){var e=ue.getFixed();I.onDblClick.call(ge,e)}).insertBefore(z).append(q,K);H&&(W=e("<img />").attr("src",z.attr("src")).css(U).width(V).height(Y),q.append(W)),N&&X.css({overflowY:"hidden"});var Q,Z,J,ee,te,oe,ne,re,ie,ae=I.boundary,se=b().width(V+2*ae).height(Y+2*ae).css({position:"absolute",top:n(-ae),left:n(-ae),zIndex:290}).mousedown(v),le=I.bgColor,ce=I.bgOpacity;R=a(z);var de=function(){function e(){var e,t={},o=["touchstart","touchmove","touchend"],n=document.createElement("div");try{for(e=0;e<o.length;e++){var r=o[e];r="on"+r;var i=r in n;i||(n.setAttribute(r,"return;"),i="function"==typeof n[r]),t[o[e]]=i}return t.touchstart&&t.touchend&&t.touchmove}catch(e){return!1}}function t(){return!0===I.touchSupport||!1===I.touchSupport?I.touchSupport:e()}return{createDragger:function(e){return function(t){return!I.disabled&&(!("move"===e&&!I.allowMove)&&(R=a(z),ne=!0,c(e,s(de.cfilter(t)),!0),t.stopPropagation(),t.preventDefault(),!1))}},newSelection:function(e){return v(de.cfilter(e))},cfilter:function(e){return e.pageX=e.originalEvent.changedTouches[0].pageX,e.pageY=e.originalEvent.changedTouches[0].pageY,e},isSupported:e,support:t()}}(),ue=function(){function e(e){e=a(e),f=p=e[0],m=h=e[1]}function t(e){e=a(e),d=e[0]-f,u=e[1]-m,f=e[0],m=e[1]}function o(){return[d,u]}function n(e){var t=e[0],o=e[1];0>p+t&&(t-=t+p),0>h+o&&(o-=o+h),Y<m+o&&(o+=Y-(m+o)),V<f+t&&(t+=V-(f+t)),p+=t,f+=t,h+=o,m+=o}function r(e){var t=i();switch(e){case"ne":return[t.x2,t.y];case"nw":return[t.x,t.y];case"se":return[t.x2,t.y2];case"sw":return[t.x,t.y2]}}function i(){if(!I.aspectRatio)return l();var e,t,o,n,r=I.aspectRatio,i=I.minSize[0]/te,a=I.maxSize[0]/te,d=I.maxSize[1]/oe,u=f-p,g=m-h,v=Math.abs(u),y=Math.abs(g),b=v/y;return 0===a&&(a=10*V),0===d&&(d=10*Y),b<r?(t=m,o=y*r,e=u<0?p-o:o+p,e<0?(e=0,n=Math.abs((e-p)/r),t=g<0?h-n:n+h):e>V&&(e=V,n=Math.abs((e-p)/r),t=g<0?h-n:n+h)):(e=f,n=v/r,t=g<0?h-n:h+n,t<0?(t=0,o=Math.abs((t-h)*r),e=u<0?p-o:o+p):t>Y&&(t=Y,o=Math.abs(t-h)*r,e=u<0?p-o:o+p)),e>p?(e-p<i?e=p+i:e-p>a&&(e=p+a),t=t>h?h+(e-p)/r:h-(e-p)/r):e<p&&(p-e<i?e=p-i:p-e>a&&(e=p-a),t=t>h?h+(p-e)/r:h-(p-e)/r),e<0?(p-=e,e=0):e>V&&(p-=e-V,e=V),t<0?(h-=t,t=0):t>Y&&(h-=t-Y,t=Y),c(s(p,h,e,t))}function a(e){return e[0]<0&&(e[0]=0),e[1]<0&&(e[1]=0),e[0]>V&&(e[0]=V),e[1]>Y&&(e[1]=Y),[Math.round(e[0]),Math.round(e[1])]}function s(e,t,o,n){var r=e,i=o,a=t,s=n;return o<e&&(r=o,i=e),n<t&&(a=n,s=t),[r,a,i,s]}function l(){var e,t=f-p,o=m-h;return Q&&Math.abs(t)>Q&&(f=t>0?p+Q:p-Q),Z&&Math.abs(o)>Z&&(m=o>0?h+Z:h-Z),ee/oe&&Math.abs(o)<ee/oe&&(m=o>0?h+ee/oe:h-ee/oe),J/te&&Math.abs(t)<J/te&&(f=t>0?p+J/te:p-J/te),p<0&&(f-=p,p-=p),h<0&&(m-=h,h-=h),f<0&&(p-=f,f-=f),m<0&&(h-=m,m-=m),f>V&&(e=f-V,p-=e,f-=e),m>Y&&(e=m-Y,h-=e,m-=e),p>V&&(e=p-Y,m-=e,h-=e),h>Y&&(e=h-Y,m-=e,h-=e),c(s(p,h,f,m))}function c(e){return{x:e[0],y:e[1],x2:e[2],y2:e[3],w:e[2]-e[0],h:e[3]-e[1]}}var d,u,p=0,h=0,f=0,m=0;return{flipCoords:s,setPressed:e,setCurrent:t,getOffset:o,moveOffset:n,getCorner:r,getFixed:i}}(),pe=function(){function t(e,t){f.left.css({height:n(t)}),f.right.css({height:n(t)})}function o(){return r(ue.getFixed())}function r(e){f.top.css({left:n(e.x),width:n(e.w),height:n(e.y)}),f.bottom.css({top:n(e.y2),left:n(e.x),width:n(e.w),height:n(Y-e.y2)}),f.right.css({left:n(e.x2),width:n(V-e.x2)}),f.left.css({width:n(e.x)})}function i(){return e("<div />").css({position:"absolute",backgroundColor:I.shadeColor||I.bgColor}).appendTo(h)}function a(){p||(p=!0,h.insertBefore(z),o(),he.setBgOpacity(1,0,1),W.hide(),s(I.shadeColor||I.bgColor,1),he.isAwake()?c(I.bgOpacity,1):c(1,1))}function s(e,t){P(u(),e,t)}function l(){p&&(h.remove(),W.show(),p=!1,he.isAwake()?he.setBgOpacity(I.bgOpacity,1,1):(he.setBgOpacity(1,1,1),he.disableHandles()),P(G,0,1))}function c(e,t){p&&(I.bgFade&&!t?h.animate({opacity:1-e},{queue:!1,duration:I.fadeTime}):h.css({opacity:1-e}))}function d(){I.shade?a():l(),he.isAwake()&&c(I.bgOpacity)}function u(){return h.children()}var p=!1,h=e("<div />").css({position:"absolute",zIndex:240,opacity:0}),f={top:i(),left:i().height(Y),right:i().height(Y),bottom:i()};return{update:o,updateRaw:r,getShades:u,setBgColor:s,enable:a,disable:l,resize:t,refresh:d,opacity:c}}(),he=function(){function t(t){var o=e("<div />").css({position:"absolute",opacity:I.borderOpacity}).addClass(r(t));return q.append(o),o}function o(t,o){var n=e("<div />").mousedown(h(t)).css({cursor:t+"-resize",position:"absolute",zIndex:o}).addClass("ord-"+t);return de.support&&n.bind("touchstart.jcrop",de.createDragger(t)),K.append(n),n}function i(e){var t=I.handleSize;return o(e,E++).css({opacity:I.handleOpacity}).width(t).height(t).addClass(r("handle"))}function a(e){return o(e,E++).addClass("jcrop-dragbar")}function s(e){var t;for(t=0;t<e.length;t++)M[e[t]]=a(e[t])}function l(e){var o,n;for(n=0;n<e.length;n++){switch(e[n]){case"n":o="hline";break;case"s":o="hline bottom";break;case"e":o="vline right";break;case"w":o="vline"}F[e[n]]=t(o)}}function c(e){var t;for(t=0;t<e.length;t++)D[e[t]]=i(e[t])}function d(e,t){I.shade||W.css({top:n(-t),left:n(-e)}),X.css({top:n(t),left:n(e)})}function u(e,t){X.width(Math.round(e)).height(Math.round(t))}function p(){var e=ue.getFixed();ue.setPressed([e.x,e.y]),ue.setCurrent([e.x2,e.y2]),f()}function f(e){if(T)return g(e)}function g(e){var t=ue.getFixed();u(t.w,t.h),d(t.x,t.y),I.shade&&pe.updateRaw(t),T||y(),e?I.onSelect.call(ge,m(t)):I.onChange.call(ge,m(t))}function v(e,t,o){(T||t)&&(I.bgFade&&!o?z.animate({opacity:e},{queue:!1,duration:I.fadeTime}):z.css("opacity",e))}function y(){X.show(),I.shade?pe.opacity(ce):v(ce,!0),T=!0}function C(){S(),X.hide(),I.shade?pe.opacity(1):v(1),T=!1,I.onRelease.call(ge)}function w(){A&&K.show()}function x(){if(A=!0,I.allowResize)return K.show(),!0}function S(){A=!1,K.hide()}function _(e){e?(re=!0,S()):(re=!1,x())}function k(){_(!1),p()}var T,E=370,F={},D={},M={},A=!1;I.dragEdges&&e.isArray(I.createDragbars)&&s(I.createDragbars),e.isArray(I.createHandles)&&c(I.createHandles),I.drawBorders&&e.isArray(I.createBorders)&&l(I.createBorders),e(document).bind("touchstart.jcrop-ios",function(t){e(t.currentTarget).hasClass("jcrop-tracker")&&t.stopPropagation()});var P=b().mousedown(h("move")).css({cursor:"move",position:"absolute",zIndex:360});return de.support&&P.bind("touchstart.jcrop",de.createDragger("move")),q.append(P),S(),{updateVisible:f,update:g,release:C,refresh:p,isAwake:function(){return T},setCursor:function(e){P.css("cursor",e)},enableHandles:x,enableOnly:function(){A=!0},showHandles:w,disableHandles:S,animMode:_,setBgOpacity:v,done:k}}(),fe=function(){function t(t){se.css({zIndex:450}),t?e(document).bind("touchmove.jcrop",a).bind("touchend.jcrop",l):p&&e(document).bind("mousemove.jcrop",n).bind("mouseup.jcrop",r)}function o(){se.css({zIndex:290}),e(document).unbind(".jcrop")}function n(e){return d(s(e)),!1}function r(e){return e.preventDefault(),e.stopPropagation(),ne&&(ne=!1,u(s(e)),he.isAwake()&&I.onSelect.call(ge,m(ue.getFixed())),o(),d=function(){},u=function(){}),!1}function i(e,o,n){return ne=!0,d=e,u=o,t(n),!1}function a(e){return d(s(de.cfilter(e))),!1}function l(e){return r(de.cfilter(e))}function c(e){se.css("cursor",e)}var d=function(){},u=function(){},p=I.trackDocument;return p||se.mousemove(n).mouseup(r).mouseout(r),z.before(se),{activateHandlers:i,setCursor:c}}(),me=function(){function t(){I.keySupport&&(i.show(),i.focus())}function o(){i.hide()}function n(e,t,o){I.allowMove&&(ue.moveOffset([t,o]),he.updateVisible(!0)),e.preventDefault(),e.stopPropagation()}function r(e){if(e.ctrlKey||e.metaKey)return!0;ie=!!e.shiftKey;var t=ie?10:1;switch(e.keyCode){case 37:n(e,-t,0);break;case 39:n(e,t,0);break;case 38:n(e,0,-t);break;case 40:n(e,0,t);break;case 27:I.allowSelect&&he.release();break;case 9:return!0}return!1}var i=e('<input type="radio" />').css({position:"fixed",left:"-120px",width:"12px"}).addClass("jcrop-keymgr"),a=e("<div />").css({position:"absolute",overflow:"hidden"}).append(i);return I.keySupport&&(i.keydown(r).blur(o),N||!I.fixedSupport?(i.css({position:"absolute",left:"-20px"}),a.append(i).insertBefore(z)):i.insertBefore(z)),{watchKeys:t}}();de.support&&se.bind("touchstart.jcrop",de.newSelection),K.hide(),L(!0);var ge={setImage:A,animateTo:w,setSelect:x,setOptions:T,tellSelect:_,tellScaled:k,setClass:C,disable:E,enable:F,cancel:D,release:he.release,destroy:M,focus:me.watchKeys,getBounds:function(){return[V*te,Y*oe]},getWidgetSize:function(){return[V,Y]},getScaleFactor:function(){return[te,oe]},getOptions:function(){return I},ui:{holder:G,selection:X}};return $&&G.bind("selectstart",function(){return!1}),j.data("Jcrop",ge),ge},e.fn.Jcrop=function(t,o){var n;return this.each(function(){if(e(this).data("Jcrop")){if("api"===t)return e(this).data("Jcrop");e(this).data("Jcrop").setOptions(t)}else"IMG"==this.tagName?e.Jcrop.Loader(this,function(){e(this).css({display:"block",visibility:"hidden"}),n=e.Jcrop(this,t),e.isFunction(o)&&o.call(n)}):(e(this).css({display:"block",visibility:"hidden"}),n=e.Jcrop(this,t),e.isFunction(o)&&o.call(n))}),this},e.Jcrop.Loader=function(t,o,n){function r(){a.complete?(i.unbind(".jcloader"),e.isFunction(o)&&o.call(a)):window.setTimeout(r,50)}var i=e(t),a=i[0];i.bind("load.jcloader",r).bind("error.jcloader",function(){i.unbind(".jcloader"),e.isFunction(n)&&n.call(a)}),a.complete&&e.isFunction(o)&&(i.unbind(".jcloader"),o.call(a))},e.Jcrop.defaults={allowSelect:!0,allowMove:!0,allowResize:!0,trackDocument:!0,baseClass:"jcrop",addClass:null,bgColor:"black",bgOpacity:.6,bgFade:!1,borderOpacity:.4,handleOpacity:.5,handleSize:7,aspectRatio:0,keySupport:!0,createHandles:["n","s","e","w","nw","ne","se","sw"],createDragbars:["n","s","e","w"],createBorders:["n","s","e","w"],drawBorders:!0,dragEdges:!0,fixedSupport:!0,touchSupport:null,shade:null,boxWidth:0,boxHeight:0,boundary:2,fadeTime:400,animationDelay:20,swingSpeed:3,minSelect:[0,0],maxSize:[0,0],minSize:[0,0],onChange:function(){},onSelect:function(){},onDblClick:function(){},onRelease:function(){}}}(jQuery),function(e){window.jcrop_api=null,window.init_papercrop=function(){e("div[id$=_cropbox]").each(function(){var t=e(this).attr("id").replace("_cropbox",""),o=!!e("#"+t+"_crop_preview").length,n=e("input#"+t+"_aspect").val();e(this).width();"false"===n&&(n=!1),update_crop=function(r){var i,a,s;o&&n&&(i=e("#"+t+"_crop_preview_wrapper").width(),a=i/r.w,s=i/r.h,e("img#"+t+"_crop_preview").css({width:Math.round(a*e("input[id$='_"+t+"_original_w']").val())+"px",height:Math.round(s*e("input[id$='_"+t+"_original_h']").val()/n)+"px",marginLeft:"-"+Math.round(a*r.x)+"px",marginTop:"-"+Math.round(s*r.y/n)+"px"})),e("#"+t+"_crop_x").val(Math.round(r.x)),e("#"+t+"_crop_y").val(Math.round(r.y)),e("#"+t+"_crop_w").val(Math.round(r.w)),e("#"+t+"_crop_h").val(Math.round(r.h))},e(this).find("img").Jcrop({onChange:update_crop,onSelect:update_crop,setSelect:[0,0,250,250],aspectRatio:!1===n?undefined:n,boxWidth:e("input[id$='_"+t+"_box_w']").val()},function(){jcrop_api=this})})},e(document).ready(function(){init_papercrop()})}(jQuery),function(e){"use strict";e.ajaxPrefilter(function(e){if(e.iframe)return e.originalURL=e.url,"iframe"}),e.ajaxTransport("iframe",function(t,o){function n(){s.each(function(t,o){var n=e(o);n.data("clone").replaceWith(n)}),r.remove(),i.one("load",function(){i.remove()}),i.attr("src","about:blank")}var r=null,i=null,a="iframe-"+e.now(),s=e(t.files).filter(":file:enabled"),l=null;if(t.dataTypes.shift(),t.data=o.data,s.length)return r=e("<form enctype='multipart/form-data' method='post'></form>").hide().attr({action:t.originalURL,target:a}),"string"==typeof t.data&&t.data.length>0&&e.error("data must not be serialized"),e.each(t.data||{},function(t,o){e.isPlainObject(o)&&(t=o.name,o=o.value),e("<input type='hidden' />").attr({name:t,value:o}).appendTo(r)}),e("<input type='hidden' value='IFrame' name='X-Requested-With' />").appendTo(r),l=t.dataTypes[0]&&t.accepts[t.dataTypes[0]]?t.accepts[t.dataTypes[0]]+("*"!==t.dataTypes[0]?", */*; q=0.01":""):t.accepts["*"],e("<input type='hidden' name='X-HTTP-Accept'>").attr("value",l).appendTo(r),s.after(function(){var t=e(this),o=t.clone().prop("disabled",!0);return t.data("clone",o),o}).next(),s.appendTo(r),{send:function(t,o){i=e("<iframe src='about:blank' name='"+a+"' id='"+a+"' style='display:none'></iframe>"),i.one("load",function(){i.one("load",function(){var e=this.contentWindow?this.contentWindow.document:this.contentDocument?this.contentDocument:this.document,t=e.documentElement?e.documentElement:e.body,r=t.getElementsByTagName("textarea")[0],i=r&&r.getAttribute("data-type")||null,a=r&&r.getAttribute("data-status")||200,s=r&&r.getAttribute("data-statusText")||"OK",l={html:t.innerHTML,text:i?r.value:t?t.textContent||t.innerText:null};n(),o(a,s,l,i?"Content-Type: "+i:null)}),r[0].submit()}),e("body").append(r,i)},abort:function(){null!==i&&(i.unbind("load").attr("src","about:blank"),n())}}})}(jQuery),function(e){var t;e.remotipart=t={setup:function(o){var n=o.data("ujs:submit-button"),r=e('meta[name="csrf-param"]').attr("content"),i=e('meta[name="csrf-token"]').attr("content"),a=o.find('input[name="'+r+'"]').length;o.one("ajax:beforeSend.remotipart",function(s,l,c){return delete c.beforeSend,c.iframe=!0,c.files=e(e.rails.fileInputSelector,o),c.data=o.serializeArray(),n&&c.data.push(n),c.files.each(function(e,t){for(var o=c.data.length-1;o>=0;o--)c.data[o].name==t.name&&c.data.splice(o,1)}),c.processData=!1,c.dataType===undefined&&(c.dataType="script *"),c.data.push({name:"remotipart_submitted",value:!0}),i&&r&&!a&&c.data.push({name:r,value:i}),e.rails.fire(o,"ajax:remotipartSubmit",[l,c])&&(e.rails.ajax(c).always(function(t){e.rails.fire(o,"ajax:remotipartComplete",[t])}),setTimeout(function(){e.rails.disableFormElements(o)},20)),t.teardown(o),!1}).data("remotipartSubmitted",!0)},teardown:function(e){e.unbind("ajax:beforeSend.remotipart").removeData("remotipartSubmitted")}},e(document).on("ajax:aborted:file","form",function(){var o=e(this);return t.setup(o),e.rails.handleRemote(o),!1})}(jQuery),function(e){var t=0,o=function(){return(new Date).getTime()+t++},n=function(e){return"["+e+"]$1"},r=function(e){return"_"+e+"_$1"},i=function(t,o,n){return t?"function"==typeof t?(o&&console.warn("association-insertion-traversal is ignored, because association-insertion-node is given as a function."),t(n)):"string"==typeof t?o?n[o](t):"this"==t?n:e(t):void 0:n.parent()};e(document).on("click",".add_fields",function(t){t.preventDefault();var a=e(this),s=a.data("association"),l=a.data("associations"),c=a.data("association-insertion-template"),d=a.data("association-insertion-method")||a.data("association-insertion-position")||"before",u=a.data("association-insertion-node"),p=a.data("association-insertion-traversal"),h=parseInt(a.data("count"),10),f=new RegExp("\\[new_"+s+"\\](.*?\\s)","g"),m=new RegExp("_new_"+s+"_(\\w*)","g"),g=o(),v=c.replace(f,n(g)),y=[];for(v==c&&(f=new RegExp("\\[new_"+l+"\\](.*?\\s)","g"),m=new RegExp("_new_"+l+"_(\\w*)","g"),v=c.replace(f,n(g))),v=v.replace(m,r(g)),y=[v],h=isNaN(h)?1:Math.max(h,1),h-=1;h;)g=o(),v=c.replace(f,n(g)),v=v.replace(m,r(g)),y.push(v),h-=1;var b=i(u,p,a);b&&0!=b.length||console.warn("Couldn't find the element to insert the template. Make sure your `data-association-insertion-*` on `link_to_add_association` is correct."),e.each(y,function(t,o){var n=e(o),r=jQuery.Event("cocoon:before-insert");if(b.trigger(r,[n]),!r.isDefaultPrevented()){b[d](n);b.trigger("cocoon:after-insert",[n])}})}),e(document).on("click",".remove_fields.dynamic, .remove_fields.existing",function(t){var o=e(this),n=o.data("wrapper-class")||"nested-fields",r=o.closest("."+n),i=r.parent();t.preventDefault();var a=jQuery.Event("cocoon:before-remove");if(i.trigger(a,[r]),!a.isDefaultPrevented()){var s=i.data("remove-timeout")||0;setTimeout(function(){o.hasClass("dynamic")?r.detach():(o.prev("input[type=hidden]").val("1"),r.hide()),i.trigger("cocoon:after-remove",[r])},s)}}),e(document).on("ready page:load turbolinks:load",function(){e(".remove_fields.existing.destroyed").each(function(){var t=e(this),o=t.data("wrapper-class")||"nested-fields";t.closest("."+o).hide()})})}(jQuery),void 0===Filterrific)var Filterrific={};Filterrific.submitFilterForm=function(){var e=$(this).parents("form"),t=e.attr("action");$(".filterrific_spinner").show(),$.ajax({url:t,data:e.serialize(),type:"GET",dataType:"script"}).done(function(){$(".filterrific_spinner").hide()})},function(e){e.fn.filterrific_observe_field=function(t,o){return t*=1e3,this.each(function(){var n=e(this),r=n.val(),i=function(){if(a())return void(l&&clearInterval(l));var e=n.val();r!=e&&(r=e,n.map(o))},a=function(){return 0==n.closest("html").length},s=function(){l&&(clearInterval(l),l=setInterval(i,t))};i();var l=setInterval(i,t);n.bind("keyup click mousemove",s)})}}(jQuery),Filterrific.init=function(){$("#filterrific_filter").on("change",":input",Filterrific.submitFilterForm),$(".filterrific-periodically-observed").filterrific_observe_field(.5,Filterrific.submitFilterForm)},jQuery(document).ready(Filterrific.init),jQuery(document).on("page:load",Filterrific.init);/***
This is part of jsdifflib v1.0. <http://snowtide.com/jsdifflib>

Copyright (c) 2007, Snowtide Informatics Systems, Inc.
All rights reserved.

Redistribution and use in source and binary forms, with or without modification,
are permitted provided that the following conditions are met:

	* Redistributions of source code must retain the above copyright notice, this
		list of conditions and the following disclaimer.
	* Redistributions in binary form must reproduce the above copyright notice,
		this list of conditions and the following disclaimer in the documentation
		and/or other materials provided with the distribution.
	* Neither the name of the Snowtide Informatics Systems nor the names of its
		contributors may be used to endorse or promote products derived from this
		software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY
EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT
SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH
DAMAGE.
***/
var __whitespace={" ":!0,"\t":!0,"\n":!0,"\f":!0,"\r":!0},difflib={defaultJunkFunction:function(e){return __whitespace.hasOwnProperty(e)},stripLinebreaks:function(e){return e.replace(/^[\n\r]*|[\n\r]*$/g,"")},stringAsLines:function(e){for(var t=e.indexOf("\n"),o=e.indexOf("\r"),n=t>-1&&o>-1||o<0?"\n":"\r",r=e.split(n),i=0;i<r.length;i++)r[i]=difflib.stripLinebreaks(r[i]);return r},__reduce:function(e,t,o){if(null!=o)var n=o,r=0;else{if(!t)return null;var n=t[0],r=1}for(;r<t.length;r++)n=e(n,t[r]);return n},__ntuplecomp:function(e,t){for(var o=Math.max(e.length,t.length),n=0;n<o;n++){if(e[n]<t[n])return-1;if(e[n]>t[n])return 1}return e.length==t.length?0:e.length<t.length?-1:1},__calculate_ratio:function(e,t){return t?2*e/t:1},__isindict:function(e){return function(t){return e.hasOwnProperty(t)}},__dictget:function(e,t,o){return e.hasOwnProperty(t)?e[t]:o},SequenceMatcher:function(e,t,o){this.set_seqs=function(e,t){this.set_seq1(e),this.set_seq2(t)},this.set_seq1=function(e){e!=this.a&&(this.a=e,this.matching_blocks=this.opcodes=null)},this.set_seq2=function(e){e!=this.b&&(this.b=e,this.matching_blocks=this.opcodes=this.fullbcount=null,this.__chain_b())},this.__chain_b=function(){for(var e=this.b,t=e.length,o=this.b2j={},n={},r=0;r<e.length;r++){var i=e[r];if(o.hasOwnProperty(i)){var a=o[i];t>=200&&100*a.length>t?(n[i]=1,delete o[i]):a.push(r)}else o[i]=[r]}for(var i in n)n.hasOwnProperty(i)&&delete o[i];var s=this.isjunk,l={};if(s){for(var i in n)n.hasOwnProperty(i)&&s(i)&&(l[i]=1,delete n[i]);for(var i in o)o.hasOwnProperty(i)&&s(i)&&(l[i]=1,delete o[i])}this.isbjunk=difflib.__isindict(l),this.isbpopular=difflib.__isindict(n)},this.find_longest_match=function(e,t,o,n){for(var r,i=this.a,a=this.b,s=this.b2j,l=this.isbjunk,c=e,d=o,u=0,p=null,h={},f=[],m=e;m<t;m++){var g={},v=difflib.__dictget(s,i[m],f);for(var y in v)if(v.hasOwnProperty(y)){if((p=v[y])<o)continue;if(p>=n)break;g[p]=r=difflib.__dictget(h,p-1,0)+1,r>u&&(c=m-r+1,d=p-r+1,u=r)}h=g}for(;c>e&&d>o&&!l(a[d-1])&&i[c-1]==a[d-1];)c--,d--,u++;for(;c+u<t&&d+u<n&&!l(a[d+u])&&i[c+u]==a[d+u];)u++;for(;c>e&&d>o&&l(a[d-1])&&i[c-1]==a[d-1];)c--,d--,u++;for(;c+u<t&&d+u<n&&l(a[d+u])&&i[c+u]==a[d+u];)u++;return[c,d,u]},this.get_matching_blocks=function(){if(null!=this.matching_blocks)return this.matching_blocks;for(var e,t,o,n,r,i,a,s,l,c=this.a.length,d=this.b.length,u=[[0,c,0,d]],p=[];u.length;)r=u.pop(),e=r[0],t=r[1],o=r[2],n=r[3],l=this.find_longest_match(e,t,o,n),i=l[0],a=l[1],(s=l[2])&&(p.push(l),e<i&&o<a&&u.push([e,i,o,a]),i+s<t&&a+s<n&&u.push([i+s,t,a+s,n]));p.sort(difflib.__ntuplecomp);var h,f,m,g=0,v=0,y=0,b=0,C=[];for(var w in p)p.hasOwnProperty(w)&&(b=p[w],h=b[0],f=b[1],m=b[2],g+y==h&&v+y==f?y+=m:(y&&C.push([g,v,y]),g=h,v=f,y=m));return y&&C.push([g,v,y]),C.push([c,d,0]),this.matching_blocks=C,this.matching_blocks},this.get_opcodes=function(){if(null!=this.opcodes)return this.opcodes;var e=0,t=0,o=[];this.opcodes=o;var n,r,i,a,s,l=this.get_matching_blocks();for(var c in l)l.hasOwnProperty(c)&&(n=l[c],r=n[0],i=n[1],a=n[2],s="",e<r&&t<i?s="replace":e<r?s="delete":t<i&&(s="insert"),s&&o.push([s,e,r,t,i]),e=r+a,t=i+a,a&&o.push(["equal",r,e,i,t]));return o},this.get_grouped_opcodes=function(e){e||(e=3);var t=this.get_opcodes();t||(t=[["equal",0,1,0,1]]);var o,n,r,i,a,s;"equal"==t[0][0]&&(o=t[0],n=o[0],r=o[1],i=o[2],a=o[3],s=o[4],t[0]=[n,Math.max(r,i-e),i,Math.max(a,s-e),s]),"equal"==t[t.length-1][0]&&(o=t[t.length-1],n=o[0],r=o[1],i=o[2],a=o[3],s=o[4],t[t.length-1]=[n,r,Math.min(i,r+e),a,Math.min(s,a+e)]);var l=e+e,c=[],d=[];for(var u in t)t.hasOwnProperty(u)&&(o=t[u],n=o[0],r=o[1],i=o[2],a=o[3],s=o[4],"equal"==n&&i-r>l&&(c.push([n,r,Math.min(i,r+e),a,Math.min(s,a+e)]),d.push(c),c=[],r=Math.max(r,i-e),a=Math.max(a,s-e)),c.push([n,r,i,a,s]));return!c||1==c.length&&"equal"==c[0][0]||d.push(c),d},this.ratio=function(){return matches=difflib.__reduce(function(e,t){return e+t[t.length-1]},this.get_matching_blocks(),0),difflib.__calculate_ratio(matches,this.a.length+this.b.length)},this.quick_ratio=function(){var e,t;if(null==this.fullbcount){this.fullbcount=e={};for(var o=0;o<this.b.length;o++)t=this.b[o],e[t]=difflib.__dictget(e,t,0)+1}e=this.fullbcount;for(var n={},r=difflib.__isindict(n),i=numb=0,o=0;o<this.a.length;o++)t=this.a[o],r(t)?numb=n[t]:numb=difflib.__dictget(e,t,0),n[t]=numb-1,numb>0&&i++;return difflib.__calculate_ratio(i,this.a.length+this.b.length)},this.real_quick_ratio=function(){var e=this.a.length,t=this.b.length;return _calculate_ratio(Math.min(e,t),e+t)},this.isjunk=o||difflib.defaultJunkFunction,this.a=this.b=null,this.set_seqs(e,t)}};/*
This is part of jsdifflib v1.0. <http://github.com/cemerick/jsdifflib>

Copyright 2007 - 2011 Chas Emerick <cemerick@snowtide.com>. All rights reserved.

Redistribution and use in source and binary forms, with or without modification, are
permitted provided that the following conditions are met:

   1. Redistributions of source code must retain the above copyright notice, this list of
      conditions and the following disclaimer.

   2. Redistributions in binary form must reproduce the above copyright notice, this list
      of conditions and the following disclaimer in the documentation and/or other materials
      provided with the distribution.

THIS SOFTWARE IS PROVIDED BY Chas Emerick ``AS IS'' AND ANY EXPRESS OR IMPLIED
WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND
FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL Chas Emerick OR
CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

The views and conclusions contained in the software and documentation are those of the
authors and should not be interpreted as representing official policies, either expressed
or implied, of Chas Emerick.
*/
diffview={buildView:function(e){function t(e,t){var o=document.createElement(e);return o.className=t,o}function o(e,t){var o=document.createElement(e);return o.appendChild(document.createTextNode(t)),o}function n(e,t,o){var n=document.createElement(e);return n.className=t,n.appendChild(document.createTextNode(o)),n}function r(e,r,i,a,s){return r<i?(e.appendChild(o("th",(r+1).toString())),e.appendChild(n("td",s,a[r].replace(/\t/g,"\xa0\xa0\xa0\xa0"))),r+1):(e.appendChild(document.createElement("th")),e.appendChild(t("td","empty")),r)}function i(e,t,r,i,a){e.appendChild(o("th",null==t?"":(t+1).toString())),e.appendChild(o("th",null==r?"":(r+1).toString())),e.appendChild(n("td",a,i[null!=t?t:r].replace(/\t/g,"\xa0\xa0\xa0\xa0")))}var a=e.baseTextLines,s=e.newTextLines,l=e.opcodes,c=e.baseTextName?e.baseTextName:"Base Text",d=e.newTextName?e.newTextName:"New Text",u=e.contextSize,p=0==e.viewType||1==e.viewType?e.viewType:0;if(null==a)throw"Cannot build diff view; baseTextLines is not defined.";if(null==s)throw"Cannot build diff view; newTextLines is not defined.";if(!l)throw"Canno build diff view; opcodes is not defined.";var h=document.createElement("thead"),f=document.createElement("tr");h.appendChild(f),p?(f.appendChild(document.createElement("th")),f.appendChild(document.createElement("th")),f.appendChild(n("th","texttitle",c+" vs. "+d))):(f.appendChild(document.createElement("th")),f.appendChild(n("th","texttitle",c)),f.appendChild(document.createElement("th")),f.appendChild(n("th","texttitle",d))),h=[h];for(var m,g=[],v=0;v<l.length;v++){code=l[v],change=code[0];for(var y=code[1],b=code[2],C=code[3],w=code[4],x=Math.max(b-y,w-C),S=[],_=[],k=0;k<x;k++){if(u&&l.length>1&&(v>0&&k==u||0==v&&0==k)&&"equal"==change){var T=x-(0==v?1:2)*u;if(T>1){if(S.push(f=document.createElement("tr")),y+=T,C+=T,k+=T-1,f.appendChild(o("th","...")),p||f.appendChild(n("td","skip","")),f.appendChild(o("th","...")),f.appendChild(n("td","skip","")),v+1==l.length)break;continue}}S.push(f=document.createElement("tr")),p?"insert"==change?i(f,null,C++,s,change):"replace"==change?(_.push(m=document.createElement("tr")),y<b&&i(f,y++,null,a,"delete"),C<w&&i(m,null,C++,s,"insert")):"delete"==change?i(f,y++,null,a,change):i(f,y++,C++,a,change):(y=r(f,y,b,a,change),C=r(f,C,w,s,change))}for(var k=0;k<S.length;k++)g.push(S[k]);for(var k=0;k<_.length;k++)g.push(_[k])}g.push(f=n("th","author","diff view generated by ")),f.setAttribute("colspan",p?3:4),f.appendChild(m=o("a","jsdifflib")),m.setAttribute("href","http://github.com/cemerick/jsdifflib"),h.push(f=document.createElement("tbody"));for(var v in g)g.hasOwnProperty(v)&&f.appendChild(g[v]);f=t("table","diff"+(p?" inlinediff":""));for(var v in h)h.hasOwnProperty(v)&&f.appendChild(h[v]);return f}},function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var t=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}();!function(o){var n="ekkoLightbox",r=o.fn[n],i={title:"",footer:"",showArrows:!0,type:null,alwaysShowClose:!1,loadingMessage:'<div class="ekko-lightbox-loader"><div><div></div><div></div></div></div>',leftArrow:"<span>&#10094;</span>",rightArrow:"<span>&#10095;</span>",strings:{close:"Close",fail:"Failed to load image:",type:"Could not detect remote target type. Force the type using data-type"},doc:document,onShow:function(){},onShown:function(){},onHide:function(){},onHidden:function(){},onNavigate:function(){},onContentLoaded:function(){}},a=function(){function n(t,r){var a=this;e(this,n),this._config=o.extend({},i,r),this._$modalArrows=null,this._galleryIndex=0,this._galleryName=null,this._padding=null,this._border=null,this._titleIsShown=!1,this._footerIsShown=!1,this._wantedWidth=0,this._wantedHeight=0,this._modalId="ekkoLightbox-"+Math.floor(1e3*Math.random()+1),this._$element=t instanceof jQuery?t:o(t),this._isBootstrap3=3==o.fn.modal.Constructor.VERSION[0];var s='<h4 class="modal-title">'+(this._config.title||"&nbsp;")+"</h4>",l='<button type="button" class="close" data-dismiss="modal" aria-label="'+this._config.strings.close+'"><span aria-hidden="true">&times;</span></button>',c='<div class="modal-header"'+(this._config.title||this._config.alwaysShowClose?"":' style="display:none"')+">"+(this._isBootstrap3?l+s:s+l)+"</div>",d='<div class="modal-footer"'+(this._config.footer?"":' style="display:none"')+">"+(this._config.footer||"&nbsp;")+"</div>",u='<div class="modal-body"><div class="ekko-lightbox-container"><div class="ekko-lightbox-item fade in show"></div><div class="ekko-lightbox-item fade"></div></div></div>',p='<div class="modal-dialog" role="document"><div class="modal-content">'+c+u+d+"</div></div>";o(this._config.doc.body).append('<div id="'+this._modalId+'" class="ekko-lightbox modal fade" tabindex="-1" tabindex="-1" role="dialog" aria-hidden="true">'+p+"</div>"),this._$modal=o("#"+this._modalId,this._config.doc),this._$modalDialog=this._$modal.find(".modal-dialog").first(),this._$modalContent=this._$modal.find(".modal-content").first(),this._$modalBody=this._$modal.find(".modal-body").first(),this._$modalHeader=this._$modal.find(".modal-header").first(),this._$modalFooter=this._$modal.find(".modal-footer").first(),this._$lightboxContainer=this._$modalBody.find(".ekko-lightbox-container").first(),this._$lightboxBodyOne=this._$lightboxContainer.find("> div:first-child").first(),this._$lightboxBodyTwo=this._$lightboxContainer.find("> div:last-child").first(),this._border=this._calculateBorders(),this._padding=this._calculatePadding(),this._galleryName=this._$element.data("gallery"),this._galleryName&&(this._$galleryItems=o(document.body).find('*[data-gallery="'+this._galleryName+'"]'),this._galleryIndex=this._$galleryItems.index(this._$element),o(document).on("keydown.ekkoLightbox",this._navigationalBinder.bind(this)),this._config.showArrows&&this._$galleryItems.length>1&&(this._$lightboxContainer.append('<div class="ekko-lightbox-nav-overlay"><a href="#">'+this._config.leftArrow+'</a><a href="#">'+this._config.rightArrow+"</a></div>"),this._$modalArrows=this._$lightboxContainer.find("div.ekko-lightbox-nav-overlay").first(),this._$lightboxContainer.on("click","a:first-child",function(e){return e.preventDefault(),a.navigateLeft()}),this._$lightboxContainer.on("click","a:last-child",function(e){return e.preventDefault(),a.navigateRight()}))),this._$modal.on("show.bs.modal",this._config.onShow.bind(this)).on("shown.bs.modal",function(){return a._toggleLoading(!0),a._handle(),a._config.onShown.call(a)}).on("hide.bs.modal",this._config.onHide.bind(this)).on("hidden.bs.modal",function(){return a._galleryName&&(o(document).off("keydown.ekkoLightbox"),o(window).off("resize.ekkoLightbox")),a._$modal.remove(),a._config.onHidden.call(a)}).modal(this._config),o(window).on("resize.ekkoLightbox",function(){a._resize(a._wantedWidth,a._wantedHeight)})}return t(n,null,[{key:"Default",get:function(){return i}}]),t(n,[{key:"element",value:function(){return this._$element}},{key:"modal",value:function(){return this._$modal}},{key:"navigateTo",value:function(e){if(e<0||e>this._$galleryItems.length-1)return this;this._galleryIndex=e,this._$element=o(this._$galleryItems.get(this._galleryIndex)),this._handle()}},{key:"navigateLeft",value:function(){if(1!==this._$galleryItems.length)return 0===this._galleryIndex?this._galleryIndex=this._$galleryItems.length-1:this._galleryIndex--,this._config.onNavigate.call(this,"left",this._galleryIndex),this.navigateTo(this._galleryIndex)}},{key:"navigateRight",value:function(){if(1!==this._$galleryItems.length)return this._galleryIndex===this._$galleryItems.length-1?this._galleryIndex=0:this._galleryIndex++,this._config.onNavigate.call(this,"right",this._galleryIndex),this.navigateTo(this._galleryIndex)}},{key:"close",value:function(){return this._$modal.modal("hide")}},{key:"_navigationalBinder",value:function(e){return e=e||window.event,39===e.keyCode?this.navigateRight():37===e.keyCode?this.navigateLeft():void 0}},{key:"_detectRemoteType",value:function(e,t){return t=t||!1,!t&&this._isImage(e)&&(t="image"),!t&&this._getYoutubeId(e)&&(t="youtube"),!t&&this._getVimeoId(e)&&(t="vimeo"),!t&&this._getInstagramId(e)&&(t="instagram"),(!t||["image","youtube","vimeo","instagram","video","url"].indexOf(t)<0)&&(t="url"),t}},{key:"_isImage",value:function(e){return e&&e.match(/(^data:image\/.*,)|(\.(jp(e|g|eg)|gif|png|bmp|webp|svg)((\?|#).*)?$)/i)}},{key:"_containerToUse",value:function(){var e=this,t=this._$lightboxBodyTwo,o=this._$lightboxBodyOne;return this._$lightboxBodyTwo.hasClass("in")&&(t=this._$lightboxBodyOne,o=this._$lightboxBodyTwo),o.removeClass("in show"),setTimeout(function(){e._$lightboxBodyTwo.hasClass("in")||e._$lightboxBodyTwo.empty(),e._$lightboxBodyOne.hasClass("in")||e._$lightboxBodyOne.empty()},500),t.addClass("in show"),t}},{key:"_handle",value:function(){var e=this._containerToUse();this._updateTitleAndFooter();var t=this._$element.attr("data-remote")||this._$element.attr("href"),o=this._detectRemoteType(t,this._$element.attr("data-type")||!1);if(["image","youtube","vimeo","instagram","video","url"].indexOf(o)<0)return this._error(this._config.strings.type);switch(o){case"image":this._preloadImage(t,e),this._preloadImageByIndex(this._galleryIndex,3);break;case"youtube":this._showYoutubeVideo(t,e);break;case"vimeo":this._showVimeoVideo(this._getVimeoId(t),e);break;case"instagram":this._showInstagramVideo(this._getInstagramId(t),e);break;case"video":this._showHtml5Video(t,e);break;default:this._loadRemoteContent(t,e)}return this}},{key:"_getYoutubeId",value:function(e){if(!e)return!1;var t=e.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/);return!(!t||11!==t[2].length)&&t[2]}},{key:"_getVimeoId",value:function(e){return!!(e&&e.indexOf("vimeo")>0)&&e}},{key:"_getInstagramId",value:function(e){return!!(e&&e.indexOf("instagram")>0)&&e}},{key:"_toggleLoading",value:function(e){return e=e||!1,e?(this._$modalDialog.css("display","none"),this._$modal.removeClass("in show"),o(".modal-backdrop").append(this._config.loadingMessage)):(this._$modalDialog.css("display","block"),this._$modal.addClass("in show"),o(".modal-backdrop").find(".ekko-lightbox-loader").remove()),this}},{key:"_calculateBorders",value:function(){return{top:this._totalCssByAttribute("border-top-width"),right:this._totalCssByAttribute("border-right-width"),bottom:this._totalCssByAttribute("border-bottom-width"),left:this._totalCssByAttribute("border-left-width")}}},{key:"_calculatePadding",value:function(){return{top:this._totalCssByAttribute("padding-top"),right:this._totalCssByAttribute("padding-right"),bottom:this._totalCssByAttribute("padding-bottom"),left:this._totalCssByAttribute("padding-left")}}},{key:"_totalCssByAttribute",value:function(e){return parseInt(this._$modalDialog.css(e),10)+parseInt(this._$modalContent.css(e),10)+parseInt(this._$modalBody.css(e),10)}},{key:"_updateTitleAndFooter",value:function(){var e=this._$element.data("title")||"",t=this._$element.data("footer")||"";return this._titleIsShown=!1,e||this._config.alwaysShowClose?(this._titleIsShown=!0,this._$modalHeader.css("display","").find(".modal-title").html(e||"&nbsp;")):this._$modalHeader.css("display","none"),this._footerIsShown=!1,t?(this._footerIsShown=!0,this._$modalFooter.css("display","").html(t)):this._$modalFooter.css("display","none"),this}},{key:"_showYoutubeVideo",value:function(e,t){var o=this._getYoutubeId(e),n=e.indexOf("&")>0?e.substr(e.indexOf("&")):"",r=this._$element.data("width")||560,i=this._$element.data("height")||r/(560/315);return this._showVideoIframe("//www.youtube.com/embed/"+o+"?badge=0&autoplay=1&html5=1"+n,r,i,t)}},{key:"_showVimeoVideo",value:function(e,t){var o=this._$element.data("width")||500,n=this._$element.data("height")||o/(560/315);return this._showVideoIframe(e+"?autoplay=1",o,n,t)}},{key:"_showInstagramVideo",value:function(e,t){var o=this._$element.data("width")||612,n=o+80;return e="/"!==e.substr(-1)?e+"/":e,t.html('<iframe width="'+o+'" height="'+n+'" src="'+e+'embed/" frameborder="0" allowfullscreen></iframe>'),this._resize(o,n),this._config.onContentLoaded.call(this),this._$modalArrows&&this._$modalArrows.css("display","none"),this._toggleLoading(!1),this}},{key:"_showVideoIframe",value:function(e,t,o,n){return o=o||t,n.html('<div class="embed-responsive embed-responsive-16by9"><iframe width="'+t+'" height="'+o+'" src="'+e+'" frameborder="0" allowfullscreen class="embed-responsive-item"></iframe></div>'),this._resize(t,o),this._config.onContentLoaded.call(this),this._$modalArrows&&this._$modalArrows.css("display","none"),this._toggleLoading(!1),this}},{key:"_showHtml5Video",value:function(e,t){var o=this._$element.data("width")||560,n=this._$element.data("height")||o/(560/315);return t.html('<div class="embed-responsive embed-responsive-16by9"><video width="'+o+'" height="'+n+'" src="'+e+'" preload="auto" autoplay controls class="embed-responsive-item"></video></div>'),this._resize(o,n),this._config.onContentLoaded.call(this),this._$modalArrows&&this._$modalArrows.css("display","none"),this._toggleLoading(!1),this}},{key:"_loadRemoteContent",value:function(e,t){var n=this,r=this._$element.data("width")||560,i=this._$element.data("height")||560,a=this._$element.data("disableExternalCheck")||!1;return this._toggleLoading(!1),a||this._isExternal(e)?(t.html('<iframe src="'+e+'" frameborder="0" allowfullscreen></iframe>'),this._config.onContentLoaded.call(this)):t.load(e,o.proxy(function(){return n._$element.trigger("loaded.bs.modal")})),this._$modalArrows&&this._$modalArrows.css("display","none"),this._resize(r,i),this}},{key:"_isExternal",value:function(e){var t=e.match(/^([^:\/?#]+:)?(?:\/\/([^\/?#]*))?([^?#]+)?(\?[^#]*)?(#.*)?/);return"string"==typeof t[1]&&t[1].length>0&&t[1].toLowerCase()!==location.protocol||"string"==typeof t[2]&&t[2].length>0&&t[2].replace(new RegExp(":("+{"http:":80,"https:":443}[location.protocol]+")?$"),"")!==location.host}},{key:"_error",value:function(e){return console.error(e),this._containerToUse().html(e),this._resize(300,300),this}},{key:"_preloadImageByIndex",value:function(e,t){if(this._$galleryItems){var n=o(this._$galleryItems.get(e),!1);if(void 0!==n){var r=n.attr("data-remote")||n.attr("href");return("image"===n.attr("data-type")||this._isImage(r))&&this._preloadImage(r,!1),t>0?this._preloadImageByIndex(e+1,t-1):void 0}}}},{key:"_preloadImage",value:function(e,t){var n=this;t=t||!1;var r=new Image;return t&&function(){var i=setTimeout(function(){t.append(n._config.loadingMessage)},200);r.onload=function(){i&&clearTimeout(i),i=null;var e=o("<img />");return e.attr("src",r.src),e.addClass("img-fluid"),e.css("width","100%"),t.html(e),n._$modalArrows&&n._$modalArrows.css("display",""),n._resize(r.width,r.height),n._toggleLoading(!1),n._config.onContentLoaded.call(n)},r.onerror=function(){return n._toggleLoading(!1),n._error(n._config.strings.fail+"  "+e)}}(),r.src=e,r}},{key:"_resize",value:function(e,t){t=t||e,this._wantedWidth=e,this._wantedHeight=t;var n=this._padding.left+this._padding.right+this._border.left+this._border.right,r=Math.min(e+n,this._config.doc.body.clientWidth);e+n>r?(t*=(r-n)/e,e=r):e+=n;var i=0,a=0;this._footerIsShown&&(a=this._$modalFooter.outerHeight(!0)||55),this._titleIsShown&&(i=this._$modalHeader.outerHeight(!0)||67);var s=this._padding.top+this._padding.bottom+this._border.bottom+this._border.top,l=parseFloat(this._$modalDialog.css("margin-top"))+parseFloat(this._$modalDialog.css("margin-bottom")),c=Math.min(t,o(window).height()-s-l-i-a);if(t>c){var d=Math.min(c/t,1);e=Math.ceil(d*e)}if(this._$lightboxContainer.css("height",c),this._$modalDialog.css("width","auto").css("maxWidth",e),this._isBootstrap3){var u=this._$modal.data("bs.modal");u&&u.handleUpdate()}else{var u=this._$modal.data("bs.modal");u&&u._handleUpdate()}return this}}],[{key:"_jQueryInterface",value:function(e){var t=this;return e=e||{},this.each(function(){var r=o(t),i=o.extend({},n.Default,r.data(),"object"==typeof e&&e);new n(t,i)})}}]),n}();o.fn[n]=a._jQueryInterface,o.fn[n].Constructor=a,o.fn[n].noConflict=function(){return o.fn[n]=r,a._jQueryInterface}}(jQuery)}(jQuery),function(e,t){"function"==typeof define&&define.amd?define([],t.bind(e,this)):"object"==typeof module&&module.exports?module.exports=t.call(e,this):e.SocialCalc=t.call(e,this)}(this,function(e){/*
// The module of the SocialCalc package with customizable constants, strings, etc.
// This is where most of the common localizations are done.
//
// (c) Copyright 2008, 2009, 2010 Socialtext, Inc.
// All Rights Reserved.
//
// The contents of this file are subject to the Artistic License 2.0; you may not
// use this file except in compliance with the License. You may obtain a copy of
// the License at http://socialcalc.org/licenses/al-20/.
//
// Some of the other files in the SocialCalc package are licensed under
// different licenses. Please note the licenses of the modules you use.
//
// Code History:
//
// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.
// Based in part on the SocialCalc 1.1.0 code written in Perl.
// The SocialCalc 1.1.0 code was:
//    Portions (c) Copyright 2005, 2006, 2007 Software Garden, Inc.
//    All Rights Reserved.
//    Portions (c) Copyright 2007 Socialtext, Inc.
//    All Rights Reserved.
// The Perl SocialCalc started as modifications to the wikiCalc(R) program, version 1.0.
// wikiCalc 1.0 was written by Software Garden, Inc.
// Unless otherwise specified, referring to "SocialCalc" in comments refers to this
// JavaScript version of the code, not the SocialCalc Perl code.
//
*/
var t;t||(t={}),t.Constants={cellDataType:{v:"value",n:"value",t:"text",f:"formula",c:"constant"},textdatadefaulttype:"t",s_BrowserNotSupported:"Browser not supported.",s_InternalError:"Internal SocialCalc error (probably an internal bug): ",s_pssUnknownColType:"Unknown col type item",s_pssUnknownRowType:"Unknown row type item",s_pssUnknownLineType:"Unknown line type",s_cfspUnknownCellType:"Unknown cell type item",doCanonicalizeSheet:!0,s_escUnknownSheetCmd:"Unknown sheet command: ",s_escUnknownSetCoordCmd:"Unknown set coord command: ",s_escUnknownCmd:"Unknown command: ",s_caccCircRef:"Circular reference to ",defaultRowNameWidth:"30",defaultAssumedRowHeight:15,defaultCellIDPrefix:"cell_",defaultCellLayout:"padding:2px 2px 1px 2px;vertical-align:top;",defaultCellFontStyle:"normal normal",defaultCellFontSize:"small",defaultCellFontFamily:"Verdana,Arial,Helvetica,sans-serif",defaultPaneDividerWidth:"3",defaultPaneDividerHeight:"3",defaultGridCSS:"1px solid #C0C0C0;",defaultCommentClass:"",defaultCommentStyle:"background-repeat:no-repeat;background-position:top right;background-image:url(images/sc-commentbg.gif);",defaultCommentNoGridClass:"",defaultCommentNoGridStyle:"",defaultReadonlyClass:"",defaultReadonlyStyle:"background-repeat:no-repeat;background-position:top right;background-image:url(images/sc-lockbg.gif);",defaultReadonlyNoGridClass:"",defaultReadonlyNoGridStyle:"",defaultReadonlyComment:"Locked cell",defaultColWidth:"80",defaultMinimumColWidth:10,defaultHighlightTypeCursorClass:"",defaultHighlightTypeCursorStyle:"color:#FFF;backgroundColor:#A6A6A6;",defaultHighlightTypeRangeClass:"",defaultHighlightTypeRangeStyle:"color:#000;backgroundColor:#E5E5E5;",defaultColnameClass:"",defaultColnameStyle:"overflow:visible;font-size:small;text-align:center;color:#FFFFFF;background-color:#808080;",defaultSelectedColnameClass:"",defaultSelectedColnameStyle:"overflow:visible;font-size:small;text-align:center;color:#FFFFFF;background-color:#404040;",defaultRownameClass:"",defaultRownameStyle:"position:relative;overflow:visible;font-size:small;text-align:right;color:#FFFFFF;background-color:#808080;",defaultSelectedRownameClass:"",defaultSelectedRownameStyle:"position:relative;overflow:visible;font-size:small;text-align:right;color:#FFFFFF;background-color:#404040;",defaultUpperLeftClass:"",defaultUpperLeftStyle:"font-size:small;",defaultSkippedCellClass:"",defaultSkippedCellStyle:"font-size:small;background-color:#CCC",defaultPaneDividerClass:"",defaultPaneDividerStyle:"font-size:small;background-color:#C0C0C0;padding:0px;",defaultUnhideLeftClass:"",defaultUnhideLeftStyle:"float:right;width:9px;height:12px;cursor:pointer;background-image:url(images/sc-unhideleft.gif);padding:0;",defaultUnhideRightClass:"",defaultUnhideRightStyle:"float:left;width:9px;height:12px;cursor:pointer;background-image:url(images/sc-unhideright.gif);padding:0;",defaultUnhideTopClass:"",defaultUnhideTopStyle:"float:left;left:1px;position:absolute;bottom:-4px;width:12px;height:9px;cursor:pointer;background-image:url(images/sc-unhidetop.gif);padding:0;",defaultUnhideBottomClass:"",defaultUnhideBottomStyle:"float:left;width:12px;height:9px;cursor:pointer;background-image:url(images/sc-unhidebottom.gif);padding:0;",defaultColResizeBarClass:"col-resize-bar",defaultRowResizeBarClass:"row-resize-bar",s_rcMissingSheet:"Render Context must have a sheet object",defaultLinkFormatString:'<span style="font-size:smaller;text-decoration:none !important;background-color:#66B;color:#FFF;">Link</span>',defaultPageLinkFormatString:'<span style="font-size:smaller;text-decoration:none !important;background-color:#66B;color:#FFF;">Page</span>',defaultFormatp:"#,##0.0%",defaultFormatc:"[$$]#,##0.00",defaultFormatdt:"d-mmm-yyyy h:mm:ss",defaultFormatd:"d-mmm-yyyy",defaultFormatt:"[h]:mm:ss",defaultDisplayTRUE:"TRUE",defaultDisplayFALSE:"FALSE",defaultImagePrefix:"/sc_images/sc_",defaultTableEditorIDPrefix:"te_",defaultPageUpDnAmount:15,AllowCtrlS:!0,defaultTableControlThickness:20,cteGriddivClass:"",s_statusline_executing:"Executing...",s_statusline_displaying:"Displaying...",s_statusline_ordering:"Ordering...",s_statusline_calculating:"Calculating...",s_statusline_calculatingls:"Calculating... Loading Sheet...",s_statusline_doingserverfunc:"doing server function ",s_statusline_incell:" in cell ",s_statusline_calcstart:"Calculation start...",s_statusline_sum:"SUM",s_statusline_recalcneeded:'<span style="color:#999;">(Recalc needed)</span>',s_statusline_circref:'<span style="color:red;">Circular reference: ',s_statusline_sendemail:"Sending Email ",s_inputboxdisplaymultilinetext:"[Multi-line text: Click icon on right to edit]",defaultInputEchoClass:"",defaultInputEchoStyle:"filter:alpha(opacity=90);opacity:.9;backgroundColor:#FFD;border:1px solid #884;fontSize:small;padding:2px 10px 1px 2px;cursor:default;",defaultInputEchoPromptClass:"",defaultInputEchoPromptStyle:"filter:alpha(opacity=90);opacity:.9;backgroundColor:#FFD;borderLeft:1px solid #884;borderRight:1px solid #884;borderBottom:1px solid #884;fontSize:small;fontStyle:italic;padding:2px 10px 1px 2px;cursor:default;",defaultInputEchoHintClass:"",defaultInputEchoHintStyle:"filter:alpha(opacity=80);opacity:.8;backgroundColor:#884;border:1px solid #884;fontSize:small;fontWeight:bold;padding:2px 2px 2px 2px;color:#FFF;position:absolute;top:-20px;cursor:default;",ietUnknownFunction:"Unknown function ",CH_radius1:29,CH_radius2:41,s_CHfillAllTooltip:"Fill Contents and Formats Down/Right",s_CHfillContentsTooltip:"Fill Contents Only Down/Right",s_CHmovePasteAllTooltip:"Move Contents and Formats",s_CHmovePasteContentsTooltip:"Move Contents Only",s_CHmoveInsertAllTooltip:"Slide Contents and Formats within Row/Col",s_CHmoveInsertContentsTooltip:"Slide Contents within Row/Col",s_CHindicatorOperationLookup:{Fill:"Fill",FillC:"Fill Contents",Move:"Move",MoveI:"Slide",MoveC:"Move Contents",MoveIC:"Slide Contents"},s_CHindicatorDirectionLookup:{Down:" Down",Right:" Right",Horizontal:" Horizontal",Vertical:" Vertical"},defaultTCSliderThickness:9,defaultTCButtonThickness:20,defaultTCThumbThickness:15,TCmainStyle:"backgroundColor:#EEE;",TCmainClass:"",TCendcapStyle:"backgroundColor:#FFF;",TCendcapClass:"",TCpanesliderClass:"tc-paneslider",s_panesliderTooltiph:"Drag to lock pane vertically",s_panesliderTooltipv:"Drag to lock pane horizontally",TClessbuttonStyle:"backgroundColor:#AAA;",TClessbuttonClass:"",TClessbuttonRepeatWait:300,TClessbuttonRepeatInterval:20,TCmorebuttonStyle:"backgroundColor:#AAA;",TCmorebuttonClass:"",TCmorebuttonRepeatWait:300,TCmorebuttonRepeatInterval:20,TCscrollareaStyle:"backgroundColor:#DDD;",TCscrollareaClass:"",TCscrollareaRepeatWait:500,TCscrollareaRepeatInterval:100,TCthumbClass:"",TCthumbStyle:"backgroundColor:#CCC;",TCPStrackinglineClass:"tracklingine",TCPStrackinglineStyle:"overflow:hidden;position:absolute;zIndex:100;",TCPStrackinglineThickness:"2px",TCTDFSthumbstatusvClass:"",TCTDFSthumbstatusvStyle:"height:20px;width:auto;border:3px solid #808080;overflow:hidden;backgroundColor:#FFF;fontSize:small;position:absolute;zIndex:100;",TCTDFSthumbstatushClass:"",TCTDFSthumbstatushStyle:"height:20px;width:auto;border:1px solid black;padding:2px;backgroundColor:#FFF;fontSize:small;position:absolute;zIndex:100;",TCTDFSthumbstatusrownumClass:"",TCTDFSthumbstatusrownumStyle:"color:#FFF;background-color:#808080;font-size:small;white-space:nowrap;padding:3px;",TCTDFStopOffsetv:0,TCTDFSleftOffsetv:-80,s_TCTDFthumbstatusPrefixv:"Row ",TCTDFStopOffseth:-30,TCTDFSleftOffseth:0,s_TCTDFthumbstatusPrefixh:"Col ",TooltipOffsetX:2,TooltipOffsetY:10,TDpopupElementClass:"",TDpopupElementStyle:"border:1px solid black;padding:1px 2px 2px 2px;textAlign:center;backgroundColor:#FFF;fontSize:7pt;fontFamily:Verdana,Arial,Helvetica,sans-serif;position:absolute;width:auto;zIndex:110;",SCToolbarbackground:"background-color:#ffffff;",SCTabbackground:"background-color:#CCC;",SCTabselectedCSS:"font-size:small;padding:6px 30px 6px 8px;color:#FFF;background-color:#404040;cursor:default;border-right:1px solid #CCC;",SCTabplainCSS:"font-size:small;padding:6px 30px 6px 8px;color:#FFF;background-color:#808080;cursor:default;border-right:1px solid #CCC;",SCToolbartext:"font-size:x-small;font-weight:bold;color:#888",SCFormulabarheight:30,SCStatuslineheight:20,SCStatuslineCSS:"font-size:10px;padding:3px 0px;",SCFormatNumberFormats:"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!Automatic!:general|%loc!Auto w/ commas!:[,]General|[break]:|00:00|000:000|0000:0000|00000:00000|[break]:|%loc!Formula!:formula|%loc!Hidden!:hidden|[newcol]:1234:0|1,234:#,##0|1,234.5:#,##0.0|1,234.56:#,##0.00|1,234.567:#,##0.000|1,234.5678:#,##0.0000|[break]:|1,234%:#,##0%|1,234.5%:#,##0.0%|1,234.56%:#,##0.00%|[newcol]:|$1,234:$#,##0|$1,234.5:$#,##0.0|$1,234.56:$#,##0.00|[break]:|(1,234):#,##0_);(#,##0)|(1,234.5):#,##0.0_);(#,##0.0)|(1,234.56):#,##0.00_);(#,##0.00)|[break]:|($1,234):$#,##0_);($#,##0)|($1,234.5):$#,##0.0_);($#,##0.0)|($1,234.56):$#,##0.00_);($#,##0.00)|[newcol]:|1/4/06:m/d/yy|01/04/2006:mm/dd/yyyy|2006-01-04:yyyy-mm-dd|4-Jan-06:d-mmm-yy|04-Jan-2006:dd-mmm-yyyy|January 4, 2006:mmmm d, yyyy|[break]:|1\\c23:h:mm|1\\c23 PM:h:mm AM/PM|1\\c23\\c45:h:mm:ss|01\\c23\\c45:hh:mm:ss|26\\c23 (h\\cm):[hh]:mm|69\\c45 (m\\cs):[mm]:ss|69 (s):[ss]|[newcol]:|2006-01-04 01\\c23\\c45:yyyy-mm-dd hh:mm:ss|January 4, 2006:mmmm d, yyyy hh:mm:ss|Wed:ddd|Wednesday:dddd|",SCFormatTextFormats:"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!Automatic!:general|%loc!Plain Text!:text-plain|HTML:text-html|%loc!Wikitext!:text-wiki|%loc!Link!:text-link|%loc!Formula!:formula|%loc!Hidden!:hidden|",SCFormatPadsizes:"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!No padding!:0px|[newcol]:|1 pixel:1px|2 pixels:2px|3 pixels:3px|4 pixels:4px|5 pixels:5px|6 pixels:6px|7 pixels:7px|8 pixels:8px|[newcol]:|9 pixels:9px|10 pixels:10px|11 pixels:11px|12 pixels:12px|13 pixels:13px|14 pixels:14px|16 pixels:16px|18 pixels:18px|[newcol]:|20 pixels:20px|22 pixels:22px|24 pixels:24px|28 pixels:28px|36 pixels:36px|",SCFormatFontsizes:"[cancel]:|[break]:|%loc!Default!:|[custom]:|X-Small:x-small|Small:small|Medium:medium|Large:large|X-Large:x-large|[newcol]:|6pt:6pt|7pt:7pt|8pt:8pt|9pt:9pt|10pt:10pt|11pt:11pt|12pt:12pt|14pt:14pt|16pt:16pt|[newcol]:|18pt:18pt|20pt:20pt|22pt:22pt|24pt:24pt|28pt:28pt|36pt:36pt|48pt:48pt|72pt:72pt|[newcol]:|8 pixels:8px|9 pixels:9px|10 pixels:10px|11 pixels:11px|12 pixels:12px|13 pixels:13px|14 pixels:14px|[newcol]:|16 pixels:16px|18 pixels:18px|20 pixels:20px|22 pixels:22px|24 pixels:24px|28 pixels:28px|36 pixels:36px|",SCFormatFontfamilies:"[cancel]:|[break]:|%loc!Default!:|[custom]:|Verdana:Verdana,Arial,Helvetica,sans-serif|Arial:arial,helvetica,sans-serif|Courier:'Courier New',Courier,monospace|",SCFormatFontlook:"[cancel]:|[break]:|%loc!Default!:|%loc!Normal!:normal normal|%loc!Bold!:normal bold|%loc!Italic!:italic normal|%loc!Bold Italic!:italic bold",SCFormatTextAlignhoriz:"[cancel]:|[break]:|%loc!Default!:|%loc!Left!:left|%loc!Center!:center|%loc!Right!:right|",SCFormatNumberAlignhoriz:"[cancel]:|[break]:|%loc!Default!:|%loc!Left!:left|%loc!Center!:center|%loc!Right!:right|",SCFormatAlignVertical:"[cancel]:|[break]:|%loc!Default!:|%loc!Top!:top|%loc!Middle!:middle|%loc!Bottom!:bottom|",SCFormatColwidth:"[cancel]:|[break]:|%loc!Default!:|[custom]:|[newcol]:|20 pixels:20|40:40|60:60|80:80|100:100|120:120|140:140|160:160|[newcol]:|180 pixels:180|200:200|220:220|240:240|260:260|280:280|300:300|",SCFormatRecalc:"[cancel]:|[break]:|%loc!Auto!:|%loc!Manual!:off|",SCFormatUserMaxCol:"[cancel]:|[break]:|%loc!Default!:|[custom]:|[newcol]:|Unlimited:0|10:10|20:20|30:30|40:40|50:50|60:60|80:80|100:100|",SCFormatUserMaxRow:"[cancel]:|[break]:|%loc!Default!:|[custom]:|[newcol]:|Unlimited:0|10:10|20:20|30:30|40:40|50:50|60:60|80:80|100:100|",ISCButtonNormalBackground:"transparent",ISCButtonBorderNormal:"none",ISCButtonBorderHover:"none",ISCButtonBorderDown:"none",ISCButtonDownBackground:"#888",s_PopupListCancel:"[Cancel]",s_PopupListCustom:"Custom",s_loc_align_center:"Align Center",s_loc_align_left:"Align Left",s_loc_align_right:"Align Right",s_loc_alignment:"Alignment",s_loc_audit:"Audit",s_loc_audit_trail_this_session:"Audit Trail This Session",s_loc_auto:"Auto",s_loc_auto_sum:"Auto Sum",s_loc_auto_wX_commas:"Auto w/ commas",s_loc_automatic:"Automatic",s_loc_background:"Background",s_loc_bold:"Bold",s_loc_bold_XampX_italics:"Bold &amp; Italics",s_loc_bold_italic:"Bold Italic",s_loc_borders:"Borders",s_loc_borders_off:"Borders Off",s_loc_borders_on:"Borders On",s_loc_bottom:"Bottom",s_loc_bottom_border:"Bottom Border",s_loc_cell_settings:"CELL SETTINGS",s_loc_csv_format:"CSV format",s_loc_cancel:"Cancel",s_loc_category:"Category",s_loc_center:"Center",s_loc_clear:"Clear",s_loc_clear_socialcalc_clipboard:"Clear SocialCalc Clipboard",s_loc_clipboard:"Clipboard",s_loc_color:"Color",s_loc_column_:"Column ",s_loc_comment:"Comment",s_loc_copy:"Copy",s_loc_custom:"Custom",s_loc_cut:"Cut",s_loc_default:"Default",s_loc_default_alignment:"Default Alignment",s_loc_default_column_width:"Default Column Width",s_loc_default_font:"Default Font",s_loc_default_format:"Default Format",s_loc_default_padding:"Default Padding",s_loc_delete:"Delete",s_loc_delete_column:"Delete Column",s_loc_delete_contents:"Delete Cell Contents",s_loc_delete_row:"Delete Row",s_loc_description:"Description",s_loc_display_clipboard_in:"Display Clipboard in",s_loc_down:"Down",s_loc_edit:"Edit",s_loc_existing_names:"Existing Names",s_loc_family:"Family",s_loc_fill_down:"Fill Down",s_loc_fill_right:"Fill Right",s_loc_font:"Font",s_loc_format:"Format",s_loc_formula:"Formula",s_loc_function_list:"Function List",s_loc_functions:"Functions",s_loc_grid:"Grid",s_loc_hidden:"Hidden",s_loc_hide_column:"Hide Column",s_loc_hide_row:"Hide Row",s_loc_horizontal:"Horizontal",s_loc_insert_column:"Insert Column Before",s_loc_insert_row:"Insert Row Before",s_loc_italic:"Italic",s_loc_last_sort:"Last Sort",s_loc_left:"Left",s_loc_left_border:"Left Border",s_loc_link:"Link",s_loc_link_input_box:"Link Input Box",s_loc_list:"List",s_loc_load_socialcalc_clipboard_with_this:"Load SocialCalc Clipboard With This",s_loc_lock_cell:"Lock Cell",s_loc_major_sort:"Major Sort",s_loc_manual:"Manual",s_loc_merge_cells:"Merge/Unmerge Cells",s_loc_middle:"Middle",s_loc_minor_sort:"Minor Sort",s_loc_move_insert:"Move Insert",s_loc_move_paste:"Move Paste",s_loc_multiXline_input_box:"Multi-line Input Box",s_loc_name:"Name",s_loc_names:"Names",s_loc_no_padding:"No padding",s_loc_normal:"Normal",s_loc_number:"Number",s_loc_number_horizontal:"Number Horizontal",s_loc_ok:"OK",s_loc_padding:"Padding",s_loc_page_name:"Page Name",s_loc_paste:"Paste",s_loc_paste_formats:"Paste Formats",s_loc_plain_text:"Plain Text",s_loc_recalc:"Recalc",s_loc_recalculation:"Recalculation",s_loc_redo:"Redo",s_loc_right:"Right",s_loc_right_border:"Right Border",s_loc_sheet_settings:"SHEET SETTINGS",s_loc_save:"Save",s_loc_save_to:"Save to",s_loc_set_cell_contents:"Set Cell Contents",s_loc_set_cells_to_sort:"Set Cells To Sort",s_loc_set_value_to:"Set Value To",s_loc_set_to_link_format:"Set to Link format",s_loc_setXclear_move_from:"Set/Clear Move From",s_loc_show_cell_settings:"Show Cell Settings",s_loc_show_sheet_settings:"Show Sheet Settings",s_loc_show_in_new_browser_window:"Show in new browser window",s_loc_size:"Size",s_loc_socialcalcXsave_format:"SocialCalc-save format",s_loc_sort:"Sort",s_loc_sort_:"Sort ",s_loc_sort_cells:"Sort Cells",s_loc_swap_colors:"Swap Colors",s_loc_tabXdelimited_format:"Tab-delimited format",s_loc_text:"Text",s_loc_text_horizontal:"Text Horizontal",s_loc_this_is_aXbrXsample:"This is a<br>sample",s_loc_top:"Top",s_loc_top_border:"Top Border",s_loc_undone_steps:"UNDONE STEPS",s_loc_url:"URL",s_loc_undo:"Undo",s_loc_unlock_cell:"Unlock Cell",s_loc_unmerge_cells:"Unmerge Cells",s_loc_up:"Up",s_loc_value:"Value",s_loc_vertical:"Vertical",s_loc_wikitext:"Wikitext",s_loc_workspace:"Workspace",s_loc_XnewX:"[New]",s_loc_XnoneX:"[None]",s_loc_Xselect_rangeX:"[select range]",SVStatuslineheight:20,SVStatuslineCSS:"font-size:10px;padding:3px 0px;",FormatNumber_separatorchar:",",FormatNumber_decimalchar:".",FormatNumber_defaultCurrency:"$",s_FormatNumber_daynames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],s_FormatNumber_daynames3:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],s_FormatNumber_monthnames:["January","February","March","April","May","June","July","August","September","October","November","December"],s_FormatNumber_monthnames3:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],s_FormatNumber_am:"AM",s_FormatNumber_am1:"A",s_FormatNumber_pm:"PM",s_FormatNumber_pm1:"P",s_parseerrexponent:"Improperly formed number exponent",s_parseerrchar:"Unexpected character in formula",s_parseerrstring:"Improperly formed string",s_parseerrspecialvalue:"Improperly formed special value",s_parseerrtwoops:"Error in formula (two operators inappropriately in a row)",s_parseerrmissingopenparen:"Missing open parenthesis in list with comma(s). ",s_parseerrcloseparennoopen:"Closing parenthesis without open parenthesis. ",s_parseerrmissingcloseparen:"Missing close parenthesis. ",s_parseerrmissingoperand:"Missing operand. ",s_parseerrerrorinformula:"Error in formula.",s_calcerrerrorvalueinformula:"Error value in formula",s_parseerrerrorinformulabadval:"Error in formula resulting in bad value",s_formularangeresult:"Formula results in range value:",s_calcerrnumericnan:"Formula results in an bad numeric value",s_calcerrnumericoverflow:"Numeric overflow",s_sheetunavailable:"Sheet unavailable:",s_calcerrcellrefmissing:"Cell reference missing when expected.",s_calcerrsheetnamemissing:"Sheet name missing when expected.",s_circularnameref:"Circular name reference to name",s_calcerrunknownname:"Unknown name",s_calcerrincorrectargstofunction:"Incorrect arguments to function",s_sheetfuncunknownfunction:"Unknown function",s_sheetfunclnarg:"LN argument must be greater than 0",s_sheetfunclog10arg:"LOG10 argument must be greater than 0",s_sheetfunclogsecondarg:"LOG second argument must be numeric greater than 0",s_sheetfunclogfirstarg:"LOG first argument must be greater than 0",s_sheetfuncroundsecondarg:"ROUND second argument must be numeric",s_sheetfuncddblife:"DDB life must be greater than 1",s_sheetfuncslnlife:"SLN life must be greater than 1",s_fdef_ABS:"Absolute value function. ",s_fdef_ACOS:"Trigonometric arccosine function. ",s_fdef_AND:"True if all arguments are true. ",s_fdef_ASIN:"Trigonometric arcsine function. ",s_fdef_ATAN:"Trigonometric arctan function. ",s_fdef_ATAN2:"Trigonometric arc tangent function (result is in radians). ",s_fdef_AVERAGE:"Averages the values. ",s_fdef_CHOOSE:"Returns the value specified by the index. The values may be ranges of cells. ",s_fdef_COLUMNS:"Returns the number of columns in the range. ",s_fdef_COS:"Trigonometric cosine function (value is in radians). ",s_fdef_COUNT:"Counts the number of numeric values, not blank, text, or error. ",s_fdef_COUNTA:"Counts the number of non-blank values. ",s_fdef_COUNTBLANK:'Counts the number of blank values. (Note: "" is not blank.) ',s_fdef_COUNTIF:'Counts the number of number of cells in the range that meet the criteria. The criteria may be a value ("x", 15, 1+3) or a test (>25). ',s_fdef_DATE:'Returns the appropriate date value given numbers for year, month, and day. For example: DATE(2006,2,1) for February 1, 2006. Note: In this program, day "1" is December 31, 1899 and the year 1900 is not a leap year. Some programs use January 1, 1900, as day "1" and treat 1900 as a leap year. In both cases, though, dates on or after March 1, 1900, are the same. ',s_fdef_DAVERAGE:"Averages the values in the specified field in records that meet the criteria. ",s_fdef_DAY:"Returns the day of month for a date value. ",s_fdef_DCOUNT:"Counts the number of numeric values, not blank, text, or error, in the specified field in records that meet the criteria. ",s_fdef_DCOUNTA:"Counts the number of non-blank values in the specified field in records that meet the criteria. ",s_fdef_DDB:"Returns the amount of depreciation at the given period of time (the default factor is 2 for double-declining balance).   ",s_fdef_DEGREES:"Converts value in radians into degrees. ",s_fdef_DGET:"Returns the value of the specified field in the single record that meets the criteria. ",s_fdef_DMAX:"Returns the maximum of the numeric values in the specified field in records that meet the criteria. ",s_fdef_DMIN:"Returns the maximum of the numeric values in the specified field in records that meet the criteria. ",s_fdef_DPRODUCT:"Returns the result of multiplying the numeric values in the specified field in records that meet the criteria. ",s_fdef_DSTDEV:"Returns the sample standard deviation of the numeric values in the specified field in records that meet the criteria. ",s_fdef_DSTDEVP:"Returns the standard deviation of the numeric values in the specified field in records that meet the criteria. ",s_fdef_DSUM:"Returns the sum of the numeric values in the specified field in records that meet the criteria. ",s_fdef_DVAR:"Returns the sample variance of the numeric values in the specified field in records that meet the criteria. ",s_fdef_DVARP:"Returns the variance of the numeric values in the specified field in records that meet the criteria. ",s_fdef_EVEN:"Rounds the value up in magnitude to the nearest even integer. ",s_fdef_EXACT:'Returns "true" if the values are exactly the same, including case, type, etc. ',s_fdef_EXP:"Returns e raised to the value power. ",s_fdef_FACT:"Returns factorial of the value. ",s_fdef_FALSE:'Returns the logical value "false". ',s_fdef_FIND:'Returns the starting position within string2 of the first occurrence of string1 at or after "start". If start is omitted, 1 is assumed. ',s_fdef_FV:"Returns the future value of repeated payments of money invested at the given rate for the specified number of periods, with optional present value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). ",s_fdef_HLOOKUP:"Look for the matching value for the given value in the range and return the corresponding value in the cell specified by the row offset. If rangelookup is 1 (the default) and not 0, match if within numeric brackets (match<=value) instead of exact match. ",s_fdef_HOUR:"Returns the hour portion of a time or date/time value. ",s_fdef_IF:"Results in true-value if logical-expression is TRUE or non-zero, otherwise results in false-value. ",s_fdef_INDEX:"Returns a cell or range reference for the specified row and column in the range. If range is 1-dimensional, then only one of rownum or colnum are needed. If range is 2-dimensional and rownum or colnum are zero, a reference to the range of just the specified column or row is returned. You can use the returned reference value in a range, e.g., sum(A1:INDEX(A2:A10,4)). ",s_fdef_INT:"Returns the value rounded down to the nearest integer (towards -infinity). ",s_fdef_IRR:"Returns the interest rate at which the cash flows in the range have a net present value of zero. Uses an iterative process that will return #NUM! error if it does not converge. There may be more than one possible solution. Providing the optional guess value may help in certain situations where it does not converge or finds an inappropriate solution (the default guess is 10%). ",s_fdef_ISBLANK:'Returns "true" if the value is a reference to a blank cell. ',s_fdef_ISERR:'Returns "true" if the value is of type "Error" but not "NA". ',s_fdef_ISERROR:'Returns "true" if the value is of type "Error". ',s_fdef_ISLOGICAL:'Returns "true" if the value is of type "Logical" (true/false). ',s_fdef_ISNA:'Returns "true" if the value is the error type "NA". ',s_fdef_ISNONTEXT:'Returns "true" if the value is not of type "Text". ',s_fdef_ISNUMBER:'Returns "true" if the value is of type "Number" (including logical values). ',s_fdef_ISTEXT:'Returns "true" if the value is of type "Text". ',s_fdef_LEFT:"Returns the specified number of characters from the text value. If count is omitted, 1 is assumed. ",s_fdef_LEN:"Returns the number of characters in the text value. ",s_fdef_LN:"Returns the natural logarithm of the value. ",s_fdef_LOG:"Returns the logarithm of the value using the specified base. ",s_fdef_LOG10:"Returns the base 10 logarithm of the value. ",s_fdef_LOWER:"Returns the text value with all uppercase characters converted to lowercase. ",s_fdef_MATCH:"Look for the matching value for the given value in the range and return position (the first is 1) in that range. If rangelookup is 1 (the default) and not 0, match if within numeric brackets (match<=value) instead of exact match. If rangelookup is -1, act like 1 but the bracket is match>=value. ",s_fdef_MAX:"Returns the maximum of the numeric values. ",s_fdef_MID:"Returns the specified number of characters from the text value starting from the specified position. ",s_fdef_MIN:"Returns the minimum of the numeric values. ",s_fdef_MINUTE:"Returns the minute portion of a time or date/time value. ",s_fdef_MOD:"Returns the remainder of the first value divided by the second. ",s_fdef_MONTH:"Returns the month part of a date value. ",s_fdef_N:"Returns the value if it is a numeric value otherwise an error. ",s_fdef_NA:"Returns the #N/A error value which propagates through most operations. ",s_fdef_NOT:"Returns FALSE if value is true, and TRUE if it is false. ",s_fdef_NOW:"Returns the current date/time. ",s_fdef_NPER:"Returns the number of periods at which payments invested each period at the given rate with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period) has the given present value. ",s_fdef_NPV:"Returns the net present value of cash flows (which may be individual values and/or ranges) at the given rate. The flows are positive if income, negative if paid out, and are assumed at the end of each period. ",s_fdef_ODD:"Rounds the value up in magnitude to the nearest odd integer. ",s_fdef_OR:"True if any argument is true ",s_fdef_PI:"The value 3.1415926... ",s_fdef_PMT:"Returns the amount of each payment that must be invested at the given rate for the specified number of periods to have the specified present value, with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). ",s_fdef_POWER:"Returns the first value raised to the second value power. ",s_fdef_PRODUCT:"Returns the result of multiplying the numeric values. ",s_fdef_PROPER:"Returns the text value with the first letter of each word converted to uppercase and the others to lowercase. ",s_fdef_PV:"Returns the present value of the given number of payments each invested at the given rate, with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). ",s_fdef_RADIANS:"Converts value in degrees into radians. ",s_fdef_RATE:"Returns the rate at which the given number of payments each invested at the given rate has the specified present value, with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). Uses an iterative process that will return #NUM! error if it does not converge. There may be more than one possible solution. Providing the optional guess value may help in certain situations where it does not converge or finds an inappropriate solution (the default guess is 10%). ",s_fdef_REPLACE:"Returns text1 with the specified number of characters starting from the specified position replaced by text2. ",s_fdef_REPT:"Returns the text repeated the specified number of times. ",s_fdef_RIGHT:"Returns the specified number of characters from the text value starting from the end. If count is omitted, 1 is assumed. ",s_fdef_ROUND:"Rounds the value to the specified number of decimal places. If precision is negative, then round to powers of 10. The default precision is 0 (round to integer). ",s_fdef_ROWS:"Returns the number of rows in the range. ",s_fdef_SECOND:"Returns the second portion of a time or date/time value (truncated to an integer). ",s_fdef_SIN:"Trigonometric sine function (value is in radians) ",s_fdef_SLN:"Returns the amount of depreciation at each period of time using the straight-line method. ",s_fdef_SQRT:"Square root of the value ",s_fdef_STDEV:"Returns the sample standard deviation of the numeric values. ",s_fdef_STDEVP:"Returns the standard deviation of the numeric values. ",s_fdef_SUBSTITUTE:'Returns text1 with the all occurrences of oldtext replaced by newtext. If "occurrence" is present, then only that occurrence is replaced. ',s_fdef_SUM:"Adds the numeric values. The values to the sum function may be ranges in the form similar to A1:B5. ",s_fdef_SUMIF:'Sums the numeric values of cells in the range that meet the criteria. The criteria may be a value ("x", 15, 1+3) or a test (>25). If range2 is present, then range1 is tested and the corresponding range2 value is summed. ',s_fdef_SYD:"Depreciation by Sum of Year's Digits method. ",s_fdef_T:"Returns the text value or else a null string. ",s_fdef_TAN:"Trigonometric tangent function (value is in radians) ",s_fdef_TIME:"Returns the time value given the specified hour, minute, and second. ",s_fdef_TODAY:'Returns the current date (an integer). Note: In this program, day "1" is December 31, 1899 and the year 1900 is not a leap year. Some programs use January 1, 1900, as day "1" and treat 1900 as a leap year. In both cases, though, dates on or after March 1, 1900, are the same. ',s_fdef_TRIM:"Returns the text value with leading, trailing, and repeated spaces removed. ",s_fdef_TRUE:'Returns the logical value "true". ',s_fdef_TRUNC:"Truncates the value to the specified number of decimal places. If precision is negative, truncate to powers of 10. ",s_fdef_UPPER:"Returns the text value with all lowercase characters converted to uppercase. ",s_fdef_VALUE:"Converts the specified text value into a numeric value. Various forms that look like numbers (including digits followed by %, forms that look like dates, etc.) are handled. This may not handle all of the forms accepted by other spreadsheets and may be locale dependent. ",s_fdef_VAR:"Returns the sample variance of the numeric values. ",s_fdef_VARP:"Returns the variance of the numeric values. ",s_fdef_VLOOKUP:"Look for the matching value for the given value in the range and return the corresponding value in the cell specified by the column offset. If rangelookup is 1 (the default) and not 0, match if within numeric brackets (match>=value) instead of exact match. ",s_fdef_WEEKDAY:"Returns the day of week specified by the date value. If type is 1 (the default), Sunday is day and Saturday is day 7. If type is 2, Monday is day 1 and Sunday is day 7. If type is 3, Monday is day 0 and Sunday is day 6. ",s_fdef_YEAR:"Returns the year part of a date value. ",s_fdef_SUMPRODUCT:"Sums the pairwise products of 2 or more ranges. The ranges must be of equal length.",s_fdef_CEILING:"Rounds the given number up to the nearest integer or multiple of significance. Significance is the value to whose multiple of ten the value is to be rounded up (.01, .1, 1, 10, etc.)",s_fdef_FLOOR:"Rounds the given number down to the nearest multiple of significance. Significance is the value to whose multiple of ten the number is to be rounded down (.01, .1, 1, 10, etc.)",s_farg_v:"value",s_farg_vn:"value1, value2, ...",s_farg_xy:"valueX, valueY",s_farg_choose:"index, value1, value2, ...",s_farg_range:"range",s_farg_rangec:"range, criteria",s_farg_date:"year, month, day",s_farg_dfunc:"databaserange, fieldname, criteriarange",s_farg_ddb:"cost, salvage, lifetime, period, [factor]",s_farg_find:"string1, string2, [start]",s_farg_fv:"rate, n, payment, [pv, [paytype]]",s_farg_hlookup:"value, range, row, [rangelookup]",s_farg_iffunc:"logical-expression, true-value, [false-value]",s_farg_index:"range, rownum, colnum",s_farg_irr:"range, [guess]",s_farg_tc:"text, count",s_farg_log:"value, base",s_farg_match:"value, range, [rangelookup]",s_farg_mid:"text, start, length",s_farg_nper:"rate, payment, pv, [fv, [paytype]]",s_farg_npv:"rate, value1, value2, ...",s_farg_pmt:"rate, n, pv, [fv, [paytype]]",s_farg_pv:"rate, n, payment, [fv, [paytype]]",s_farg_rate:"n, payment, pv, [fv, [paytype, [guess]]]",s_farg_replace:"text1, start, length, text2",s_farg_vp:"value, [precision]",s_farg_valpre:"value, precision",s_farg_csl:"cost, salvage, lifetime",s_farg_cslp:"cost, salvage, lifetime, period",s_farg_subs:"text1, oldtext, newtext, [occurrence]",s_farg_sumif:"range1, criteria, [range2]",s_farg_hms:"hour, minute, second",s_farg_txt:"text",s_farg_vlookup:"value, range, col, [rangelookup]",s_farg_weekday:"date, [type]",s_farg_dt:"date",
s_farg_rangen:"range1, range2, ...",s_farg_vsig:"value, [significance]",function_classlist:["all","stat","lookup","datetime","financial","test","math","text","gui","action"],s_fclass_all:"All",s_fclass_stat:"Statistics",s_fclass_lookup:"Lookup",s_fclass_datetime:"Date & Time",s_fclass_financial:"Financial",s_fclass_test:"Test",s_fclass_math:"Math",s_fclass_text:"Text",s_fclass_action:"Email & Copy",s_fclass_gui:"Button & Input",lastone:null},t.ConstantsDefaultClasses={defaultComment:"",defaultCommentNoGrid:"",defaultHighlightTypeCursor:"",defaultHighlightTypeRange:"",defaultColname:"",defaultSelectedColname:"",defaultRowname:"",defaultSelectedRowname:"",defaultUpperLeft:"",defaultSkippedCell:"",defaultPaneDivider:"",cteGriddiv:"",defaultInputEcho:{classname:"",style:"filter:alpha(opacity=90);opacity:.9;"},TCmain:"",TCendcap:"",TCpaneslider:"",TClessbutton:"",TCmorebutton:"",TCscrollarea:"",TCthumb:"",TCPStrackingline:"",TCTDFSthumbstatus:"",TDpopupElement:""},t.ConstantsSetClasses=function(e){var o,n=t.ConstantsDefaultClasses,r=t.Constants;e=e||"";for(o in n)"string"==typeof n[o]?(r[o+"Class"]=e+(n[o]||o),r[o+"Style"]!==undefined&&(r[o+"Style"]="")):"object"==typeof n[o]&&(r[o+"Class"]=e+(n[o].classname||o),r[o+"Style"]=n[o].style)},t.ConstantsSetImagePrefix=function(e){var o=t.Constants;for(var n in o)"string"==typeof o[n]&&(o[n]=o[n].replace(o.defaultImagePrefix,e));o.defaultImagePrefix=e};/*
// (c) Copyright 2010 Socialtext, Inc.
// All Rights Reserved.
//
// The contents of this file are subject to the Artistic License 2.0; you may not
// use this file except in compliance with the License. You may obtain a copy of
// the License at http://socialcalc.org/licenses/al-20/.
//
// Some of the other files in the SocialCalc package are licensed under
// different licenses. Please note the licenses of the modules you use.
//
// Code History:
//
// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.
// Based in part on the SocialCalc 1.1.0 code written in Perl.
// The SocialCalc 1.1.0 code was:
//    Portions (c) Copyright 2005, 2006, 2007 Software Garden, Inc.
//    All Rights Reserved.
//    Portions (c) Copyright 2007 Socialtext, Inc.
//    All Rights Reserved.
// The Perl SocialCalc started as modifications to the wikiCalc(R) program, version 1.0.
// wikiCalc 1.0 was written by Software Garden, Inc.
// Unless otherwise specified, referring to "SocialCalc" in comments refers to this
// JavaScript version of the code, not the SocialCalc Perl code.
//
*/
var t;t||(t={}),t.Callbacks={expand_wiki:null,expand_markup:function(e,o,n){return t.default_expand_markup(e,o,n)},MakePageLink:null,NormalizeSheetName:null},t.Cell=function(e){this.coord=e,this.datavalue="",this.datatype=null,this.formula="",this.valuetype="b",this.readonly=!1},t.CellProperties={coord:1,datavalue:1,datatype:1,formula:1,valuetype:1,errors:1,comment:1,readonly:1,bt:2,br:2,bb:2,bl:2,layout:2,font:2,color:2,bgcolor:2,cellformat:2,nontextvalueformat:2,textvalueformat:2,colspan:2,rowspan:2,cssc:2,csss:2,mod:2,displaystring:3,parseinfo:3,hcolspan:3,hrowspan:3},t.CellPropertiesTable={bt:"borderstyle",br:"borderstyle",bb:"borderstyle",bl:"borderstyle",layout:"layout",font:"font",color:"color",bgcolor:"color",cellformat:"cellformat",nontextvalueformat:"valueformat",textvalueformat:"valueformat"},t.Sheet=function(){t.ResetSheet(this),this.statuscallback=null,this.statuscallbackparams=null},t.ResetSheet=function(e){e.cells={},e.attribs={lastcol:1,lastrow:1,defaultlayout:0,usermaxcol:0,usermaxrow:0},e.rowattribs={hide:{},height:{}},e.colattribs={width:{},hide:{}},e.names={},e.layouts=[],e.layouthash={},e.fonts=[],e.fonthash={},e.colors=[],e.colorhash={},e.borderstyles=[],e.borderstylehash={},e.cellformats=[],e.cellformathash={},e.valueformats=[],e.valueformathash={},e.matched_cells=[],e.selected_search_cell=undefined,e.copiedfrom="",e.changes=new t.UndoStack,e.renderneeded=!1,e.changedrendervalues=!0,e.recalcchangedavalue=!1,e.hiddencolrow="",e.sci=new t.SheetCommandInfo(e),e.ioEventTree={},e.ioParameterList={}},t.Sheet.prototype.ResetSheet=function(){t.ResetSheet(this)},t.Sheet.prototype.AddCell=function(e){return this.cells[e.coord]=e},t.Sheet.prototype.LastCol=function(){var e=1;for(var o in this.cells){var n=t.coordToCr(o);n.col>e&&(e=n.col)}return e},t.Sheet.prototype.LastRow=function(){var e=1;for(var o in this.cells){var n=t.coordToCr(o);n.row>e&&(e=n.row)}return e},t.Sheet.prototype.GetAssuredCell=function(e){return this.cells[e]||this.AddCell(new t.Cell(e))},t.Sheet.prototype.ParseSheetSave=function(e){t.ParseSheetSave(e,this)},t.Sheet.prototype.CellFromStringParts=function(e,o,n){return t.CellFromStringParts(this,e,o,n)},t.Sheet.prototype.CreateSheetSave=function(e,o){return t.CreateSheetSave(this,e,o)},t.Sheet.prototype.CellToString=function(e){return t.CellToString(this,e)},t.Sheet.prototype.CanonicalizeSheet=function(e){return t.CanonicalizeSheet(this,e)},t.Sheet.prototype.EncodeCellAttributes=function(e){return t.EncodeCellAttributes(this,e)},t.Sheet.prototype.EncodeSheetAttributes=function(){return t.EncodeSheetAttributes(this)},t.Sheet.prototype.DecodeCellAttributes=function(e,o,n){return t.DecodeCellAttributes(this,e,o,n)},t.Sheet.prototype.DecodeSheetAttributes=function(e){return t.DecodeSheetAttributes(this,e)},t.Sheet.prototype.ScheduleSheetCommands=function(e,o){return t.ScheduleSheetCommands(this,e,o)},t.Sheet.prototype.SheetUndo=function(){return t.SheetUndo(this)},t.Sheet.prototype.SheetRedo=function(){return t.SheetRedo(this)},t.Sheet.prototype.CreateAuditString=function(){return t.CreateAuditString(this)},t.Sheet.prototype.GetStyleNum=function(e,o){return t.GetStyleNum(this,e,o)},t.Sheet.prototype.GetStyleString=function(e,o){return t.GetStyleString(this,e,o)},t.Sheet.prototype.RecalcSheet=function(){return t.RecalcSheet(this)},t.ParseSheetSave=function(e,o){var n,r,i,a,s,l,c,d,u,p=e.split(/\r\n|\n/),h=[],f=t.Constants;for(r=0;r<p.length;r++){switch(n=p[r],h=n.split(":"),h[0]){case"cell":c=o.GetAssuredCell(h[1]),i=2,o.CellFromStringParts(c,h,i);break;case"col":for(l=h[1],i=2;a=h[i++];)switch(a){case"w":o.colattribs.width[l]=h[i++];break;case"hide":o.colattribs.hide[l]=h[i++];break;default:throw f.s_pssUnknownColType+" '"+a+"'"}break;case"row":for(l=h[1]-0,i=2;a=h[i++];)switch(a){case"h":o.rowattribs.height[l]=h[i++]-0;break;case"hide":o.rowattribs.hide[l]=h[i++];break;default:throw f.s_pssUnknownRowType+" '"+a+"'"}break;case"sheet":for(d=o.attribs,i=1;a=h[i++];)switch(a){case"c":d.lastcol=h[i++]-0;break;case"r":d.lastrow=h[i++]-0;break;case"w":d.defaultcolwidth=h[i++]+"";break;case"h":d.defaultrowheight=h[i++]-0;break;case"tf":d.defaulttextformat=h[i++]-0;break;case"ntf":d.defaultnontextformat=h[i++]-0;break;case"layout":d.defaultlayout=h[i++]-0;break;case"font":d.defaultfont=h[i++]-0;break;case"tvf":d.defaulttextvalueformat=h[i++]-0;break;case"ntvf":d.defaultnontextvalueformat=h[i++]-0;break;case"color":d.defaultcolor=h[i++]-0;break;case"bgcolor":d.defaultbgcolor=h[i++]-0;break;case"circularreferencecell":d.circularreferencecell=h[i++];break;case"recalc":d.recalc=h[i++];break;case"needsrecalc":d.needsrecalc=h[i++];break;case"usermaxcol":d.usermaxcol=h[i++]-0;break;case"usermaxrow":d.usermaxrow=h[i++]-0;break;default:i+=1}break;case"name":u=t.decodeFromSave(h[1]).toUpperCase(),o.names[u]={desc:t.decodeFromSave(h[2])},o.names[u].definition=t.decodeFromSave(h[3]);break;case"layout":h=p[r].match(/^layout\:(\d+)\:(.+)$/),o.layouts[h[1]-0]=h[2],o.layouthash[h[2]]=h[1]-0;break;case"font":o.fonts[h[1]-0]=h[2],o.fonthash[h[2]]=h[1]-0;break;case"color":o.colors[h[1]-0]=h[2],o.colorhash[h[2]]=h[1]-0;break;case"border":o.borderstyles[h[1]-0]=h[2],o.borderstylehash[h[2]]=h[1]-0;break;case"cellformat":s=t.decodeFromSave(h[2]),o.cellformats[h[1]-0]=s,o.cellformathash[s]=h[1]-0;break;case"valueformat":s=t.decodeFromSave(h[2]),o.valueformats[h[1]-0]=s,o.valueformathash[s]=h[1]-0;break;case"version":break;case"copiedfrom":o.copiedfrom=h[1]+":"+h[2];break;case"clipboardrange":case"clipboard":case"":break;default:throw alert(f.s_pssUnknownLineType+" '"+h[0]+"'"),f.s_pssUnknownLineType+" '"+h[0]+"'"}h=null}},t.CellFromStringParts=function(e,o,n,r){for(var o,i,a;i=n[r++];)switch(i){case"v":o.datavalue=t.decodeFromSave(n[r++])-0,o.datatype="v",o.valuetype="n";break;case"t":o.datavalue=t.decodeFromSave(n[r++]),o.datatype="t",o.valuetype=t.Constants.textdatadefaulttype;break;case"vt":a=n[r++],o.valuetype=a,"n"==a.charAt(0)?(o.datatype="v",o.datavalue=t.decodeFromSave(n[r++])-0):(o.datatype="t",o.datavalue=t.decodeFromSave(n[r++]));break;case"vtf":a=n[r++],o.valuetype=a,"n"==a.charAt(0)?o.datavalue=t.decodeFromSave(n[r++])-0:o.datavalue=t.decodeFromSave(n[r++]),o.formula=t.decodeFromSave(n[r++]),o.datatype="f";break;case"vtc":a=n[r++],o.valuetype=a,"n"==a.charAt(0)?o.datavalue=t.decodeFromSave(n[r++])-0:o.datavalue=t.decodeFromSave(n[r++]),o.formula=t.decodeFromSave(n[r++]),o.datatype="c";break;case"ro":ro=t.decodeFromSave(n[r++]),o.readonly="yes"==ro.toLowerCase();break;case"e":o.errors=t.decodeFromSave(n[r++]);break;case"b":o.bt=n[r++]-0,o.br=n[r++]-0,o.bb=n[r++]-0,o.bl=n[r++]-0;break;case"l":o.layout=n[r++]-0;break;case"f":o.font=n[r++]-0;break;case"c":o.color=n[r++]-0;break;case"bg":o.bgcolor=n[r++]-0;break;case"cf":o.cellformat=n[r++]-0;break;case"ntvf":o.nontextvalueformat=n[r++]-0;break;case"tvf":o.textvalueformat=n[r++]-0;break;case"colspan":o.colspan=n[r++]-0;break;case"rowspan":o.rowspan=n[r++]-0;break;case"cssc":o.cssc=n[r++];break;case"csss":o.csss=t.decodeFromSave(n[r++]);break;case"mod":r+=1;break;case"comment":o.comment=t.decodeFromSave(n[r++]);break;default:throw t.Constants.s_cfspUnknownCellType+" '"+i+"'"}},t.sheetfields=["defaultrowheight","defaultcolwidth","circularreferencecell","recalc","needsrecalc","usermaxcol","usermaxrow"],t.sheetfieldsshort=["h","w","circularreferencecell","recalc","needsrecalc","usermaxcol","usermaxrow"],t.sheetfieldsxlat=["defaulttextformat","defaultnontextformat","defaulttextvalueformat","defaultnontextvalueformat","defaultcolor","defaultbgcolor","defaultfont","defaultlayout"],t.sheetfieldsxlatshort=["tf","ntf","tvf","ntvf","color","bgcolor","font","layout"],t.sheetfieldsxlatxlt=["cellformat","cellformat","valueformat","valueformat","color","color","font","layout"],t.CreateSheetSave=function(e,o,n){var r,i,a,s,l,c,d,u,p,h,f,m=[];e.CanonicalizeSheet(n||t.Constants.doCanonicalizeSheet);var g=e.xlt;for(f=o?t.ParseRange(o):{cr1:{row:1,col:1},cr2:{row:g.maxrow,col:g.maxcol}},i=f.cr1,a=f.cr2,m.push("version:1.5"),s=i.row;s<=a.row;s++)for(l=i.col;l<=a.col;l++)c=t.crToCoord(l,s),(r=e.cells[c])&&(d=e.CellToString(r),0!=d.length&&(d="cell:"+c+d,m.push(d)));for(l=1;l<=g.maxcol;l++)c=t.rcColname(l),e.colattribs.width[c]&&m.push("col:"+c+":w:"+e.colattribs.width[c]),e.colattribs.hide[c]&&m.push("col:"+c+":hide:"+e.colattribs.hide[c]);for(s=1;s<=g.maxrow;s++)e.rowattribs.height[s]&&m.push("row:"+s+":h:"+e.rowattribs.height[s]),e.rowattribs.hide[s]&&m.push("row:"+s+":hide:"+e.rowattribs.hide[s]);for(d="sheet:c:"+g.maxcol+":r:"+g.maxrow,p=0;p<t.sheetfields.length;p++)(u=t.encodeForSave(e.attribs[t.sheetfields[p]]))&&(d+=":"+t.sheetfieldsshort[p]+":"+u);for(p=0;p<t.sheetfieldsxlat.length;p++)(u=e.attribs[t.sheetfieldsxlat[p]])&&(d+=":"+t.sheetfieldsxlatshort[p]+":"+g[t.sheetfieldsxlatxlt[p]+"sxlat"][u]);for(m.push(d),p=1;p<g.newborderstyles.length;p++)m.push("border:"+p+":"+g.newborderstyles[p]);for(p=1;p<g.newcellformats.length;p++)m.push("cellformat:"+p+":"+t.encodeForSave(g.newcellformats[p]));for(p=1;p<g.newcolors.length;p++)m.push("color:"+p+":"+g.newcolors[p]);for(p=1;p<g.newfonts.length;p++)m.push("font:"+p+":"+g.newfonts[p]);for(p=1;p<g.newlayouts.length;p++)m.push("layout:"+p+":"+g.newlayouts[p]);for(p=1;p<g.newvalueformats.length;p++)m.push("valueformat:"+p+":"+t.encodeForSave(g.newvalueformats[p]));for(p=0;p<g.namesorder.length;p++)h=g.namesorder[p],m.push("name:"+t.encodeForSave(h).toUpperCase()+":"+t.encodeForSave(e.names[h].desc)+":"+t.encodeForSave(e.names[h].definition));return o&&m.push("copiedfrom:"+t.crToCoord(i.col,i.row)+":"+t.crToCoord(a.col,a.row)),m.push(""),delete e.xlt,m.join("\n")},t.CellToString=function(e,o){var o,n,r,i,a,s,l,c,d;return n="",o?(r=t.encodeForSave(o.datavalue),"v"==o.datatype?"n"==o.valuetype?n+=":v:"+r:n+=":vt:"+o.valuetype+":"+r:"t"==o.datatype?o.valuetype==t.Constants.textdatadefaulttype?n+=":t:"+r:n+=":vt:"+o.valuetype+":"+r:(i=t.encodeForSave(o.formula),"f"==o.datatype?n+=":vtf:"+o.valuetype+":"+r+":"+i:"c"==o.datatype&&(n+=":vtc:"+o.valuetype+":"+r+":"+i)),o.readonly&&(n+=":ro:yes"),o.errors&&(n+=":e:"+t.encodeForSave(o.errors)),a=o.bt||"",s=o.br||"",l=o.bb||"",c=o.bl||"",e.xlt?(d=e.xlt,(a||s||l||c)&&(n+=":b:"+d.borderstylesxlat[a||0]+":"+d.borderstylesxlat[s||0]+":"+d.borderstylesxlat[l||0]+":"+d.borderstylesxlat[c||0]),o.layout&&(n+=":l:"+d.layoutsxlat[o.layout]),o.font&&(n+=":f:"+d.fontsxlat[o.font]),o.color&&(n+=":c:"+d.colorsxlat[o.color]),o.bgcolor&&(n+=":bg:"+d.colorsxlat[o.bgcolor]),o.cellformat&&(n+=":cf:"+d.cellformatsxlat[o.cellformat]),o.textvalueformat&&(n+=":tvf:"+d.valueformatsxlat[o.textvalueformat]),o.nontextvalueformat&&(n+=":ntvf:"+d.valueformatsxlat[o.nontextvalueformat])):((a||s||l||c)&&(n+=":b:"+a+":"+s+":"+l+":"+c),o.layout&&(n+=":l:"+o.layout),o.font&&(n+=":f:"+o.font),o.color&&(n+=":c:"+o.color),o.bgcolor&&(n+=":bg:"+o.bgcolor),o.cellformat&&(n+=":cf:"+o.cellformat),o.textvalueformat&&(n+=":tvf:"+o.textvalueformat),o.nontextvalueformat&&(n+=":ntvf:"+o.nontextvalueformat)),o.colspan&&(n+=":colspan:"+o.colspan),o.rowspan&&(n+=":rowspan:"+o.rowspan),o.cssc&&(n+=":cssc:"+o.cssc),o.csss&&(n+=":csss:"+t.encodeForSave(o.csss)),o.mod&&(n+=":mod:"+o.mod),o.comment&&(n+=":comment:"+t.encodeForSave(o.comment)),n):n},t.CanonicalizeSheet=function(e,o){var n,r,i,a,s,l,c,d,u,p,h,f,m,g=0,v=0,y=["borderstyle","cellformat","color","font","layout","valueformat"],b={};b.namesorder=[];for(c in e.names)b.namesorder.push(c);if(b.namesorder.sort(),!t.Constants.doCanonicalizeSheet||!o){for(l=0;l<y.length;l++){for(c=y[l],b["new"+c+"s"]=e[c+"s"],n=e[c+"s"].length,u=new Array(n),u[0]="",f=1;f<n;f++)u[f]=f;b[c+"sxlat"]=u}return b.maxrow=e.attribs.lastrow,b.maxcol=e.attribs.lastcol,void(e.xlt=b)}for(l=0;l<y.length;l++)c=y[l],b[c+"sUsed"]={};var C=b.colorsUsed,w=b.borderstylesUsed,x=b.fontsUsed,S=b.layoutsUsed,_=b.cellformatsUsed,k=b.valueformatsUsed;for(r in e.cells)i=t.coordToCr(r),a=e.cells[r],s=!1,a.valuetype&&"b"!=a.valuetype&&(s=!0),a.color&&(C[a.color]=1,s=!0),a.bgcolor&&(C[a.bgcolor]=1,s=!0),a.bt&&(w[a.bt]=1,s=!0),a.br&&(w[a.br]=1,s=!0),a.bb&&(w[a.bb]=1,s=!0),a.bl&&(w[a.bl]=1,s=!0),a.layout&&(S[a.layout]=1,s=!0),a.font&&(x[a.font]=1,s=!0),a.cellformat&&(_[a.cellformat]=1,s=!0),a.textvalueformat&&(k[a.textvalueformat]=1,s=!0),a.nontextvalueformat&&(k[a.nontextvalueformat]=1,s=!0),s&&(i.row>g&&(g=i.row),i.col>v&&(v=i.col));for(f=0;f<t.sheetfieldsxlat.length;f++)(m=e.attribs[t.sheetfieldsxlat[f]])&&(b[t.sheetfieldsxlatxlt[f]+"sUsed"][m]=1);c={height:1,hide:1};for(m in c)for(i in e.rowattribs[m])i>g&&(g=i);c={hide:1,width:1};for(m in c)for(r in e.colattribs[m])i=t.coordToCr(r+"1"),i.col>v&&(v=i.col);for(l=0;l<y.length;l++){c=y[l],d=[],p=b[c+"sUsed"];for(m in p)d.push(e[c+"s"][m]);for(d.sort(),d.unshift(""),u=[""],h=e[c+"hash"],f=1;f<d.length;f++)u[h[d[f]]]=f;b[c+"sxlat"]=u,b["new"+c+"s"]=d}b.maxrow=g||1,b.maxcol=v||1,e.xlt=b},t.EncodeCellAttributes=function(e,t){var o,n,r,i={},a=function(e){i[e]={def:!0,val:""}},s=function(e){for(var t=0;t<e.length;t++)a(e[t])},l=function(e,t){i[e].def=!1,i[e].val=t||""},c=function(e,t){"*"!=t&&(i[e].def=!1,i[e].val=t)},d=e.GetAssuredCell(t);for(a("alignhoriz"),d.cellformat&&l("alignhoriz",e.cellformats[d.cellformat]),s(["alignvert","padtop","padright","padbottom","padleft"]),d.layout&&(parts=e.layouts[d.layout].match(/^padding:\s*(\S+)\s+(\S+)\s+(\S+)\s+(\S+);vertical-align:\s*(\S+);/),c("padtop",parts[1]),c("padright",parts[2]),c("padbottom",parts[3]),c("padleft",parts[4]),c("alignvert",parts[5])),s(["fontfamily","fontlook","fontsize"]),d.font&&(parts=e.fonts[d.font].match(/^(\*|\S+? \S+?) (\S+?) (\S.*)$/),c("fontfamily",parts[3]),c("fontsize",parts[2]),c("fontlook",parts[1])),a("textcolor"),d.color&&l("textcolor",e.colors[d.color]),a("bgcolor"),d.bgcolor&&l("bgcolor",e.colors[d.bgcolor]),s(["numberformat","textformat"]),d.nontextvalueformat&&l("numberformat",e.valueformats[d.nontextvalueformat]),d.textvalueformat&&l("textformat",e.valueformats[d.textvalueformat]),s(["colspan","rowspan"]),l("colspan",d.colspan||1),l("rowspan",d.rowspan||1),o=0;o<4;o++)n="trbl".charAt(o),r="b"+n,a(r),l(r,d[r]?e.borderstyles[d[r]]:""),a(r+"thickness"),a(r+"style"),a(r+"color"),d[r]&&(parts=e.borderstyles[d[r]].match(/(\S+)\s+(\S+)\s+(\S.+)/),l(r+"thickness",parts[1]),l(r+"style",parts[2]),l(r+"color",parts[3]));return s(["cssc","csss","mod"]),l("cssc",d.cssc||""),l("csss",d.csss||""),l("mod",d.mod||"n"),i},t.EncodeSheetAttributes=function(e){var t,o=e.attribs,n={},r=function(e){n[e]={def:!0,val:""}},i=function(e){for(var t=0;t<e.length;t++)r(e[t])},a=function(e,o){n[e].def=!1,n[e].val=o||t},s=function(e,t){"*"!=t&&(n[e].def=!1,n[e].val=t)};return r("colwidth"),o.defaultcolwidth&&a("colwidth",o.defaultcolwidth),r("rowheight"),o.rowheight&&a("rowheight",o.defaultrowheight),r("textalignhoriz"),o.defaulttextformat&&a("textalignhoriz",e.cellformats[o.defaulttextformat]),r("numberalignhoriz"),o.defaultnontextformat&&a("numberalignhoriz",e.cellformats[o.defaultnontextformat]),i(["alignvert","padtop","padright","padbottom","padleft"]),o.defaultlayout&&(parts=e.layouts[o.defaultlayout].match(/^padding:\s*(\S+)\s+(\S+)\s+(\S+)\s+(\S+);vertical-align:\s*(\S+);/),s("padtop",parts[1]),s("padright",parts[2]),s("padbottom",parts[3]),s("padleft",parts[4]),s("alignvert",parts[5])),i(["fontfamily","fontlook","fontsize"]),o.defaultfont&&(parts=e.fonts[o.defaultfont].match(/^(\*|\S+? \S+?) (\S+?) (\S.*)$/),s("fontfamily",parts[3]),s("fontsize",parts[2]),s("fontlook",parts[1])),r("textcolor"),o.defaultcolor&&a("textcolor",e.colors[o.defaultcolor]),r("bgcolor"),o.defaultbgcolor&&a("bgcolor",e.colors[o.defaultbgcolor]),i(["numberformat","textformat"]),o.defaultnontextvalueformat&&a("numberformat",e.valueformats[o.defaultnontextvalueformat]),o.defaulttextvalueformat&&a("textformat",e.valueformats[o.defaulttextvalueformat]),r("recalc"),o.recalc&&a("recalc",o.recalc),r("usermaxcol"),o.usermaxcol&&a("usermaxcol",o.usermaxcol),r("usermaxrow"),o.usermaxrow&&a("usermaxrow",o.usermaxrow),n},t.DecodeCellAttributes=function(e,t,o,n){var r,a,s,l=e.GetAssuredCell(t),c=!1,d=function(e,t,n){var r;o[e]&&(r=o[e].def?"":o[e].val)!=(t||"")&&p(n+" "+r)},u="",p=function(e){u&&(u+="\n"),u+="set "+(n||t)+" "+e,c=!0};for(d("alignhoriz",e.cellformats[l.cellformat],"cellformat"),r=o.alignvert.def&&o.padtop.def&&o.padright.def&&o.padbottom.def&&o.padleft.def?"":"padding:"+(o.padtop.def?"* ":o.padtop.val+" ")+(o.padright.def?"* ":o.padright.val+" ")+(o.padbottom.def?"* ":o.padbottom.val+" ")+(o.padleft.def?"*":o.padleft.val)+";vertical-align:"+(o.alignvert.def?"*;":o.alignvert.val+";"),r!=(e.layouts[l.layout]||"")&&p("layout "+r),r=o.fontlook.def&&o.fontsize.def&&o.fontfamily.def?"":(o.fontlook.def?"* ":o.fontlook.val+" ")+(o.fontsize.def?"* ":o.fontsize.val+" ")+(o.fontfamily.def?"*":o.fontfamily.val),r!=(e.fonts[l.font]||"")&&p("font "+r),d("textcolor",e.colors[l.color],"color"),d("bgcolor",e.colors[l.bgcolor],"bgcolor"),d("numberformat",e.valueformats[l.nontextvalueformat],"nontextvalueformat"),d("textformat",e.valueformats[l.textvalueformat],"textvalueformat"),i=0;i<4;i++)a="trbl".charAt(i),s="b"+a,d(s,e.borderstyles[l[s]],s);return d("cssc",l.cssc,"cssc"),d("csss",l.csss,"csss"),o.mod&&(r=o.mod.def?"n":o.mod.val)!=(l.mod||"n")&&("n"==r&&(r=""),p("mod "+r)),c?u:null},t.DecodeSheetAttributes=function(e,t){var o,n=e.attribs,r=!1,i=function(e,o,n){var r;t[e]&&(r=t[e].def?"":t[e].val)!=(o||"")&&s(n+" "+r)},a="",s=function(e){a&&(a+="\n"),a+="set sheet "+e,r=!0};return i("colwidth",n.defaultcolwidth,"defaultcolwidth"),i("rowheight",n.defaultrowheight,"defaultrowheight"),i("textalignhoriz",e.cellformats[n.defaulttextformat],"defaulttextformat"),i("numberalignhoriz",e.cellformats[n.defaultnontextformat],"defaultnontextformat"),o=t.alignvert.def&&t.padtop.def&&t.padright.def&&t.padbottom.def&&t.padleft.def?"":"padding:"+(t.padtop.def?"* ":t.padtop.val+" ")+(t.padright.def?"* ":t.padright.val+" ")+(t.padbottom.def?"* ":t.padbottom.val+" ")+(t.padleft.def?"*":t.padleft.val)+";vertical-align:"+(t.alignvert.def?"*;":t.alignvert.val+";"),o!=(e.layouts[n.defaultlayout]||"")&&s("defaultlayout "+o),o=t.fontlook.def&&t.fontsize.def&&t.fontfamily.def?"":(t.fontlook.def?"* ":t.fontlook.val+" ")+(t.fontsize.def?"* ":t.fontsize.val+" ")+(t.fontfamily.def?"*":t.fontfamily.val),o!=(e.fonts[n.defaultfont]||"")&&s("defaultfont "+o),i("textcolor",e.colors[n.defaultcolor],"defaultcolor"),i("bgcolor",e.colors[n.defaultbgcolor],"defaultbgcolor"),i("numberformat",e.valueformats[n.defaultnontextvalueformat],"defaultnontextvalueformat"),i("textformat",e.valueformats[n.defaulttextvalueformat],"defaulttextvalueformat"),i("recalc",e.attribs.recalc,"recalc"),i("usermaxcol",e.attribs.usermaxcol,"usermaxcol"),i("usermaxrow",e.attribs.usermaxrow,"usermaxrow"),r?a:null},t.SheetCommandInfo=function(e){this.sheetobj=e,this.timerobj=null,this.firsttimerdelay=50,this.timerdelay=1,this.maxtimeslice=100,this.saveundo=!1,this.CmdExtensionCallbacks={}},t.ScheduleSheetCommands=function(o,n,r){var i=o.sci,a=new t.Parse(n);i.sheetobj.statuscallback&&o.statuscallback(i,"cmdstart","",i.sheetobj.statuscallbackparams),r&&i.sheetobj.changes.PushChange(""),i.timerobj=e.setTimeout(function(){t.SheetCommandsTimerRoutine(i,a,r)},i.firsttimerdelay)},t.SheetCommandsTimerRoutine=function(o,n,r){var i,a=new Date;for(o.timerobj=null;!n.EOF();)if(i=t.ExecuteSheetCommand(o.sheetobj,n,r),i&&("function"==typeof alert?alert(i):console.log(i)),n.NextLine(),new Date-a>=o.maxtimeslice)return void(o.timerobj=e.setTimeout(function(){t.SheetCommandsTimerRoutine(o,n,r)},o.timerdelay));o.sheetobj.statuscallback&&o.sheetobj.statuscallback(o,"cmdend","",o.sheetobj.statuscallbackparams)},t.ExecuteSheetCommand=function(e,o,n){function r(o){function n(e){return"v"==e||"c"==e}var r=t.GetSpreadsheetControlObject().editor,i=r.range2,a=undefined;if(i.hasrange){var s,l;o&&i.bottom-i.top==1&&i.left==i.right?(s=e.GetAssuredCell(t.crToCoord(i.left,i.top)),l=e.GetAssuredCell(t.crToCoord(i.left,i.bottom)),n(s.datatype)&&n(l.datatype)&&(a=l.datavalue-s.datavalue)):o||i.left==i.right||(s=e.GetAssuredCell(t.crToCoord(i.left,i.top)),l=e.GetAssuredCell(t.crToCoord(i.right,i.top)),n(s.datatype)&&n(l.datatype)&&(a=l.datavalue-s.datavalue))}return r.Range2Remove(),a}var i,a,s,l,c,d,u,p,h,f,m,g,v,y,b,C,w,x,S,_,k,T,E,F,D,M,A,P,L,R,I,O,$,N,U,j,H,B,z,V,Y,G,W,q,K,X,Q,Z,J,ee,te,oe,ne,re,ie,ae,se,le,ce,de,ue,y,b,pe,he,fe,me=e.attribs,ge=e.changes,ve=t.CellProperties,ye=t.Constants,be=!1,Ce=function(){var e=t.ParseRange(l);g=e.cr1,v=e.cr2,v.col>me.lastcol&&(me.lastcol=v.col),v.row>me.lastrow&&(me.lastrow=v.row)};switch(h="",i=o.RestOfStringNoMove(),n&&e.changes.AddDo(i),a=o.NextToken()){case"set":if(l=o.NextToken(),c=o.NextToken(),s=o.RestOfString(),f="set "+l+" "+c,"sheet"==l)switch(e.renderneeded=!0,c){case"defaultcolwidth":n&&ge.AddUndo(f,me[c]),me[c]=s;break;case"defaultcolor":case"defaultbgcolor":n&&ge.AddUndo(f,e.GetStyleString("color",me[c])),me[c]=e.GetStyleNum("color",s);break;case"defaultlayout":n&&ge.AddUndo(f,e.GetStyleString("layout",me[c])),me[c]=e.GetStyleNum("layout",s);break;case"defaultfont":n&&ge.AddUndo(f,e.GetStyleString("font",me[c])),"* * *"==s&&(s=""),me[c]=e.GetStyleNum("font",s);break;case"defaulttextformat":case"defaultnontextformat":n&&ge.AddUndo(f,e.GetStyleString("cellformat",me[c])),me[c]=e.GetStyleNum("cellformat",s);break;case"defaulttextvalueformat":case"defaultnontextvalueformat":n&&ge.AddUndo(f,e.GetStyleString("valueformat",me[c])),me[c]=e.GetStyleNum("valueformat",s);for(C in e.cells)delete e.cells[C].displaystring;break;case"lastcol":case"lastrow":n&&ge.AddUndo(f,me[c]-0),d=s-0,"number"==typeof d&&(me[c]=d>0?d:1);break;case"recalc":n&&ge.AddUndo(f,me[c]),"off"==s?me.recalc=s:delete me.recalc;break;case"usermaxcol":case"usermaxrow":n&&ge.AddUndo(f,me[c]-0),d=s-0,"number"==typeof d&&(me[c]=d>0?d:0);break;default:h=ye.s_escUnknownSheetCmd+i}else if(/^[a-z]{1,2}(:[a-z]{1,2})?$/i.test(l))for(e.renderneeded=!0,l=l.toUpperCase(),u=l.indexOf(":"),u>=0?(g=t.coordToCr(l.substring(0,u)+"1"),v=t.coordToCr(l.substring(u+1)+"1")):(g=t.coordToCr(l+"1"),v=g),y=g.col;y<=v.col;y++)"width"==c?(C=t.rcColname(y),n&&ge.AddUndo("set "+C+" width",e.colattribs.width[C]),s.length>0?e.colattribs.width[C]=s:delete e.colattribs.width[C]):"hide"==c&&(e.hiddencolrow="col",C=t.rcColname(y),n&&ge.AddUndo("set "+C+" hide",e.colattribs.hide[C]),s.length>0?e.colattribs.hide[C]=s:delete e.colattribs.hide[C]);else if(/^\d+(:\d+)?$/i.test(l))for(e.renderneeded=!0,l=l.toUpperCase(),u=l.indexOf(":"),u>=0?(g=t.coordToCr("A"+l.substring(0,u)),v=t.coordToCr("A"+l.substring(u+1))):(g=t.coordToCr("A"+l),v=g),b=g.row;b<=v.row;b++)"height"==c?(n&&ge.AddUndo("set "+b+" height",e.rowattribs.height[b]),s.length>0?e.rowattribs.height[b]=s:delete e.rowattribs.height[b]):"hide"==c&&(e.hiddencolrow="row",n&&ge.AddUndo("set "+b+" hide",e.rowattribs.hide[b]),s.length>0?e.rowattribs.hide[b]=s:delete e.rowattribs.hide[b]);else if(/^[a-z]{1,2}\d+(:[a-z]{1,2}\d+)?$/i.test(l))for(be=!0,Ce(),g.row!=v.row||g.col!=v.col||e.celldisplayneeded||e.renderneeded?(e.renderneeded=!0,e.celldisplayneeded=""):e.celldisplayneeded=t.crToCoord(g.col,g.row),b=g.row;b<=v.row;b++)for(y=g.col;y<=v.col;y++)C=t.crToCoord(y,b),w=e.GetAssuredCell(C),w.readonly&&"readonly"!=c||(n&&ge.AddUndo("set "+C+" all",e.CellToString(w)),"value"==c?(u=s.indexOf(" "),w.datavalue=s.substring(u+1)-0,delete w.errors,w.datatype="v",w.valuetype=s.substring(0,u),delete w.displaystring,delete w.parseinfo,me.needsrecalc="yes"):"text"==c?(u=s.indexOf(" "),w.datavalue=t.decodeFromSave(s.substring(u+1)),delete w.errors,w.datatype="t",w.valuetype=s.substring(0,u),delete w.displaystring,delete w.parseinfo,me.needsrecalc="yes"):"formula"==c?(w.datavalue=0,delete w.errors,w.datatype="f",t._app&&"e#N/A"!=w.valuetype&&(w.prevvaluetype=w.valuetype),w.valuetype="e#N/A",w.formula=s,delete w.displaystring,delete w.parseinfo,me.needsrecalc="yes"):"constant"==c?(u=s.indexOf(" "),p=s.substring(u+1).indexOf(" "),w.datavalue=s.substring(u+1,u+1+p)-0,w.valuetype=s.substring(0,u),"e"==w.valuetype.charAt(0)?w.errors=w.valuetype.substring(1):delete w.errors,w.datatype="c",w.formula=s.substring(u+p+2),delete w.displaystring,delete w.parseinfo,me.needsrecalc="yes"):"empty"==c?(w.datavalue="",delete w.errors,w.datatype=null,w.formula="",w.valuetype="b",delete w.displaystring,delete w.parseinfo,me.needsrecalc="yes"):"all"==c?(s.length>0?(w=new t.Cell(C),e.CellFromStringParts(w,s.split(":"),1),e.cells[C]=w):delete e.cells[C],me.needsrecalc="yes"):/^b[trbl]$/.test(c)?(w[c]=e.GetStyleNum("borderstyle",s),e.renderneeded=!0):"color"==c||"bgcolor"==c?w[c]=e.GetStyleNum("color",s):"layout"==c||"cellformat"==c?w[c]=e.GetStyleNum(c,s):"font"==c?("* * *"==s&&(s=""),w[c]=e.GetStyleNum("font",s)):"textvalueformat"==c||"nontextvalueformat"==c?(w[c]=e.GetStyleNum("valueformat",s),delete w.displaystring):"cssc"==c?(s=s.replace(/[^a-zA-Z0-9\-]/g,""),w.cssc=s):"csss"==c?(s=s.replace(/\n/g,""),w.csss=s):"mod"==c?(s=s.replace(/[^yY]/g,"").toLowerCase(),w.mod=s):"comment"==c?w.comment=t.decodeFromSave(s):"readonly"==c?w.readonly="yes"==s.toLowerCase():h=ye.s_escUnknownSetCoordCmd+i);break;case"merge":if(e.renderneeded=!0,l=o.NextToken(),s=o.RestOfString(),Ce(),w=e.GetAssuredCell(g.coord),w.readonly)break;n&&ge.AddUndo("unmerge "+g.coord),v.col>g.col?w.colspan=v.col-g.col+1:delete w.colspan,v.row>g.row?w.rowspan=v.row-g.row+1:delete w.rowspan,e.changedrendervalues=!0;break;case"unmerge":if(e.renderneeded=!0,l=o.NextToken(),s=o.RestOfString(),Ce(),w=e.GetAssuredCell(g.coord),w.readonly)break;n&&ge.AddUndo("merge "+g.coord+":"+t.crToCoord(g.col+(w.colspan||1)-1,g.row+(w.rowspan||1)-1)),delete w.colspan,delete w.rowspan,e.changedrendervalues=!0;break;case"erase":case"cut":for(e.renderneeded=!0,e.changedrendervalues=!0,l=o.NextToken(),s=o.RestOfString(),Ce(),n&&ge.AddUndo("changedrendervalues"),"cut"==a&&(n&&ge.AddUndo("loadclipboard",t.encodeForSave(t.Clipboard.clipboard)),t.Clipboard.clipboard=t.CreateSheetSave(e,l)),b=g.row;b<=v.row;b++)for(y=g.col;y<=v.col;y++)C=t.crToCoord(y,b),w=e.GetAssuredCell(C),w.readonly||(n&&ge.AddUndo("set "+C+" all",e.CellToString(w)),"all"==s?delete e.cells[C]:"formulas"==s?(w.datavalue="",w.datatype=null,w.formula="",w.valuetype="b",delete w.errors,delete w.displaystring,delete w.parseinfo,w.comment&&delete w.comment):"formats"==s&&(x=new t.Cell(C),x.datavalue=w.datavalue,x.datatype=w.datatype,x.formula=w.formula,x.valuetype=w.valuetype,w.comment&&(x.comment=w.comment),e.cells[C]=x));me.needsrecalc="yes";break;case"fillright":case"filldown":e.renderneeded=!0,e.changedrendervalues=!0,n&&ge.AddUndo("changedrendervalues"),l=o.NextToken(),s=o.RestOfString(),Ce();var we;for("fillright"==a?(S=!0,_=g.row,k=g.col+1,we=r(!1)):(S=!1,_=g.row+1,k=g.col,we=r(!0)),b=_;b<=v.row;b++)for(y=k;y<=v.col;y++)if(C=t.crToCoord(y,b),w=e.GetAssuredCell(C),!w.readonly){if(n&&ge.AddUndo("set "+C+" all",e.CellToString(w)),S?(T=t.crToCoord(g.col,b),F=y-k+1,E=0):(T=t.crToCoord(y,g.row),F=0,E=b-_+1),D=e.GetAssuredCell(T),"all"==s||"formats"==s)for(c in ve)1!=ve[c]&&(typeof D[c]===undefined||3==ve[c]?delete w[c]:w[c]=D[c]);"all"!=s&&"formulas"!=s||(we!==undefined?w.datavalue=D.datavalue+(S?F:E)*we:w.datavalue=D.datavalue,w.datatype=D.datatype,w.valuetype=D.valuetype,"f"==w.datatype?w.formula=t.OffsetFormulaCoords(D.formula,F,E):w.formula=D.formula,delete w.parseinfo,w.errors=D.errors),delete w.displaystring}me.needsrecalc="yes";break;case"copy":l=o.NextToken(),s=o.RestOfString(),n&&ge.AddUndo("loadclipboard",t.encodeForSave(t.Clipboard.clipboard)),t.Clipboard.clipboard=t.CreateSheetSave(e,l);break;case"loadclipboard":s=o.RestOfString(),n&&ge.AddUndo("loadclipboard",t.encodeForSave(t.Clipboard.clipboard)),t.Clipboard.clipboard=t.decodeFromSave(s);break;case"clearclipboard":n&&ge.AddUndo("loadclipboard",t.encodeForSave(t.Clipboard.clipboard)),t.Clipboard.clipboard="";break;case"paste":if(e.renderneeded=!0,e.changedrendervalues=!0,n&&ge.AddUndo("changedrendervalues"),l=o.NextToken(),s=o.RestOfString(),Ce(),!t.Clipboard.clipboard)break;for(M=new t.Sheet,M.ParseSheetSave(t.Clipboard.clipboard),A=t.ParseRange(M.copiedfrom),F=g.col-A.cr1.col,E=g.row-A.cr1.row,P=Math.max(v.col-g.col+1,A.cr2.col-A.cr1.col+1),L=Math.max(v.row-g.row+1,A.cr2.row-A.cr1.row+1),g.col+P-1>me.lastcol&&(me.lastcol=g.col+P-1),g.row+L-1>me.lastrow&&(me.lastrow=g.row+L-1),b=g.row;b<g.row+L;b++)for(y=g.col;y<g.col+P;y++)if(C=t.crToCoord(y,b),w=e.GetAssuredCell(C),!w.readonly){if(n&&ge.AddUndo("set "+C+" all",e.CellToString(w)),T=t.crToCoord(A.cr1.col+(y-g.col)%(A.cr2.col-A.cr1.col+1),A.cr1.row+(b-g.row)%(A.cr2.row-A.cr1.row+1)),D=M.GetAssuredCell(T),"all"==s||"formats"==s)for(c in ve)1!=ve[c]&&(typeof D[c]===undefined||3==ve[c]?delete w[c]:(R=t.CellPropertiesTable[c],R&&D[c]?w[c]=e.GetStyleNum(R,M.GetStyleString(R,D[c])):w[c]=D[c]));"all"!=s&&"formulas"!=s||(w.datavalue=D.datavalue,w.datatype=D.datatype,w.valuetype=D.valuetype,"f"==w.datatype?w.formula=t.OffsetFormulaCoords(D.formula,F,E):w.formula=D.formula,delete w.parseinfo,w.errors=D.errors,D.comment?w.comment=D.comment:w.comment&&delete w.comment),delete w.displaystring}me.needsrecalc="yes";break;case"sort":for(e.renderneeded=!0,e.changedrendervalues=!0,n&&ge.AddUndo("changedrendervalues"),l=o.NextToken(),Ce(),X=[],Q=[],Z=0,J=0;J<=3;J++)X[J]=o.NextToken(),Q[J]=o.NextToken(),X[J]&&(Z=J);for(te={},ee=[],oe=[],ne=[],b=g.row;b<=v.row;b++){for(y=g.col;y<=v.col;y++)C=t.crToCoord(y,b),w=e.cells[C],w?(te[C]=e.CellToString(w),n&&ge.AddUndo("set "+C+" all",te[C])):n&&ge.AddUndo("set "+C+" all");for(ee.push(ee.length),oe.push([]),ne.push([]),slast=ne.length-1,J=0;J<=Z;J++)C=X[J]+b,w=e.GetAssuredCell(C),m=w.datavalue,ie=w.valuetype.charAt(0)||"b","t"==ie&&(m=m.toLowerCase()),oe[slast].push(m),ne[slast].push(ie)}for(re=function(e,t){var o,n,r,i,a;for(o=0;o<=Z;o++)if("up"==Q[o]?(n=e,r=t):(n=t,r=e),i=ne[n][o],tb=ne[r][o],"t"==i?"t"==tb?(n=oe[n][o],r=oe[r][o],a=n>r?1:n<r?-1:0):"n"==tb?a=1:"b"==tb?a="up"==Q[o]?-1:1:"e"==tb&&(a=-1):"n"==i?"t"==tb?a=-1:"n"==tb?(n=oe[n][o]-0,r=oe[r][o]-0,a=n>r?1:n<r?-1:0):"b"==tb?a="up"==Q[o]?-1:1:"e"==tb&&(a=-1):"e"==i?"e"==tb?(n=oe[n][o],r=oe[r][o],a=n>r?1:n<r?-1:0):a="b"==tb&&"up"==Q[o]?-1:1:"b"==i&&(a="b"==tb?0:"up"==Q[o]?1:-1),a)return a;return a=e>t?1:e<t?-1:0},ee.sort(re),b=g.row;b<=v.row;b++)for(ae=ee[b-g.row],y=g.col;y<=v.col;y++)C=t.crToCoord(y,b),se=t.crToCoord(y,ae+g.row),te[se]?(w=new t.Cell(C),e.CellFromStringParts(w,te[se].split(":"),1),"f"==w.datatype&&(w.formula=t.OffsetFormulaCoords(w.formula,0,b-g.row-ae)),e.cells[C]=w):delete e.cells[C];me.needsrecalc="yes";break;case"insertcol":case"insertrow":for(e.renderneeded=!0,e.changedrendervalues=!0,e.widgetsClean=!1,l=o.NextToken(),s=o.RestOfString(),Ce(),"insertcol"==a?(F=1,I=g.col,E=0,O=1,$=g.col,U=g.col,N=1,j=me.lastrow,n&&ge.AddUndo("deletecol "+g.coord)):(F=0,I=1,E=1,O=g.row,$=1,U=me.lastcol,N=g.row,j=g.row,n&&ge.AddUndo("deleterow "+g.coord)),b=me.lastrow;b>=O;b--)for(y=me.lastcol;y>=I;y--)T=t.crToCoord(y,b),C=t.crToCoord(y+F,b+E),e.cells[T]?e.cells[C]=e.cells[T]:delete e.cells[C];for(b=N;b<=j;b++)for(y=$;y<=U;y++){C=t.crToCoord(y,b),w=new t.Cell(C),e.cells[C]=w,T=t.crToCoord(y-F,b-E),D=e.GetAssuredCell(T);for(c in ve)2==ve[c]&&(w[c]=D[c])}for(C in e.cells)w=e.cells[C],w&&"f"==w.datatype&&(w.formula=t.AdjustFormulaCoords(w.formula,g.col,F,g.row,E)),w&&delete w.parseinfo;for(le in e.names)e.names[le]&&(ce=e.names[le].definition,de="","="==ce.charAt(0)&&(de="=",ce=ce.substring(1)),e.names[le].definition=de+t.AdjustFormulaCoords(ce,g.col,F,g.row,E));for(b=me.lastrow;b>=O&&"insertrow"==a;b--){H=b+E;for(c in e.rowattribs)m=e.rowattribs[c][b],e.rowattribs[c][H]!=m&&(m?e.rowattribs[c][H]=m:delete e.rowattribs[c][H])}for(y=me.lastcol;y>=I&&"insertcol"==a;y--){z=t.rcColname(y),B=t.rcColname(y+F);for(c in e.colattribs)m=e.colattribs[c][z],e.colattribs[c][B]!=m&&(m?e.colattribs[c][B]=m:delete e.colattribs[c][B])}var xe=new t.RenderContext(e);xe.CalculateCellSkipData();var Se={};for(var _e in xe.cellskip){var ke=t.coordToCr(_e),Te=xe.cellskip[_e];"insertcol"===a&&ke.col===$&&(Se[Te]||(e.GetAssuredCell(Te).colspan+=F),Se[Te]=!0),"insertrow"===a&&ke.row===N&&(Se[Te]||(e.GetAssuredCell(Te).rowspan+=E),Se[Te]=!0)}me.lastcol+=F,me.lastrow+=E,me.needsrecalc="yes";break;case"deletecol":case"deleterow":for(e.renderneeded=!0,e.changedrendervalues=!0,e.widgetsClean=!1,l=o.NextToken(),s=o.RestOfString(),Y=me.lastcol,V=me.lastrow,Ce(),"deletecol"==a?(F=g.col-v.col-1,E=0,k=v.col+1,_=1):(F=0,E=g.row-v.row-1,k=1,_=v.row+1),b=_;b<=V-E;b++)for(y=k;y<=Y-F;y++)if(C=t.crToCoord(y+F,b+E),(w=e.cells[C])&&w.readonly)return h="Unable to remove "+("deletecol"==a?"column":"row")+", because cell "+w.coord+" is locked";for(b=_;b<=V-E;b++)for(y=k;y<=Y-F;y++)C=t.crToCoord(y+F,b+E),n&&(b<_-E||y<k-F)&&(w=e.cells[C],
w?ge.AddUndo("set "+C+" all",e.CellToString(w)):ge.AddUndo("erase "+C+" all")),T=t.crToCoord(y,b),w=e.cells[T],w?e.cells[C]=w:delete e.cells[C];
//!!! multiple deletes isn't setting #REF!; need to fix up #REF!'s on undo but only those!
for(C in e.cells)(w=e.cells[C])&&("f"==w.datatype?(q=w.formula,w.formula=t.AdjustFormulaCoords(q,g.col,F,g.row,E),w.formula!=q&&(delete w.parseinfo,n&&-1!=w.formula.indexOf("#REF!")&&(K=t.coordToCr(C),ge.AddUndo("set "+t.rcColname(K.col-F)+(K.row-E)+" formula "+q)))):delete w.parseinfo);for(le in e.names)e.names[le]&&(ce=e.names[le].definition,de="","="==ce.charAt(0)&&(de="=",ce=ce.substring(1)),e.names[le].definition=de+t.AdjustFormulaCoords(ce,g.col,F,g.row,E));for(b=_;b<=V-E&&"deleterow"==a;b++){G=b+E;for(c in e.rowattribs)m=e.rowattribs[c][b],e.rowattribs[c][G]!=m&&(n&&ge.AddUndo("set "+G+" "+c,e.rowattribs[c][G]),m?e.rowattribs[c][G]=m:delete e.rowattribs[c][G])}for(y=k;y<=Y-F&&"deletecol"==a;y++){z=t.rcColname(y),W=t.rcColname(y+F);for(c in e.colattribs)m=e.colattribs[c][z],e.colattribs[c][W]!=m&&(n&&ge.AddUndo("set "+W+" "+c,e.colattribs[c][W]),m?e.colattribs[c][W]=m:delete e.colattribs[c][W])}var xe=new t.RenderContext(e);xe.CalculateCellSkipData();var Ee={};for(var _e in xe.cellskip){var ke=t.coordToCr(_e),Te=xe.cellskip[_e],Fe=xe.coordToCR[Te];"deletecol"===a&&ke.col===k+F&&Fe.col<ke.col&&(Ee[Te]||(e.GetAssuredCell(Te).colspan+=F),Ee[Te]=!0),"deleterow"===a&&ke.row===_+E&&Fe.row<ke.row&&(Ee[Te]||(e.GetAssuredCell(Te).rowspan+=E),Ee[Te]=!0)}if(n)if("deletecol"==a)for(y=g.col;y<=v.col;y++)ge.AddUndo("insertcol "+t.rcColname(g.col));else for(b=g.row;b<=v.row;b++)ge.AddUndo("insertrow "+g.row);"deletecol"==a?g.col<=Y&&(v.col<=Y?me.lastcol+=F:me.lastcol=g.col-1):g.row<=V&&(v.row<=V?me.lastrow+=E:me.lastrow=g.row-1),me.needsrecalc="yes";break;case"movepaste":case"moveinsert":var De,Me,Ae,Pe,Le,Re,Ie;for(e.renderneeded=!0,e.changedrendervalues=!0,n&&ge.AddUndo("changedrendervalues"),l=o.NextToken(),Me=o.NextToken(),s=o.RestOfString(),""==s&&(s="all"),Ce(),Ae=t.coordToCr(Me),F=Ae.col-g.col,E=Ae.row-g.row,P=v.col-g.col+1,L=v.row-g.row+1,De={},b=g.row;b<=v.row;b++)for(y=g.col;y<=v.col;y++)if(C=t.crToCoord(y,b),w=e.GetAssuredCell(C),!w.readonly&&(n&&ge.AddUndo("set "+C+" all",e.CellToString(w)),e.cells[C])){De[C]=new t.Cell(C);for(c in ve)typeof w[c]!==undefined&&(De[C][c]=w[c],"all"==s&&delete w[c],"formulas"==s&&(1!=ve[c]&&3!=ve[c]||delete w[c]),"formats"==s&&2==ve[c]&&delete w[c]);"formulas"==s&&(w.datavalue="",w.datatype=null,w.formula="",w.valuetype="b"),"all"==s&&delete e.cells[C]}if("moveinsert"==a&&(Pe=!1,Le=!1,0==E&&(Ae.col<g.col||Ae.col>v.col)?Ae.col<g.col?(Re=g.col-Ae.col,Pe=-1):(Ae.col-=1,F=Ae.col-v.col,Re=Ae.col-v.col,Pe=1):0==F&&(Ae.row<g.row||Ae.row>v.row)?Ae.row<g.row?(Re=g.row-Ae.row,Le=-1):(Ae.row-=1,E=Ae.row-v.row,Re=Ae.row-v.row,Le=1):a="movepaste"),Ie={},Le)for(b=0;b<Re;b++)for(y=g.col;y<=v.col;y++){if(Le<0?(T=t.crToCoord(y,Ae.row+Re-b-1),C=t.crToCoord(y,v.row-b)):(T=t.crToCoord(y,Ae.row-Re+b+1),C=t.crToCoord(y,g.row+b)),D=e.GetAssuredCell(T),n&&ge.AddUndo("set "+T+" all",e.CellToString(D)),w=e.GetAssuredCell(C),"all"==s||"formats"==s)for(c in ve)1!=ve[c]&&(typeof D[c]===undefined||3==ve[c]?delete w[c]:w[c]=D[c]);"all"!=s&&"formulas"!=s||(w.datavalue=D.datavalue,w.datatype=D.datatype,w.valuetype=D.valuetype,w.formula=D.formula,delete w.parseinfo,w.errors=D.errors),delete w.displaystring,Ie[T]=C}if(Pe)for(y=0;y<Re;y++)for(b=g.row;b<=v.row;b++){if(Pe<0?(T=t.crToCoord(Ae.col+Re-y-1,b),C=t.crToCoord(v.col-y,b)):(T=t.crToCoord(Ae.col-Re+y+1,b),C=t.crToCoord(g.col+y,b)),D=e.GetAssuredCell(T),n&&ge.AddUndo("set "+T+" all",e.CellToString(D)),w=e.GetAssuredCell(C),"all"==s||"formats"==s)for(c in ve)1!=ve[c]&&(typeof D[c]===undefined||3==ve[c]?delete w[c]:w[c]=D[c]);"all"!=s&&"formulas"!=s||(w.datavalue=D.datavalue,w.datatype=D.datatype,w.valuetype=D.valuetype,w.formula=D.formula,delete w.parseinfo,w.errors=D.errors),delete w.displaystring,Ie[T]=C}for(Ae.col+P-1>me.lastcol&&(me.lastcol=Ae.col+P-1),Ae.row+L-1>me.lastrow&&(me.lastrow=Ae.row+L-1),b=g.row;b<g.row+L;b++)for(y=g.col;y<g.col+P;y++)if(C=t.crToCoord(y+F,b+E),w=e.GetAssuredCell(C),!w.readonly)if(n&&ge.AddUndo("set "+C+" all",e.CellToString(w)),T=t.crToCoord(y,b),Ie[T]=C,"all"!=s||De[T]){if(D=De[T],D||(D=e.GetAssuredCell(T)),"all"==s||"formats"==s)for(c in ve)1!=ve[c]&&(typeof D[c]===undefined||3==ve[c]?delete w[c]:w[c]=D[c]);"all"!=s&&"formulas"!=s||(w.datavalue=D.datavalue,w.datatype=D.datatype,w.valuetype=D.valuetype,w.formula=D.formula,delete w.parseinfo,w.errors=D.errors,D.comment?w.comment=D.comment:w.comment&&delete w.comment),delete w.displaystring}else delete e.cells[C];for(C in e.cells)(w=e.cells[C])&&("f"==w.datatype?(q=w.formula,w.formula=t.ReplaceFormulaCoords(q,Ie),w.formula!=q&&(delete w.parseinfo,n&&!Ie[C]&&ge.AddUndo("set "+C+" formula "+q))):delete w.parseinfo);for(le in e.names)e.names[le]&&(ce=e.names[le].definition,q=ce,de="","="==ce.charAt(0)&&(de="=",ce=ce.substring(1)),e.names[le].definition=de+t.ReplaceFormulaCoords(ce,Ie),n&&e.names[le].definition!=q&&ge.AddUndo("name define "+le+" "+q));me.needsrecalc="yes";break;case"name":if(l=o.NextToken(),le=o.NextToken(),s=o.RestOfString(),""==(le=le.toUpperCase().replace(/[^A-Z0-9_\.]/g,"")))break;if("define"==l){if(""==s)break;e.names[le]?(n&&ge.AddUndo("name define "+le+" "+e.names[le].definition),e.names[le].definition=s):(n&&ge.AddUndo("name delete "+le),e.names[le]={definition:s,desc:""})}else"desc"==l?e.names[le]&&(n&&ge.AddUndo("name desc "+le+" "+e.names[le].desc),e.names[le].desc=s):"delete"==l&&(n&&(e.names[le].desc&&ge.AddUndo("name desc "+le+" "+e.names[le].desc),ge.AddUndo("name define "+le+" "+e.names[le].definition)),delete e.names[le]);me.needsrecalc="yes";break;case"recalc":me.needsrecalc="yes",e.recalconce=!0;break;case"redisplay":e.renderneeded=!0;break;case"changedrendervalues":e.changedrendervalues=!0;break;case"pane":if(le=o.NextToken().toUpperCase(),he=1,pe=t.GetSpreadsheetControlObject().editor,"ROW"===le.toUpperCase()){for(b=parseInt(o.NextToken(),10),"undefined"!=typeof pe.context.rowpanes[1]&&"number"==typeof pe.context.rowpanes[1].first&&(he=pe.context.rowpanes[1].first),n&&ge.AddUndo("pane row "+he);"yes"==pe.context.sheetobj.rowattribs.hide[b];)b++;(!b||b<=pe.context.rowpanes[0].first)&&pe.context.rowpanes.length>1?pe.context.rowpanes.length=1:(pe.context.rowpanes.length-1&&pe.timeout,pe.context.SetRowPaneFirstLast(0,pe.context.rowpanes[0].first,b-1),pe.context.SetRowPaneFirstLast(1,b,b)),pe.griddiv&&(fe=document.getElementById("trackingline-vertical"))&&(pe.griddiv.removeChild(fe),pe.FitToEditTable())}else{for(y=parseInt(o.NextToken(),10),"undefined"!=typeof pe.context.colpanes[1]&&"number"==typeof pe.context.colpanes[1].first&&(he=pe.context.colpanes[1].first),n&&ge.AddUndo("pane col "+he);"yes"==pe.context.sheetobj.colattribs.hide[t.rcColname(y)];)y++;(!y||y<=pe.context.colpanes[0].first)&&pe.context.colpanes.length>1?pe.context.colpanes.length=1:(pe.context.colpanes.length-1&&pe.timeout,pe.context.SetColPaneFirstLast(0,pe.context.colpanes[0].first,y-1),pe.context.SetColPaneFirstLast(1,y,y)),pe.griddiv&&(fe=document.getElementById("trackingline-horizon"))&&(pe.griddiv.removeChild(fe),pe.FitToEditTable())}e.renderneeded=!0;break;case"startcmdextension":le=o.NextToken(),ue=e.sci.CmdExtensionCallbacks[le],ue&&ue.func(le,ue.data,e,o,n);break;case"settimetrigger":case"sendemail":case"submitform":break;default:h=ye.s_escUnknownCmd+i}return t._app&&(be?1==e.renderneeded&&"value"!=c&&"text"!=c&&"formula"!=c&&"constant"!=c&&"empty"!=c?e.widgetsClean=!1:"all"==c&&(e.widgetsClean=!1):1==e.renderneeded&&(e.widgetsClean=!1)),h},t.SheetUndo=function(e){var t,o=e.changes.TOS(),n=o?o.undo.length-1:-1,r="";for(t=n;t>=0;t--)r&&(r+="\n"),r+=o.undo[t];e.changes.Undo(),e.ScheduleSheetCommands(r,!1)},t.SheetRedo=function(e){var t,o;if(!e.changes.Redo())return void e.ScheduleSheetCommands("",!1);t=e.changes.TOS();var n="";for(o=0;t&&o<t.command.length;o++)n&&(n+="\n"),n+=t.command[o];e.ScheduleSheetCommands(n,!1)},t.CreateAuditString=function(e){var t,o,n="",r=e.changes.stack,i=e.changes.tos;for(t=0;t<=i;t++)for(o=0;o<r[t].command.length;o++)n+=r[t].command[o]+"\n";return n},t.GetStyleNum=function(e,t,o){var n;return 0==o.length?0:(n=e[t+"hash"][o],n||(e[t+"s"].length<1&&e[t+"s"].push(""),n=e[t+"s"].push(o)-1,e[t+"hash"][o]=n,e.changedrendervalues=!0),n)},t.GetStyleString=function(e,t,o){return o?e[t+"s"][o]:null},t.OffsetFormulaCoords=function(e,o,n){var r,i,a,s,l,c,d="",u=t.Formula;if(!u)return"Need SocialCalc.Formula";var p=u.TokenType,h=p.op,f=p.string,m=p.coord,g=u.TokenOpExpansion;for(r=u.ParseFormulaIntoTokens(e),s=0;s<r.length;s++)a=r[s].type,i=r[s].text,a==m?(c="",l=t.coordToCr(i),"$"!=i.charAt(0)?l.col+=o:c+="$",c+=t.rcColname(l.col),-1==i.indexOf("$",1)?l.row+=n:c+="$",c+=l.row,(l.row<1||l.col<1)&&(c="#REF!"),d+=c):a==f?i.indexOf('"')>=0?d+='"'+i.replace(/"/,'""')+'"':d+='"'+i+'"':d+=a==h?g[i]||i:i;return d},t.AdjustFormulaCoords=function(e,o,n,r,i){var a,s,l,c,d="",u=!1,p=t.Formula;if(!p)return"Need SocialCalc.Formula";var h=p.TokenType,f=h.op,m=h.string,g=h.coord,v=p.TokenOpExpansion;for(parseinfo=t.Formula.ParseFormulaIntoTokens(e),l=0;l<parseinfo.length;l++)a=parseinfo[l].type,s=parseinfo[l].text,a==f&&("!"==s?u=!0:":"!=s&&(u=!1),s=v[s]||s),a==g?(cr=t.coordToCr(s),(n<0&&cr.col>=o&&cr.col<o-n||i<0&&cr.row>=r&&cr.row<r-i)&&(u||(cr.col=0,cr.row=0)),u||(cr.col>=o&&(cr.col+=n),cr.row>=r&&(cr.row+=i)),c="$"==s.charAt(0)?"$"+t.rcColname(cr.col):t.rcColname(cr.col),-1!=s.indexOf("$",1)?c+="$"+cr.row:c+=cr.row,(cr.row<1||cr.col<1)&&(c="#REF!"),s=c):a==m&&(s=s.indexOf('"')>=0?'"'+s.replace(/"/,'""')+'"':'"'+s+'"'),d+=s;return d},t.ReplaceFormulaCoords=function(e,o){var n,r,i,a,s,l="",c=!1,d=t.Formula;if(!d)return"Need SocialCalc.Formula";var u=d.TokenType,p=u.op,h=u.string,f=u.coord,m=d.TokenOpExpansion;for(parseinfo=t.Formula.ParseFormulaIntoTokens(e),i=0;i<parseinfo.length;i++)n=parseinfo[i].type,r=parseinfo[i].text,n==p&&("!"==r?c=!0:":"!=r&&(c=!1),
//!!!! HANDLE RANGE EXTENT MOVES
r=m[r]||r),n==f?(cr=t.coordToCr(r),s=t.crToCoord(cr.col,cr.row),o[s]&&!c&&(cr=t.coordToCr(o[s]),a="$"==r.charAt(0)?"$"+t.rcColname(cr.col):t.rcColname(cr.col),-1!=r.indexOf("$",1)?a+="$"+cr.row:a+=cr.row,r=a)):n==h&&(r=r.indexOf('"')>=0?'"'+r.replace(/"/,'""')+'"':'"'+r+'"'),l+=r;return l},t.RecalcInfo={sheet:null,currentState:0,state:{idle:0,start_calc:1,order:2,calc:3,start_wait:4,done_wait:5},recalctimer:null,maxtimeslice:100,timeslicedelay:1,starttime:0,queue:[],LoadSheet:function(){return!1}},t.RecalcData=function(){this.inrecalc=!0,this.celllist=[],this.celllistitem=0,this.calclist=null,this.calclistlength=0,this.firstcalc=null,this.lastcalc=null,this.nextcalc=null,this.count=0,this.checkinfo={}},t.RecalcCheckInfo=function(){this.oldcoord=null,this.parsepos=0,this.inrange=!1,this.inrangestart=!1,this.cr1=null,this.cr2=null,this.c1=null,this.c2=null,this.r1=null,this.r2=null,this.c=null,this.r=null},t.RecalcSheet=function(e){var o=t.RecalcInfo;if(o.currentState!=o.state.idle)return void o.queue.push(e);delete e.attribs.circularreferencecell,t.Formula.FreshnessInfoReset(),t.RecalcClearTimeout(),o.sheet=e,o.currentState=o.state.start_calc,o.starttime=new Date,e.statuscallback&&e.statuscallback(o,"calcstart",null,e.statuscallbackparams),t.RecalcSetTimeout()},t.RecalcSetTimeout=function(){var o=t.RecalcInfo;o.recalctimer=e.setTimeout(t.RecalcTimerRoutine,o.timeslicedelay)},t.RecalcClearTimeout=function(){var o=t.RecalcInfo;o.recalctimer&&(e.clearTimeout(o.recalctimer),o.recalctimer=null)},t.RecalcLoadedSheet=function(e,o,n,r){var i,a=t.RecalcInfo,s=t.Formula;i=t.Formula.AddSheetToCache(e||s.SheetCache.waitingForLoading,o,r),n&&i&&"off"!=i.attribs.recalc&&(i.previousrecalcsheet=a.sheet,a.sheet=i,a.currentState=a.state.start_calc),s.SheetCache.waitingForLoading=null,t.RecalcSetTimeout()},t.RecalcTimerRoutine=function(){var e,o,n,r=new Date,i=0,a=t.Formula;if(!a)return"Need SocialCalc.Formula";var s=t.RecalcInfo,l=s.sheet;if(l){var c=l.recalcdata||(l.recalcdata={}),d=function(e,t){l.statuscallback&&l.statuscallback(c,e,t,l.statuscallbackparams)};if(t.RecalcClearTimeout(),s.currentState==s.state.start_calc){c=new t.RecalcData,l.recalcdata=c;for(n in l.cells)n&&c.celllist.push(n);c.calclist={},s.currentState=s.state.order}if(s.currentState==s.state.order){for(;c.celllistitem<c.celllist.length;)if(n=c.celllist[c.celllistitem++],t.RecalcCheckCell(l,n),new Date-r>=s.maxtimeslice)return d("calcorder",{coord:n,total:c.celllist.length,count:c.celllistitem}),void t.RecalcSetTimeout();return d("calccheckdone",c.calclistlength),c.nextcalc=c.firstcalc,s.currentState=s.state.calc,void t.RecalcSetTimeout()}if(s.currentState==s.state.start_wait){if(s.currentState=s.state.done_wait,s.LoadSheet&&s.LoadSheet(a.SheetCache.waitingForLoading))return;return void t.RecalcLoadedSheet(null,"",!1)}if(s.currentState==s.state.done_wait)return s.currentState=s.state.calc,void t.RecalcSetTimeout();for(s.currentState!=s.state.calc&&alert("Recalc state error: "+s.currentState+". Error in SocialCalc code."),n=l.recalcdata.nextcalc;n;){if(o=l.cells[n],o.parseinfo||(o.parseinfo=a.ParseFormulaIntoTokens(o.formula)),o.parseinfo.coord=n,e=a.evaluate_parsed_formula(o.parseinfo,l,!1),a.SheetCache.waitingForLoading){if(1!=s.firstRenderScheduled){t.GetSpreadsheetControlObject().editor.ScheduleRender(!1),s.firstRenderScheduled=!0}return c.nextcalc=n,c.count+=i,d("calcloading",{sheetname:a.SheetCache.waitingForLoading}),s.currentState=s.state.start_wait,void t.RecalcSetTimeout()}if(a.RemoteFunctionInfo.waitingForServer)return c.nextcalc=n,c.count+=i,d("calcserverfunc",{funcname:a.RemoteFunctionInfo.waitingForServer,coord:n,total:c.calclistlength,count:c.count}),void(s.currentState=s.state.done_wait);if(o.datavalue==e.value&&o.valuetype==e.type||(o.datavalue=e.value,o.valuetype=e.type,delete o.displaystring,l.recalcchangedavalue=!0),e.error&&(o.errors=e.error),i++,n=l.recalcdata.calclist[n],new Date-r>=s.maxtimeslice)return c.nextcalc=n,c.count+=i,d("calcstep",{coord:n,total:c.calclistlength,count:c.count}),void t.RecalcSetTimeout()}if(c.inrecalc=!1,l.reRenderCellList=l.recalcdata.celllist,delete l.recalcdata,delete l.attribs.needsrecalc,s.sheet=l.previousrecalcsheet||null,s.sheet)return s.currentState=s.state.calc,void t.RecalcSetTimeout();a.FreshnessInfo.recalc_completed=!0,s.currentState=s.state.idle,d("calcfinished",new Date-s.starttime),s.queue.length>0&&(l=s.queue.shift(),l.RecalcSheet())}},t.RecalcCheckCell=function(e,o){var n,r,i,a,s,l,c,d,u,p,h=t.Formula;if(!h)return"Need SocialCalc.Formula";var f=h.TokenType,m=f.op,g=f.name,v=f.coord,y=e.recalcdata,b=y.checkinfo,C=!1,w=null,x=o;e:for(;x;)if(u=e.cells[x],p=b[x],!u||"f"!=u.datatype||p&&"object"!=typeof p)x=w,b[x]&&(w=b[x].oldcoord);else{for(p||(p=new t.RecalcCheckInfo,b[x]=p),u.errors&&delete u.errors,u.parseinfo||(u.parseinfo=h.ParseFormulaIntoTokens(u.formula)),n=u.parseinfo,a=p.parsepos;a<n.length;a++){if(p.inrange){if(p.inrangestart&&(p.cr1.col>p.cr2.col?(p.c1=p.cr2.col,p.c2=p.cr1.col):(p.c1=p.cr1.col,p.c2=p.cr2.col),p.c=p.c1-1,p.cr1.row>p.cr2.row?(p.r1=p.cr2.row,p.r2=p.cr1.row):(p.r1=p.cr1.row,p.r2=p.cr2.row),p.r=p.r1,p.inrangestart=!1),p.c+=1,p.c>p.c2){if(p.r+=1,p.r>p.r2){p.inrange=!1;continue}p.c=p.c1}if(s=t.crToCoord(p.c,p.r),p.parsepos=a,p.oldcoord=w,w=x,x=s,b[x]&&"object"==typeof b[x])return u.errors=t.Constants.s_caccCircRef+o,b[o]=!0,y.firstcalc?y.calclist[y.lastcalc]=o:y.firstcalc=o,y.lastcalc=o,y.calclistlength++,e.attribs.circularreferencecell=x+"|"+w,u.errors;continue e}if(i=n[a].type,r=n[a].text,i==m&&("!"==r?C=!0:":"!=r&&(C=!1)),i==g)if(l=h.LookupName(e,r),"range"==l.type){if(-1!=(c=l.value.indexOf("|"))){p.cr1=t.coordToCr(l.value.substring(0,c)),d=l.value.indexOf("|",c+1),p.cr2=t.coordToCr(l.value.substring(c+1,d)),p.inrange=!0,p.inrangestart=!0,a-=1;continue}}else"coord"==l.type&&(i=v,r=l.value);if(i==v){if(a>=2&&n[a-1].type==m&&":"==n[a-1].text&&n[a-2].type==v&&!C){p.cr1=t.coordToCr(n[a-2].text),p.cr2=t.coordToCr(r),p.inrange=!0,p.inrangestart=!0,a-=1;continue}if(!C){if(-1!=r.indexOf("$")&&(r=r.replace(/\$/g,"")),p.parsepos=a+1,p.oldcoord=w,w=x,x=r,b[x]&&"object"==typeof b[x])return u.errors=t.Constants.s_caccCircRef+o,b[o]=!0,y.firstcalc?y.calclist[y.lastcalc]=o:y.firstcalc=o,y.lastcalc=o,y.calclistlength++,e.attribs.circularreferencecell=x+"|"+w,u.errors;continue e}}}C=!1,b[x]=!0,y.firstcalc?y.calclist[y.lastcalc]=x:y.firstcalc=x,y.lastcalc=x,y.calclistlength++,x=w,w=b[x]?b[x].oldcoord:null}return""},t.Parse=function(e){this.str=e,this.pos=0,this.delimiter=" ",this.lineEnd=e.indexOf("\n"),this.lineEnd<0&&(this.lineEnd=e.length)},t.Parse.prototype.NextToken=function(){if(this.pos<0)return"";var e=this.str.indexOf(this.delimiter,this.pos),t=this.pos;return e>this.lineEnd&&(e=this.lineEnd),e>=0?(this.pos=e+1,this.str.substring(t,e)):(this.pos=this.lineEnd,this.str.substring(t,this.lineEnd))},t.Parse.prototype.RestOfString=function(){var e=this.pos;return this.pos<0||this.pos>=this.lineEnd?"":(this.pos=this.lineEnd,this.str.substring(e,this.lineEnd))},t.Parse.prototype.RestOfStringNoMove=function(){return this.pos<0||this.pos>=this.lineEnd?"":this.str.substring(this.pos,this.lineEnd)},t.Parse.prototype.NextLine=function(){this.pos=this.lineEnd+1,this.lineEnd=this.str.indexOf("\n",this.pos),this.lineEnd<0&&(this.lineEnd=this.str.length)},t.Parse.prototype.EOF=function(){return this.pos<0||this.pos>=this.str.length},t.UndoStack=function(){this.stack=[],this.tos=-1,this.maxRedo=0,this.maxUndo=50},t.UndoStack.prototype.PushChange=function(e){for(;this.stack.length>0&&this.stack.length-1>this.tos;)this.stack.pop();this.stack.push({command:[],type:e,undo:[]}),this.maxRedo&&this.stack.length>this.maxRedo&&this.stack.shift(),this.maxUndo&&this.stack.length>this.maxUndo&&(this.stack[this.stack.length-this.maxUndo-1].undo=[]),this.tos=this.stack.length-1},t.UndoStack.prototype.AddDo=function(){if(this.stack[this.stack.length-1]){for(var e=[],t=0;t<arguments.length;t++)null!=arguments[t]&&e.push(arguments[t]);var o=e.join(" ");this.stack[this.stack.length-1].command.push(o)}},t.UndoStack.prototype.AddUndo=function(){if(this.stack[this.stack.length-1]){for(var e=[],t=0;t<arguments.length;t++)null!=arguments[t]&&e.push(arguments[t]);var o=e.join(" ");this.stack[this.stack.length-1].undo.push(o)}},t.UndoStack.prototype.TOS=function(){return this.tos>=0?this.stack[this.tos]:null},t.UndoStack.prototype.Undo=function(){return this.tos>=0&&(!this.maxUndo||this.tos>this.stack.length-this.maxUndo-1)&&(this.tos-=1,!0)},t.UndoStack.prototype.Redo=function(){return this.tos<this.stack.length-1&&(this.tos+=1,!0)},t.Clipboard={clipboard:""},t.RenderContext=function(e){var o=e.attribs,n=t.Constants;if(this.sheetobj=e,this.hideRowsCols=!1,this.showGrid=!1,this.showRCHeaders=!1,this.rownamewidth=n.defaultRowNameWidth,this.pixelsPerRow=n.defaultAssumedRowHeight,this.cellskip={},this.coordToCR={},this.colwidth=[],this.rowheight=[],this.totalwidth=0,this.totalheight=0,this.rowpanes=[],this.colpanes=[],this.colunhideleft=[],this.colunhideright=[],this.rowunhidetop=[],this.rowunhidebottom=[],this.maxcol=0,this.maxrow=0,this.highlights={},this.cursorsuffix="",this.highlightTypes={cursor:{style:n.defaultHighlightTypeCursorStyle,className:n.defaultHighlightTypeCursorClass},range:{style:n.defaultHighlightTypeRangeStyle,className:n.defaultHighlightTypeRangeClass},cursorinsertup:{style:"color:#FFF;backgroundColor:#A6A6A6;backgroundRepeat:repeat-x;backgroundPosition:top left;backgroundImage:url("+n.defaultImagePrefix+"cursorinsertup.gif);",className:n.defaultHighlightTypeCursorClass},cursorinsertleft:{style:"color:#FFF;backgroundColor:#A6A6A6;backgroundRepeat:repeat-y;backgroundPosition:top left;backgroundImage:url("+n.defaultImagePrefix+"cursorinsertleft.gif);",className:n.defaultHighlightTypeCursorClass},range2:{style:"color:#000;backgroundColor:#FFF;backgroundImage:url("+n.defaultImagePrefix+"range2.gif);",className:""}},this.cellIDprefix=n.defaultCellIDPrefix,this.defaultlinkstyle=null,this.defaultHTMLlinkstyle={type:"html"},this.defaultfontstyle=n.defaultCellFontStyle,this.defaultfontsize=n.defaultCellFontSize,this.defaultfontfamily=n.defaultCellFontFamily,this.defaultlayout=n.defaultCellLayout,this.defaultpanedividerwidth=n.defaultPaneDividerWidth,this.defaultpanedividerheight=n.defaultPaneDividerHeight,this.gridCSS=n.defaultGridCSS,this.commentClassName=n.defaultCommentClass,this.commentCSS=n.defaultCommentStyle,this.commentNoGridClassName=n.defaultCommentNoGridClass,this.commentNoGridCSS=n.defaultCommentNoGridStyle,this.readonlyClassName=n.defaultReadonlyClass,this.readonlyCSS=n.defaultReadonlyStyle,this.readonlyNoGridClassName=n.defaultReadonlyNoGridClass,this.readonlyNoGridCSS=n.defaultReadonlyNoGridStyle,this.readonlyComment=n.defaultReadonlyComment,this.classnames={colname:n.defaultColnameClass,rowname:n.defaultRownameClass,selectedcolname:n.defaultSelectedColnameClass,selectedrowname:n.defaultSelectedRownameClass,upperleft:n.defaultUpperLeftClass,skippedcell:n.defaultSkippedCellClass,panedivider:n.defaultPaneDividerClass,unhideleft:n.defaultUnhideLeftClass,unhideright:n.defaultUnhideRightClass,unhidetop:n.defaultUnhideTopClass,unhidebottom:n.defaultUnhideBottomClass,colresizebar:n.defaultColResizeBarClass,rowresizebar:n.defaultRowResizeBarClass},this.explicitStyles={colname:n.defaultColnameStyle,rowname:n.defaultRownameStyle,selectedcolname:n.defaultSelectedColnameStyle,selectedrowname:n.defaultSelectedRownameStyle,upperleft:n.defaultUpperLeftStyle,skippedcell:n.defaultSkippedCellStyle,panedivider:n.defaultPaneDividerStyle,unhideleft:n.defaultUnhideLeftStyle,unhideright:n.defaultUnhideRightStyle,unhidetop:n.defaultUnhideTopStyle,unhidebottom:n.defaultUnhideBottomStyle},this.cellskip=null,this.needcellskip=!0,this.fonts=[],this.layouts=[],this.needprecompute=!0,!o)throw n.s_rcMissingSheet;this.rowpanes[0]={first:1,last:o.lastrow},this.colpanes[0]={first:1,last:o.lastcol},this.usermaxcol=o.usermaxcol,this.usermaxrow=o.usermaxrow},t.RenderContext.prototype.PrecomputeSheetFontsAndLayouts=function(){t.PrecomputeSheetFontsAndLayouts(this)},t.RenderContext.prototype.CalculateCellSkipData=function(){t.CalculateCellSkipData(this)},t.RenderContext.prototype.CalculateColWidthData=function(){t.CalculateColWidthData(this)},t.RenderContext.prototype.CalculateRowHeightData=function(){t.CalculateRowHeightData(this)},t.RenderContext.prototype.SetRowPaneFirstLast=function(e,t,o){this.rowpanes[e]={first:t,last:o}},t.RenderContext.prototype.SetColPaneFirstLast=function(e,t,o){this.colpanes[e]={first:t,last:o}},t.RenderContext.prototype.CoordInPane=function(e,o,n){return t.CoordInPane(this,e,o,n)},t.RenderContext.prototype.CellInPane=function(e,o,n,r){return t.CellInPane(this,e,o,n,r)},t.RenderContext.prototype.InitializeTable=function(e){t.InitializeTable(this,e)},t.RenderContext.prototype.RenderSheet=function(e,o){return t.RenderSheet(this,e,o)},t.RenderContext.prototype.RenderColGroup=function(){return t.RenderColGroup(this)},t.RenderContext.prototype.RenderColHeaders=function(){return t.RenderColHeaders(this)},t.RenderContext.prototype.RenderSizingRow=function(){return t.RenderSizingRow(this)},t.RenderContext.prototype.RenderRow=function(e,o,n){return t.RenderRow(this,e,o,n)},t.RenderContext.prototype.RenderSpacingRow=function(){return t.RenderSpacingRow(this)},t.RenderContext.prototype.RenderCell=function(e,o,n,r,i,a){return t.RenderCell(this,e,o,n,r,i,a)},t.PrecomputeSheetFontsAndLayouts=function(e){var o,n,r,i,a,s,l,c,d=e.sheetobj,u=d.attribs;for(u.defaultfont&&(o=d.fonts[u.defaultfont],o=o.replace(/^\*/,t.Constants.defaultCellFontStyle),o=o.replace(/(.+)\*(.+)/,"$1"+t.Constants.defaultCellFontSize+"$2"),o=o.replace(/\*$/,t.Constants.defaultCellFontFamily),n=o.match(/^(\S+? \S+?) (\S+?) (\S.*)$/),e.defaultfontstyle=n[1],e.defaultfontsize=n[2],e.defaultfontfamily=n[3]),s=1;s<d.fonts.length;s++)l=d.fonts[s],l=l.replace(/^\*/,e.defaultfontstyle),l=l.replace(/(.+)\*(.+)/,"$1"+e.defaultfontsize+"$2"),l=l.replace(/\*$/,e.defaultfontfamily),n=l.match(/^(\S+?) (\S+?) (\S+?) (\S.*)$/),e.fonts[s]={style:n[1],weight:n[2],size:n[3],family:n[4]};for(r=/^padding:\s*(\S+)\s+(\S+)\s+(\S+)\s+(\S+);vertical-align:\s*(\S+);/,i=t.Constants.defaultCellLayout.match(r),a=u.defaultlayout?d.layouts[u.defaultlayout].match(r):["","*","*","*","*","*"],s=1;s<d.layouts.length;s++){for(l=d.layouts[s],n=l.match(r),c=1;c<=5;c++)"*"==n[c]&&(n[c]="*"!=a[c]?a[c]:i[c]);e.layouts[s]="padding:"+n[1]+" "+n[2]+" "+n[3]+" "+n[4]+";vertical-align:"+n[5]+";"}e.needprecompute=!1},t.CalculateCellSkipData=function(e){var o,n,r,i,a,s,l,c,d,u=e.sheetobj;u.rowattribs,u.colattribs;for(e.maxrow=0,e.maxcol=0,e.cellskip={},o=1;o<=u.attribs.lastrow;o++)for(n=1;n<=u.attribs.lastcol;n++)if(r=t.crToCoord(n,o),(i=u.cells[r])!==undefined&&!e.cellskip[r]&&(a=i.colspan||1,s=i.rowspan||1,a>1||s>1))for(l=o;l<o+s;l++)for(c=n;c<n+a;c++)d=t.crToCoord(c,l),d==r?e.coordToCR[r]={row:o,col:n}:e.cellskip[d]=r,l>e.maxrow&&(maxrow=l),c>e.maxcol&&(maxcol=c);e.needcellskip=!1},t.CalculateColWidthData=function(e){var o,n,r,i,a=e.sheetobj;a.colattribs;for(i=e.showRCHeaders?e.rownamewidth-0:0,colpane=0;colpane<e.colpanes.length;colpane++)for(o=e.colpanes[colpane].first;o<=e.colpanes[colpane].last;o++)n=t.rcColname(o),"yes"==a.colattribs.hide[n]?e.colwidth[o]=0:(r=a.colattribs.width[n]||a.attribs.defaultcolwidth||t.Constants.defaultColWidth,"blank"!=r&&"auto"!=r||(r=""),e.colwidth[o]=r+"",i+=r&&r-0>0?r-0:10);e.totalwidth=i},t.CalculateRowHeightData=function(e){var o,n,r,i=e.sheetobj;for(r=e.showRCHeaders?e.pixelsPerRow:0,rowpane=0;rowpane<e.rowpanes.length;rowpane++)for(o=e.rowpanes[rowpane].first;o<=e.rowpanes[rowpane].last;o++)"yes"===i.rowattribs.hide[o]?e.rowheight[o]=0:(n=i.rowattribs.height[o]||i.attribs.defaultrowheight||t.Constants.defaultAssumedRowHeight,"blank"!==n&&"auto"!==n||(n=""),e.rowheight[o]=n+"",r+=n&&n-0>0?n-0:10);e.totalheight=r},t.InitializeTable=function(e,t){t.style.borderCollapse="collapse",t.cellSpacing="0",t.cellPadding="0",t.style.width=e.totalwidth+"px"},t.RenderSheet=function(e,t,o){var n,r,i,a,s,l;for(e.sheetobj.changedrendervalues&&(e.needcellskip=!0,e.needprecompute=!0,e.sheetobj.changedrendervalues=!1),e.needcellskip&&e.CalculateCellSkipData(),e.needprecompute&&e.PrecomputeSheetFontsAndLayouts(),e.CalculateColWidthData(),e.CalculateRowHeightData(),i=document.createElement("table"),e.InitializeTable(i),a=e.RenderColGroup(),i.appendChild(a),s=document.createElement("tbody"),s.appendChild(e.RenderSizingRow()),e.showRCHeaders&&(n=e.RenderColHeaders())&&s.appendChild(n),r=0;r<e.rowpanes.length;r++){for(rownum=e.rowpanes[r].first;rownum<=e.rowpanes[r].last;rownum++)n=e.RenderRow(rownum,r,o),s.appendChild(n);r<e.rowpanes.length-1&&(n=e.RenderSpacingRow(),s.appendChild(n))}return i.appendChild(s),t&&(l=t.parentNode)&&l.replaceChild(i,t),i},t.RenderRow=function(e,o,n,r){var i,a,s,l,c=e.sheetobj,d=document.createElement("tr");if(e.showRCHeaders){if(a=document.createElement("td"),e.classnames&&(a.className=e.classnames.rowname),e.explicitStyles&&(a.style.cssText=e.explicitStyles.rowname),a.width=e.rownamewidth,a.height=e.rowheight[o],a.style.verticalAlign="top",a.innerHTML=o+"",o<e.rowpanes[e.rowpanes.length-1].last&&"yes"==c.rowattribs.hide[o+1]){var u=document.createElement("div");u.style.position="relative";var p=document.createElement("div");e.classnames&&(p.className=e.classnames.unhidetop),e.explicitStyles&&(p.style.cssText=e.explicitStyles.unhidetop);var h=e.rowheight[o]-0-t.Constants.defaultAssumedRowHeight;h=0===h?4:h,p.style.bottom="-"+h+"px",e.rowunhidetop[o]=p,u.appendChild(p),a.appendChild(u)}if(o>1&&"yes"==c.rowattribs.hide[o-1]){var p=document.createElement("div");e.classnames&&(p.className=e.classnames.unhidebottom),e.explicitStyles&&(p.style.cssText=e.explicitStyles.unhidebottom),e.rowunhidebottom[o]=p,a.appendChild(p)}var f=document.createElement("div");f.className=e.classnames.rowresizebar,a.appendChild(f),d.appendChild(a)}for(s=0;s<e.colpanes.length;s++){for(i=e.colpanes[s].first;i<=e.colpanes[s].last;i++)(a=e.RenderCell(o,i,n,s,null,r))&&d.appendChild(a);s<e.colpanes.length-1&&(a=document.createElement("td"),a.width=e.defaultpanedividerwidth,e.classnames.panedivider&&(a.className=e.classnames.panedivider),e.explicitStyles.panedivider&&(a.style.cssText=e.explicitStyles.panedivider),l=document.createElement("div"),l.style.width=e.defaultpanedividerwidth+"px",l.style.overflow="hidden",a.appendChild(l),d.appendChild(a))}return"yes"==c.rowattribs.hide[o]&&(d.style.cssText+=";display:none"),d},t.RenderSpacingRow=function(e){var t,o,n,r,i=(e.sheetobj,document.createElement("tr"));for(e.showRCHeaders&&(o=document.createElement("td"),o.width=e.rownamewidth,o.height=e.defaultpanedividerheight,e.classnames.panedivider&&(o.className=e.classnames.panedivider),e.explicitStyles.panedivider&&(o.style.cssText=e.explicitStyles.panedivider),i.appendChild(o)),n=0;n<e.colpanes.length;n++){for(t=e.colpanes[n].first;t<=e.colpanes[n].last;t++)o=document.createElement("td"),r=e.colwidth[t],r&&(o.width=r),o.height=e.defaultpanedividerheight,e.classnames.panedivider&&(o.className=e.classnames.panedivider),e.explicitStyles.panedivider&&(o.style.cssText=e.explicitStyles.panedivider),o&&i.appendChild(o);n<e.colpanes.length-1&&(o=document.createElement("td"),o.width=e.defaultpanedividerwidth,o.height=e.defaultpanedividerheight,e.classnames.panedivider&&(o.className=e.classnames.panedivider),e.explicitStyles.panedivider&&(o.style.cssText=e.explicitStyles.panedivider),i.appendChild(o))}return i},t.RenderColHeaders=function(e){var o,n,r=e.sheetobj,i=document.createElement("tr");if(!e.showRCHeaders)return null;for(n=document.createElement("td"),e.classnames&&(n.className=e.classnames.upperleft),e.explicitStyles&&(n.style.cssText=e.explicitStyles.upperleft),n.width=e.rownamewidth,i.appendChild(n),colpane=0;colpane<e.colpanes.length;colpane++){for(o=e.colpanes[colpane].first;o<=e.colpanes[colpane].last;o++){if(n=document.createElement("td"),e.classnames&&(n.className=e.classnames.colname),e.explicitStyles&&(n.style.cssText=e.explicitStyles.colname),"yes"==r.colattribs.hide[t.rcColname(o)]&&(n.style.cssText+=";display:none"),n.innerHTML=t.rcColname(o),o<e.colpanes[e.colpanes.length-1].last&&"yes"==r.colattribs.hide[t.rcColname(o+1)]){var a=document.createElement("div");e.classnames&&(a.className=e.classnames.unhideleft),e.explicitStyles&&(a.style.cssText=e.explicitStyles.unhideleft),e.colunhideleft[o]=a,n.appendChild(a)}o>1&&"yes"==r.colattribs.hide[t.rcColname(o-1)]&&(a=document.createElement("div"),e.classnames&&(a.className=e.classnames.unhideright),e.explicitStyles&&(a.style.cssText=e.explicitStyles.unhideright),e.colunhideright[o]=a,n.appendChild(a));var s=document.createElement("span");s.style.height=t.Constants.defaultAssumedRowHeight+"px",s.className=e.classnames.colresizebar,n.appendChild(s),i.appendChild(n)}colpane<e.colpanes.length-1&&(n=document.createElement("td"),n.width=e.defaultpanedividerwidth,e.classnames.panedivider&&(n.className=e.classnames.panedivider),e.explicitStyles.panedivider&&(n.style.cssText=e.explicitStyles.panedivider),i.appendChild(n))}return i},t.RenderColGroup=function(e){var o,n,r,i,a=e.sheetobj,s=document.createElement("colgroup");for(e.showRCHeaders&&(r=document.createElement("col"),r.width=e.rownamewidth,s.appendChild(r)),o=0;o<e.colpanes.length;o++){for(n=e.colpanes[o].first;n<=e.colpanes[o].last;n++)r=document.createElement("col"),"yes"==a.colattribs.hide[t.rcColname(n)]?r.width="1":(i=e.colwidth[n],i&&(r.width=i),s.appendChild(r));o<e.colpanes.length-1&&(r=document.createElement("col"),r.width=e.defaultpanedividerwidth,s.appendChild(r))}return s},t.RenderSizingRow=function(e){var o,n,r,i,a=e.sheetobj,s=document.createElement("tr");for(e.showRCHeaders&&(r=document.createElement("td"),r.style.width=e.rownamewidth+"px",r.height="1",s.appendChild(r)),o=0;o<e.colpanes.length;o++){for(n=e.colpanes[o].first;n<=e.colpanes[o].last;n++)r=document.createElement("td"),"yes"==a.colattribs.hide[t.rcColname(n)]?r.width="1":(i=e.colwidth[n])&&(r.width=i),r.height="1",s.appendChild(r);o<e.colpanes.length-1&&(r=document.createElement("td"),r.width=e.defaultpanedividerwidth,r.height="1",s.appendChild(r))}return s},t.RenderCell=function(e,o,n,r,i,a,s){var l,c,d,u,p,h,f,m=e.sheetobj,g="";o-=0,n-=0;var v=t.crToCoord(n,o);if(e.cellskip[v])return e.CoordInPane(e.cellskip[v],r,i)?null:(d=a?t.CreatePseudoElement():document.createElement("td"),e.classnames.skippedcell&&(d.className=e.classnames.skippedcell),e.explicitStyles.skippedcell&&(d.style.cssText=e.explicitStyles.skippedcell),d.innerHTML="&nbsp;",d);if(d=a?t.CreatePseudoElement():document.createElement("td"),e.cellIDprefix&&(d.id=e.cellIDprefix+v),p=m.cells[v],p||(p=new t.Cell(v)),f=m.attribs,scc=t.Constants,p.colspan>1){for(u=1,l=1;l<p.colspan;l++)"yes"!=m.colattribs.hide[t.rcColname(n+l)]&&e.CellInPane(o,n+l,r,i)&&u++;d.colSpan=u}if(p.rowspan>1){for(u=1,l=1;l<p.rowspan;l++)"yes"!=m.rowattribs.hide[o+l+""]&&e.CellInPane(o+l,n,r,i)&&u++;d.rowSpan=u}
//!!!!!!!!!
return p.displaystring!=undefined&&0!=m.widgetsClean||(p.displaystring=t.FormatValueForDisplay(m,p.datavalue,v,s||e.defaultlinkstyle)),d.innerHTML=p.displaystring,l=p.layout||f.defaultlayout,l&&"undefined"!=typeof e.layouts[l]?g+=e.layouts[l]:g+=scc.defaultCellLayout,l=p.font||f.defaultfont,l&&"undefined"!=typeof e.fonts[l]?(c=e.fonts[l],g+="font-style:"+c.style+";font-weight:"+c.weight+";font-size:"+c.size+";font-family:"+c.family+";"):(scc.defaultCellFontSize&&(g+="font-size:"+scc.defaultCellFontSize+";"),scc.defaultCellFontFamily&&(g+="font-family:"+scc.defaultCellFontFamily+";")),l=p.color||f.defaultcolor,l&&"undefined"!=typeof m.colors[l]&&(g+="color:"+m.colors[l]+";"),l=p.bgcolor||f.defaultbgcolor,l&&"undefined"!=typeof m.colors[l]&&(g+="background-color:"+m.colors[l]+";"),l=p.cellformat,l&&"undefined"!=typeof m.cellformats[l]?g+="text-align:"+m.cellformats[l]+";":(c=p.valuetype.charAt(0),"t"==c?(l=f.defaulttextformat)&&"undefined"!=typeof m.cellformats[l]&&(g+="text-align:"+m.cellformats[l]+";"):"n"==c?(l=f.defaultnontextformat,l&&"undefined"!=typeof m.cellformats[l]?g+="text-align:"+m.cellformats[l]+";":g+="text-align:right;"):g+="text-align:left;"),(p.colspan>1||p.rowspan>1)&&(h=m.cells[t.crToCoord(n+(p.colspan||1)-1,o+(p.rowspan||1)-1)]),l=p.bt,l&&"undefined"!=typeof m.borderstyles[l]&&(g+="border-top:"+m.borderstyles[l]+";"),l=void 0!==h?h.br:p.br,l&&"undefined"!=typeof m.borderstyles[l]?g+="border-right:"+m.borderstyles[l]+";":e.showGrid&&(c=e.CellInPane(o,n+(p.colspan||1),r,i)?t.crToCoord(n+(p.colspan||1),o):"nomatch",e.cellskip[c]&&(c=e.cellskip[c]),m.cells[c]&&m.cells[c].bl||(g+="border-right:"+e.gridCSS)),l=void 0!==h?h.bb:p.bb,l&&"undefined"!=typeof m.borderstyles[l]?g+="border-bottom:"+m.borderstyles[l]+";":e.showGrid&&(c=e.CellInPane(o+(p.rowspan||1),n,r,i)?t.crToCoord(n,o+(p.rowspan||1)):"nomatch",e.cellskip[c]&&(c=e.cellskip[c]),m.cells[c]&&m.cells[c].bt||(g+="border-bottom:"+e.gridCSS)),l=p.bl,l&&"undefined"!=typeof m.borderstyles[l]&&(g+="border-left:"+m.borderstyles[l]+";"),p.comment&&(d.title=p.comment,e.showGrid?(e.commentClassName&&(d.className=(d.className?d.className+" ":"")+e.commentClassName),g+=e.commentCSS):(e.commentNoGridClassName&&(d.className=(d.className?d.className+" ":"")+e.commentNoGridClassName),g+=e.commentNoGridCSS)),p.readonly&&(p.comment||(d.title=e.readonlyComment),e.showGrid?(e.readonlyClassName&&(d.className=(d.className?d.className+" ":"")+e.readonlyClassName),g+=e.readonlyCSS):(e.readonlyNoGridClassName&&(d.className=(d.className?d.className+" ":"")+e.readonlyNoGridClassName),g+=e.readonlyNoGridCSS)),d.style.cssText=g,p.cssc!==undefined&&(a?d.className=(d.className?d.className+" ":"")+p.cssc:d.classList.add(p.cssc)),c=e.highlights[v],c&&("cursor"==c&&(c+=e.cursorsuffix),e.highlightTypes[c].className&&(d.className=(d.className?d.className+" ":"")+e.highlightTypes[c].className),t.setStyles(d,e.highlightTypes[c].style)),"yes"==m.colattribs.hide[t.rcColname(n)]&&(d.style.cssText+=";display:none"),"yes"==m.rowattribs.hide[o]&&(d.style.cssText+=";display:none"),d},t.CoordInPane=function(e,t,o,n){var r=e.coordToCR[t];if(!r||!r.row||!r.col)throw"Bad coordToCR for "+t;return e.CellInPane(r.row,r.col,o,n)},t.CellInPane=function(e,t,o,n,r){var i=e.rowpanes[n],a=e.colpanes[r];if(!i||!a)throw"CellInPane called with unknown panes "+n+"/"+r;return!(t<i.first||t>i.last)&&!(o<a.first||o>a.last)},t.CreatePseudoElement=function(){return{style:{cssText:""},innerHTML:"",className:""}},t.rcColname=function(e){e>702&&(e=702),e<1&&(e=1);var t=(e-1)%26+65,o=Math.floor((e-1)/26);return o?String.fromCharCode(o+64)+String.fromCharCode(t):String.fromCharCode(t)},t.letters=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],t.crToCoord=function(e,o){e<1&&(e=1),e>702&&(e=702),o<1&&(o=1);var n=(e-1)%26,r=Math.floor((e-1)/26);return r?t.letters[r-1]+t.letters[n]+o:t.letters[n]+o},t.coordToCol={},t.coordToRow={},t.coordToCr=function(e){var o,n,r,i=t.coordToRow[e];if(i)return{row:i,col:t.coordToCol[e]};for(o=0,i=0,n=0;n<e.length;n++)36==(r=e.charCodeAt(n))||(r<=57?i=10*i+r-48:r>=97?o=26*o+r-96:r>=65&&(o=26*o+r-64));return t.coordToCol[e]=o,t.coordToRow[e]=i,{row:i,col:o}},t.ParseRange=function(e){var o,n,r,i;return e||(e="A1:A1"),e=e.toUpperCase(),o=e.indexOf(":"),o>=0?(n=e.substring(0,o),r=t.coordToCr(n),r.coord=n,n=e.substring(o+1),i=t.coordToCr(n),i.coord=n):(r=t.coordToCr(e),r.coord=e,i=t.coordToCr(e),i.coord=e),{cr1:r,cr2:i}},t.decodeFromSave=function(e){if("string"!=typeof e)return e;if(-1==e.indexOf("\\"))return e;var t=e.replace(/\\c/g,":");return t=t.replace(/\\n/g,"\n"),t.replace(/\\b/g,"\\")},t.decodeFromAjax=function(e){if("string"!=typeof e)return e;if(-1==e.indexOf("\\"))return e;var t=e.replace(/\\c/g,":");return t=t.replace(/\\n/g,"\n"),t=t.replace(/\\e/g,"]]"),t.replace(/\\b/g,"\\")},t.encodeForSave=function(e){return"string"!=typeof e?e:(-1!=e.indexOf("\\")&&(e=e.replace(/\\/g,"\\b")),-1!=e.indexOf(":")&&(e=e.replace(/:/g,"\\c")),-1!=e.indexOf("\n")&&(e=e.replace(/\n/g,"\\n")),e)},t.special_chars=function(e){return/[&<>"]/.test(e)&&(e=e.replace(/&/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/"/g,"&quot;")),e},t.Lookup=function(e,t){for(i=0;i<t.length;i++)if(t[i]>e)return i>0?i-1:null;return t.length-1},t.setStyles=function(e,t){var o,n,r,i,a;if(t)for(o=t.split(";"),n=0;n<o.length;n++)-1!=(r=o[n].indexOf(":"))&&(i=o[n].substring(0,r),a=o[n].substring(r+1),i&&a&&(e.style[i]=a))},t.GetViewportInfo=function(){var t={};return e.innerWidth?(t.width=e.innerWidth,t.height=e.innerHeight,t.horizontalScroll=e.pageXOffset,t.verticalScroll=e.pageYOffset):document.documentElement&&document.documentElement.clientWidth?(t.width=document.documentElement.clientWidth,t.height=document.documentElement.clientHeight,t.horizontalScroll=document.documentElement.scrollLeft,t.verticalScroll=document.documentElement.scrollTop):document.body.clientWidth&&(t.width=document.body.clientWidth,t.height=document.body.clientHeight,t.horizontalScroll=document.body.scrollLeft,t.verticalScroll=document.body.scrollTop),t},t.GetElementPosition=function(e){for(var o=0,n=0;e&&"relative"!=t.GetComputedStyle(e,"position");)o+=e.offsetLeft,n+=e.offsetTop,e=e.offsetParent;return{left:o,top:n}},t.GetElementPositionWithScroll=function(e){var t=e.getBoundingClientRect();return{left:t.left,right:t.right,top:t.top,bottom:t.bottom,width:t.width?t.width:t.right-t.left,height:t.height?t.height:t.bottom-t.top}},t.GetElementFixedParent=function(e){for(;e&&"HTML"!=e.tagName;){if("fixed"==t.GetComputedStyle(e,"position"))return e;e=e.parentNode}return!1},t.GetComputedStyle=function(e,t){var o;return o="undefined"!=typeof e.currentStyle?e.currentStyle:document.defaultView.getComputedStyle(e,null),o[t]},t.LookupElement=function(e,t){var o;for(o=0;o<t.length;o++)if(t[o].element==e)return t[o];return null},t.AssignID=function(e,t,o){e.idPrefix&&(t.id=e.idPrefix+o)},t.GetCellContents=function(e,t){var o="",n=e.cells[t];if(n)switch(n.datatype){case"v":o=n.datavalue+"";break;case"t":o="'"+n.datavalue;break;case"f":o="="+n.formula;break;case"c":o=n.formula}return o},t.FormatValueForDisplay=function(e,o,n,r){var i,a,s,l,c=e.attribs,d=(t.Constants,e.cells[n]);d||(d=new t.Cell(n)),l=o,a=d.valuetype||"",s=a.substring(1),valueinputwidget=a.charAt(1);var u=a.substring(2),p=null,h=null;if(a=a.charAt(0),d.errors||"e"==a)return l=d.errors||s||"Error in cell";if("t"==a){if("formula"==(i=e.valueformats[d.textvalueformat-0]||e.valueformats[c.defaulttextvalueformat-0]||""))return l="f"==d.datatype?t.special_chars("="+d.formula)||"&nbsp;":"c"==d.datatype?t.special_chars("'"+d.formula)||"&nbsp;":t.special_chars("'"+l)||"&nbsp;";var p=l;l=t.format_text_for_display(l,d.valuetype,i,e,r,d.nontextvalueformat);var h=l}else if("n"==a){if(i=d.nontextvalueformat,null!=i&&""!=i||(i=c.defaultnontextvalueformat),i=e.valueformats[i-0],null!=i&&"none"!=i||(i=""),"formula"==i)return l="f"==d.datatype?t.special_chars("="+d.formula)||"&nbsp;":"c"==d.datatype?t.special_chars("'"+d.formula)||"&nbsp;":t.special_chars("'"+l)||"&nbsp;";if("forcetext"==i)return l="f"==d.datatype?t.special_chars("="+d.formula)||"&nbsp;":"c"==d.datatype?t.special_chars(d.formula)||"&nbsp;":t.special_chars(l)||"&nbsp;";var p=l;l=t.format_number_for_display(l,d.valuetype,i);var h=l}else l="&nbsp;";if("i"==valueinputwidget&&null!=p&&null!=h){var f=e.ioParameterList[n],m=t.Formula.FunctionList[u];if(m){var g=m[5],v=0==p?"":"checked";g=g.replace(/<%=checked%>/g,v),g=g.replace(/<%=formated_value%>/g,h),g=g.replace(/<%=display_value%>/g,p);var y;if(f){for(var b=0;b<f.length;b++){y="coord"==f[b].type?e.GetAssuredCell(f[b].value).datavalue:f[b].value;var C=new RegExp("<%=parameter"+b+"_value%>","g");g=g.replace(C,y)}if(f.html)for(var w=0;w<f.html.length;w++){var C=new RegExp("<%=html"+w+"_value%>","g");g=g.replace(C,f.html[w])}f.css&&(g=g.replace(/^(<\w+)(\W)/,"$1 style='"+f.css+"'$2"))}return g.replace(/<%=cell_reference%>/g,n)}return"error:Widget HTML missing"}return l},t.format_text_for_display=function(e,o,n,r,i,a){var n,s,l,c,d,u;return s=o.substring(1),u=e,"none"!=n&&null!=n||(n=""),/^(text-|custom|hidden)/.test(n)||(n=""),""!=n&&"General"!=n||("h"==s&&(n="text-html"),"w"!=s&&"r"!=s||(n="text-wiki"),"l"==s&&(n="text-link"),s||(n="text-plain")),"text-html"==n||(t.Callbacks.expand_wiki&&/^text-wiki/.test(n)?u=t.Callbacks.expand_wiki(u,r,i,n):"text-wiki"==n?u=t.Callbacks.expand_markup&&t.Callbacks.expand_markup(u,r,i)||t.special_chars("wiki-text:"+u):"text-url"==n?(l=t.special_chars(u),c=encodeURI(u),u='<a href="'+c+'">'+l+"</a>"):"text-link"==n?u=t.expand_text_link(u,r,i,n):"text-image"==n?(c=encodeURI(u),u='<img src="'+c+'">'):"text-custom:"==n.substring(0,12)?(l=t.special_chars(u),l=l.replace(/  /g,"&nbsp; "),l=l.replace(/\n/g,"<br>"),c=encodeURI(u),d={},d.r=u,d.s=l,d.u=c,u=n.substring(12),u=u.replace(/@(r|s|u)/g,function(e,t){return d[t]})):"custom"==n.substring(0,6)?(u=t.special_chars(u),u=u.replace(/  /g,"&nbsp; "),u=u.replace(/\n/g,"<br>"),u+=" (custom format)"):"hidden"==n?u="&nbsp;":null!=a&&""!=a&&"none"!=r.valueformats[a-0]&&""!=r.valueformats[a-0]?(n=r.valueformats[a],u=t.format_number_for_display(e,o,n)):(u=t.special_chars(u),u=u.replace(/  /g,"&nbsp; "),u=u.replace(/\n/g,"<br>"))),u},t.format_number_for_display=function(e,o,n){var r,i,a=t.Constants;return r=e-0,i=o.substring(1),"Auto"!=n&&""!=n||(n="%"==i?a.defaultFormatp:"$"==i?a.defaultFormatc:"dt"==i?a.defaultFormatdt:"d"==i?a.defaultFormatd:"t"==i?a.defaultFormatt:"l"==i?"logical":"General"),"logical"==n?r?a.defaultDisplayTRUE:a.defaultDisplayFALSE:"hidden"==n?"&nbsp;":t.FormatNumber.formatNumberWithFormat(e,n,"")},t.DetermineValueType=function(e){var o,n,r,i,a,s,l,c,d,u,p=e+"",h="t";return o=p.replace(/^\s+/,""),o=o.replace(/\s+$/,""),0==p.length?h="":p.match(/^\s+$/)||(o.match(/^[-+]?\d*(?:\.)?\d*(?:[eE][-+]?\d+)?$/)?(p=o-0,isNaN(p)?p=e+"":h="n"):o.match(/^[-+]?\d*(?:\.)?\d*\s*%$/)?(p=(o.slice(0,-1)-0)/100,h="n%"):o.match(/^[-+]?\$\s*\d*(?:\.)?\d*\s*$/)&&o.match(/\d/)?(p=o.replace(/\$/,"")-0,h="n$"):o.match(/^[-+]?(\d*,\d*)+(?:\.)?\d*$/)?(p=o.replace(/,/g,"")-0,h="n"):o.match(/^[-+]?(\d*,\d*)+(?:\.)?\d*\s*%$/)?(p=(o.replace(/[%,]/g,"")-0)/100,h="n%"):o.match(/^[-+]?\$\s*(\d*,\d*)+(?:\.)?\d*$/)&&o.match(/\d/)?(p=o.replace(/[\$,]/g,"")-0,h="n$"):(n=p.match(/^(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{1,4})\s*$/))?(r=n[3]-0,r=r<1e3?r+2e3:r,p=0===navigator.language.indexOf("fr")?t.FormatNumber.convert_date_gregorian_to_julian(r,n[2]-0,n[1]-0)-2415019:t.FormatNumber.convert_date_gregorian_to_julian(r,n[1]-0,n[2]-0)-2415019,h="nd"):(n=p.match(/^(\d{4})[\/\-](\d{1,2})[\/\-](\d{1,2})\s*$/))?(r=n[1]-0,r=r<1e3?r+2e3:r,p=t.FormatNumber.convert_date_gregorian_to_julian(r,n[2]-0,n[3]-0)-2415019,h="nd"):(n=p.match(/^(\d{4})[\/\-](\d{1,2})[\/\-](\d{1,2}) (\d{1,2}):(\d{1,2})\s*$/))?(r=n[1]-0,r=r<1e3?r+2e3:r,i=n[4]-0,a=n[5]-0,p=t.FormatNumber.convert_date_gregorian_to_julian(r,n[2]-0,n[3]-0)-2415019,h="nd",i<24&&a<60&&(p+=i/24+a/1440,h="ndt")):(n=p.match(/^(\d{4})[\/\-](\d{1,2})[\/\-](\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})\s*$/))?(r=n[1]-0,r=r<1e3?r+2e3:r,i=n[4]-0,a=n[5]-0,s=n[6]-0,p=t.FormatNumber.convert_date_gregorian_to_julian(r,n[2]-0,n[3]-0)-2415019,h="nd",i<24&&a<60&&s<60&&(p+=i/24+a/1440+s/86400,h="ndt")):(n=p.match(/^(\d{1,2}):(\d{1,2})\s*$/))?(i=n[1]-0,a=n[2]-0,i<24&&a<60&&(p=i/24+a/1440,h="nt")):(n=p.match(/^(\d{1,2}):(\d{1,2}):(\d{1,2})\s*$/))?(i=n[1]-0,a=n[2]-0,s=n[3]-0,i<24&&a<60&&s<60&&(p=i/24+a/1440+s/86400,h="nt")):(n=p.match(/^\s*([-+]?\d+) (\d+)\/(\d+)\s*$/))?(d=n[1]-0,c=n[2]-0,(l=n[3]-0)&&l>0&&(p=d+(d<0?-c/l:c/l),h="n")):(u=t.InputConstants[p.toUpperCase()])?(c=u.indexOf(","),p=u.substring(0,c)-0,h=u.substring(c+1)):o.length>7&&"http://"==o.substring(0,7).toLowerCase()?(p=o,h="tl"):o.match(/<([A-Z][A-Z0-9]*)\b[^>]*>[\s\S]*?<\/\1>/i)&&(p=o,h="th")),{value:p,type:h}},t.InputConstants={TRUE:"1,nl",FALSE:"0,nl","#N/A":"0,e#N/A","#NULL!":"0,e#NULL!","#NUM!":"0,e#NUM!","#DIV/0!":"0,e#DIV/0!","#VALUE!":"0,e#VALUE!","#REF!":"0,e#REF!","#NAME?":"0,e#NAME?"},t.default_expand_markup=function(e){var o=e;return o=t.special_chars(o),o=o.replace(/  /g,"&nbsp; "),o=o.replace(/\n/g,"<br>")},t.expand_text_link=function(e,o,n,r){var i,a,s=t.Constants,l="",c=t.ParseCellLinkText(e+"");return i=c.desc?t.special_chars(c.desc):c.pagename?s.defaultPageLinkFormatString:s.defaultLinkFormatString,e.length>7&&"http://"==e.substring(0,7).toLowerCase()&&">"!=e.charAt(e.length-1)&&(i=i.substring(7)),a=c.newwin||!n?' target="_blank"':"",c.pagename?t.Callbacks.MakePageLink&&(l=t.Callbacks.MakePageLink(c.pagename,c.workspacename,n,r)):l=encodeURI(c.url),'<a href="'+l+'"'+a+">"+i+"</a>"},t.ParseCellLinkText=function(e){var t={url:"",desc:"",newwin:!1,pagename:"",workspace:""},o=!1,n=e.length-1,r=0,i=e.lastIndexOf("<"),a=e.lastIndexOf("["),s=e.lastIndexOf("{"),l=-1;return">"==e.charAt(n)&&-1!=i||"]"==e.charAt(n)&&-1!=a||!("}"!=e.charAt(n)||"]"!=e.charAt(n-1)||-1==s||-1==a||a<s)?(">"==e.charAt(n)?(l=i-1,i>0&&"<"==e.charAt(l)&&">"==e.charAt(n-1)&&(l--,n--,t.newwin=!0)):"]"==e.charAt(n)?(l=a-1,o=!0,a>0&&"["==e.charAt(l)&&"]"==e.charAt(n-1)&&(l--,n--,t.newwin=!0)):"}"==e.charAt(n)&&(l=s-1,o=!0,wsend=a,n--,a>0&&"["==e.charAt(a-1)&&"]"==e.charAt(n-1)&&(wsend=a-1,n--,t.newwin=!0)," "==e.charAt(wsend-1)&&wsend--,t.workspace=e.substring(s+1,wsend)||"")," "==e.charAt(l)&&l--,'"'==e.charAt(r)&&'"'==e.charAt(l)&&(r++,l--)):(n++,l=n),o?t.pagename=e.substring(a+1,n)||"":t.url=e.substring(i+1,n)||"",l>=r&&(t.desc=e.substring(r,l+1)),t},t.ConvertSaveToOtherFormat=function(e,o,n){var r,i,a,s,l,c,d,u,p,h,f="";if("scsave"==o)return e;if(""==e)return"";if(r=new t.Sheet,r.ParseSheetSave(e),n)throw"SocialCalc.ConvertSaveToOtherFormat: Not doing recalc.";if(a=r.copiedfrom?t.ParseRange(r.copiedfrom):{cr1:{row:1,col:1},cr2:{row:r.attribs.lastrow,col:r.attribs.lastcol}},"html"==o)return i=new t.RenderContext(r),r.copiedfrom&&(i.rowpanes[0]={first:a.cr1.row,last:a.cr2.row},i.colpanes[0]={first:a.cr1.col,last:a.cr2.col}),s=document.createElement("div"),l=i.RenderSheet(null,i.defaultHTMLlinkstyle),s.appendChild(l),delete i,delete r,f=s.innerHTML,delete l,delete s,f;for(c=a.cr1.row;c<=a.cr2.row;c++){for(d=a.cr1.col;d<=a.cr2.col;d++)u=t.crToCoord(d,c),p=r.GetAssuredCell(u),h=p.errors?p.errors:p.datavalue+"","csv"==o?(-1!=h.indexOf('"')&&(h=h.replace(/"/g,'""')),/[, \n"]/.test(h)&&(h='"'+h+'"'),d>a.cr1.col&&(h=","+h)):"tab"==o&&(-1!=h.indexOf("\n")&&(-1!=h.indexOf('"')&&(h=h.replace(/"/g,'""')),h='"'+h+'"'),d>a.cr1.col&&(h="\t"+h)),f+=h;f+="\n"}return f},t.ConvertOtherFormatToSave=function(e,o){var n,r,i,a,s,l,c,d,u,p,h,f,m="",g=function(){p++,p>f&&(f=p),h=t.crToCoord(p,u),t.SetConvertedCell(n,h,s),s=""};if("scsave"==o)return e;if(n=new t.Sheet,r=e.split(/\r\n|\n/),f=0,"csv"==o){for(u=0,l=!1,i=0;i<r.length&&(i!=r.length-1||""!=r[i]);i++)for(l?s+="\n":(s="",u++,p=0),a=r[i],c=0;c<a.length;c++)d=a.charAt(c),'"'!=d?(","!=d||l?s+=d:g(),c!=a.length-1||l||g()):l?c<a.length-1&&'"'==a.charAt(c+1)?(c++,s+='"'):(l=!1,c==a.length-1&&g()):l=!0;f>0&&(n.attribs.lastrow=u,n.attribs.lastcol=f,m=n.CreateSheetSave("A1:"+t.crToCoord(f,u)))}if("tab"==o){for(u=0,l=!1,i=0;i<r.length&&(i!=r.length-1||""!=r[i]);i++)for(l?s+="\n":(s="",u++,p=0),a=r[i],c=0;c<a.length;c++){if('"'==(d=a.charAt(c))){if(l){c<a.length-1?'"'==a.charAt(c+1)?(c++,s+='"'):"\t"==a.charAt(c+1)&&(c++,l=!1,g()):(l=!1,g());continue}if(""==s){l=!0;continue}}"\t"!=d||l?s+=d:g(),c!=a.length-1||l||g()}f>0&&(n.attribs.lastrow=u,n.attribs.lastcol=f,m=n.CreateSheetSave("A1:"+t.crToCoord(f,u)))}return m},t.SetConvertedCell=function(e,o,n){var r,i;r=e.GetAssuredCell(o),i=t.DetermineValueType(n),"n"==i.type&&i.value==n?(r.datatype="v",r.valuetype="n",r.datavalue=i.value):"t"==i.type.charAt(0)?(r.datatype="t",r.valuetype=i.type,r.datavalue=i.value):(r.datatype="c",r.valuetype=i.type,r.datavalue=i.value,r.formula=n)};/*
// The code module of the SocialCalc package that displays a scrolling grid with panes
// and handles keyboard and mouse I/O.
//
// (c) Copyright 2008, 2009, 2010 Socialtext, Inc.
// All Rights Reserved.
//
*/
/*

LEGAL NOTICES REQUIRED BY THE COMMON PUBLIC ATTRIBUTION LICENSE:

EXHIBIT A. Common Public Attribution License Version 1.0.

The contents of this file are subject to the Common Public Attribution License Version 1.0 (the
"License"); you may not use this file except in compliance with the License. You may obtain a copy
of the License at http://socialcalc.org. The License is based on the Mozilla Public License Version 1.1 but
Sections 14 and 15 have been added to cover use of software over a computer network and provide for
limited attribution for the Original Developer. In addition, Exhibit A has been modified to be
consistent with Exhibit B.

Software distributed under the License is distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY
KIND, either express or implied. See the License for the specific language governing rights and
limitations under the License.

The Original Code is SocialCalc JavaScript TableEditor.

The Original Developer is the Initial Developer.

The Initial Developer of the Original Code is Socialtext, Inc. All portions of the code written by
Socialtext, Inc., are Copyright (c) Socialtext, Inc. All Rights Reserved.

Contributor: Dan Bricklin.


EXHIBIT B. Attribution Information

When the TableEditor is producing and/or controlling the display the Graphic Image must be
displayed on the screen visible to the user in a manner comparable to that in the
Original Code. The Attribution Phrase must be displayed as a "tooltip" or "hover-text" for
that image. The image must be linked to the Attribution URL so as to access that page
when clicked. If the user interface includes a prominent "about" display which includes
factual prominent attribution in a form similar to that in the "about" display included
with the Original Code, including Socialtext copyright notices and URLs, then the image
need not be linked to the Attribution URL but the "tool-tip" is still required.

Attribution Copyright Notice:

 Copyright (C) 2010 Socialtext, Inc.
 All Rights Reserved.

Attribution Phrase (not exceeding 10 words): SocialCalc

Attribution URL: http://www.socialcalc.org/xoattrib

Graphic Image: The contents of the sc-logo.gif file in the Original Code or
a suitable replacement from http://www.socialcalc.org/licenses specified as
being for SocialCalc.

Display of Attribution Information is required in Larger Works which are defined
in the CPAL as a work which combines Covered Code or portions thereof with code
not governed by the terms of the CPAL.

*/
//    Portions (c) Copyright 2005, 2006, 2007 Software Garden, Inc.
//    Portions (c) Copyright 2007 Socialtext, Inc.
var t;t||(t={}),t.TableEditor=function(o){var n=t.Constants;this.context=o,this.toplevel=null,this.fullgrid=null,this.noEdit=!1,this.width=null,this.tablewidth=null,this.height=null,this.tableheight=null,this.inputBox=null,this.inputEcho=null,this.verticaltablecontrol=null,this.horizontaltablecontrol=null,this.logo=null,this.cellhandles=null,this.timeout=null,this.busy=!1,this.ensureecell=!1,this.deferredCommands=[],this.deferredEmailCommands=[],this.gridposition=null,this.headposition=null,this.firstscrollingrow=null,this.firstscrollingrowtop=null,this.lastnonscrollingrow=null,this.lastvisiblerow=null,this.firstscrollingcol=null,this.firstscrollingcolleft=null,this.lastnonscrollingcol=null,this.lastvisiblecol=null,this.rowpositions=[],this.colpositions=[],this.rowheight=[],this.colwidth=[],this.ecell=null,this.state="start",this.workingvalues={},this.imageprefix=n.defaultImagePrefix,this.idPrefix=n.defaultTableEditorIDPrefix,this.pageUpDnAmount=n.defaultPageUpDnAmount,this.recalcFunction=function(e){if(!e.context.sheetobj.RecalcSheet)return null;e.context.sheetobj.RecalcSheet(t.EditorSheetStatusCallback,e)},this.ctrlkeyFunction=function(o,n){var r,i,a,s,l,c;switch(n){case"[ctrl-c]":case"[ctrl-x]":return r=o.pasteTextarea,r.value="",i=t.GetEditorCellElement(o,o.ecell.row,o.ecell.col),i&&(a=t.GetElementPosition(i.element),r.style.left=a.left-1+"px",r.style.top=a.top-1+"px"),l=o.range.hasrange?t.crToCoord(o.range.left,o.range.top)+":"+t.crToCoord(o.range.right,o.range.bottom):o.ecell.coord,c=t.ConvertSaveToOtherFormat(t.CreateSheetSave(o.context.sheetobj,l),"tab"),s="[ctrl-c]"==n||o.noEdit||o.ECellReadonly()?"copy "+l+" formulas":"cut "+l+" formulas",o.EditorScheduleSheetCommands(s,!0,!1),r.style.display="block",r.value=c,r.focus(),r.select(),e.setTimeout(function(){var e=o.pasteTextarea;e.blur(),e.style.display="none",t.KeyboardFocus()},200),!0;case"[ctrl-v]":return!(!o.noEdit&&!o.ECellReadonly())||(r=o.pasteTextarea,r.value="",i=t.GetEditorCellElement(o,o.ecell.row,o.ecell.col),i&&(a=t.GetElementPosition(i.element),r.style.left=a.left-1+"px",r.style.top=a.top-1+"px"),r.style.display="block",r.value="",r.focus(),e.setTimeout(function(){var e=o.pasteTextarea,n=e.value;e.blur(),e.style.display="none";var r="";if(o.pastescclipboard)o.pastescclipboard=!1;else{var i=t.ConvertSaveToOtherFormat(t.Clipboard.clipboard,"tab");n=n.replace(/\r\n/g,"\n"),n==i||n.length-i.length==1&&n.substring(0,n.length-1)==i||(r="loadclipboard "+t.encodeForSave(t.ConvertOtherFormatToSave(n,"tab"))+"\n")}var a;if(o.range.hasrange){var s=new t.Sheet;s.ParseSheetSave(t.Clipboard.clipboard);var l=s.copiedfrom.match(/(.+):(.+)/);a=null!==l&&l[1]===l[2]?t.crToCoord(o.range.left,o.range.top)+":"+t.crToCoord(o.range.right,o.range.bottom):t.crToCoord(o.range.left,o.range.top)}else a=o.ecell.coord;r+="paste "+a+" formulas",o.EditorScheduleSheetCommands(r,!0,!1),t.KeyboardFocus()},200),!0);case"[ctrl-z]":return o.EditorScheduleSheetCommands("undo",!0,!1),!1;case"[ctrl-s]":if(!t.Constants.AllowCtrlS)break;return e.setTimeout(function(){var n=o.context.sheetobj,r=n.GetAssuredCell(o.ecell.coord),i=r.nontextvalueformat?n.valueformats[r.nontextvalueformat-0]||"":"",a=e.prompt("Advanced Feature:\n\nCustom Numeric Format or Command",i);if(null!=a){if(a.match(/^cmd:/))s=a.substring(4);else{if(a.match(/^edit:/))return s=a.substring(5),void(t.CtrlSEditor&&t.CtrlSEditor(s));l=o.range.hasrange?t.crToCoord(o.range.left,o.range.top)+":"+t.crToCoord(o.range.right,o.range.bottom):o.ecell.coord,s="set "+l+" nontextvalueformat "+a}o.EditorScheduleSheetCommands(s,!0,!1)}},200),!1}return!0},o.sheetobj.statuscallback=t.EditorSheetStatusCallback,o.sheetobj.statuscallbackparams=this,this.StatusCallback={},this.MoveECellCallback={},this.RangeChangeCallback={},this.SettingsCallbacks={},this.ecell={coord:"A1",row:1,col:1},o.highlights[this.ecell.coord]="cursor",this.range={hasrange:!1},this.range2={hasrange:!1}},t.TableEditor.prototype.CreateTableEditor=function(e,o){return t.CreateTableEditor(this,e,o)},t.TableEditor.prototype.ResizeTableEditor=function(e,o){return t.ResizeTableEditor(this,e,o)},t.TableEditor.prototype.SaveEditorSettings=function(){return t.SaveEditorSettings(this)},t.TableEditor.prototype.LoadEditorSettings=function(e,o){return t.LoadEditorSettings(this,e,o)},t.TableEditor.prototype.EditorRenderSheet=function(){t.EditorRenderSheet(this)},t.TableEditor.prototype.EditorScheduleSheetCommands=function(e,o,n){t.EditorScheduleSheetCommands(this,e,o,n)},t.TableEditor.prototype.ScheduleSheetCommands=function(e,t){this.context.sheetobj.ScheduleSheetCommands(e,t)},t.TableEditor.prototype.SheetUndo=function(){this.context.sheetobj.SheetUndo()},t.TableEditor.prototype.SheetRedo=function(){this.context.sheetobj.SheetRedo()},t.TableEditor.prototype.EditorStepSet=function(e,o){t.EditorStepSet(this,e,o)},t.TableEditor.prototype.GetStatuslineString=function(e,o,n){return t.EditorGetStatuslineString(this,e,o,n)},t.TableEditor.prototype.EditorMouseRegister=function(){return t.EditorMouseRegister(this)},t.TableEditor.prototype.EditorMouseUnregister=function(){return t.EditorMouseUnregister(this)},t.TableEditor.prototype.EditorMouseRange=function(e){return t.EditorMouseRange(this,e)},t.TableEditor.prototype.EditorProcessKey=function(e,o){return t.EditorProcessKey(this,e,o)},t.TableEditor.prototype.EditorAddToInput=function(e,o){return t.EditorAddToInput(this,e,o)},t.TableEditor.prototype.DisplayCellContents=function(){return t.EditorDisplayCellContents(this)},t.TableEditor.prototype.EditorSaveEdit=function(e){return t.EditorSaveEdit(this,e)},t.TableEditor.prototype.EditorApplySetCommandsToRange=function(e,o){return t.EditorApplySetCommandsToRange(this,e,o)},t.TableEditor.prototype.MoveECellWithKey=function(e){return t.MoveECellWithKey(this,e)},t.TableEditor.prototype.MoveECell=function(e){return t._app?"A1":t.MoveECell(this,e)},t.TableEditor.prototype.ReplaceCell=function(e,o,n){t.ReplaceCell(this,e,o,n)},t.TableEditor.prototype.UpdateCellCSS=function(e,o,n){t.UpdateCellCSS(this,e,o,n)},t.TableEditor.prototype.SetECellHeaders=function(e){t.SetECellHeaders(this,e)},t.TableEditor.prototype.EnsureECellVisible=function(){t.EnsureECellVisible(this)},t.TableEditor.prototype.ECellReadonly=function(e){return t.ECellReadonly(this,e)},t.TableEditor.prototype.RangeAnchor=function(e){t.RangeAnchor(this,e)},t.TableEditor.prototype.RangeExtend=function(e){t.RangeExtend(this,e)},t.TableEditor.prototype.RangeRemove=function(){t.RangeRemove(this)},t.TableEditor.prototype.Range2Remove=function(){t.Range2Remove(this)},t.TableEditor.prototype.FitToEditTable=function(){t.FitToEditTable(this)},t.TableEditor.prototype.CalculateEditorPositions=function(){t.CalculateEditorPositions(this)},t.TableEditor.prototype.ScheduleRender=function(){this.ScheduleRender(!0)},t.TableEditor.prototype.ScheduleRender=function(e){t._app&&1==e&&(this.context.sheetobj.widgetsClean=!1),t.ScheduleRender(this)},t.TableEditor.prototype.DoRenderStep=function(){t.DoRenderStep(this)},t.TableEditor.prototype.SchedulePositionCalculations=function(){t.SchedulePositionCalculations(this)},t.TableEditor.prototype.DoPositionCalculations=function(){t.DoPositionCalculations(this)},t.TableEditor.prototype.CalculateRowPositions=function(e,o,n){return t.CalculateRowPositions(this,e,o,n)},t.TableEditor.prototype.CalculateColPositions=function(e,o,n){return t.CalculateColPositions(this,e,o,n)},t.TableEditor.prototype.ScrollRelative=function(e,o){t.ScrollRelative(this,e,o)},t.TableEditor.prototype.ScrollRelativeBoth=function(e,o){t.ScrollRelativeBoth(this,e,o)},t.TableEditor.prototype.PageRelative=function(e,o){t.PageRelative(this,e,o)},t.TableEditor.prototype.LimitLastPanes=function(){t.LimitLastPanes(this)},t.TableEditor.prototype.ScrollTableUpOneRow=function(){return t.ScrollTableUpOneRow(this)},t.TableEditor.prototype.ScrollTableDownOneRow=function(){return t.ScrollTableDownOneRow(this)},t.TableEditor.prototype.ScrollTableLeftOneCol=function(){return t.ScrollTableLeftOneCol(this)},t.TableEditor.prototype.ScrollTableRightOneCol=function(){return t.ScrollTableRightOneCol(this)},t.TableEditor.prototype.StopPropagation=function(){return t.StopPropagation(this)},t.TableEditor.prototype.SetMouseMoveUp=function(){return t.SetMouseMoveUp(this)},t.TableEditor.prototype.RemoveMouseMoveUp=function(){return t.RemoveMouseMoveUp(this)},t.CreateTableEditor=function(o,n,r){var i=t.Constants,a=t.AssignID;o.toplevel=document.createElement("div"),o.toplevel.style.position="relative",a(o,o.toplevel,"toplevel"),o.width=n,o.height=r,o.griddiv=document.createElement("div"),o.tablewidth=Math.max(0,n-i.defaultTableControlThickness),o.tableheight=Math.max(0,r-i.defaultTableControlThickness),o.griddiv.style.width=o.tablewidth+"px",o.griddiv.style.height=o.tableheight+"px",o.griddiv.style.overflow="hidden",o.griddiv.style.cursor="default",i.cteGriddivClass&&(o.griddiv.className=i.cteGriddivClass),a(o,o.griddiv,"griddiv"),o.FitToEditTable(),o.EditorRenderSheet(),o.griddiv.appendChild(o.fullgrid),o.verticaltablecontrol=new t.TableControl(o,!0,o.tableheight),o.verticaltablecontrol.CreateTableControl(),a(o,o.verticaltablecontrol.main,"tablecontrolv"),o.horizontaltablecontrol=new t.TableControl(o,!1,o.tablewidth),o.horizontaltablecontrol.CreateTableControl(),a(o,o.horizontaltablecontrol.main,"tablecontrolh");var s,l,c,d,u;return s=document.createElement("table"),o.layouttable=s,s.cellSpacing=0,s.cellPadding=0,a(o,s,"layouttable"),l=document.createElement("tbody"),s.appendChild(l),c=document.createElement("tr"),l.appendChild(c),d=document.createElement("td"),d.appendChild(o.griddiv),c.appendChild(d),1!=t._app&&(d=document.createElement("td"),d.appendChild(o.verticaltablecontrol.main),c.appendChild(d)),c=document.createElement("tr"),l.appendChild(c),1!=t._app&&(d=document.createElement("td"),d.appendChild(o.horizontaltablecontrol.main),c.appendChild(d)),d=document.createElement("td"),t._app?d.style.background="url("+o.imageprefix+"logo.gif) no-repeat right center":d.style.background="url("+o.imageprefix+"logo.gif) no-repeat center center",d.innerHTML="<div style='cursor:pointer;font-size:1px;'><img src='"+o.imageprefix+"1x1.gif' border='0' width='18' height='18'></div>",c.appendChild(d),o.logo=d,a(o,o.logo,"logo"),t.TooltipRegister(d.firstChild.firstChild,"SocialCalc",null,o.toplevel),o.toplevel.appendChild(o.layouttable),o.noEdit||(o.inputEcho=new t.InputEcho(o),a(o,o.inputEcho.main,"inputecho")),o.cellhandles=new t.CellHandles(o),u=document.createElement("textarea"),t.setStyles(u,"display:none;position:absolute;height:1px;width:1px;opacity:0;filter:alpha(opacity=0);"),u.value="",o.pasteTextarea=u,a(o,o.pasteTextarea,"pastetextarea"),navigator.userAgent.match(/Safari\//)&&!navigator.userAgent.match(/Chrome\//)&&(e.removeEventListener("beforepaste",t.SafariPasteFunction,!1),e.addEventListener("beforepaste",t.SafariPasteFunction,!1),e.removeEventListener("beforecopy",t.SafariPasteFunction,!1),e.addEventListener("beforecopy",t.SafariPasteFunction,!1),e.removeEventListener("beforecut",t.SafariPasteFunction,!1),e.addEventListener("beforecut",t.SafariPasteFunction,!1)),o.toplevel.appendChild(o.pasteTextarea),t.MouseWheelRegister(o.toplevel,{WheelMove:t.EditorProcessMouseWheel,editor:o}),t.KeyboardSetFocus(o),t.EditorSheetStatusCallback(null,"startup",null,o),o.toplevel},t.SafariPasteFunction=function(e){e.preventDefault()},t.ResizeTableEditor=function(e,o,n){var r=t.Constants;e.width=o,e.height=n,e.toplevel.style.width=o+"px",e.toplevel.style.height=n+"px",t._app?e.tablewidth=Math.max(0,o):e.tablewidth=Math.max(0,o-r.defaultTableControlThickness),e.tableheight=Math.max(0,n-r.defaultTableControlThickness),e.griddiv.style.width=e.tablewidth+"px",e.griddiv.style.height=e.tableheight+"px",e.verticaltablecontrol.main.style.height=e.tableheight+"px",e.horizontaltablecontrol.main.style.width=e.tablewidth+"px",e.FitToEditTable(),e.ScheduleRender()},t.SaveEditorSettings=function(e){var t,o,n=e.context,r=e.range,i="";for(i+="version:1.0\n",t=0;t<n.rowpanes.length;t++)i+="rowpane:"+t+":"+n.rowpanes[t].first+":"+n.rowpanes[t].last+"\n";for(t=0;t<n.colpanes.length;t++)i+="colpane:"+t+":"+n.colpanes[t].first+":"+n.colpanes[t].last+"\n";e.ecell&&(i+="ecell:"+e.ecell.coord+"\n"),r.hasrange&&(i+="range:"+r.anchorcoord+":"+r.top+":"+r.bottom+":"+r.left+":"+r.right+"\n");for(o in e.SettingsCallbacks)i+=e.SettingsCallbacks[o].save(e,o);return i},t.LoadEditorSettings=function(e,o,n){var r,i,a,s,l,c,d,u,p,h=o.split(/\r\n|\n/),f=[],m=e.context;for(m.rowpanes=[{first:1,last:1}],m.colpanes=[{first:1,last:1}],e.ecell=null,e.range={hasrange:!1},e.range2={hasrange:!1},p=e.range,m.highlights={},u=m.highlights,i=0;i<h.length;i++)switch(r=h[i],f=r.split(":"),d=f[0]){case"version":break;case"rowpane":m.rowpanes[f[1]-0]={first:f[2]-0,last:f[3]-0};break;case"colpane":m.colpanes[f[1]-0]={first:f[2]-0,last:f[3]-0};break;case"ecell":e.ecell=t.coordToCr(f[1]),e.ecell.coord=f[1],u[f[1]]="cursor";break;case"range":for(p.hasrange=!0,p.anchorcoord=f[1],a=t.coordToCr(p.anchorcoord),p.anchorrow=a.row,p.anchorcol=a.col,p.top=f[2]-0,p.bottom=f[3]-0,p.left=f[4]-0,p.right=f[5]-0,s=p.top;s<=p.bottom;s++)for(l=p.left;l<=p.right;l++)c=t.crToCoord(l,s),"cursor"!=u[c]&&(u[c]="range");break;default:e.SettingsCallbacks[d]&&e.SettingsCallbacks[d].load(e,d,r,n)}},t.EditorRenderSheet=function(e){e.EditorMouseUnregister();var o=e.context.sheetobj;if(null!=o.reRenderCellList&&t._app&&!0===o.widgetsClean){for(var n in o.reRenderCellList){var r=o.reRenderCellList[n],i=o.cells[r].valuetype;"i"==i.charAt(1)&&i==o.cells[r].prevvaluetype||(cr=t.coordToCr(r),cell=t.GetEditorCellElement(e,cr.row,cr.col),null!=cell&&e.ReplaceCell(cell,cr.row,cr.col))}o.reRenderCellList=[]}else e.fullgrid=e.context.RenderSheet(e.fullgrid),null!=o.reRenderCellList&&t._app&&(o.widgetsClean=!0,o.reRenderCellList=[]);e.ecell&&e.SetECellHeaders("selected"),t.AssignID(e,e.fullgrid,"fullgrid"),t._app||(e.fullgrid.className="te_download"),e.EditorMouseRegister()},t.EditorScheduleSheetCommands=function(e,o,n,r){if("start"==e.state||r){if(e.busy&&!r)return void e.deferredCommands.push({cmdstr:o,saveundo:n});var i=o.split(" ");switch(i[0]){case"recalc":case"redisplay":e.context.sheetobj.ScheduleSheetCommands(o,!1);break;case"undo":t._app&&(e.context.sheetobj.widgetsClean=!1),e.SheetUndo();break;case"redo":t._app&&(e.context.sheetobj.widgetsClean=!1),e.SheetRedo();break;case"setemailparameters":t.TriggerIoAction.Email(i[1],i[2]);break;default:e.context.sheetobj.ScheduleSheetCommands(o,n)}}},t.EditorSheetStatusCallback=function(e,o,n,r){var i,a,s,l=r.context.sheetobj,c=function(e){for(i in r.StatusCallback)r.StatusCallback[i].func&&r.StatusCallback[i].func(r,e,n,r.StatusCallback[i].params)};switch(o){case"startup":break;case"cmdstart":r.busy=!0,l.celldisplayneeded="";break;case"cmdextension":break;case"cmdend":if(c(o),l.changedrendervalues&&(r.context.PrecomputeSheetFontsAndLayouts(),r.context.CalculateCellSkipData(),l.changedrendervalues=!1),l.celldisplayneeded&&!l.renderneeded&&l.cells[l.celldisplayneeded]&&"e#N/A"!=l.cells[l.celldisplayneeded].valuetype&&(cr=t.coordToCr(l.celldisplayneeded),a=t.GetEditorCellElement(r,cr.row,cr.col),r.ReplaceCell(a,cr.row,cr.col)),r.deferredCommands.length)return s=r.deferredCommands.shift(),void r.EditorScheduleSheetCommands(s.cmdstr,s.saveundo,!0);if(l.attribs.needsrecalc&&("off"!=l.attribs.recalc||l.recalconce)&&r.recalcFunction?(r.FitToEditTable(),l.renderneeded=!1,l.recalconce&&delete l.recalconce,r.recalcFunction(r)):l.renderneeded?(r.FitToEditTable(),l.renderneeded=!1,r.ScheduleRender(!1)):r.SchedulePositionCalculations(),"col"==l.hiddencolrow&&null!==r.ecell){for(var d=r.ecell.col;"yes"==l.colattribs.hide[t.rcColname(d)];)d++;var u=t.crToCoord(d,r.ecell.row);r.MoveECell(u),l.hiddencolrow=""}if("row"==l.hiddencolrow&&null!==r.ecell){for(var p=r.ecell.row;"yes"==l.rowattribs.hide[p];)p++;var u=t.crToCoord(r.ecell.col,p);r.MoveECell(u),l.hiddencolrow=""}return;case"calcstart":r.busy=!0;break;case"calccheckdone":case"calcorder":case"calcstep":case"calcloading":case"calcserverfunc":break;case"calcfinished":return c(o),void r.ScheduleRender(!1);case"schedrender":r.busy=!0;break;case"renderdone":break;case"schedposcalc":r.busy=!0;break;case"doneposcalc":if(r.deferredEmailCommands.length){c(o);var h=r.deferredEmailCommands.shift();return void r.EditorScheduleSheetCommands(h.cmdstr,h.saveundo,!0)}return void(r.deferredCommands.length?(c(o),s=r.deferredCommands.shift(),r.EditorScheduleSheetCommands(s.cmdstr,s.saveundo,!0)):(r.busy=!1,c(o),"start"==r.state&&r.DisplayCellContents()));case"emailing":case"confirmemailsent":break;default:alert("Unknown status: "+o)}c(o)},t.EditorGetStatuslineString=function(e,o,n,r){var i,a,s,l,c,d,u,p,h=t.Constants;switch(a="",o){case"moveecell":case"rangechange":case"startup":break;case"cmdstart":r.command=!0,document.body.style.cursor="progress",e.griddiv.style.cursor="progress",a=h.s_statusline_executing;break;case"cmdextension":a="Command Extension: "+n;break;case"cmdend":r.command=!1;break;case"schedrender":a=h.s_statusline_displaying;break;case"renderdone":a=" ";break;case"schedposcalc":a=h.s_statusline_displaying;break;case"cmdendnorender":case"doneposcalc":document.body.style.cursor="default",e.griddiv.style.cursor="default","sent"==r.emailing&&(a=r.emailreponse,r.emailreponse="",r.emailing="done");break;case"calcorder":a=h.s_statusline_ordering+Math.floor(100*n.count/(n.total||1))+"%";break;case"calcstep":a=h.s_statusline_calculating+Math.floor(100*n.count/(n.total||1))+"%";break;case"calcloading":a=h.s_statusline_calculatingls+": "+n.sheetname;break;case"calcserverfunc":a=h.s_statusline_calculating+Math.floor(100*n.count/(n.total||1))+"%, "+h.s_statusline_doingserverfunc+n.funcname+h.s_statusline_incell+n.coord;break;case"calcstart":r.calculating=!0,document.body.style.cursor="progress",e.griddiv.style.cursor="progress",a=h.s_statusline_calcstart;break;case"calccheckdone":break;case"calcfinished":r.calculating=!1;break;case"emailing":r.emailing="sending",r.emailreponse="";break;case"confirmemailsent":r.emailing="sent","undefined"==typeof r.emailreponse&&(r.emailreponse=""),r.emailreponse+=n;break;default:a=o}if("sending"==r.emailing&&(a+=h.s_statusline_sendemail),"sent"==r.emailing&&(a+=r.emailreponse),!a&&r.calculating&&(a=h.s_statusline_calculating),!r.calculating&&!r.command&&!a&&e.range.hasrange&&(e.range.left!=e.range.right||e.range.top!=e.range.bottom)){for(p=0,c=e.range.top;c<=e.range.bottom;c++)for(d=e.range.left;d<=e.range.right;d++)(u=e.context.sheetobj.cells[t.crToCoord(d,c)])&&u.valuetype&&"n"==u.valuetype.charAt(0)&&(p+=u.datavalue-0);p=t.FormatNumber.formatNumberWithFormat(p,"[,]General",""),s=t.crToCoord(e.range.left,e.range.top)+":"+t.crToCoord(e.range.right,e.range.bottom),a=s+" ("+(e.range.right-e.range.left+1)+"x"+(e.range.bottom-e.range.top+1)+") "+h.s_statusline_sum+"="+p+" "+a}return i=(e.ecell||{}).coord+" &nbsp; "+a,r.calculating||"yes"!=e.context.sheetobj.attribs.needsrecalc||(i+=" &nbsp; "+h.s_statusline_recalcneeded),l=e.context.sheetobj.attribs.circularreferencecell,l&&(l=l.replace(/\|/," referenced by "),i+=" &nbsp; "+h.s_statusline_circref+l+"</span>"),i+=""},t.EditorMouseInfo={registeredElements:[],editor:null,element:null,ignore:!1,mousedowncoord:"",mouselastcoord:"",mouseresizecol:"",mouseresizeclientx:null,mouseresizedisplay:null},t.EditorMouseRegister=function(e){var o,n=t.EditorMouseInfo,r=e.fullgrid;for(o=0;o<n.registeredElements.length;o++)if(n.registeredElements[o].editor==e){if(n.registeredElements[o].element==r)return;break}if(o<n.registeredElements.length?n.registeredElements[o].element=r:n.registeredElements.push({element:r,editor:e}),r.addEventListener)r.addEventListener("mousedown",t.ProcessEditorMouseDown,!1),r.addEventListener("dblclick",t.ProcessEditorDblClick,!1);else{if(!r.attachEvent)throw"Browser not supported";r.attachEvent("onmousedown",t.ProcessEditorMouseDown),r.attachEvent("ondblclick",t.ProcessEditorDblClick)}n.ignore=!1},t.EditorMouseUnregister=function(e){var o,n,r=t.EditorMouseInfo;e.fullgrid;for(o=0;o<r.registeredElements.length&&r.registeredElements[o].editor!=e;o++);o<r.registeredElements.length&&(n=r.registeredElements[o].element,n.removeEventListener?(n.removeEventListener("mousedown",t.ProcessEditorMouseDown,!1),n.removeEventListener("dblclick",t.ProcessEditorDblClick,!1)):n.detachEvent&&(n.detachEvent("onmousedown",t.ProcessEditorMouseDown),n.detachEvent("ondblclick",t.ProcessEditorDblClick)),r.registeredElements.splice(o,1))},t.StopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,e.preventDefault?e.preventDefault():e.returnValue=!1},t.SetMouseMoveUp=function(e,o,n,r){document.addEventListener?(document.addEventListener("mousemove",e,!0),document.addEventListener("mouseup",o,!0)):n.attachEvent&&(n.setCapture(),n.attachEvent("onmousemove",e),n.attachEvent("onmouseup",o),n.attachEvent("onlosecapture",o)),t.StopPropagation(r)},t.RemoveMouseMoveUp=function(e,o,n,r){t.StopPropagation(r),document.removeEventListener?(document.removeEventListener("mousemove",e,!0),document.removeEventListener("mouseup",o,!0)):n.detachEvent&&(n.detachEvent("onlosecapture",o),n.detachEvent("onmouseup",o),n.detachEvent("onmousemove",e),n.releaseCapture())},t.ProcessEditorMouseDown=function(o){var n,r,i,a,s=o||e.event,l=t.EditorMouseInfo,c=s.target||s.srcElement,d=c;3==d.nodeType&&(d=d.parentNode);var u;if(!l.ignore){for(u=null;!u&&c;c=c.parentNode)u=t.LookupElement(c,l.registeredElements);if(!u)return void(l.editor=null);n=u.editor,l.element=c,a=n.range;var p=t.GetElementPositionWithScroll(n.toplevel),h=s.clientX-p.left,f=s.clientY-p.top;if(r=t.GridMousePosition(n,h,f)){if(l.editor=n,r.rowheader)return void(r.rowselect?t.ProcessEditorRowselectMouseDown(o,c,r):t.ProcessEditorRowsizeMouseDown(o,c,r));if(r.colheader)return void(r.colselect?t.ProcessEditorColselectMouseDown(o,c,r):t.ProcessEditorColsizeMouseDown(o,c,r));if(r.coord){if(a.hasrange||o.shiftKey&&n.RangeAnchor(),i=n.MoveECell(r.coord),1==t._app)return void t.CmdGotFocus(!0);var m=n.context.sheetobj.cells[i];if(m&&"i"==m.valuetype.charAt(1)){var g=m.valuetype.substring(2),v=g+"_"+i;if(d&&v==d.id){var y=document.getElementById(v);t.CmdGotFocus(y)}}else a.hasrange&&(o.shiftKey?n.RangeExtend():n.RangeRemove()),l.mousedowncoord=i,l.mouselastcoord=i,n.EditorMouseRange(i),t.KeyboardSetFocus(n),"start"!=n.state&&n.inputBox&&n.inputBox.element.focus(),t.SetMouseMoveUp(t.ProcessEditorMouseMove,t.ProcessEditorMouseUp,c,s)}}}},t.EditorMouseRange=function(e,o){var n,r,i=e.range;switch(e.state){case"input":n=e.inputBox.GetText(),r=e.workingvalues,("(+-*/,:!&<>=^".indexOf(n.slice(-1))>=0&&"="==n.slice(0,1)||"="==n)&&(r.partialexpr=n),r.partialexpr?o&&(i.hasrange?e.inputBox.SetText(r.partialexpr+t.crToCoord(i.left,i.top)+":"+t.crToCoord(i.right,i.bottom)):e.inputBox.SetText(r.partialexpr+o)):(e.inputBox.Blur(),e.inputBox.ShowInputBox(!1),e.state="start",e.cellhandles.ShowCellHandles(!0),e.EditorSaveEdit(),e.inputBox.DisplayCellContents(null));break;case"inputboxdirect":e.inputBox.Blur(),e.inputBox.ShowInputBox(!1),e.state="start",e.cellhandles.ShowCellHandles(!0),e.EditorSaveEdit(),e.inputBox.DisplayCellContents(null)}},t.ProcessEditorMouseMove=function(o){var n,r,i=o||e.event,a=t.EditorMouseInfo;if((n=a.editor)&&!a.ignore){a.element;var s=t.GetElementPositionWithScroll(n.toplevel),l=i.clientX-s.left,c=i.clientY-s.top;if(r=t.GridMousePosition(n,l,c)){if(r&&!r.coord)return void t.SetDragAutoRepeat(n,r);t.SetDragAutoRepeat(n,null),r.coord&&(r.coord!=a.mouselastcoord&&(o.shiftKey||n.range.hasrange||n.RangeAnchor(a.mousedowncoord),n.MoveECell(r.coord),n.RangeExtend()),a.mouselastcoord=r.coord,n.EditorMouseRange(r.coord),t.StopPropagation(i))}}},t.ProcessEditorMouseUp=function(o){var n,r,i,a=o||e.event,s=t.EditorMouseInfo;if((n=s.editor)&&!s.ignore){r=s.element;var l=t.GetElementPositionWithScroll(n.toplevel),c=a.clientX-l.left,d=a.clientY-l.top;if(i=t.GridMousePosition(n,c,d),t.SetDragAutoRepeat(n,null),i)return i.coord||(i.coord=n.ecell.coord),n.range.hasrange?(n.MoveECell(i.coord),n.RangeExtend()):i.coord&&i.coord!=s.mousedowncoord&&(n.RangeAnchor(s.mousedowncoord),n.MoveECell(i.coord),n.RangeExtend()),n.EditorMouseRange(i.coord),s.editor=null,t.RemoveMouseMoveUp(t.ProcessEditorMouseMove,t.ProcessEditorMouseUp,r,a),!1}},t.ProcessEditorColsizeMouseDown=function(o,n,r){var i=o||e.event,a=t.EditorMouseInfo,s=a.editor,l=t.GetElementPositionWithScroll(s.toplevel),c=i.clientX-l.left;if(a.mouseresizecolnum=r.coltoresize,a.mouseresizecol=t.rcColname(r.coltoresize),a.mousedownclientx=c,a.mousecoltounhide=r.coltounhide,r.coltoresize){var d=document.createElement("div");a.mouseresizedisplay=d,d.style.width="auto",d.style.position="absolute",d.style.zIndex=100,d.style.top=s.headposition.top+"px",d.style.left=s.colpositions[r.coltoresize]+"px",d.innerHTML='<table cellpadding="0" cellspacing="0"><tr><td style="height:100px;border:1px dashed black;background-color:white;width:'+(s.context.colwidth[a.mouseresizecolnum]-2)+'px;">&nbsp;</td><td><div style="font-size:small;color:white;background-color:gray;padding:4px;">'+s.context.colwidth[a.mouseresizecolnum]+"</div></td></tr></table>",t.setStyles(d.firstChild.lastChild.firstChild.childNodes[0],"filter:alpha(opacity=85);opacity:.85;"),s.toplevel.appendChild(d)}t.SetMouseMoveUp(t.ProcessEditorColsizeMouseMove,t.ProcessEditorColsizeMouseUp,s.toplevel,i)},t.ProcessEditorColsizeMouseMove=function(o){var n=o||e.event,r=t.EditorMouseInfo,i=r.editor;if(i){if(r.mouseresizecolnum){var a=t.GetElementPositionWithScroll(i.toplevel),s=n.clientX-a.left,l=i.context.colwidth[r.mouseresizecolnum]-0+(s-r.mousedownclientx);l<t.Constants.defaultMinimumColWidth&&(l=t.Constants.defaultMinimumColWidth);var c=r.mouseresizedisplay;c.innerHTML='<table cellpadding="0" cellspacing="0"><tr><td style="height:100px;border:1px dashed black;background-color:white;width:'+(l-2)+'px;">&nbsp;</td><td><div style="font-size:small;color:white;background-color:gray;padding:4px;">'+l+"</div></td></tr></table>",t.setStyles(c.firstChild.lastChild.firstChild.childNodes[0],"filter:alpha(opacity=85);opacity:.85;")}t.StopPropagation(n)}},t.ProcessEditorColsizeMouseUp=function(o){var n=o||e.event,r=t.EditorMouseInfo,i=r.editor;if(i){element=r.element;var a=t.GetElementPositionWithScroll(i.toplevel),s=n.clientX-a.left;if(t.RemoveMouseMoveUp(t.ProcessEditorColsizeMouseMove,t.ProcessEditorColsizeMouseUp,i.toplevel,n),r.mousecoltounhide)i.EditorScheduleSheetCommands("set "+t.rcColname(r.mousecoltounhide)+" hide",!0,!1);else if(r.mouseresizecolnum){var l=i.context.colwidth[r.mouseresizecolnum]-0+(s-r.mousedownclientx);l<t.Constants.defaultMinimumColWidth&&(l=t.Constants.defaultMinimumColWidth),i.EditorScheduleSheetCommands("set "+r.mouseresizecol+" width "+l,!0,!1),i.timeout&&e.clearTimeout(i.timeout),i.timeout=e.setTimeout(t.FinishColRowSize,1)}return!1}},t.FinishColRowSize=function(){var e=t.EditorMouseInfo,o=e.editor;o&&(o.toplevel.removeChild(e.mouseresizedisplay),e.mouseresizedisplay=null,e.editor=null)},t.ProcessEditorRowselectMouseDown=function(o,n,r){var i=o||e.event,a=t.EditorMouseInfo,s=a.editor,l=t.GetSpreadsheetControlObject().sheet;coord1=t.crToCoord(1,r.row),coord2=t.crToCoord(l.LastCol(),r.row),coord3=t.crToCoord(s.firstscrollingcol,r.row),s.RangeAnchor(coord1),s.RangeExtend(coord2),s.MoveECell(coord3),t.SetMouseMoveUp(t.ProcessEditorRowselectMouseMove,t.ProcessEditorRowselectMouseUp,s.toplevel,i)},t.ProcessEditorRowselectMouseMove=function(o){var n=o||e.event,r=t.EditorMouseInfo,i=r.editor,a=t.GetSpreadsheetControlObject().sheet;if(i){var s=t.GetElementPositionWithScroll(i.toplevel),l=n.clientX-s.left,c=n.clientY-s.top;result=t.GridMousePosition(i,l,c),coord2=t.crToCoord(a.LastCol(),result.row),coord3=t.crToCoord(i.firstscrollingcol,result.row),i.RangeExtend(coord2),i.MoveECell(coord3)}},t.ProcessEditorRowselectMouseUp=function(o){var n=(o||e.event,t.EditorMouseInfo),r=n.editor;r&&t.RemoveMouseMoveUp(t.ProcessEditorRowselectMouseMove,t.ProcessEditorRowselectMouseUp,r.toplevel,o)},t.ProcessEditorColselectMouseDown=function(o,n,r){var i=o||e.event,a=t.EditorMouseInfo,s=a.editor,l=t.GetSpreadsheetControlObject().sheet;coord1=t.crToCoord(r.col,1),coord2=t.crToCoord(r.col,l.LastRow()),coord3=t.crToCoord(r.col,s.firstscrollingrow),s.RangeAnchor(coord1),s.RangeExtend(coord2),s.MoveECell(coord3),t.SetMouseMoveUp(t.ProcessEditorColselectMouseMove,t.ProcessEditorColselectMouseUp,s.toplevel,i)},t.ProcessEditorColselectMouseMove=function(o){var n=o||e.event,r=t.EditorMouseInfo,i=r.editor,a=t.GetSpreadsheetControlObject().sheet;if(i){var s=t.GetElementPositionWithScroll(i.toplevel),l=n.clientX-s.left,c=n.clientY-s.top;result=t.GridMousePosition(i,l,c),coord2=t.crToCoord(result.col,a.LastRow()),coord3=t.crToCoord(result.col,i.firstscrollingrow),i.RangeExtend(coord2),i.MoveECell(coord3)}},t.ProcessEditorColselectMouseUp=function(o){var n=(o||e.event,t.EditorMouseInfo),r=n.editor;r&&t.RemoveMouseMoveUp(t.ProcessEditorColselectMouseMove,t.ProcessEditorColselectMouseUp,r.toplevel,o)},t.ProcessEditorRowsizeMouseDown=function(o,n,r){var i=o||e.event,a=t.EditorMouseInfo,s=a.editor,l=t.GetSpreadsheetControlObject().spreadsheetDiv.firstChild.offsetHeight,c=i.clientY-l;if(a.mouseresizerownum=r.rowtoresize,a.mouseresizerow=r.rowtoresize,a.mousedownclienty=c,a.mouserowtounhide=r.rowtounhide,r.rowtoresize){var d=document.createElement("div");a.mouseresizedisplay=d,d.style.width=s.context.totalwidth+"px",d.style.height=s.rowpositions[r.rowtoresize]+"px",d.style.position="absolute",d.style.zIndex=100,d.style.top=s.rowpositions[r.rowtoresize]+"px",d.style.left=s.headposition.left+"px",d.innerHTML='<table cellpadding="0" cellspacing="0"><tr><td style="width:100pxborder:1px dashed black;background-color:white;height:'+(s.context.rowheight[a.mouseresizerownum]-2)+'px;">&nbsp;</td><td><div style="font-size:small;color:white;background-color:gray;padding:4px;">'+s.context.rowheight[a.mouseresizerownum]+"</div></td></tr></table>",t.setStyles(d.firstChild.lastChild.firstChild.childNodes[0],"filter:alpha(opacity=85);opacity:.5;"),s.toplevel.appendChild(d)}t.SetMouseMoveUp(t.ProcessEditorRowsizeMouseMove,t.ProcessEditorRowsizeMouseUp,s.toplevel,i)},t.ProcessEditorRowsizeMouseMove=function(o){var n=o||e.event,r=t.EditorMouseInfo,i=r.editor;if(i){if(r.mouseresizerownum){var a=t.GetSpreadsheetControlObject().spreadsheetDiv.firstChild.offsetHeight,s=n.clientY-a,l=i.context.rowheight[r.mouseresizerownum]-0+(s-r.mousedownclienty);l<t.Constants.defaultAssumedRowHeight&&(l=t.Constants.defaultAssumedRowHeight);var c=r.mouseresizedisplay;c.innerHTML='<table cellpadding="0" cellspacing="0"><tr><td style="width:100px;border:1px dashed black;background-color:white;height:'+(l-2)+'px;">&nbsp;</td><td><div style="font-size:small;color:white;background-color:gray;padding:4px;">'+l+"</div></td></tr></table>",t.setStyles(c.firstChild.lastChild.firstChild.childNodes[0],"filter:alpha(opacity=85);opacity:.5;")}t.StopPropagation(n)}},t.ProcessEditorRowsizeMouseUp=function(o){var n=o||e.event,r=t.EditorMouseInfo,i=r.editor;if(i){element=r.element;var a=t.GetSpreadsheetControlObject().spreadsheetDiv.firstChild.offsetHeight,s=n.clientY-a;if(t.RemoveMouseMoveUp(t.ProcessEditorRowsizeMouseMove,t.ProcessEditorRowsizeMouseUp,i.toplevel,n),r.mouserowtounhide)i.EditorScheduleSheetCommands("set "+r.mouserowtounhide+" hide",!0,!1);else if(r.mouseresizerownum){var l=i.context.rowheight[r.mouseresizerownum]-0+(s-r.mousedownclienty);l<t.Constants.defaultAssumedRowHeight&&(l=t.Constants.defaultAssumedRowHeight),i.EditorScheduleSheetCommands("set "+r.mouseresizerownum+" height "+l,!0,!1),i.timeout&&e.clearTimeout(i.timeout),i.timeout=e.setTimeout(t.FinishColRowSize,1)}return!1}},t.AutoRepeatInfo={timer:null,mouseinfo:null,repeatinterval:1e3,editor:null,repeatcallback:null},t.SetDragAutoRepeat=function(o,n,r){var i,a,s=t.AutoRepeatInfo;if(s.repeatcallback=r,!n)return s.timer&&(e.clearTimeout(s.timer),s.timer=null),void(s.mouseinfo=null);if(s.editor=o,s.mouseinfo&&(n.rowheader||n.rowfooter?n.row!=s.mouseinfo.row&&(i=t.crToCoord(o.ecell.col,n.row),s.repeatcallback?(a=n.row<s.mouseinfo.row?"left":n.row>s.mouseinfo.row?"right":"",s.repeatcallback(i,a)):(o.MoveECell(i),o.MoveECell(i),o.RangeExtend(),o.EditorMouseRange(i))):(n.colheader||n.colfooter)&&n.col!=s.mouseinfo.col&&(i=t.crToCoord(n.col,o.ecell.row),s.repeatcallback?(a=n.row<s.mouseinfo.row?"left":n.row>s.mouseinfo.row?"right":"",s.repeatcallback(i,a)):(o.MoveECell(i),o.RangeExtend(),o.EditorMouseRange(i)))),s.mouseinfo=n,n.distance<5)s.repeatinterval=333;else if(n.distance<10)s.repeatinterval=250;else if(n.distance<25)s.repeatinterval=100;else{if(!(n.distance<35))return void(s.timer&&(e.clearTimeout(s.timer),s.timer=null))
;s.repeatinterval=75}s.timer||(s.timer=e.setTimeout(t.DragAutoRepeat,s.repeatinterval))},t.DragAutoRepeat=function(){var o,n,r,i=t.AutoRepeatInfo,a=i.mouseinfo;a.rowheader?o="left":a.rowfooter?o="right":a.colheader?o="up":a.colfooter&&(o="down"),i.repeatcallback?(r=t.coordToCr(i.editor.ecell.coord),"left"==o&&r.col>1?r.col--:"right"==o?r.col++:"up"==o&&r.row>1?r.row--:"down"==o&&r.row++,n=t.crToCoord(r.col,r.row),i.repeatcallback(n,o)):(n=i.editor.MoveECellWithKey("[a"+o+"]shifted"))&&i.editor.EditorMouseRange(n),i.timer=e.setTimeout(t.DragAutoRepeat,i.repeatinterval)},t.ProcessEditorDblClick=function(o){var n,r,i,a=o||e.event,s=t.EditorMouseInfo,l=a.target||a.srcElement;if(!s.ignore){for(i=null;!i&&l;l=l.parentNode)i=t.LookupElement(l,s.registeredElements);if(!i)return void(s.editor=null);n=i.editor;var c=t.GetElementPositionWithScroll(n.toplevel),d=a.clientX-c.left,u=a.clientY-c.top;if((r=t.GridMousePosition(n,d,u))&&r.coord){switch(s.editor=n,s.element=l,n.range,sheetobj=n.context.sheetobj,n.state){case"start":t.EditorOpenCellEdit(n)}t.StopPropagation(a)}}},t.EditorOpenCellEdit=function(e){var t;return!e.ecell||(!e.inputBox||(!!e.inputBox.element.disabled||(e.inputBox.ShowInputBox(!0),e.inputBox.Focus(),e.inputBox.SetText(""),e.inputBox.DisplayCellContents(),e.inputBox.Select("end"),t=e.workingvalues,t.partialexpr="",t.ecoord=e.ecell.coord,t.erow=e.ecell.row,void(t.ecol=e.ecell.col))))},t.EditorProcessKey=function(e,o,n){var r,i,a,s=(e.context.sheetobj,e.workingvalues),l=e.range;switch("string"!=typeof o&&(o=""),e.state){case"start":if(n.shiftKey&&"[a"==o.substr(0,2)&&(o+="shifted"),"[enter]"==o&&(o="[adown]"),"[tab]"==o&&(o=n.shiftKey?"[aleft]":"[aright]"),"[a"==o.substr(0,2)||"[pg"==o.substr(0,3)||"[home]"==o)return!e.MoveECellWithKey(o);if("[del]"==o||"[backspace]"==o){e.noEdit||e.ECellReadonly()||e.EditorApplySetCommandsToRange("empty","");break}if("[esc]"==o){if(l.hasrange){e.RangeRemove(),e.MoveECell(l.anchorcoord);for(a in e.StatusCallback)e.StatusCallback[a].func(e,"specialkey",o,e.StatusCallback[a].params)}return!1}if("[f2]"==o)return!(!e.noEdit&&!e.ECellReadonly())||(t.EditorOpenCellEdit(e),e.state="inputboxdirect",!1);if(o.length>1&&"["==o.substr(0,1)||0==o.length)return!(e.ctrlkeyFunction&&o.length>0)||e.ctrlkeyFunction(e,o);if(!e.ecell)return!0;if(!e.inputBox)return!0;if(e.ECellReadonly())return!0;e.inputBox.element.disabled=!1,e.state="input",e.inputBox.ShowInputBox(!0),e.inputBox.Focus(),e.inputBox.SetText(o),e.inputBox.Select("end"),s.partialexpr="",s.ecoord=e.ecell.coord,s.erow=e.ecell.row,s.ecol=e.ecell.col,e.RangeRemove();break;case"input":if(i=e.inputBox.GetText(),e.inputBox.skipOne)return!1;if("[esc]"==o||"[enter]"==o||"[tab]"==o||o&&"[a"==o.substr(0,2)){if(("(+-*/,:!&<>=^".indexOf(i.slice(-1))>=0&&"="==i.slice(0,1)||"="==i)&&(s.partialexpr=i),s.partialexpr&&(n.shiftKey&&"[a"==o.substr(0,2)&&(o+="shifted"),r=e.MoveECellWithKey(o)))return l.hasrange?e.inputBox.SetText(s.partialexpr+t.crToCoord(l.left,l.top)+":"+t.crToCoord(l.right,l.bottom)):e.inputBox.SetText(s.partialexpr+r),!1;e.inputBox.Blur(),e.inputBox.ShowInputBox(!1),e.state="start",e.cellhandles.ShowCellHandles(!0),"[esc]"!=o?(e.EditorSaveEdit(),e.ecell.coord!=s.ecoord&&e.MoveECell(s.ecoord),"[enter]"==o&&(o="[adown]"),"[tab]"==o&&(o=n.shiftKey?"[aleft]":"[aright]"),"[a"==o.substr(0,2)&&e.MoveECellWithKey(o)):(e.inputBox.DisplayCellContents(),e.RangeRemove(),e.MoveECell(s.ecoord));break}return s.partialexpr&&"[backspace]"==o?(e.inputBox.SetText(s.partialexpr),s.partialexpr="",e.RangeRemove(),e.MoveECell(s.ecoord),e.inputBox.ShowInputBox(!0),!1):"[f2]"==o?(e.state="inputboxdirect",!1):(l.hasrange&&e.RangeRemove(),e.MoveECell(s.ecoord),s.partialexpr&&(e.inputBox.ShowInputBox(!0),s.partialexpr=""),!0);case"inputboxdirect":if(i=e.inputBox.GetText(),"[esc]"==o||"[enter]"==o||"[tab]"==o){e.inputBox.Blur(),e.inputBox.ShowInputBox(!1),e.state="start",e.cellhandles.ShowCellHandles(!0),"[esc]"==o?e.inputBox.DisplayCellContents():(e.EditorSaveEdit(),e.ecell.coord!=s.ecoord&&e.MoveECell(s.ecoord),"[enter]"==o&&(o="[adown]"),"[tab]"==o&&(o=n.shiftKey?"[aleft]":"[aright]"),"[a"==o.substr(0,2)&&e.MoveECellWithKey(o));break}return"[f2]"!=o||(e.state="input",!1);case"skip-and-start":return e.state="start",e.cellhandles.ShowCellHandles(!0),!1;default:return!0}return!1},t.EditorAddToInput=function(e,t,o){var n=e.workingvalues;if(!e.noEdit&&!e.ECellReadonly())switch(e.state){case"start":e.state="input",e.inputBox.ShowInputBox(!0),e.inputBox.element.disabled=!1,e.inputBox.Focus(),e.inputBox.SetText((o||"")+t),e.inputBox.Select("end"),n.partialexpr="",n.ecoord=e.ecell.coord,n.erow=e.ecell.row,n.ecol=e.ecell.col,e.RangeRemove();break;case"input":case"inputboxdirect":e.inputBox.element.focus(),n.partialexpr&&(e.inputBox.SetText(n.partialexpr),n.partialexpr="",e.RangeRemove(),e.MoveECell(n.ecoord)),e.inputBox.SetText(e.inputBox.GetText()+t)}},t.EditorDisplayCellContents=function(e){e.inputBox&&e.inputBox.DisplayCellContents()},t.EditorSaveEdit=function(e,o){var n,r,i,a,s,l,c=e.context.sheetobj,d=e.workingvalues;i="text t",a="string"==typeof o?o:e.inputBox.GetText(),s=t.GetCellContents(c,d.ecoord)+"",a!=s&&(r=a.charAt(0),"="==r&&-1==a.indexOf("\n")?(i="formula",a=a.substring(1)):"'"==r?(i="text t",a=a.substring(1),n=t.DetermineValueType(a),"t"==n.type.charAt(0)&&(i="text "+n.type)):0==a.length?i="empty":(n=t.DetermineValueType(a),i="n"==n.type&&a==n.value+""?"value n":"t"==n.type.charAt(0)?"text "+n.type:""==n.type?"text t":"constant "+n.type+" "+n.value),"t"==i.charAt(0)&&(a=t.encodeForSave(a)),l="set "+d.ecoord+" "+i+" "+a,e.EditorScheduleSheetCommands(l,!0,!1),"undefined"!=typeof c.ioEventTree&&"undefined"!=typeof c.ioParameterList&&"undefined"!=typeof c.ioEventTree[d.ecoord]&&t.EditedTriggerCell(c.ioEventTree[d.ecoord],d.ecoord,e,c))},t.EditedTriggerCell=function(e,t,o,n){for(var r in e){var i=n.ioParameterList[r];if(void 0!==i)switch(i.function_name){case"EMAILONEDIT":case"EMAILONEDITIF":cmdline="setemailparameters "+r+" "+t,o.deferredEmailCommands.push({cmdstr:cmdline,saveundo:!1})}}},t.EditorApplySetCommandsToRange=function(e,o){var n,r=(e.context.sheetobj,e.ecell),i=e.range;i.hasrange?(coord=t.crToCoord(i.left,i.top)+":"+t.crToCoord(i.right,i.bottom),n="set "+coord+" "+o,e.EditorScheduleSheetCommands(n,!0,!1)):(n="set "+r.coord+" "+o,e.EditorScheduleSheetCommands(n,!0,!1)),e.DisplayCellContents()},t.EditorProcessMouseWheel=function(e,t,o,n){n.functionobj.editor.busy||(t>0&&n.functionobj.editor.ScrollRelative(!0,Math.floor(1.5*-t)),t<0&&n.functionobj.editor.ScrollRelative(!0,Math.ceil(1.5*-t)))},t.GridMousePosition=function(e,o,n){var r,i,a,s,l,c,d={};for(r=1;r<e.rowpositions.length&&!(e.rowheight[r]&&e.rowpositions[r]+e.rowheight[r]>n);r++);for(a=1;a<e.colpositions.length&&!(e.colwidth[a]&&e.colpositions[a]+e.colwidth[a]>o);a++);if(d.row=r,d.col=a,e.headposition){if(o<e.headposition.left&&o>=e.gridposition.left){for(d.rowheader=!0,d.distance=e.headposition.left-o,d.rowtoresize=!1,d.rowselect=!1,l=1;l<e.rowpositions.length;l++)if(e.rowheight[l]&&e.rowpositions[l]+e.rowheight[l]-3<=n&&e.rowpositions[l]+e.rowheight[l]+3>=n){d.rowtoresize=l;break}for((unhide=e.context.rowunhidetop[r])&&(pos=t.GetElementPosition(unhide),o>=pos.left&&o<pos.left+unhide.offsetWidth&&n>=e.rowpositions[r]+e.rowheight[r]-unhide.offsetHeight&&n<e.rowpositions[r]+e.rowheight[r]&&(d.rowtounhide=r+1)),(unhide=e.context.rowunhidebottom[r])&&(pos=t.GetElementPosition(unhide),o>=pos.left&&o<pos.left+unhide.offsetWidth&&n>=e.rowpositions[r]&&n<e.rowpositions[r]+unhide.offsetHeight&&(d.rowtounhide=r-1)),i=0;i<e.context.rowpanes.length;i++)if(d.rowtoresize>=e.context.rowpanes[i].first&&d.rowtoresize<=e.context.rowpanes[i].last)return d;return delete d.rowtoresize,d.rowselect=!0,d}if(n<e.headposition.top&&n>e.gridposition.top){for(d.colheader=!0,d.distance=e.headposition.top-n,d.coltoresize=!1,d.colselect=!1,c=1;c<e.colpositions.length;c++)if(e.colwidth[c]&&e.colpositions[c]+e.colwidth[c]-3<=o&&e.colpositions[c]+e.colwidth[c]+3>=o){d.coltoresize=c;break}for((unhide=e.context.colunhideleft[a])&&(pos=t.GetElementPosition(unhide),o>=pos.left&&o<pos.left+unhide.offsetWidth&&n>=pos.top&&n<pos.top+unhide.offsetHeight&&(d.coltounhide=a+1)),(unhide=e.context.colunhideright[a])&&(pos=t.GetElementPosition(unhide),o>=pos.left&&o<pos.left+unhide.offsetWidth&&n>=pos.top&&n<pos.top+unhide.offsetHeight&&(d.coltounhide=a-1)),s=0;s<e.context.colpanes.length;s++)if(d.coltoresize>=e.context.colpanes[s].first&&d.coltoresize<=e.context.colpanes[s].last)return d;return delete d.coltoresize,d.colselect=!0,d}return o>=e.verticaltablecontrol.controlborder?(d.rowfooter=!0,d.distance=o-e.verticaltablecontrol.controlborder,d):n>=e.horizontaltablecontrol.controlborder?(d.colfooter=!0,d.distance=n-e.horizontaltablecontrol.controlborder,d):o<e.gridposition.left?(d.rowheader=!0,d.distance=e.headposition.left-o,d):n<=e.gridposition.top?(d.colheader=!0,d.distance=e.headposition.top-n,d):(d.coord=t.crToCoord(d.col,d.row),e.context.cellskip[d.coord]&&(d.coord=e.context.cellskip[d.coord]),d)}return null},t.GetEditorCellElement=function(e,o,n){var r=0,i=0;if(0==e.context.showRCHeaders)var r=-1,i=-1;var a,s,l,c,d=0,u=0;for(a=0;a<e.context.rowpanes.length;a++){if(o>=e.context.rowpanes[a].first&&o<=e.context.rowpanes[a].last)for(s=0;s<e.context.colpanes.length;s++){if(n>=e.context.colpanes[s].first&&n<=e.context.colpanes[s].last){for(d+=o-e.context.rowpanes[a].first+2,l=e.context.colpanes[s].first;l<=n;l++)(c=e.context.cellskip[t.crToCoord(l,o)])&&e.context.CoordInPane(c,a,s)||u++;return{element:e.griddiv.firstChild.lastChild.childNodes[d+i].childNodes[u+r],rowpane:a,colpane:s}}for(l=e.context.colpanes[s].first;l<=e.context.colpanes[s].last;l++)(c=e.context.cellskip[t.crToCoord(l,o)])&&e.context.CoordInPane(c,a,s)||u++;u+=1}d+=e.context.rowpanes[a].last-e.context.rowpanes[a].first+1+1}return null},t.MoveECellWithKey=function(e,o){var n,r,i,a,s=!1,l=1;if(!e.ecell)return null;switch("shifted"==o.slice(-7)&&(o=o.slice(0,-7),s=!0),r=e.ecell.row,i=e.ecell.col,a=e.context.sheetobj.cells[e.ecell.coord],o){case"[adown]":r+=a&&a.rowspan||1;break;case"[aup]":r--,l=-1;break;case"[pgdn]":r+=e.pageUpDnAmount-1+(a&&a.rowspan||1);break;case"[pgup]":r-=e.pageUpDnAmount,l=-1;break;case"[aright]":i+=a&&a.colspan||1;break;case"[aleft]":i--,l=-1;break;case"[home]":r=1,i=1;break;default:return null}for(e.context.sheetobj.attribs.usermaxcol&&(i=Math.min(e.context.sheetobj.attribs.usermaxcol,i)),e.context.sheetobj.attribs.usermaxrow&&(r=Math.min(e.context.sheetobj.attribs.usermaxrow,r));"yes"==e.context.sheetobj.colattribs.hide[t.rcColname(i)];)(i+=l)<1&&(l=-l,i=1);for(;"yes"==e.context.sheetobj.rowattribs.hide[r];)(r+=l)<1&&(l=-l,r=1);return e.range.hasrange||s&&e.RangeAnchor(),n=e.MoveECell(t.crToCoord(i,r)),e.range.hasrange&&(s?e.RangeExtend():e.RangeRemove()),n},t.MoveECell=function(e,o){var n,r,i=e.context.highlights,a=t.coordToCr(o);if(e.context.sheetobj.attribs.usermaxcol&&a.col>e.context.sheetobj.attribs.usermaxcol&&(a.col=e.context.sheetobj.attribs.usermaxcol),e.context.sheetobj.attribs.usermaxrow&&a.row>e.context.sheetobj.attribs.usermaxrow&&(a.row=e.context.sheetobj.attribs.usermaxrow),o=t.crToCoord(a.col,a.row),e.ecell){if(e.ecell.coord==o)return o;n=t.GetEditorCellElement(e,e.ecell.row,e.ecell.col),delete i[e.ecell.coord],e.range2.hasrange&&e.ecell.row>=e.range2.top&&e.ecell.row<=e.range2.bottom&&e.ecell.col>=e.range2.left&&e.ecell.col<=e.range2.right&&(i[e.ecell.coord]="range2"),e.UpdateCellCSS(n,e.ecell.row,e.ecell.col),e.SetECellHeaders(""),e.cellhandles&&e.cellhandles.ShowCellHandles(!1)}o=e.context.cellskip[o]||o,e.ecell=t.coordToCr(o),e.ecell.coord=o,n=t.GetEditorCellElement(e,e.ecell.row,e.ecell.col),i[o]="cursor";for(r in e.MoveECellCallback)e.MoveECellCallback[r](e);e.UpdateCellCSS(n,e.ecell.row,e.ecell.col),e.SetECellHeaders("selected");for(r in e.StatusCallback)e.StatusCallback[r].func(e,"moveecell",o,e.StatusCallback[r].params);return e.busy?e.ensureecell=!0:(e.ensureecell=!1,e.EnsureECellVisible()),o},t.EnsureECellVisible=function(e){var t=0,o=0;e.ecell.row>e.lastnonscrollingrow&&(e.ecell.row<e.firstscrollingrow?t=e.ecell.row-e.firstscrollingrow-Math.floor((e.lastvisiblerow-e.firstscrollingrow)/2):e.ecell.row+1>e.lastvisiblerow&&(t=e.ecell.row-e.lastvisiblerow+Math.floor((e.lastvisiblerow-e.firstscrollingrow)/2))),e.ecell.col>e.lastnonscrollingcol&&(e.ecell.col<e.firstscrollingcol?o=e.ecell.col-e.firstscrollingcol-Math.floor((e.lastvisiblecol-e.firstscrollingcol)/2):e.ecell.col+1>e.lastvisiblecol&&(o=e.ecell.col-e.lastvisiblecol+Math.floor((e.lastvisiblecol-e.firstscrollingcol)/2))),0!=t||0!=o?e.ScrollRelativeBoth(t,o):e.cellhandles.ShowCellHandles(!0)},t.ReplaceCell=function(e,t,o,n){var r,i;if(t&&(r=e.context.RenderCell(o,n,t.rowpane,t.colpane,!0,null))&&t.element){t.element.innerHTML=r.innerHTML,t.element.style.cssText="",t.element.className=r.className;for(i in r.style)"cssText"!=r.style[i]&&(t.element.style[i]=r.style[i])}},t.UpdateCellCSS=function(e,t,o,n){var r,i;if(t&&(r=e.context.RenderCell(o,n,t.rowpane,t.colpane,!0,null))){t.element.style.cssText="",t.element.className=r.className;for(i in r.style)"cssText"!=r.style[i]&&(t.element.style[i]=r.style[i])}},t.SetECellHeaders=function(e,o){if(!1!==e.context.showRCHeaders){var n,r,i,a,s,l=e.ecell,c=e.context,d=0,u=0;if(l){for(;"yes"==c.sheetobj.colattribs.hide[t.rcColname(l.col)];)l.col++;for(;"yes"==c.sheetobj.rowattribs.hide[l.row];)l.row++;for(l.coord=t.crToCoord(l.col,l.row),n=0;n<c.rowpanes.length;n++)i=c.rowpanes[n].first,a=c.rowpanes[n].last,l.row>=i&&l.row<=a&&null!==e.fullgrid&&(s=e.fullgrid.childNodes[1].childNodes[2+d+l.row-i].childNodes[0])&&(c.classnames&&(s.className=c.classnames[o+"rowname"]),c.explicitStyles&&(s.style.cssText=c.explicitStyles[o+"rowname"]),s.style.verticalAlign="top"),d+=a-i+1+1;for(r=0;r<c.colpanes.length;r++)i=c.colpanes[r].first,a=c.colpanes[r].last,l.col>=i&&l.col<=a&&null!==e.fullgrid&&(s=e.fullgrid.childNodes[1].childNodes[1].childNodes[1+u+l.col-i])&&(c.classnames&&(s.className=c.classnames[o+"colname"]),c.explicitStyles&&(s.style.cssText=c.explicitStyles[o+"colname"])),u+=a-i+1+1}}},t.ECellReadonly=function(e,t){if(!t&&e.ecell&&(t=e.ecell.coord),!t)return!1;var o=e.context.sheetobj.cells[t];return o&&o.readonly},t.RangeAnchor=function(e,t){e.range.hasrange&&e.RangeRemove(),e.RangeExtend(t)},t.RangeExtend=function(e,o){var n,r,i,a,s,l,c,d=e.context.highlights,u=e.range,p=e.range2;if(o?(c=t.coordToCr(o),c.coord=o):c=e.ecell,c){u.hasrange||(u.anchorcoord=c.coord,u.anchorrow=c.row,u.top=c.row,u.bottom=c.row,u.anchorcol=c.col,u.left=c.col,u.right=c.col,u.hasrange=!0),u.anchorrow<c.row?(u.top=u.anchorrow,u.bottom=c.row):(u.top=c.row,u.bottom=u.anchorrow),u.anchorcol<c.col?(u.left=u.anchorcol,u.right=c.col):(u.left=c.col,u.right=u.anchorcol);for(i in d)switch(d[i]){case"range":d[i]="unrange";break;case"range2":d[i]="unrange2"}for(a=u.top;a<=u.bottom;a++)for(s=u.left;s<=u.right;s++)switch(i=t.crToCoord(s,a),d[i]){case"unrange":d[i]="range";break;case"cursor":break;case"unrange2":default:d[i]="newrange"}for(a=p.top;p.hasrange&&a<=p.bottom;a++)for(s=p.left;s<=p.right;s++)switch(i=t.crToCoord(s,a),d[i]){case"unrange2":d[i]="range2";break;case"range":case"newrange":case"cursor":break;default:d[i]="newrange2"}for(i in d){switch(d[i]){case"unrange":delete d[i];break;case"newrange":d[i]="range";break;case"newrange2":d[i]="range2";break;case"range":case"range2":case"cursor":continue}r=t.coordToCr(i),n=t.GetEditorCellElement(e,r.row,r.col),e.UpdateCellCSS(n,r.row,r.col)}for(l in e.RangeChangeCallback)e.RangeChangeCallback[l](e);i=t.crToCoord(e.range.left,e.range.top),e.range.left==e.range.right&&e.range.top==e.range.bottom||(i+=":"+t.crToCoord(e.range.right,e.range.bottom));for(l in e.StatusCallback)e.StatusCallback[l].func(e,"rangechange",i,e.StatusCallback[l].params)}},t.RangeRemove=function(e){var o,n,r,i,a,s,l=e.context.highlights,c=e.range,d=e.range2;if(c.hasrange||d.hasrange){for(i=d.top;d.hasrange&&i<=d.bottom;i++)for(a=d.left;a<=d.right;a++)switch(r=t.crToCoord(a,i),l[r]){case"range":l[r]="newrange2";break;case"range2":case"cursor":break;default:l[r]="newrange2"}for(r in l){switch(l[r]){case"range":delete l[r];break;case"newrange2":l[r]="range2";break;case"cursor":continue}n=t.coordToCr(r),o=t.GetEditorCellElement(e,n.row,n.col),e.UpdateCellCSS(o,n.row,n.col)}c.hasrange=!1;for(s in e.RangeChangeCallback)e.RangeChangeCallback[s](e);for(s in e.StatusCallback)e.StatusCallback[s].func(e,"rangechange","",e.StatusCallback[s].params)}},t.Range2Remove=function(e){var o,n,r,i=e.context.highlights,a=e.range2;if(a.hasrange){for(r in i){switch(i[r]){case"range2":delete i[r];break;case"range":case"cursor":continue}n=t.coordToCr(r),o=t.GetEditorCellElement(e,n.row,n.col),e.UpdateCellCSS(o,n.row,n.col)}a.hasrange=!1}},t.FitToEditTable=function(e){var o,n,r,i,a,s,l,c,d=e.context,u=d.sheetobj;u.colattribs;for(i=d.showRCHeaders?d.rownamewidth-0:0,colpane=0;colpane<d.colpanes.length-1;colpane++)for(o=d.colpanes[colpane].first;o<=d.colpanes[colpane].last;o++)n=t.rcColname(o),"yes"!=u.colattribs.hide[n]&&(r=u.colattribs.width[n]||u.attribs.defaultcolwidth||t.Constants.defaultColWidth,"blank"!=r&&"auto"!=r||(r=""),i+=r&&r-0>0?r-0:10);for(o=d.colpanes[colpane].first;o<=1e4&&(//!!! max for safety, but makes that col max!!!
n=t.rcColname(o),"yes"!=u.colattribs.hide[n]&&(r=u.colattribs.width[n]||u.attribs.defaultcolwidth||t.Constants.defaultColWidth,"blank"!=r&&"auto"!=r||(r=""),i+=r&&r-0>0?r-0:10),!(i>e.tablewidth));o++);d.colpanes[colpane].last=d.sheetobj.attribs.usermaxcol||o;for(var p=d.rowpanes[0].first,h=d.sheetobj.attribs.lastrow;"yes"==u.rowattribs.hide[p]&&p<h;)p++;for(d.rowpanes[0].first=p,a=d.showRCHeaders?1:0,l=0;l<d.rowpanes.length-1;l++)for(a+=d.rowpanes[l].last-d.rowpanes[l].first+1,s=d.rowpanes[l].first;s<=d.rowpanes[l].last;s++)"yes"==u.rowattribs.hide[s]&&a--;c=e.tableheight-a*d.pixelsPerRow,d.rowpanes[l].last=d.sheetobj.attribs.usermaxrow||d.rowpanes[l].first+Math.floor(c/d.pixelsPerRow)+1},t.CalculateEditorPositions=function(e){var o,n,r;e.gridposition=t.GetElementPosition(e.griddiv);var i=e.griddiv.firstChild.lastChild.childNodes[1].childNodes[0];for(e.headposition=t.GetElementPosition(i),e.headposition.left+=i.offsetWidth,e.headposition.top+=i.offsetHeight,e.rowpositions=[],o=0;o<e.context.rowpanes.length;o++)e.CalculateRowPositions(o,e.rowpositions,e.rowheight);for(r=0;r<e.rowpositions.length&&!(e.rowpositions[r]>e.gridposition.top+e.tableheight);r++);for(e.lastvisiblerow=r-1,e.colpositions=[],n=0;n<e.context.colpanes.length;n++)e.CalculateColPositions(n,e.colpositions,e.colwidth);for(r=0;r<e.colpositions.length&&!(e.colpositions[r]>e.gridposition.left+e.tablewidth);r++);for(e.lastvisiblecol=r-1,e.firstscrollingrow=e.context.rowpanes[e.context.rowpanes.length-1].first;"yes"==e.context.sheetobj.rowattribs.hide[e.firstscrollingrow];)e.firstscrollingrow++;for(e.firstscrollingrowtop=e.rowpositions[e.firstscrollingrow]||e.headposition.top,e.lastnonscrollingrow=e.context.rowpanes.length-1>0?e.context.rowpanes[e.context.rowpanes.length-2].last:0,e.firstscrollingcol=e.context.colpanes[e.context.colpanes.length-1].first;"yes"==e.context.sheetobj.colattribs.hide[t.rcColname(e.firstscrollingcol)];)e.firstscrollingcol++;e.firstscrollingcolleft=e.colpositions[e.firstscrollingcol]||e.headposition.left,e.lastnonscrollingcol=e.context.colpanes.length-1>0?e.context.colpanes[e.context.colpanes.length-2].last:0,e.verticaltablecontrol.ComputeTableControlPositions(),e.horizontaltablecontrol.ComputeTableControlPositions()},t.ScheduleRender=function(o){1!=o.ignoreRender&&(o.timeout&&e.clearTimeout(o.timeout),t.EditorSheetStatusCallback(null,"schedrender",null,o),o.timeout=e.setTimeout(function(){t.DoRenderStep(o)},1))},t.DoRenderStep=function(o){o.timeout=null,o.EditorRenderSheet(),t.EditorSheetStatusCallback(null,"renderdone",null,o),t.EditorSheetStatusCallback(null,"schedposcalc",null,o),o.timeout=e.setTimeout(function(){t.DoPositionCalculations(o)},1)},t.SchedulePositionCalculations=function(o){t.EditorSheetStatusCallback(null,"schedposcalc",null,o),o.timeout=e.setTimeout(function(){t.DoPositionCalculations(o)},1)},t.DoPositionCalculations=function(e){e.timeout=null,e.CalculateEditorPositions(),e.verticaltablecontrol.PositionTableControlElements(),e.horizontaltablecontrol.PositionTableControlElements(),t.EditorSheetStatusCallback(null,"doneposcalc",null,e),e.ensureecell&&e.ecell&&!e.deferredCommands.length&&(e.ensureecell=!1,e.EnsureECellVisible()),e.cellhandles.ShowCellHandles(!0)},t.CalculateRowPositions=function(e,t,o,n){var r,i,a,s,l,c,d=e.context;d.sheetobj;if(d.showRCHeaders){for(c=e.fullgrid.lastChild,r=2,i=0;i<t;i++)r+=d.rowpanes[i].last-d.rowpanes[i].first+2;for(s=0,a=d.rowpanes[i].first;a<=d.rowpanes[i].last;a++)l=c.childNodes[r+s],s++,l&&(o[a]||(o[a]=l.firstChild.offsetTop,n[a]=l.firstChild.offsetHeight))}},t.CalculateColPositions=function(e,o,n,r){var i,a,s,l,c,d,u,p=e.context;p.sheetobj;if(p.showRCHeaders){for(u=e.fullgrid.lastChild,i=1,a=0;a<o;a++)i+=p.colpanes[a].last-p.colpanes[a].first+2;for(c=u.childNodes[1],l=0,s=p.colpanes[a].first;s<=p.colpanes[a].last;s++)d=t.GetElementPosition(c.childNodes[i+l]),n[s]||(n[s]=d.left,c.childNodes[i+l]&&(r[s]=c.childNodes[i+l].offsetWidth)),l++}},t.ScrollRelative=function(e,t,o){t?e.ScrollRelativeBoth(o,0):e.ScrollRelativeBoth(0,o)},t.ScrollRelativeBoth=function(e,o,n){var r=e.context,i=o>0?1:-1,a=n>0?1:-1,s=r.rowpanes.length,l=s>1?r.rowpanes[s-2].last+1:1;r.rowpanes[s-1].first+o<l&&(o=-r.rowpanes[s-1].first+l);var c=r.colpanes.length,d=c>1?r.colpanes[c-2].last+1:1;for(r.colpanes[c-1].first+n<d&&(n=-r.colpanes[c-1].first+d);"yes"==r.sheetobj.colattribs.hide[t.rcColname(r.colpanes[c-1].first+n)];)if((n+=a)<1){n=0;break}for(;"yes"==r.sheetobj.rowattribs.hide[r.rowpanes[s-1].first+o];)if((o+=i)<1){o=0;break}if((1==o||-1==o)&&0==n)return 1==o?e.ScrollTableUpOneRow():e.ScrollTableDownOneRow(),e.ecell&&e.SetECellHeaders("selected"),void e.SchedulePositionCalculations();0==o&&0==n||(r.rowpanes[s-1].first+=o,r.rowpanes[s-1].last+=o,r.colpanes[c-1].first+=n,r.colpanes[c-1].last+=n,e.LimitLastPanes(),e.FitToEditTable(),e.ScheduleRender())},t.PageRelative=function(e,o,n){var r,i,a,s,l=e.context,c=o?"rowpanes":"colpanes",d=l[c][l[c].length-1],u=o?"lastvisiblerow":"lastvisiblecol",p=o?e.rowheight:e.colwidth,h=o?t.Constants.defaultAssumedRowHeight:t.Constants.defaultColWidth;if(n>0)(i=e[u])==d.first&&(i+=1);else{for(a=o?e.tableheight-(e.firstscrollingrowtop-e.gridposition.top):e.tablewidth-(e.firstscrollingcolleft-e.gridposition.left),a-=p[e[u]]>0?p[e[u]]:h,i=d.first-1;i>0&&(r=p[i]>0?p[i]:h,!(a<r));i--)a-=r;s=d.first,i>=s&&(i=s-1),i<1&&(i=1)}d.first=i,d.last=i+1,e.LimitLastPanes(),e.FitToEditTable(),e.ScheduleRender()},t.LimitLastPanes=function(e){var t,o=e.context;t=o.rowpanes.length,t>1&&o.rowpanes[t-1].first<=o.rowpanes[t-2].last&&(o.rowpanes[t-1].first=o.rowpanes[t-2].last+1),o.sheetobj.attribs.usermaxrow&&o.rowpanes[t-1].first>o.sheetobj.attribs.usermaxrow&&(o.rowpanes[t-1].first=o.sheetobj.attribs.usermaxrow),t=o.colpanes.length,t>1&&o.colpanes[t-1].first<=o.colpanes[t-2].last&&(o.colpanes[t-1].first=o.colpanes[t-2].last+1),o.sheetobj.attribs.usermaxcol&&o.colpanes[t-1].first>o.sheetobj.attribs.usermaxcol&&(o.colpanes[t-1].first=o.sheetobj.attribs.usermaxcol)},t.ScrollTableUpOneRow=function(e){var o,n,r,i,a,s,l,c,d,u,p,h,f={},m=e.context,g=m.sheetobj,v=e.fullgrid;for(h=v.lastChild,o=m.showRCHeaders?2:1,n=0;n<m.rowpanes.length-1;n++)o+=m.rowpanes[n].last-m.rowpanes[n].first+2;if(m.sheetobj.attribs.usermaxrow&&m.sheetobj.attribs.usermaxrow-m.rowpanes[n].first<1)return v;for(h.removeChild(h.childNodes[o]),m.rowpanes[n].first++,m.rowpanes[n].last++,e.FitToEditTable(),m.CalculateColWidthData(),m.sheetobj.attribs.usermaxrow&&m.rowpanes[n].last==m.sheetobj.attribs.usermaxrow||(c=m.RenderRow(m.rowpanes[n].last,n),h.appendChild(c)),maxrowspan=1,l=m.rowpanes[n].first-1,a=0;a<m.colpanes.length;a++)for(i=m.colpanes[a].first;i<=m.colpanes[a].last;i++)coord=t.crToCoord(i,l),m.cellskip[coord]||(s=g.cells[coord])&&s.rowspan>maxrowspan&&(maxrowspan=s.rowspan);if(maxrowspan>1)for(r=1;r<maxrowspan&&!(r+l>=m.rowpanes[n].last);r++)d=m.RenderRow(r+l,n),u=h.childNodes[o+r-1],h.replaceChild(d,u);for(p=m.rowpanes[n].last,a=0;a<m.colpanes.length;a++)for(i=m.colpanes[a].first;i<=m.colpanes[a].last;i++)coord=m.cellskip[t.crToCoord(i,p)],coord&&((r=m.coordToCR[coord].row-0)==m.rowpanes[n].last||r<m.rowpanes[n].first||(s=g.cells[coord])&&s.rowspan>1&&(f[r]=!0));for(r in f)d=m.RenderRow(r,n),u=h.childNodes[o+(r-m.rowpanes[n].first)],h.replaceChild(d,u);return v},t.ScrollTableDownOneRow=function(e){var o,n,r,i,a,s,l,c,d,u,p,h={},f=e.context,m=f.sheetobj,g=e.fullgrid;for(p=g.lastChild,o=f.showRCHeaders?2:1,n=0;n<f.rowpanes.length-1;n++)o+=f.rowpanes[n].last-f.rowpanes[n].first+2;for(f.sheetobj.attribs.usermaxrow||p.removeChild(p.childNodes[o+(f.rowpanes[n].last-f.rowpanes[n].first)]),f.rowpanes[n].first--,f.rowpanes[n].last--,e.FitToEditTable(),f.CalculateColWidthData(),c=f.RenderRow(f.rowpanes[n].first,n),p.insertBefore(c,p.childNodes[o]),maxrowspan=1,l=f.rowpanes[n].first,a=0;a<f.colpanes.length;a++)for(i=f.colpanes[a].first;i<=f.colpanes[a].last;i++)coord=t.crToCoord(i,l),f.cellskip[coord]||(s=m.cells[coord])&&s.rowspan>maxrowspan&&(maxrowspan=s.rowspan);if(maxrowspan>1)for(r=1;r<maxrowspan&&!(r+l>f.rowpanes[n].last);r++)c=f.RenderRow(r+l,n),d=p.childNodes[o+r],p.replaceChild(c,d);for(u=f.rowpanes[n].last,a=0;a<f.colpanes.length;a++)for(i=f.colpanes[a].first;i<=f.colpanes[a].last;i++)coord=t.crToCoord(i,u),s=m.cells[coord],s&&s.rowspan>1?h[u]=!0:(coord=f.cellskip[t.crToCoord(i,u)],coord&&((r=f.coordToCR[coord].row-0)==u||r<f.rowpanes[n].first||(s=m.cells[coord])&&s.rowspan>1&&(h[r]=!0)));for(r in h)c=f.RenderRow(r,n),d=p.childNodes[o+(r-f.rowpanes[n].first)],p.replaceChild(c,d);return g},t.InputBox=function(e,o){e&&(this.element=e,this.editor=o,this.inputEcho=null,o.inputBox=this,e.onmousedown=t.InputBoxOnMouseDown,o.MoveECellCallback.formulabar=function(e){"start"==e.state&&o.inputBox.DisplayCellContents(e.ecell.coord)})},t.InputBox.prototype.DisplayCellContents=function(e){t.InputBoxDisplayCellContents(this,e)},t.InputBox.prototype.ShowInputBox=function(e){this.editor.inputEcho.ShowInputEcho(e)},t.InputBox.prototype.GetText=function(){return this.element.value},t.InputBox.prototype.SetText=function(e){this.element&&(this.element.value=e,this.editor.inputEcho.SetText(e+"_"))},t.InputBox.prototype.Focus=function(){t.InputBoxFocus(this)},t.InputBox.prototype.Blur=function(){return this.element.blur()},t.InputBox.prototype.Select=function(e){if(this.element)switch(e){case"end":if(document.selection&&document.selection.createRange)try{var t=document.selection.createRange().duplicate();t.moveToElementText(this.element),t.collapse(!1),t.select()}catch(e){this.element.selectionStart!=undefined&&(this.element.selectionStart=this.element.value.length,this.element.selectionEnd=this.element.value.length)}else this.element.selectionStart!=undefined&&(this.element.selectionStart=this.element.value.length,this.element.selectionEnd=this.element.value.length)}},t.InputBoxDisplayCellContents=function(e,o){var n=t.Constants;if(e){if(!o){if(!e.editor)return;if(!e.editor.ecell)return;o=e.editor.ecell.coord}var r=t.GetCellContents(e.editor.context.sheetobj,o);-1!=r.indexOf("\n")?(r=n.s_inputboxdisplaymultilinetext,e.element.disabled=!0):e.editor.ECellReadonly()?e.element.disabled=!0:e.element.disabled=!1,e.SetText(r)}},t.InputBoxFocus=function(e){if(e){e.element.focus();var t=e.editor;t.state="input";var o=t.workingvalues;o.partialexpr="",o.ecoord=t.ecell.coord,o.erow=t.ecell.row,o.ecol=t.ecell.col}},t.InputBoxOnMouseDown=function(){var e=t.Keyboard.focusTable;if(!e)return!0;var o=e.workingvalues;switch(e.state){case"start":e.state="inputboxdirect",o.partialexpr="",o.ecoord=e.ecell.coord,o.erow=e.ecell.row,o.ecol=e.ecell.col,e.inputEcho.ShowInputEcho(!0);break;case"input":o.partialexpr="",e.MoveECell(o.ecoord),e.state="inputboxdirect",t.KeyboardFocus()}},t.InputEcho=function(e){var o=t.Constants;this.editor=e,this.text="",this.interval=null,this.container=null,this.main=null,this.prompt=null,this.hint=null,this.functionbox=null,this.container=document.createElement("div"),t.setStyles(this.container,"display:none;position:absolute;zIndex:10;"),this.main=document.createElement("div"),o.defaultInputEchoClass&&(this.main.className=o.defaultInputEchoClass),o.defaultInputEchoStyle&&t.setStyles(this.main,o.defaultInputEchoStyle),this.main.innerHTML="&nbsp;",this.hint=document.createElement("div"),o.defaultInputEchoHintClass&&(this.hint.className=o.defaultInputEchoHintClass),o.defaultInputEchoHintStyle&&t.setStyles(this.hint,o.defaultInputEchoHintStyle),this.hint.innerHTML="",this.container.appendChild(this.hint),this.container.appendChild(this.main),this.prompt=document.createElement("div"),o.defaultInputEchoPromptClass&&(this.prompt.className=o.defaultInputEchoPromptClass),o.defaultInputEchoPromptStyle&&t.setStyles(this.prompt,o.defaultInputEchoPromptStyle),this.prompt.innerHTML="",this.container.appendChild(this.prompt),t.DragRegister(this.main,!0,!0,{MouseDown:t.DragFunctionStart,MouseMove:t.DragFunctionPosition,MouseUp:t.DragFunctionPosition,Disabled:null,positionobj:this.container},this.editor.toplevel),e.toplevel.appendChild(this.container)},t.InputEcho.prototype.ShowInputEcho=function(e){return t.ShowInputEcho(this,e)},t.InputEcho.prototype.SetText=function(e){return t.SetInputEchoText(this,e)},t.ShowInputEcho=function(o,n){var r,i,a=o.editor;a&&(n?(a.cellhandles.ShowCellHandles(!1),r=t.GetEditorCellElement(a,a.ecell.row,a.ecell.col),r&&(i=t.GetElementPosition(r.element),o.container.style.left=i.left-1+"px",o.container.style.top=i.top-1+"px"),o.hint.innerHTML=a.ecell.coord,o.container.style.display="block",o.interval&&e.clearInterval(o.interval),o.interval=e.setInterval(t.InputEchoHeartbeat,50)):(o.interval&&e.clearInterval(o.interval),o.container.style.display="none"))},t.SetInputEchoText=function(e,o){var n,r,i=t.Constants,a=t.special_chars(o);a=a.replace(/\n/g,"<br>"),e.text!=a&&(e.main.innerHTML=a,e.text=a);var s=o.match(/.*[\+\-\*\/\&\^\<\>\=\,\(]([A-Za-z][A-Za-z][\w\.]*?)\([^\)]*$/);"="==o.charAt(0)&&s?(n=s[1].toUpperCase(),t.Formula.FunctionList[n]?(t.Formula.FillFunctionInfo(),r=t.special_chars(n+"("+t.Formula.FunctionArgString(n)+")")):r=i.ietUnknownFunction+n,e.prompt.innerHTML!=r&&(e.prompt.innerHTML=r,e.prompt.style.display="block")):"none"!=e.prompt.style.display&&(e.prompt.innerHTML="",e.prompt.style.display="none")},t.InputEchoHeartbeat=function(){var e=t.Keyboard.focusTable;if(!e)return!0;e.inputEcho.SetText(e.inputBox.GetText()+"_")},t.InputEchoMouseDown=function(o){var n=(o||e.event,t.Keyboard.focusTable);if(!n)return!0;n.inputBox.element.focus()},t.CellHandles=function(e){t.Constants;if(!e.noEdit){this.editor=e,this.noCursorSuffix=!1,this.movedmouse=!1,this.draghandle=document.createElement("div"),t.setStyles(this.draghandle,"display:none;position:absolute;zIndex:8;border:1px solid white;width:4px;height:4px;fontSize:1px;backgroundColor:#0E93D8;cursor:default;"),this.draghandle.innerHTML="&nbsp;",e.toplevel.appendChild(this.draghandle),t.AssignID(e,this.draghandle,"draghandle");var o="png";if(navigator.userAgent.match(/MSIE 6\.0/)&&(o="gif"),this.dragpalette=document.createElement("div"),t.setStyles(this.dragpalette,"display:none;position:absolute;zIndex:8;width:90px;height:90px;fontSize:1px;textAlign:center;cursor:default;backgroundImage:url("+t.Constants.defaultImagePrefix+"drag-handles."+o+");"),this.dragpalette.innerHTML="&nbsp;",e.toplevel.appendChild(this.dragpalette),t.AssignID(e,this.dragpalette,"dragpalette"),this.dragtooltip=document.createElement("div"),t.setStyles(this.dragtooltip,"display:none;position:absolute;zIndex:9;border:1px solid black;width:100px;height:auto;fontSize:10px;backgroundColor:#FFFFFF;"),this.dragtooltip.innerHTML="&nbsp;",e.toplevel.appendChild(this.dragtooltip),t.AssignID(e,this.dragtooltip,"dragtooltip"),this.fillinghandle=document.createElement("div"),t.setStyles(this.fillinghandle,"display:none;position:absolute;zIndex:9;border:1px solid black;width:auto;height:14px;fontSize:10px;backgroundColor:#FFFFFF;"),this.fillinghandle.innerHTML="&nbsp;",e.toplevel.appendChild(this.fillinghandle),t.AssignID(e,this.fillinghandle,"fillinghandle"),this.draghandle.addEventListener)this.draghandle.addEventListener("mousemove",t.CellHandlesMouseMoveOnHandle,!1),this.dragpalette.addEventListener("mousedown",t.CellHandlesMouseDown,!1),this.dragpalette.addEventListener("mousemove",t.CellHandlesMouseMoveOnHandle,!1);else{if(!this.draghandle.attachEvent)throw"Browser not supported";this.draghandle.attachEvent("onmousemove",t.CellHandlesMouseMoveOnHandle),this.dragpalette.attachEvent("onmousedown",t.CellHandlesMouseDown),this.dragpalette.attachEvent("onmousemove",t.CellHandlesMouseMoveOnHandle)}}},t.CellHandles.prototype.ShowCellHandles=function(e,o){return t.ShowCellHandles(this,e,o)},t.ShowCellHandles=function(e,o,n){var r,i,a,s=e.editor,l=!1,c=1,d=1;if(s&&s.ecell){do{if(!o)break;if(i=s.ecell.row,a=s.ecell.col,"start"!=s.state)break;if(i>=s.lastvisiblerow)break;if(a>=s.lastvisiblecol)break;if(i<s.firstscrollingrow)break;if(a<s.firstscrollingcol)break;for(;"yes"==s.context.sheetobj.colattribs.hide[t.rcColname(a+c)];)c++;for(;"yes"==s.context.sheetobj.rowattribs.hide[i+d];)d++;if(r=s.context.sheetobj.cells[t.crToCoord(a+c-1,i+d-1)],void 0!==r&&(c+=(r.colspan||1)-1,d+=(r.rowspan||1)-1),s.rowpositions[i+d]+20>s.horizontaltablecontrol.controlborder)break;if(s.rowpositions[i+d]-10<s.headposition.top)break;if(s.colpositions[a+c]+20>s.verticaltablecontrol.controlborder)break;if(s.colpositions[a+c]-30<s.headposition.left)break;e.draghandle.style.left=s.colpositions[a+c]-1+"px",e.draghandle.style.top=s.rowpositions[i+d]-1+"px",e.draghandle.style.display="block",n&&(e.draghandle.style.display="none",e.dragpalette.style.left=s.colpositions[a+c]-45+"px",e.dragpalette.style.top=s.rowpositions[i+d]-45+"px",e.dragpalette.style.display="block",e.dragtooltip.style.left=s.colpositions[a+c]-45+"px",e.dragtooltip.style.top=s.rowpositions[i+d]+45+"px",e.dragtooltip.style.display="none"),l=!0}while(!1);l||(e.draghandle.style.display="none"),n||(e.dragpalette.style.display="none",e.dragtooltip.style.display="none")}},t.CellHandlesMouseMoveOnHandle=function(o){var n=t.Constants,r=o||e.event,i=r.target||r.srcElement,a=t.Keyboard.focusTable;if(!a)return!0;var s=a.cellhandles;if(!s.editor)return!0;var l=t.GetElementPositionWithScroll(a.toplevel),c=r.clientX-l.left,d=r.clientY-l.top;if(!a.cellhandles.mouseDown){if(a.cellhandles.ShowCellHandles(!0,!0),i==s.dragpalette){var u=t.SegmentDivHit([n.CH_radius1,n.CH_radius2],a.cellhandles.dragpalette,c,d);if(0==u)return void t.CellHandlesHoverTimeout();s.tooltipstimer&&(e.clearTimeout(s.tooltipstimer),s.tooltipstimer=null),s.tooltipswhichhandle=u,s.tooltipstimer=e.setTimeout(t.CellHandlesTooltipsTimeout,700)}s.timer&&(e.clearTimeout(s.timer),s.timer=null),s.timer=e.setTimeout(t.CellHandlesHoverTimeout,3e3)}},t.SegmentDivHit=function(e,t,o,n){var r=t.offsetWidth,i=t.offsetHeight,a=t.offsetLeft,s=t.offsetTop,l=0,c=e,d=Math.sqrt(Math.pow(o-a-(r/2-.5),2)+Math.pow(n-s-(i/2-.5),2));if(2==c.length)return o>=a&&o<a+r/2&&n>=s&&n<s+i/2&&(d<=e[0]?l=-1:d<=e[1]&&(l=1)),o>=a+r/2&&o<a+r&&n>=s&&n<s+i/2&&(d<=e[0]?l=-2:d<=e[1]&&(l=2)),o>=a+r/2&&o<a+r&&n>=s+i/2&&n<s+i&&(d<=e[0]?l=-3:d<=e[1]&&(l=3)),o>=a&&o<a+r/2&&n>=s+i/2&&n<s+i&&(d<=e[0]?l=-4:d<=e[1]&&(l=4)),l;for(;;)if(o>=a&&o<a+r/2&&n>=s&&n<s+i/2){if(quadrant+="1","number"==typeof(l=c[0]))break;c=l,r/=2,i/=2}else if(o>=a+r/2&&o<a+r&&n>=s&&n<s+i/2){if(quadrant+="2","number"==typeof(l=c[1]))break;c=l,r/=2,a+=r,i/=2}else if(o>=a+r/2&&o<a+r&&n>=s+i/2&&n<s+i){if(quadrant+="3","number"==typeof(l=c[2]))break;c=l,r/=2,a+=r,i/=2,s+=i}else{if(!(o>=a&&o<a+r/2&&n>=s+i/2&&n<s+i))return 0;if(quadrant+="4","number"==typeof(l=c[3]))break;c=l,r/=2,i/=2,s+=i}return l},t.CellHandlesHoverTimeout=function(){if(editor=t.Keyboard.focusTable,!editor)return!0;var o=editor.cellhandles;o.timer&&(e.clearTimeout(o.timer),o.timer=null),o.tooltipstimer&&(e.clearTimeout(o.tooltipstimer),o.tooltipstimer=null),editor.cellhandles.ShowCellHandles(!0,!1)},t.CellHandlesTooltipsTimeout=function(){if(editor=t.Keyboard.focusTable,!editor)return!0;var o=editor.cellhandles;o.tooltipstimer&&(e.clearTimeout(o.tooltipstimer),o.tooltipstimer=null);var n=o.tooltipswhichhandle;if(0==n)return void t.CellHandlesHoverTimeout();if(-3==n)o.dragtooltip.innerHTML=scc.s_CHfillAllTooltip;else if(3==n)o.dragtooltip.innerHTML=scc.s_CHfillContentsTooltip;else if(-2==n)o.dragtooltip.innerHTML=scc.s_CHmovePasteAllTooltip;else if(-4==n)o.dragtooltip.innerHTML=scc.s_CHmoveInsertAllTooltip;else if(2==n)o.dragtooltip.innerHTML=scc.s_CHmovePasteContentsTooltip;else{if(4!=n)return o.dragtooltip.innerHTML="&nbsp;",void(o.dragtooltip.style.display="none");o.dragtooltip.innerHTML=scc.s_CHmoveInsertContentsTooltip}o.dragtooltip.style.display="block"},t.CellHandlesMouseDown=function(o){var n,r,i,a=t.Constants,s=o||e.event,l=t.EditorMouseInfo;if(!(n=t.Keyboard.focusTable))return!0;if(!n.busy){var c=n.cellhandles;c.movedmouse=!1;var d=t.GetElementPositionWithScroll(n.toplevel),u=s.clientX-d.left,p=s.clientY-d.top;c.timer&&(e.clearTimeout(c.timer),c.timer=null),c.tooltipstimer&&(e.clearTimeout(c.tooltipstimer),c.tooltipstimer=null),c.dragtooltip.innerHTML="&nbsp;",c.dragtooltip.style.display="none",i=n.range;var h=t.SegmentDivHit([a.CH_radius1,a.CH_radius2],n.cellhandles.dragpalette,u,p);if(1==h||-1==h||0==h)return void c.ShowCellHandles(!0,!1);switch(l.ignore=!0,-3==h?(c.dragtype="Fill",c.noCursorSuffix=!1):3==h?(c.dragtype="FillC",c.noCursorSuffix=!1):-2==h?(c.dragtype="Move",c.noCursorSuffix=!0):-4==h?(c.dragtype="MoveI",c.noCursorSuffix=!1):2==h?(c.dragtype="MoveC",c.noCursorSuffix=!0):4==h&&(c.dragtype="MoveIC",c.noCursorSuffix=!1),c.filltype=null,c.dragtype){case"Fill":case"FillC":i.hasrange||n.RangeAnchor(),n.range2.top=n.range.top,n.range2.right=n.range.right,n.range2.bottom=n.range.bottom,n.range2.left=n.range.left,n.range2.hasrange=!0;break;case"Move":case"MoveI":case"MoveC":case"MoveIC":i.hasrange||n.RangeAnchor(),n.range2.top=n.range.top,n.range2.right=n.range.right,n.range2.bottom=n.range.bottom,n.range2.left=n.range.left,n.range2.hasrange=!0,n.RangeRemove();break;default:return}c.fillinghandle.style.left=u+"px",c.fillinghandle.style.top=p-17+"px",c.fillinghandle.innerHTML=a.s_CHindicatorOperationLookup[c.dragtype]+(a.s_CHindicatorDirectionLookup[n.cellhandles.filltype]||""),c.fillinghandle.style.display="block",c.ShowCellHandles(!0,!1),c.mouseDown=!0,l.editor=n,r=n.ecell.coord,c.startingcoord=r,c.startingX=u,c.startingY=p,l.mouselastcoord=r,t.KeyboardSetFocus(n),document.addEventListener?(document.addEventListener("mousemove",t.CellHandlesMouseMove,!0),document.addEventListener("mouseup",t.CellHandlesMouseUp,!0)):c.draghandle.attachEvent&&(c.draghandle.setCapture(),c.draghandle.attachEvent("onmousemove",t.CellHandlesMouseMove),c.draghandle.attachEvent("onmouseup",t.CellHandlesMouseUp),c.draghandle.attachEvent("onlosecapture",t.CellHandlesMouseUp)),t.StopPropagation(s)}},t.CellHandlesMouseMove=function(o){var n,r,i,a,s,l,c=t.Constants,d=o||e.event,u=t.EditorMouseInfo;if(n=u.editor){var p=n.cellhandles;u.element;var h=t.GetElementPositionWithScroll(n.toplevel),f=d.clientX-h.left,m=d.clientY-h.top;if(r=t.GridMousePosition(n,f,m)){if(r&&!r.coord)return void t.SetDragAutoRepeat(n,r,t.CellHandlesDragAutoRepeat);if(t.SetDragAutoRepeat(n,null),r.coord){switch(i=t.coordToCr(n.cellhandles.startingcoord),a=t.coordToCr(r.coord),p.movedmouse=!0,p.dragtype){case"Fill":case"FillC":r.coord==p.startingcoord?(p.filltype=null,p.startingX=f,p.startingY=m):p.filltype?"Down"==p.filltype?(a.col=i.col,a.row<i.row&&(a.row=i.row)):(a.row=i.row,a.col<i.col&&(a.col=i.col)):(Math.abs(m-p.startingY)>10?p.filltype="Down":Math.abs(f-p.startingX)>10&&(p.filltype="Right"),a.col=i.col,a.row=i.row),r.coord=t.crToCoord(a.col,a.row),r.coord!=u.mouselastcoord&&(n.MoveECell(r.coord),n.RangeExtend());break;case"Move":case"MoveC":r.coord!=u.mouselastcoord&&(n.MoveECell(r.coord),s=n.range2.right-n.range2.left+r.col,l=n.range2.bottom-n.range2.top+r.row,n.RangeAnchor(t.crToCoord(s,l)),n.RangeExtend());break;case"MoveI":case"MoveIC":r.coord==p.startingcoord?(p.filltype=null,p.startingX=f,p.startingY=m):p.filltype?"Vertical"==p.filltype?(a.col=n.range2.left,a.row>=n.range2.top&&a.row<=n.range2.bottom+1&&(a.row=n.range2.bottom+2)):(a.row=n.range2.top,a.col>=n.range2.left&&a.col<=n.range2.right+1&&(a.col=n.range2.right+2)):(Math.abs(m-p.startingY)>10?p.filltype="Vertical":Math.abs(f-p.startingX)>10&&(p.filltype="Horizontal"),a.col=i.col,a.row=i.row),r.coord=t.crToCoord(a.col,a.row),r.coord!=u.mouselastcoord&&(n.MoveECell(r.coord),p.filltype?(s=n.range2.right-n.range2.left+a.col,l=n.range2.bottom-n.range2.top+a.row,n.RangeAnchor(t.crToCoord(s,l)),n.RangeExtend()):n.RangeRemove())}p.fillinghandle.style.left=f+"px",p.fillinghandle.style.top=m-17+"px",p.fillinghandle.innerHTML=c.s_CHindicatorOperationLookup[p.dragtype]+(c.s_CHindicatorDirectionLookup[n.cellhandles.filltype]||""),p.fillinghandle.style.display="block",u.mouselastcoord=r.coord,t.StopPropagation(d)}}}},t.CellHandlesDragAutoRepeat=function(e,o){var n=t.EditorMouseInfo,r=n.editor;if(r){var i,a,s,l=r.cellhandles,c=t.coordToCr(r.cellhandles.startingcoord),d=t.coordToCr(e),u=0,p=0;switch("left"==o?p=-1:"right"==o?p=1:"up"==o?u=-1:"down"==o&&(u=1),r.ScrollRelativeBoth(u,p),l.dragtype){case"Fill":case"FillC":l.filltype?"Down"==l.filltype?(d.col=c.col,d.row<c.row&&(d.row=c.row)):(d.row=c.row,d.col<c.col&&(d.col=c.col)):(d.col=c.col,d.row=c.row),i=t.crToCoord(d.col,d.row),i!=n.mouselastcoord&&(r.MoveECell(e),r.RangeExtend());break;case"Move":case"MoveC":e!=n.mouselastcoord&&(r.MoveECell(e),a=r.range2.right-r.range2.left+r.ecell.col,s=r.range2.bottom-r.range2.top+r.ecell.row,r.RangeAnchor(t.crToCoord(a,s)),r.RangeExtend());break;case"MoveI":case"MoveIC":l.filltype?"Vertical"==l.filltype?(d.col=r.range2.left,d.row>=r.range2.top&&d.row<=r.range2.bottom+1&&(d.row=r.range2.bottom+2)):(d.row=r.range2.top,d.col>=r.range2.left&&d.col<=r.range2.right+1&&(d.col=r.range2.right+2)):(d.col=c.col,d.row=c.row),i=t.crToCoord(d.col,d.row),i!=n.mouselastcoord&&(r.MoveECell(i),a=r.range2.right-r.range2.left+d.col,s=r.range2.bottom-r.range2.top+d.row,r.RangeAnchor(t.crToCoord(a,s)),r.RangeExtend())}n.mouselastcoord=i}},t.CellHandlesMouseUp=function(o){var n,r,i,a,s,l,c,d,u,p,h,f=o||e.event,m=t.EditorMouseInfo;if(n=m.editor){var g=n.cellhandles;m.element,m.ignore=!1;var v=t.GetElementPositionWithScroll(n.toplevel),y=f.clientX-v.left,b=f.clientY-v.top;switch(r=t.GridMousePosition(n,y,b),t.SetDragAutoRepeat(n,null),g.mouseDown=!1,g.noCursorSuffix=!1,g.fillinghandle.style.display="none",r||(r={}),r.coord||(r.coord=n.ecell.coord),g.dragtype){case"Fill":case"Move":case"MoveI":s=" all";break;case"FillC":case"MoveC":case"MoveIC":s=" formulas"}switch(g.movedmouse||(g.dragtype="Nothing"),g.dragtype){case"Nothing":n.Range2Remove(),n.RangeRemove();break;case"Fill":case"FillC":l=t.coordToCr(g.startingcoord),c=t.coordToCr(r.coord),g.filltype&&("Down"==g.filltype?c.col=l.col:c.row=l.row),r.coord=t.crToCoord(c.col,c.row),n.MoveECell(r.coord),n.RangeExtend(),a="Right"==n.cellhandles.filltype?"right":"down",i="fill"+a+" "+t.crToCoord(n.range.left,n.range.top)+":"+t.crToCoord(n.range.right,n.range.bottom)+s,n.EditorScheduleSheetCommands(i,!0,!1);break;case"Move":case"MoveC":n.context.cursorsuffix="",i="movepaste "+t.crToCoord(n.range2.left,n.range2.top)+":"+t.crToCoord(n.range2.right,n.range2.bottom)+" "+n.ecell.coord+s,n.EditorScheduleSheetCommands(i,!0,!1),n.Range2Remove();break;case"MoveI":case"MoveIC":n.context.cursorsuffix="",d=n.range2.right-n.range2.left,u=n.range2.bottom-n.range2.top,p=n.ecell.col-n.range2.left,h=n.ecell.row-n.range2.top,i="moveinsert "+t.crToCoord(n.range2.left,n.range2.top)+":"+t.crToCoord(n.range2.right,n.range2.bottom)+" "+n.ecell.coord+s,n.EditorScheduleSheetCommands(i,!0,!1),n.Range2Remove(),n.RangeRemove()," Horizontal"==n.cellhandles.filltype&&p>0?n.MoveECell(t.crToCoord(n.ecell.col-d-1,n.ecell.row)):" Vertical"==n.cellhandles.filltype&&h>0&&n.MoveECell(t.crToCoord(n.ecell.col,n.ecell.row-u-1)),n.RangeAnchor(t.crToCoord(n.ecell.col+d,n.ecell.row+u)),n.RangeExtend()}return t.RemoveMouseMoveUp(t.CellHandlesMouseMove,t.CellHandlesMouseUp,g.draghandle,f),m.editor=null,!1}},t.TableControl=function(e,o,n){var r=t.Constants;this.editor=e,this.vertical=o,this.size=n,this.main=null,this.endcap=null,this.paneslider=null,this.lessbutton=null,this.morebutton=null,this.scrollarea=null,this.thumb=null,this.controlborder=null,this.endcapstart=null,this.panesliderstart=null,this.lessbuttonstart=null,this.morebuttonstart=null,this.scrollareastart=null,this.scrollareaend=null,this.scrollareasize=null,this.thumbpos=null,this.controlthickness=r.defaultTableControlThickness,this.sliderthickness=r.defaultTCSliderThickness,this.buttonthickness=r.defaultTCButtonThickness,this.thumbthickness=r.defaultTCThumbThickness,this.minscrollingpanesize=this.buttonthickness+this.buttonthickness+this.thumbthickness+20},t.TableControl.prototype.CreateTableControl=function(){return t.CreateTableControl(this)},t.TableControl.prototype.PositionTableControlElements=function(){t.PositionTableControlElements(this)},t.TableControl.prototype.ComputeTableControlPositions=function(){t.ComputeTableControlPositions(this)},t.CreateTableControl=function(e){var o,n,r,i=t.AssignID,a=t.setStyles,s=t.Constants,l=function(o,n,r){s["s_"+n+"Tooltip"+r]&&t.TooltipRegister(o,s["s_"+n+"Tooltip"+r],null,e.editor.toplevel)},c=e.editor.imageprefix,d=e.vertical?"v":"h";return e.main=document.createElement("div"),o=e.main.style,o.height=(e.vertical?e.size:e.controlthickness)+"px",o.width=(e.vertical?e.controlthickness:e.size)+"px",o.zIndex=0,a(e.main,s.TCmainStyle),o.backgroundImage="url("+c+"main-"+d+".gif)",s.TCmainClass&&(e.main.className=s.TCmainClass),e.main.style.display="none",e.endcap=document.createElement("div"),o=e.endcap.style,o.height=e.controlthickness+"px",o.width=e.controlthickness+"px",o.zIndex=1,o.overflow="hidden",o.position="absolute",a(e.endcap,s.TCendcapStyle),o.backgroundImage="url("+c+"endcap-"+d+".gif)",s.TCendcapClass&&(e.endcap.className=s.TCendcapClass),i(e.editor,e.endcap,"endcap"+d),e.main.appendChild(e.endcap),e.paneslider=document.createElement("div"),o=e.paneslider.style,o.height=(e.vertical?e.sliderthickness:e.controlthickness)+"px",o.overflow="hidden",o.width=(e.vertical?e.controlthickness:e.sliderthickness)+"px",o.position="absolute",o[e.vertical?"top":"left"]="4px",o.zIndex=3,o.backgroundImage="url("+c+"paneslider-"+d+".gif)",s.TCpanesliderClass&&(e.paneslider.className=s.TCpanesliderClass),i(e.editor,e.paneslider,"paneslider"+d),l(e.paneslider,"paneslider",d),n={MouseDown:t.TCPSDragFunctionStart,MouseMove:t.TCPSDragFunctionMove,MouseUp:t.TCPSDragFunctionStop,Disabled:function(){return e.editor.busy}},n.control=e,1!=t._app&&t.DragRegister(e.paneslider,e.vertical,!e.vertical,n,e.editor.toplevel),e.main.appendChild(e.paneslider),e.lessbutton=document.createElement("div"),o=e.lessbutton.style,o.height=(e.vertical?e.buttonthickness:e.controlthickness)+"px",o.width=(e.vertical?e.controlthickness:e.buttonthickness)+"px",o.zIndex=2,o.overflow="hidden",o.position="absolute",a(e.lessbutton,s.TClessbuttonStyle),o.backgroundImage="url("+c+"less-"+d+"n.gif)",s.TClessbuttonClass&&(e.lessbutton.className=s.TClessbuttonClass),i(e.editor,e.lessbutton,"lessbutton"+d),r={repeatwait:s.TClessbuttonRepeatWait,repeatinterval:s.TClessbuttonRepeatInterval,normalstyle:"backgroundImage:url("+c+"less-"+d+"n.gif);",downstyle:"backgroundImage:url("+c+"less-"+d+"d.gif);",hoverstyle:"backgroundImage:url("+c+"less-"+d+"h.gif);"},n={MouseDown:function(){e.editor.busy||e.editor.ScrollRelative(e.vertical,-1)},Repeat:function(){e.editor.busy||e.editor.ScrollRelative(e.vertical,-1)},Disabled:function(){return e.editor.busy}},t.ButtonRegister(e.editor,e.lessbutton,r,n),e.main.appendChild(e.lessbutton),e.morebutton=document.createElement("div"),o=e.morebutton.style,o.height=(e.vertical?e.buttonthickness:e.controlthickness)+"px",o.width=(e.vertical?e.controlthickness:e.buttonthickness)+"px",o.zIndex=2,o.overflow="hidden",o.position="absolute",a(e.morebutton,s.TCmorebuttonStyle),o.backgroundImage="url("+c+"more-"+d+"n.gif)",s.TCmorebuttonClass&&(e.morebutton.className=s.TCmorebuttonClass),i(e.editor,e.morebutton,"morebutton"+d),r={repeatwait:s.TCmorebuttonRepeatWait,repeatinterval:s.TCmorebuttonRepeatInterval,normalstyle:"backgroundImage:url("+c+"more-"+d+"n.gif);",downstyle:"backgroundImage:url("+c+"more-"+d+"d.gif);",hoverstyle:"backgroundImage:url("+c+"more-"+d+"h.gif);"},n={MouseDown:function(){e.editor.busy||e.editor.ScrollRelative(e.vertical,1)},Repeat:function(){e.editor.busy||e.editor.ScrollRelative(e.vertical,1)},Disabled:function(){return e.editor.busy}},t.ButtonRegister(e.editor,e.morebutton,r,n),e.main.appendChild(e.morebutton),e.scrollarea=document.createElement("div"),o=e.scrollarea.style,o.height=e.controlthickness+"px",o.width=e.controlthickness+"px",o.zIndex=1,o.overflow="hidden",o.position="absolute",a(e.scrollarea,s.TCscrollareaStyle),o.backgroundImage="url("+c+"scrollarea-"+d+".gif)",s.TCscrollareaClass&&(e.scrollarea.className=s.TCscrollareaClass),i(e.editor,e.scrollarea,"scrollarea"+d),r={repeatwait:s.TCscrollareaRepeatWait,repeatinterval:s.TCscrollareaRepeatWait},n={MouseDown:t.ScrollAreaClick,Repeat:t.ScrollAreaClick,Disabled:function(){return e.editor.busy}},n.control=e,t.ButtonRegister(e.editor,e.scrollarea,r,n),e.main.appendChild(e.scrollarea),e.thumb=document.createElement("div"),o=e.thumb.style,o.height=(e.vertical?e.thumbthickness:e.controlthickness)+"px",o.width=(e.vertical?e.controlthickness:e.thumbthickness)+"px",o.zIndex=2,o.overflow="hidden",o.position="absolute",a(e.thumb,s.TCthumbStyle),e.thumb.style.backgroundImage="url("+c+"thumb-"+d+"n.gif)",
s.TCthumbClass&&(e.thumb.className=s.TCthumbClass),i(e.editor,e.thumb,"thumb"+d),n={MouseDown:t.TCTDragFunctionStart,MouseMove:t.TCTDragFunctionMove,MouseUp:t.TCTDragFunctionStop,Disabled:function(){return e.editor.busy}},n.control=e,1!=t._app&&t.DragRegister(e.thumb,e.vertical,!e.vertical,n,e.editor.toplevel),r={normalstyle:"backgroundImage:url("+c+"thumb-"+d+"n.gif)",name:"Thumb",downstyle:"backgroundImage:url("+c+"thumb-"+d+"d.gif)",hoverstyle:"backgroundImage:url("+c+"thumb-"+d+"h.gif)"},t.ButtonRegister(e.editor,e.thumb,r,null),e.main.appendChild(e.thumb),e.main},t.ScrollAreaClick=function(e,o,n){var r=n.functionobj.control,i=t.GetElementPositionWithScroll(r.editor.toplevel),a=r.vertical?o.clientY-i.top:o.clientX-i.left;r.editor.busy||r.editor.PageRelative(r.vertical,a>r.thumbpos?1:-1)},t.PositionTableControlElements=function(e){var t,o,n,r=e.editor;e.vertical?(t=e.controlborder+"px",e.endcap.style.top=e.endcapstart+"px",e.endcap.style.left=t,e.paneslider.style.top=e.panesliderstart+"px",e.paneslider.style.left=t,e.lessbutton.style.top=e.lessbuttonstart+"px",e.lessbutton.style.left=t,e.morebutton.style.top=e.morebuttonstart+"px",e.morebutton.style.left=t,e.scrollarea.style.top=e.scrollareastart+"px",e.scrollarea.style.left=t,e.scrollarea.style.height=e.scrollareasize+"px",o=Math.max(r.context.sheetobj.attribs.lastrow,r.firstscrollingrow+1),n=(r.firstscrollingrow-(r.lastnonscrollingrow+1))*(e.scrollareasize-3*e.thumbthickness)/(o-(r.lastnonscrollingrow+1))+e.scrollareastart-1,n=Math.floor(n),e.thumb.style.top=n+"px",e.thumb.style.left=t):(t=e.controlborder+"px",e.endcap.style.left=e.endcapstart+"px",e.endcap.style.top=t,e.paneslider.style.left=e.panesliderstart+"px",e.paneslider.style.top=t,e.lessbutton.style.left=e.lessbuttonstart+"px",e.lessbutton.style.top=t,e.morebutton.style.left=e.morebuttonstart+"px",e.morebutton.style.top=t,e.scrollarea.style.left=e.scrollareastart+"px",e.scrollarea.style.top=t,e.scrollarea.style.width=e.scrollareasize+"px",o=Math.max(r.context.sheetobj.attribs.lastcol,r.firstscrollingcol+1),n=(r.firstscrollingcol-(r.lastnonscrollingcol+1))*(e.scrollareasize-e.thumbthickness)/(o-r.lastnonscrollingcol)+e.scrollareastart-1,n=Math.floor(n),e.thumb.style.left=n+"px",e.thumb.style.top=t),e.thumbpos=n,e.main.style.display="block"},t.ComputeTableControlPositions=function(e){var t=e.editor;if(!t.gridposition||!t.headposition)throw"Can't compute table control positions before editor positions";e.vertical?(e.controlborder=t.gridposition.left+t.tablewidth,e.endcapstart=t.gridposition.top,e.panesliderstart=t.firstscrollingrowtop-e.sliderthickness,e.lessbuttonstart=t.firstscrollingrowtop-1,e.morebuttonstart=t.gridposition.top+t.tableheight-e.buttonthickness,e.scrollareastart=t.firstscrollingrowtop-1+e.buttonthickness,e.scrollareaend=e.morebuttonstart-1,e.scrollareasize=e.scrollareaend-e.scrollareastart+1):(e.controlborder=t.gridposition.top+t.tableheight,e.endcapstart=t.gridposition.left,e.panesliderstart=t.firstscrollingcolleft-e.sliderthickness,e.lessbuttonstart=t.firstscrollingcolleft-1,e.morebuttonstart=t.gridposition.left+t.tablewidth-e.buttonthickness,e.scrollareastart=t.firstscrollingcolleft-1+e.buttonthickness,e.scrollareaend=e.morebuttonstart-1,e.scrollareasize=e.scrollareaend-e.scrollareastart+1)},t.TCPSDragFunctionStart=function(e,o,n){var r=n.functionobj.control.editor,i=t.Constants;t.DragFunctionStart(e,o,n),o.trackingline=document.createElement("div"),o.trackingline.style.height=n.vertical?i.TCPStrackinglineThickness:r.tableheight-(r.headposition.top-r.gridposition.top)+"px",o.trackingline.style.width=n.vertical?r.tablewidth-(r.headposition.left-r.gridposition.left)+"px":i.TCPStrackinglineThickness,o.trackingline.style.backgroundImage="url("+r.imageprefix+"trackingline-"+(n.vertical?"v":"h")+".gif)",i.TCPStrackinglineClass&&(o.trackingline.className=i.TCPStrackinglineClass),t.setStyles(o.trackingline,i.TCPStrackinglineStyle),n.vertical?(row=t.Lookup(o.clientY+n.functionobj.control.sliderthickness,r.rowpositions),o.trackingline.style.top=(r.rowpositions[row]||r.headposition.top)+"px",o.trackingline.style.left=r.headposition.left+"px",o.trackingline.id="trackingline-vertical",r.context.rowpanes.length-1&&(r.context.SetRowPaneFirstLast(1,r.context.rowpanes[0].last+1,r.context.rowpanes[0].last+1),r.FitToEditTable(),r.ScheduleRender())):(col=t.Lookup(o.clientX+n.functionobj.control.sliderthickness,r.colpositions),o.trackingline.style.top=r.headposition.top+"px",o.trackingline.style.left=(r.colpositions[col]||r.headposition.left)+"px",o.trackingline.id="trackingline-horizon",r.context.colpanes.length-1&&(r.context.SetColPaneFirstLast(1,r.context.colpanes[0].last+1,r.context.colpanes[0].last+1),r.FitToEditTable(),r.ScheduleRender())),r.griddiv.appendChild(o.trackingline)},t.TCPSDragFunctionMove=function(e,o,n){var r,i,a,s,l=n.functionobj.control,c=l.sliderthickness,d=l.editor;if(n.vertical){for(a=l.morebuttonstart-l.minscrollingpanesize-o.offsetY,o.clientY>a&&(o.clientY=a),s=d.headposition.top-c-o.offsetY,o.clientY<s&&(o.clientY=s),r=t.Lookup(o.clientY+c,d.rowpositions);"yes"==d.context.sheetobj.rowattribs.hide[r];)r++;o.trackingline.style.top=(d.rowpositions[r]||d.headposition.top)+"px"}else{for(a=l.morebuttonstart-l.minscrollingpanesize-o.offsetX,o.clientX>a&&(o.clientX=a),s=d.headposition.left-c-o.offsetX,o.clientX<s&&(o.clientX=s),i=t.Lookup(o.clientX+c,d.colpositions);"yes"==d.context.sheetobj.colattribs.hide[t.rcColname(i)];)i++;o.trackingline.style.left=(d.colpositions[i]||d.headposition.left)+"px"}t.DragFunctionPosition(e,o,n)},t.TCPSDragFunctionStop=function(e,o,n){var r,i,a,s,l=n.functionobj.control,c=l.sliderthickness,d=l.editor;if(n.vertical){for(a=l.morebuttonstart-l.minscrollingpanesize-o.offsetY,o.clientY>a&&(o.clientY=a),s=d.headposition.top-c-o.offsetY,o.clientY<s&&(o.clientY=s),r=t.Lookup(o.clientY+c,d.rowpositions),r>d.context.sheetobj.attribs.lastrow&&(r=d.context.sheetobj.attribs.lastrow);"yes"==d.context.sheetobj.rowattribs.hide[r];)r++;d.EditorScheduleSheetCommands("pane row "+r,!0,!1)}else{for(a=l.morebuttonstart-l.minscrollingpanesize-o.offsetX,o.clientX>a&&(o.clientX=a),s=d.headposition.left-c-o.offsetX,o.clientX<s&&(o.clientX=s),i=t.Lookup(o.clientX+c,d.colpositions),i>d.context.sheetobj.attribs.lastcol&&(i=d.context.sheetobj.attribs.lastcol);"yes"==d.context.sheetobj.colattribs.hide[t.rcColname(i)];)i++;d.EditorScheduleSheetCommands("pane col "+i,!0,!1)}},
//!!!! Note: Need to make start use same code as move/stop for determining row/col, since stop will set that
//!!!! Note: Need to make start/move/stop use positioning code that corresponds closer to
//!!!!       ComputeTableControlPositions calculations.
t.TCTDragFunctionStart=function(e,o,n){var r=n.functionobj.control,i=r.editor,a=t.Constants;if(t.DragFunctionStart(e,o,n),o.thumbstatus&&(o.thumbstatus.rowmsgele&&(o.thumbstatus.rowmsgele=null),o.thumbstatus.rowpreviewele&&(o.thumbstatus.rowpreviewele=null),i.toplevel.removeChild(o.thumbstatus),o.thumbstatus=null),o.thumbstatus=document.createElement("div"),n.vertical){a.TCTDFSthumbstatusvClass&&(o.thumbstatus.className=a.TCTDFSthumbstatusvClass),t.setStyles(o.thumbstatus,a.TCTDFSthumbstatusvStyle),o.thumbstatus.style.top=o.clientY+a.TCTDFStopOffsetv+"px",o.thumbstatus.style.left=r.controlborder-10-i.tablewidth/2+"px",o.thumbstatus.style.width=i.tablewidth/2+"px",o.thumbcontext=new t.RenderContext(i.context.sheetobj),o.thumbcontext.showGrid=!0,o.thumbcontext.rowpanes=[{first:1,last:1}];var s=i.context.colpanes[i.context.colpanes.length-1];o.thumbcontext.colpanes=[{first:s.first,last:s.last}],o.thumbstatus.innerHTML='<table cellspacing="0" cellpadding="0"><tr><td valign="top" style="'+a.TCTDFSthumbstatusrownumStyle+'" class="'+a.TCTDFSthumbstatusrownumClass+'"><div>msg</div></td><td valign="top"><div style="overflow:hidden;">preview</div></td></tr></table>',o.thumbstatus.rowmsgele=o.thumbstatus.firstChild.firstChild.firstChild.firstChild.firstChild,o.thumbstatus.rowpreviewele=o.thumbstatus.firstChild.firstChild.firstChild.childNodes[1].firstChild,i.toplevel.appendChild(o.thumbstatus),t.TCTDragFunctionRowSetStatus(o,i,i.firstscrollingrow||1)}else a.TCTDFSthumbstatushClass&&(o.thumbstatus.className=a.TCTDFSthumbstatushClass),t.setStyles(o.thumbstatus,a.TCTDFSthumbstatushStyle),o.thumbstatus.style.top=r.controlborder+a.TCTDFStopOffseth+"px",o.thumbstatus.style.left=o.clientX+a.TCTDFSleftOffseth+"px",i.toplevel.appendChild(o.thumbstatus),o.thumbstatus.innerHTML=a.s_TCTDFthumbstatusPrefixh+t.rcColname(i.firstscrollingcol)},t.TCTDragFunctionRowSetStatus=function(e,o,n){var r=t.Constants,i=r.s_TCTDFthumbstatusPrefixv+n+" ";e.thumbstatus.rowmsgele.innerHTML=i,e.thumbcontext.rowpanes=[{first:n,last:n}],e.thumbrowshown=n;e.thumbcontext.RenderSheet(e.thumbstatus.rowpreviewele.firstChild,{type:"html"})},t.TCTDragFunctionMove=function(e,o,n){var r,i,a=n.functionobj.control,s=(a.thumbthickness,a.editor),l=t.Constants;n.vertical?(o.clientY>a.scrollareaend-o.offsetY-a.thumbthickness+2&&(o.clientY=a.scrollareaend-o.offsetY-a.thumbthickness+2),o.clientY<a.scrollareastart-o.offsetY-1&&(o.clientY=a.scrollareastart-o.offsetY-1),o.thumbstatus.style.top=o.clientY+"px",r=(o.clientY+o.offsetY-a.scrollareastart+1)/(a.scrollareasize-a.thumbthickness)*(s.context.sheetobj.attribs.lastrow-s.lastnonscrollingrow)+s.lastnonscrollingrow+1,r=Math.floor(r),r<=s.lastnonscrollingrow&&(r=s.lastnonscrollingrow+1),r>s.context.sheetobj.attribs.lastrow&&(r=s.context.sheetobj.attribs.lastrow),r!=o.thumbrowshown&&t.TCTDragFunctionRowSetStatus(o,s,r)):(o.clientX>a.scrollareaend-o.offsetX-a.thumbthickness+2&&(o.clientX=a.scrollareaend-o.offsetX-a.thumbthickness+2),o.clientX<a.scrollareastart-o.offsetX-1&&(o.clientX=a.scrollareastart-o.offsetX-1),o.thumbstatus.style.left=o.clientX+"px",r=(o.clientX+o.offsetX-a.scrollareastart+1)/(a.scrollareasize-a.thumbthickness)*(s.context.sheetobj.attribs.lastcol-s.lastnonscrollingcol)+s.lastnonscrollingcol+1,r=Math.floor(r),r<=s.lastnonscrollingcol&&(r=s.lastnonscrollingcol+1),r>s.context.sheetobj.attribs.lastcol&&(r=s.context.sheetobj.attribs.lastcol),i=l.s_TCTDFthumbstatusPrefixh+t.rcColname(r),o.thumbstatus.innerHTML=i),t.DragFunctionPosition(e,o,n)},t.TCTDragFunctionStop=function(e,t,o){var n,r=o.functionobj.control,i=r.editor;o.vertical?(n=(t.clientY+t.offsetY-r.scrollareastart+1)/(r.scrollareasize-r.thumbthickness)*(i.context.sheetobj.attribs.lastrow-i.lastnonscrollingrow)+i.lastnonscrollingrow+1,n=Math.floor(n),n<=i.lastnonscrollingrow&&(n=i.lastnonscrollingrow+1),n>i.context.sheetobj.attribs.lastrow&&(n=i.context.sheetobj.attribs.lastrow),i.context.SetRowPaneFirstLast(i.context.rowpanes.length-1,n,n+1)):(n=(t.clientX+t.offsetX-r.scrollareastart+1)/(r.scrollareasize-r.thumbthickness)*(i.context.sheetobj.attribs.lastcol-i.lastnonscrollingcol)+i.lastnonscrollingcol+1,n=Math.floor(n),n<=i.lastnonscrollingcol&&(n=i.lastnonscrollingcol+1),n>i.context.sheetobj.attribs.lastcol&&(n=i.context.sheetobj.attribs.lastcol),i.context.SetColPaneFirstLast(i.context.colpanes.length-1,n,n+1)),i.FitToEditTable(),t.thumbstatus.rowmsgele&&(t.thumbstatus.rowmsgele=null),t.thumbstatus.rowpreviewele&&(t.thumbstatus.rowpreviewele=null),i.toplevel.removeChild(t.thumbstatus),t.thumbstatus=null,i.ScheduleRender()},t.DragInfo={registeredElements:[],draggingElement:null,startX:0,startY:0,startZ:0,clientX:0,clientY:0,offsetX:0,offsetY:0,relativeOffset:{left:0,top:0}},t.DragRegister=function(e,o,n,r,i){var a=t.DragInfo;if(r||(r={MouseDown:t.DragFunctionStart,MouseMove:t.DragFunctionPosition,MouseUp:t.DragFunctionPosition,Disabled:null}),a.registeredElements.push({element:e,vertical:o,horizontal:n,functionobj:r,parent:i}),e.addEventListener)e.addEventListener("mousedown",t.DragMouseDown,!1);else{if(!e.attachEvent)throw t.Constants.s_BrowserNotSupported;e.attachEvent("onmousedown",t.DragMouseDown)}},t.DragUnregister=function(e){var o,n=t.DragInfo;if(e)for(o=0;o<n.registeredElements.length;o++)if(n.registeredElements[o].element==e)return n.registeredElements.splice(o,1),void(e.removeEventListener?e.removeEventListener("mousedown",t.DragMouseDown,!1):e.detachEvent("onmousedown",t.DragMouseDown))},t.DragMouseDown=function(o){var n=o||e.event,r=t.DragInfo,i=t.LookupElement(n.target||n.srcElement,r.registeredElements);if(i&&!(i&&i.functionobj&&i.functionobj.Disabled&&i.functionobj.Disabled(n,r,i)))return r.draggingElement=i,i.parent&&(r.relativeOffset=t.GetElementPositionWithScroll(i.parent)),r.clientX=n.clientX-r.relativeOffset.left,r.clientY=n.clientY-r.relativeOffset.top,r.startX=r.clientX,r.startY=r.clientY,r.startZ=i.element.style.zIndex,r.offsetX=0,r.offsetY=0,i.element.style.zIndex="100",t.SetMouseMoveUp(t.DragMouseMove,t.DragMouseUp,i.element,n),i&&i.functionobj&&i.functionobj.MouseDown&&i.functionobj.MouseDown(n,r,i),!1},t.DragMouseMove=function(o){var n=o||e.event,r=t.DragInfo,i=r.draggingElement;return r.clientX=n.clientX-r.relativeOffset.left,r.clientY=n.clientY-r.relativeOffset.top,t.StopPropagation(n),i&&i.functionobj&&i.functionobj.MouseMove&&i.functionobj.MouseMove(n,r,i),!1},t.DragMouseUp=function(o){var n=o||e.event,r=t.DragInfo,i=r.draggingElement;return r.clientX=n.clientX-r.relativeOffset.left,r.clientY=n.clientY-r.relativeOffset.top,i.element.style.zIndex=r.startZ,i&&i.functionobj&&i.functionobj.MouseUp&&i.functionobj.MouseUp(n,r,i),t.RemoveMouseMoveUp(t.DragMouseMove,t.DragMouseUp,i.element,n),r.draggingElement=null,!1},t.DragFunctionStart=function(e,t,o){var n=o.functionobj.positionobj||o.element;t.offsetY=parseInt(n.style.top)-t.clientY,t.offsetX=parseInt(n.style.left)-t.clientX},t.DragFunctionPosition=function(e,t,o){var n=o.functionobj.positionobj||o.element;o.vertical&&(n.style.top=t.clientY+t.offsetY+"px"),o.horizontal&&(n.style.left=t.clientX+t.offsetX+"px")},t.TooltipInfo={registeredElements:[],registered:!1,tooltipElement:null,timer:null,popupElement:null,clientX:0,clientY:0,offsetX:t.Constants.TooltipOffsetX,offsetY:t.Constants.TooltipOffsetY},t.TooltipRegister=function(e,o,n,r){var i=t.TooltipInfo;if(i.registeredElements.push({element:e,tiptext:o,functionobj:n,parent:r}),!i.registered){if(document.addEventListener)document.addEventListener("mousemove",t.TooltipMouseMove,!1);else{if(!document.attachEvent)throw t.Constants.s_BrowserNotSupported;document.attachEvent("onmousemove",t.TooltipMouseMove)}i.registered=!0}},t.TooltipMouseMove=function(o){var n=o||e.event,r=t.TooltipInfo;r.clientX=n.clientX,r.clientY=n.clientY;var i=t.LookupElement(n.target||n.srcElement,r.registeredElements);r.timer&&(e.clearTimeout(r.timer),r.timer=null),r.popupElement&&t.TooltipHide(),r.tooltipElement=i||null,i&&!t.ButtonInfo.buttonDown&&(r.timer=e.setTimeout(t.TooltipWaitDone,700),r.tooltipElement.element.addEventListener?r.tooltipElement.element.addEventListener("mousedown",t.TooltipMouseDown,!1):r.tooltipElement.element.attachEvent&&r.tooltipElement.element.attachEvent("onmousedown",t.TooltipMouseDown))},t.TooltipMouseDown=function(o){var n=(o||e.event,t.TooltipInfo);n.timer&&(e.clearTimeout(n.timer),n.timer=null),n.popupElement&&t.TooltipHide(),n.tooltipElement&&(n.tooltipElement.element.removeEventListener?n.tooltipElement.element.removeEventListener("mousedown",t.TooltipMouseDown,!1):n.tooltipElement.element.attachEvent&&n.tooltipElement.element.detachEvent("onmousedown",t.TooltipMouseDown),n.tooltipElement=null)},t.TooltipDisplay=function(e){var o=t.TooltipInfo,n=t.Constants,r=e.functionobj&&"number"==typeof e.functionobj.offsetx?e.functionobj.offsetx:o.offsetX,i=e.functionobj&&"number"==typeof e.functionobj.offsety?e.functionobj.offsety:o.offsetY,a=t.GetViewportInfo(),s=t.GetElementPositionWithScroll(e.parent);o.popupElement=document.createElement("div"),n.TDpopupElementClass&&(o.popupElement.className=n.TDpopupElementClass),t.setStyles(o.popupElement,n.TDpopupElementStyle),o.popupElement.innerHTML=e.tiptext,o.clientX>a.width/2?(o.popupElement.style.bottom=s.height-o.clientY+i+s.top+"px",o.popupElement.style.right=s.width-o.clientX+r+s.left+"px"):(o.popupElement.style.bottom=s.height-o.clientY+i+s.top+"px",o.popupElement.style.left=o.clientX+r-s.left+"px"),o.clientY<50&&(o.popupElement.style.bottom=s.height-o.clientY+i-50+s.top+"px"),e.parent.appendChild(o.popupElement)},t.TooltipHide=function(){var e=t.TooltipInfo;e.popupElement&&(e.popupElement.parentNode.removeChild(e.popupElement),e.popupElement=null)},t.TooltipWaitDone=function(){var e=t.TooltipInfo;e.timer=null,t.TooltipDisplay(e.tooltipElement)},t.ButtonInfo={registeredElements:[],buttonElement:null,doingHover:!1,buttonDown:!1,timer:null,relativeOffset:null,clientX:0,clientY:0},t.ButtonRegister=function(e,o,n,r){var i=t.ButtonInfo;if(n||(n={}),i.registeredElements.push({name:n.name,element:o,editor:e,normalstyle:n.normalstyle,hoverstyle:n.hoverstyle,downstyle:n.downstyle,repeatwait:n.repeatwait,repeatinterval:n.repeatinterval,functionobj:r}),o.addEventListener)o.addEventListener("mousedown",t.ButtonMouseDown,!1),o.addEventListener("mouseover",t.ButtonMouseOver,!1),o.addEventListener("mouseout",t.ButtonMouseOut,!1);else{if(!o.attachEvent)throw t.Constants.s_BrowserNotSupported;o.attachEvent("onmousedown",t.ButtonMouseDown),o.attachEvent("onmouseover",t.ButtonMouseOver),o.attachEvent("onmouseout",t.ButtonMouseOut)}},t.ButtonMouseOver=function(o){var n=o||e.event,r=t.ButtonInfo,i=t.LookupElement(n.target||n.srcElement,r.registeredElements);if(i){if(r.buttonDown)return void(r.buttonElement==i&&(r.doingHover=!0));r.buttonElement&&r.buttonElement!=i&&r.doingHover&&t.setStyles(r.buttonElement.element,r.buttonElement.normalstyle),r.buttonElement=i,r.doingHover=!0,t.setStyles(i.element,i.hoverstyle),i&&i.functionobj&&i.functionobj.MouseOver&&i.functionobj.MouseOver(n,r,i)}},t.ButtonMouseOut=function(o){var n=o||e.event,r=t.ButtonInfo;if(r.buttonDown)return void(r.doingHover=!1);var i=t.LookupElement(n.target||n.srcElement,r.registeredElements);r.doingHover&&(r.buttonElement&&t.setStyles(r.buttonElement.element,r.buttonElement.normalstyle),r.buttonElement=null,r.doingHover=!1),i&&i.functionobj&&i.functionobj.MouseOut&&i.functionobj.MouseOut(n,r,i)},t.ButtonMouseDown=function(o){var n=o||e.event,r=t.ButtonInfo,i=(t.GetViewportInfo(),t.LookupElement(n.target||n.srcElement,r.registeredElements));i&&(i&&i.functionobj&&i.functionobj.Disabled&&i.functionobj.Disabled(n,r,i)||(r.buttonElement=i,r.buttonDown=!0,t.setStyles(i.element,r.buttonElement.downstyle),document.addEventListener?document.addEventListener("mouseup",t.ButtonMouseUp,!0):i.element.attachEvent&&(i.element.setCapture(),i.element.attachEvent("onmouseup",t.ButtonMouseUp),i.element.attachEvent("onlosecapture",t.ButtonMouseUp)),t.StopPropagation(n),r.relativeOffset=t.GetElementPositionWithScroll(i.editor.toplevel),r.clientX=n.clientX-r.relativeOffset.left,r.clientY=n.clientY-r.relativeOffset.top,i&&i.functionobj&&i.functionobj.MouseDown&&i.functionobj.MouseDown(n,r,i),i.repeatwait&&(r.timer=e.setTimeout(t.ButtonRepeat,i.repeatwait))))},t.ButtonMouseUp=function(o){var n=o||e.event,r=t.ButtonInfo,i=r.buttonElement;r.timer&&(e.clearTimeout(r.timer),r.timer=null),r.buttonDown&&(t.StopPropagation(n),document.removeEventListener?document.removeEventListener("mouseup",t.ButtonMouseUp,!0):document.detachEvent&&(i.element.detachEvent("onlosecapture",t.ButtonMouseUp),i.element.detachEvent("onmouseup",t.ButtonMouseUp),i.element.releaseCapture()),r.buttonElement.downstyle&&(r.doingHover?t.setStyles(i.element,r.buttonElement.hoverstyle):t.setStyles(i.element,r.buttonElement.normalstyle)),r.buttonDown=!1,i&&i.functionobj&&i.functionobj.MouseUp&&i.functionobj.MouseUp(n,r,i))},t.ButtonRepeat=function(){var o=t.ButtonInfo,n=o.buttonElement;n&&(n&&n.functionobj&&n.functionobj.Repeat&&n.functionobj.Repeat(null,o,n),o.timer=e.setTimeout(t.ButtonRepeat,n.repeatinterval||100))},t.MouseWheelInfo={registeredElements:[]},t.MouseWheelRegister=function(e,o){if(t.MouseWheelInfo.registeredElements.push({element:e,functionobj:o}),e.addEventListener)e.addEventListener("DOMMouseScroll",t.ProcessMouseWheel,!1),e.addEventListener("mousewheel",t.ProcessMouseWheel,!1);else{if(!e.attachEvent)throw t.Constants.s_BrowserNotSupported;e.attachEvent("onmousewheel",t.ProcessMouseWheel)}},t.ProcessMouseWheel=function(o){var n,r=o||e.event;if(!t.Keyboard.passThru){var i,a=t.MouseWheelInfo,s=r.target||r.srcElement;for(i=null;!i&&s;s=s.parentNode)i=t.LookupElement(s,a.registeredElements);i&&(n=r.wheelDelta?r.wheelDelta/120:-r.detail/3,n||(n=0),i.functionobj&&i.functionobj.WheelMove&&i.functionobj.WheelMove(r,n,a,i),r.preventDefault&&r.preventDefault(),r.returnValue=!1)}},t.keyboardTables={specialKeysCommon:{8:"[backspace]",9:"[tab]",13:"[enter]",25:"[tab]",27:"[esc]",33:"[pgup]",34:"[pgdn]",35:"[end]",36:"[home]",37:"[aleft]",38:"[aup]",39:"[aright]",40:"[adown]",45:"[ins]",46:"[del]",113:"[f2]"},specialKeysIE:{8:"[backspace]",9:"[tab]",13:"[enter]",25:"[tab]",27:"[esc]",33:"[pgup]",34:"[pgdn]",35:"[end]",36:"[home]",37:"[aleft]",38:"[aup]",39:"[aright]",40:"[adown]",45:"[ins]",46:"[del]",113:"[f2]"},controlKeysIE:{67:"[ctrl-c]",83:"[ctrl-s]",86:"[ctrl-v]",88:"[ctrl-x]",90:"[ctrl-z]"},specialKeysOpera:{8:"[backspace]",9:"[tab]",13:"[enter]",25:"[tab]",27:"[esc]",33:"[pgup]",34:"[pgdn]",35:"[end]",36:"[home]",37:"[aleft]",38:"[aup]",39:"[aright]",40:"[adown]",45:"[ins]",46:"[del]",113:"[f2]"},controlKeysOpera:{67:"[ctrl-c]",83:"[ctrl-s]",86:"[ctrl-v]",88:"[ctrl-x]",90:"[ctrl-z]"},specialKeysSafari:{8:"[backspace]",9:"[tab]",13:"[enter]",25:"[tab]",27:"[esc]",63232:"[aup]",63233:"[adown]",63234:"[aleft]",63235:"[aright]",63272:"[del]",63273:"[home]",63275:"[end]",63276:"[pgup]",63277:"[pgdn]",63237:"[f2]"},controlKeysSafari:{99:"[ctrl-c]",115:"[ctrl-s]",118:"[ctrl-v]",120:"[ctrl-x]",122:"[ctrl-z]"},ignoreKeysSafari:{63236:"[f1]",63238:"[f3]",63239:"[f4]",63240:"[f5]",63241:"[f6]",63242:"[f7]",63243:"[f8]",63244:"[f9]",63245:"[f10]",63246:"[f11]",63247:"[f12]",63289:"[numlock]"},specialKeysFirefox:{8:"[backspace]",9:"[tab]",13:"[enter]",25:"[tab]",27:"[esc]",33:"[pgup]",34:"[pgdn]",35:"[end]",36:"[home]",37:"[aleft]",38:"[aup]",39:"[aright]",40:"[adown]",45:"[ins]",46:"[del]",113:"[f2]"},controlKeysFirefox:{99:"[ctrl-c]",115:"[ctrl-s]",118:"[ctrl-v]",120:"[ctrl-x]",122:"[ctrl-z]"},ignoreKeysFirefox:{16:"[shift]",17:"[ctrl]",18:"[alt]",20:"[capslock]",19:"[pause]",44:"[printscreen]",91:"[windows]",92:"[windows]",112:"[f1]",114:"[f3]",115:"[f4]",116:"[f5]",117:"[f6]",118:"[f7]",119:"[f8]",120:"[f9]",121:"[f10]",122:"[f11]",123:"[f12]",144:"[numlock]",145:"[scrolllock]",224:"[cmd]"}},t.Keyboard={areListener:!1,focusTable:null,passThru:null,didProcessKey:!1,statusFromProcessKey:!1,repeatingKeyPress:!1,chForProcessKey:""},t.KeyboardSetFocus=function(o){t.Keyboard.focusTable=o,t.Keyboard.areListener||(document.onkeydown=t.ProcessKeyDown,document.onkeypress=t.ProcessKeyPress,t.Keyboard.areListener=!0),t.Keyboard.passThru&&(t.Keyboard.passThru.blur&&t.Keyboard.passThru.blur(),t.Keyboard.passThru=null),e.focus()},t.KeyboardFocus=function(){t.Keyboard.passThru=null,e.focus()},t.ProcessKeyDown=function(o){var n=t.keyboardTables;n.didProcessKey=!1,n.statusFromProcessKey=!1,n.repeatingKeyPress=!1;var r="",i=!0;if(!t._app&&!t.Keyboard.passThru){if(o=o||e.event,o.which==undefined){if(!(r=n.specialKeysCommon[o.keyCode])&&(o.ctrlKey&&(r=n.controlKeysIE[o.keyCode]),!r))return!0;i=t.ProcessKey(r,o),i||(o.preventDefault&&o.preventDefault(),o.returnValue=!1)}else{if(!(r=n.specialKeysCommon[o.keyCode])&&((o.ctrlKey||o.metaKey)&&(r=n.controlKeysIE[o.keyCode]),!r))return!0;i=t.ProcessKey(r,o),n.didProcessKey=!0,n.statusFromProcessKey=i,n.chForProcessKey=r}return i}},t.ProcessKeyPress=function(o){var n=t.keyboardTables,r="";if(o=o||e.event,!t._app&&!t.Keyboard.passThru){if(n.didProcessKey)return n.repeatingKeyPress?t.ProcessKey(n.chForProcessKey,o):(n.repeatingKeyPress=!0,n.statusFromProcessKey);if(o.which==undefined)r=String.fromCharCode(o.keyCode);else{if(!o.which)return!1;if(o.charCode==undefined){if(0==o.which)return!0;if(o.which<32||144==o.which){if(r=n.specialKeysOpera[o.which])return!0}else r=o.ctrlKey?n.controlKeysOpera[o.keyCode]:String.fromCharCode(o.which)}else{if(0==o.keyCode&&0==o.charCode)return;if(o.keyCode==o.charCode){if(!(r=n.specialKeysSafari[o.keyCode])){if(n.ignoreKeysSafari[o.keyCode])return!0;r=o.metaKey?n.controlKeysSafari[o.keyCode]:String.fromCharCode(o.which)}}else{if(n.specialKeysFirefox[o.keyCode])return!0;r=String.fromCharCode(o.which),(o.ctrlKey||o.metaKey)&&(r=n.controlKeysFirefox[o.which])}}}var i=t.ProcessKey(r,o);return i||(o.preventDefault&&o.preventDefault(),o.returnValue=!1),i}},t.ProcessKey=function(e,o){var n=t.Keyboard.focusTable;return!n||n.EditorProcessKey(e,o)};/*
// SocialCalc Number Formatting Library
//
// Part of the SocialCalc package.
//
// (c) Copyright 2008 Socialtext, Inc.
// All Rights Reserved.
//
// The contents of this file are subject to the Artistic License 2.0; you may not
// use this file except in compliance with the License. You may obtain a copy of
// the License at http://socialcalc.org/licenses/al-20/.
//
// Some of the other files in the SocialCalc package are licensed under
// different licenses. Please note the licenses of the modules you use.
//
// Code History:
//
// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.
// Based in part on the SocialCalc 1.1.0 code written in Perl.
// The SocialCalc 1.1.0 code was:
//    Portions (c) Copyright 2005, 2006, 2007 Software Garden, Inc.
//    All Rights Reserved.
//    Portions (c) Copyright 2007 Socialtext, Inc.
//    All Rights Reserved.
// The Perl SocialCalc started as modifications to the wikiCalc(R) program, version 1.0.
// wikiCalc 1.0 was written by Software Garden, Inc.
// Unless otherwise specified, referring to "SocialCalc" in comments refers to this
// JavaScript version of the code, not the SocialCalc Perl code.
//
*/
var t;t||(t={}),t.FormatNumber={},t.FormatNumber.format_definitions={},t.FormatNumber.separatorchar=",",t.FormatNumber.decimalchar=".",t.FormatNumber.daynames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],t.FormatNumber.daynames3=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],t.FormatNumber.monthnames3=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],t.FormatNumber.monthnames=["January","February","March","April","May","June","July","August","September","October","November","December"],t.FormatNumber.allowedcolors={BLACK:"#000000",BLUE:"#0000FF",CYAN:"#00FFFF",GREEN:"#00FF00",MAGENTA:"#FF00FF",RED:"#FF0000",WHITE:"#FFFFFF",YELLOW:"#FFFF00"},t.FormatNumber.alloweddates={H:"h]",M:"m]",MM:"mm]",S:"s]",SS:"ss]"},t.FormatNumber.commands={copy:1,color:2,integer_placeholder:3,fraction_placeholder:4,decimal:5,currency:6,general:7,separator:8,date:9,comparison:10,section:11,style:12},t.FormatNumber.datevalues={julian_offset:2415019,seconds_in_a_day:86400,seconds_in_an_hour:3600},t.FormatNumber.formatNumberWithFormat=function(e,o,n){var r,i,a,s,l,c,d,u,p,h,f,m,g,v,y,b,C,w,x,S,_,k,T,E,F,D,M,A,P,L,R,I,O,$,N,U,j,H,B,z=t.Constants,V=t.FormatNumber,Y="";if("string"==typeof e&&!e.length)return"";if(B=e-0,!isFinite(B))return"string"==typeof e?V.formatTextWithFormat(e,o):"NaN";e=B;var G=B<0?1:0;G&&(B=-B);var W=0==B?1:0;if(n=n||z.FormatNumber_DefaultCurrency,V.parse_format_string(V.format_definitions,o),!(C=V.format_definitions[o]))throw"Format not parsed error!";if(w=C.sectioninfo.length-1,C.hascomparison)for(w=0,x=0,k=0;;k++){if(r=C.operators[k],i=C.operands[k],!r){x&&(o="General",V.parse_format_string(V.format_definitions,o),C=V.format_definitions[o],w=0);break}if(r!=V.commands.section){if(r==V.commands.comparison){if(F=i.indexOf(":"),S=i.substring(0,F),_=i.substring(F+1)-0,"<"==S&&e<_||"<="==S&&e<=_||"="==S&&e==_||"<>"==S&&e!=_||">="==S&&e>=_||">"==S&&e>_)break;x=1}}else{if(!x)break;x=0,w++}}else w>0&&(1==w?G?(G=0,w=1):w=0:2!=w&&3!=w||(G?(G=0,w=1):w=W?2:0));if(E=C.sectioninfo[w],E.commas>0)for(F=0;F<E.commas;F++)B/=1e3;if(E.percent>0)for(F=0;F<E.percent;F++)B*=100;for(D=1,F=0;F<E.fractiondigits;F++)D*=10;if(M=Math.floor(B*D+.5),"number"!=typeof(M/=D))return"NaN";if(!isFinite(M))return"NaN";if(A=M+"",0==M&&(E.fractiondigits||E.integerdigits)&&(G=0),A.indexOf("e")>=0)return e+"";if(!(P=A.match(/^\+{0,1}(\d*)(?:\.(\d*)){0,1}$/)))return"NaN";if(L=P[1],L&&"0"!=L||(L=""),R=P[2],R||(R=""),E.hasdate){if(e<0)return"??-???-??&nbsp;??:??:??";for(c=(e-Math.floor(e))*V.datevalues.seconds_in_a_day,d=e*V.datevalues.seconds_in_a_day,u=Math.floor(c/V.datevalues.seconds_in_an_hour),f=Math.floor(d/V.datevalues.seconds_in_an_hour),c-=u*V.datevalues.seconds_in_an_hour,p=Math.floor(c/60),m=Math.floor(d/60),h=c-60*p,D=1,F=0;F<E.fractiondigits;F++)D*=10;for(h=Math.floor(h*D+.5),h/=D,g=Math.floor(d*D+.5),g/=D,h>=60&&(h=0,p++,m++,p>=60&&(p=0,u++,f++,u>=24&&(u=0,e++))),R=h-Math.floor(h)+"",R=R.substring(2),y=t.FormatNumber.convert_date_julian_to_gregorian(Math.floor(e+V.datevalues.julian_offset)),b=0,mspos=E.sectionstart;(r=C.operators[mspos],i=C.operands[mspos],r)&&r!=V.commands.section;mspos++)r==V.commands.date?("am/pm"!=i.toLowerCase()&&"a/p"!=i.toLowerCase()||v||(u>=12?(u-=12,v="a/p"==i.toLowerCase()?z.s_FormatNumber_pm1:z.s_FormatNumber_pm):v="a/p"==i.toLowerCase()?z.s_FormatNumber_am1:z.s_FormatNumber_am,i.indexOf(v)<0&&(v=v.toLowerCase())),!b||"m"!=i&&"mm"!=i||(C.operands[mspos]+="in"),b="h"==i.charAt(0)?1:0):r!=V.commands.copy&&(b=0);for(b=0,--mspos;(r=C.operators[mspos],i=C.operands[mspos],r)&&r!=V.commands.section;mspos--)r==V.commands.date?(!b||"m"!=i&&"mm"!=i||(C.operands[mspos]+="in"),b="ss"==i?1:0):r!=V.commands.copy&&(b=0)}for(I=0,O=0,$=0,N="",U="",j=z.FormatNumber_separatorchar,j.indexOf(" ")>=0&&(j=j.replace(/ /g,"&nbsp;")),H=z.FormatNumber_decimalchar,H.indexOf(" ")>=0&&(H=H.replace(/ /g,"&nbsp;")),T=E.sectionstart;r=C.operators[T];)if(i=C.operands[T++],r==V.commands.copy)Y+=i;else if(r==V.commands.color)N=i;else if(r==V.commands.style)U=i;else if(r==V.commands.integer_placeholder){if(G&&(Y+="-",G=0),1==++I&&L.length>E.integerdigits)for(;O<L.length-E.integerdigits;O++)Y+=L.charAt(O),E.thousandssep&&(a=L.length-O-1)>2&&a%3==0&&(Y+=j);L.length<E.integerdigits&&I<=E.integerdigits-L.length?"0"!=i&&"?"!=i||(Y+="0"==i?"0":"&nbsp;",E.thousandssep&&(a=E.integerdigits-I)>2&&a%3==0&&(Y+=j)):(Y+=L.charAt(O),E.thousandssep&&(a=L.length-O-1)>2&&a%3==0&&(Y+=j),O++)}else if(r==V.commands.fraction_placeholder)$>=R.length?"0"!=i&&"?"!=i||(Y+="0"==i?"0":"&nbsp;"):Y+=R.charAt($),$++;else if(r==V.commands.decimal)G&&(Y+="-",G=0),Y+=H;else if(r==V.commands.currency)G&&(Y+="-",G=0),Y+=i;else if(r==V.commands.general){if(0!=B){var q=Math.floor(Math.LOG10E*Math.log(B));if(q=Math.pow(10,13-q),B=Math.floor(q*B+.5)/q,!isFinite(B))return"NaN"}if(G&&(Y+="-"),A=B+"",A.indexOf("e")>=0){Y+=A;continue}if(P=A.match(/^\+{0,1}(\d*)(?:\.(\d*)){0,1}$/),L=P[1],L&&"0"!=L||(L=""),R=P[2],R||(R=""),O=0,$=0,L.length)for(;O<L.length;O++)Y+=L.charAt(O),E.thousandssep&&(a=L.length-O-1)>2&&a%3==0&&(Y+=j);else Y+="0";if(R.length)for(Y+=H;$<R.length;$++)Y+=R.charAt($)}else if(r==V.commands.date)l=i.toLowerCase(),"y"==l||"yy"==l?Y+=(y.year+"").substring(2):"yyyy"==l?Y+=y.year+"":"d"==l?Y+=y.day+"":"dd"==l?(s=1e3+y.day,Y+=(s+"").substr(2)):"ddd"==l?(s=Math.floor(e+6)%7,Y+=z.s_FormatNumber_daynames3[s]):"dddd"==l?(s=Math.floor(e+6)%7,Y+=z.s_FormatNumber_daynames[s]):"m"==l?Y+=y.month+"":"mm"==l?(s=1e3+y.month,Y+=(s+"").substr(2)):"mmm"==l?Y+=z.s_FormatNumber_monthnames3[y.month-1]:"mmmm"==l?Y+=z.s_FormatNumber_monthnames[y.month-1]:"mmmmm"==l?Y+=z.s_FormatNumber_monthnames[y.month-1].charAt(0):"h"==l?Y+=u+"":"h]"==l?Y+=f+"":"mmin"==l?(s=1e3+p+"",Y+=s.substr(2)):"mm]"==l?m<100?(s=1e3+m+"",Y+=s.substr(2)):Y+=m+"":"min"==l?Y+=p+"":"m]"==l?Y+=m+"":"hh"==l?(s=1e3+u+"",Y+=s.substr(2)):"s"==l?(s=Math.floor(h),Y+=s+""):"ss"==l?(s=1e3+Math.floor(h)+"",Y+=s.substr(2)):"am/pm"==l||"a/p"==l?Y+=v:"ss]"==l&&(g<100?(s=1e3+Math.floor(g)+"",Y+=s.substr(2)):(s=Math.floor(g),Y+=s+""));else{if(r==V.commands.section)break;if(r==V.commands.comparison)continue;Y+="!! Parse error !!"}return N&&(Y='<span style="color:'+N+';">'+Y+"</span>"),U&&(Y='<span style="'+U+';">'+Y+"</span>"),Y},t.FormatNumber.formatTextWithFormat=function(e,o){var n,r,i,a,s=(t.Constants,t.FormatNumber),l=e+"",c="",d="",u="";if(s.parse_format_string(s.format_definitions,o),thisformat=s.format_definitions[o],!thisformat)throw"Format not parsed error!";if(0==(n=thisformat.sectioninfo.length-1))n=0;else{if(3!=n)return l;n=3}for(r=thisformat.sectioninfo[n],i=r.sectionstart;op=thisformat.operators[i];)a=thisformat.operands[i++],op==s.commands.copy?c+="@"==a?l:a.replace(/ /g,"&nbsp;"):op==s.commands.color?d=a:op==s.commands.style&&(u=a);return d&&(c='<span style="color:'+d+';">'+c+"</span>"),u&&(c='<span style="'+u+';">'+c+"</span>"),c},t.FormatNumber.parse_format_string=function(e,o){var n,r,i,a,s,l,c,d,u,p,h,f,m,g,v,y,b,C=t.FormatNumber,w=1;if(!e[o]){for(n={operators:[],operands:[],sectioninfo:[{}]},e[o]=n,r=0,sectioninfo=n.sectioninfo[r],sectioninfo.sectionstart=0,sectioninfo.integerdigits=0,sectioninfo.fractiondigits=0,sectioninfo.commas=0,sectioninfo.percent=0,y=0;y<o.length;y++)if(b=o.charAt(y),c){if('"'==b){c=0,n.operators.push(C.commands.copy),n.operands.push(d);continue}d+=b}else if(u){if("]"==b){if(u=0,h=t.FormatNumber.parse_format_bracket(p),h.operator==C.commands.separator){sectioninfo.thousandssep=1;continue}h.operator==C.commands.date&&(sectioninfo.hasdate=1),h.operator==C.commands.comparison&&(n.hascomparison=1),n.operators.push(h.operator),n.operands.push(h.operand);continue}p+=b}else if(a)n.operators.push(C.commands.copy),n.operands.push(b),a=!1;else if(s)n.operators.push(C.commands.copy),n.operands.push(b+b+b+b+b),s=!1;else if(l)n.operators.push(C.commands.copy),n.operands.push("&nbsp;"),l=!1;else{if(f){if("general".charAt(f)==b.toLowerCase()){f++,7==f&&(n.operators.push(C.commands.general),n.operands.push(b),f=0);continue}f=0}if(v){if(v.charAt(0)==b){v+=b;continue}n.operators.push(C.commands.date),n.operands.push(v),sectioninfo.hasdate=1,v=""}m?(m+=b,g=m.toLowerCase(),g!="am/pm".substring(0,g.length)&&g!="a/p".substring(0,g.length)?ampstr="":"am/pm"!=g&&"a/p"!=g||(n.operators.push(C.commands.date),n.operands.push(m),m="")):"#"==b||"0"==b||"?"==b?w?(sectioninfo.integerdigits++,sectioninfo.commas&&(sectioninfo.thousandssep=1,sectioninfo.commas=0),i=1,n.operators.push(C.commands.integer_placeholder),n.operands.push(b)):(sectioninfo.fractiondigits++,i=1,n.operators.push(C.commands.fraction_placeholder),n.operands.push(b)):"."==b?(i=0,n.operators.push(C.commands.decimal),n.operands.push(b),w=0):"$"==b?(i=0,n.operators.push(C.commands.currency),n.operands.push(b)):","==b?i?sectioninfo.commas++:(n.operators.push(C.commands.copy),n.operands.push(b)):"%"==b?(i=0,sectioninfo.percent++,n.operators.push(C.commands.copy),n.operands.push(b)):'"'==b?(i=0,c=1,d=""):"["==b?(i=0,u=1,p=""):"\\"==b?(a=1,i=0):"*"==b?(s=1,i=0):"_"==b?(l=1,i=0):";"==b?(r++,n.sectioninfo[r]={},sectioninfo=n.sectioninfo[r],sectioninfo.sectionstart=1+n.operators.length,sectioninfo.integerdigits=0,sectioninfo.fractiondigits=0,sectioninfo.commas=0,sectioninfo.percent=0,w=1,i=0,n.operators.push(C.commands.section),n.operands.push(b)):"g"==b.toLowerCase()?(f=1,i=0):"a"==b.toLowerCase()?(m=b,i=0):"dmyhHs".indexOf(b)>=0?v=b:(i=0,n.operators.push(C.commands.copy),n.operands.push(b))}v&&(n.operators.push(C.commands.date),n.operands.push(v),sectioninfo.hasdate=1)}},t.FormatNumber.parse_format_bracket=function(e){var o,n=t.FormatNumber,r=t.Constants,i={};return"$"==e.charAt(0)?(i.operator=n.commands.currency,o=e.match(/^\$(.+?)(\-.+?){0,1}$/),i.operand=o?o[1]||r.FormatNumber_defaultCurrency||"$":e.substring(1)||r.FormatNumber_defaultCurrency||"$"):"?$"==e?(i.operator=n.commands.currency,i.operand="[?$]"):n.allowedcolors[e.toUpperCase()]?(i.operator=n.commands.color,i.operand=n.allowedcolors[e.toUpperCase()]):(o=e.match(/^style=([^"]*)$/))?(i.operator=n.commands.style,i.operand=o[1]):","==e?(i.operator=n.commands.separator,i.operand=e):n.alloweddates[e.toUpperCase()]?(i.operator=n.commands.date,i.operand=n.alloweddates[e.toUpperCase()]):(o=e.match(/^[<>=]/))?(o=e.match(/^([<>=]+)(.+)$/),i.operator=n.commands.comparison,i.operand=o[1]+":"+o[2]):(i.operator=n.commands.copy,i.operand="["+e+"]"),i},t.FormatNumber.convert_date_gregorian_to_julian=function(e,o,n){var r;return r=n-32075+t.intFunc(1461*(e+4800+t.intFunc((o-14)/12))/4),r+=t.intFunc(367*(o-2-12*t.intFunc((o-14)/12))/12),r-=t.intFunc(3*t.intFunc((e+4900+t.intFunc((o-14)/12))/100)/4)},t.FormatNumber.convert_date_julian_to_gregorian=function(e){var t,o,n,r,i;return t=e+68569,o=Math.floor(4*t/146097),t-=Math.floor((146097*o+3)/4),n=Math.floor(4e3*(t+1)/1461001),t=t-Math.floor(1461*n/4)+31,r=Math.floor(80*t/2447),i=t-Math.floor(2447*r/80),t=Math.floor(r/11),r=r+2-12*t,n=100*(o-49)+n+t,{year:n,month:r,day:i}},t.intFunc=function(e){return e<0?-Math.floor(-e):Math.floor(e)};/*
// SocialCalc Spreadsheet Formula Library
//
// Part of the SocialCalc package
//
// (c) Copyright 2008 Socialtext, Inc.
// All Rights Reserved.
//
// The contents of this file are subject to the Artistic License 2.0; you may not
// use this file except in compliance with the License. You may obtain a copy of
// the License at http://socialcalc.org/licenses/al-20/.
//
// Some of the other files in the SocialCalc package are licensed under
// different licenses. Please note the licenses of the modules you use.
//
// Code History:
//
// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.
// Based in part on the SocialCalc 1.1.0 code written in Perl.
// The SocialCalc 1.1.0 code was:
//    Portions (c) Copyright 2005, 2006, 2007 Software Garden, Inc.
//    All Rights Reserved.
//    Portions (c) Copyright 2007 Socialtext, Inc.
//    All Rights Reserved.
// The Perl SocialCalc started as modifications to the wikiCalc(R) program, version 1.0.
// wikiCalc 1.0 was written by Software Garden, Inc.
// Unless otherwise specified, referring to "SocialCalc" in comments refers to this
// JavaScript version of the code, not the SocialCalc Perl code.
//
*/
var t;t||(t={}),t.Formula={},t.TriggerIoAction={},t.Formula.ParseState={num:1,alpha:2,coord:3,string:4,stringquote:5,numexp1:6,numexp2:7,alphanumeric:8,specialvalue:9},t.Formula.TokenType={num:1,coord:2,op:3,name:4,error:5,string:6,space:7},t.Formula.CharClass={num:1,numstart:2,op:3,eof:4,alpha:5,incoord:6,error:7,quote:8,space:9,specialstart:10},t.Formula.CharClassTable={" ":9,"!":3,'"':8,"'":8,"#":10,$:6,"%":3,"&":3,"(":3,")":3,"*":3,"+":3,",":3,"-":3,".":2,"/":3,0:1,1:1,2:1,3:1,4:1,5:1,6:1,7:1,8:1,9:1,":":3,"<":3,"=":3,">":3,A:5,B:5,C:5,D:5,E:5,F:5,G:5,H:5,I:5,J:5,K:5,L:5,M:5,N:5,O:5,P:5,Q:5,R:5,S:5,T:5,U:5,V:5,W:5,X:5,Y:5,Z:5,"^":3,_:5,a:5,b:5,c:5,d:5,e:5,f:5,g:5,h:5,i:5,j:5,k:5,l:5,m:5,n:5,o:5,p:5,q:5,r:5,s:5,t:5,u:5,v:5,w:5,x:5,y:5,z:5},t.Formula.UpperCaseTable={a:"A",b:"B",c:"C",d:"D",e:"E",f:"F",g:"G",h:"H",i:"I",j:"J",k:"K",l:"L",m:"M",n:"N",o:"O",p:"P",q:"Q",r:"R",s:"S",t:"T",u:"U",v:"V",w:"W",x:"X",y:"Y",z:"Z",A:"A",B:"B",C:"C",D:"D",E:"E",F:"F",G:"G",H:"H",I:"I",J:"J",K:"K",L:"L",M:"M",N:"N",O:"O",P:"P",Q:"Q",R:"R",S:"S",T:"T",U:"U",V:"V",W:"W",X:"X",Y:"Y",Z:"Z"},t.Formula.SpecialConstants={"#NULL!":"0,e#NULL!","#NUM!":"0,e#NUM!","#DIV/0!":"0,e#DIV/0!","#VALUE!":"0,e#VALUE!","#REF!":"0,e#REF!","#NAME?":"0,e#NAME?"},t.Formula.TokenPrecedence={"!":1,":":2,",":2,M:-3,P:-3,"%":4,"^":5,"*":6,"/":6,"+":7,"-":7,"&":8,"<":9,">":9,G:9,L:9,N:9},t.Formula.TokenOpExpansion={G:">=",L:"<=",M:"-",N:"<>",P:"+"},t.Formula.TypeLookupTable={unaryminus:{"n*":"|n*:1|","e*":"|e*:1|","t*":"|t*:e#VALUE!|",b:"|b:n|"},unaryplus:{"n*":"|n*:1|","e*":"|e*:1|","t*":"|t*:e#VALUE!|",b:"|b:n|"},unarypercent:{"n*":"|n:n%|n*:n|","e*":"|e*:1|","t*":"|t*:e#VALUE!|",b:"|b:n|"},plus:{"n%":"|n%:n%|nd:n|nt:n|ndt:n|n$:n|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|",nd:"|n%:n|nd:nd|nt:ndt|ndt:ndt|n$:n|n:nd|n*:n|b:n|e*:2|t*:e#VALUE!|",nt:"|n%:n|nd:ndt|nt:nt|ndt:ndt|n$:n|n:nt|n*:n|b:n|e*:2|t*:e#VALUE!|",ndt:"|n%:n|nd:ndt|nt:ndt|ndt:ndt|n$:n|n:ndt|n*:n|b:n|e*:2|t*:e#VALUE!|",n$:"|n%:n|nd:n|nt:n|ndt:n|n$:n$|n:n$|n*:n|b:n|e*:2|t*:e#VALUE!|",nl:"|n%:n|nd:n|nt:n|ndt:n|n$:n|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|",n:"|n%:n|nd:nd|nt:nt|ndt:ndt|n$:n$|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|",b:"|n%:n%|nd:nd|nt:nt|ndt:ndt|n$:n$|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|","t*":"|ni:1|n*:e#VALUE!|t*:e#VALUE!|b:e#VALUE!|e*:2|","n*":"|ni:1|e*:2|","e*":"|e*:1|n*:1|t*:1|b:1|"},concat:{t:"|t:t|th:th|tw:tw|tl:t|tr:tr|t*:2|e*:2|",th:"|t:th|th:th|tw:t|tl:th|tr:t|t*:t|e*:2|",tw:"|t:tw|th:t|tw:tw|tl:tw|tr:tw|t*:t|e*:2|",tl:"|t:tl|th:th|tw:tw|tl:tl|tr:tr|t*:t|e*:2|","t*":"|t*:t|e*:2|","e*":"|e*:1|n*:1|t*:1|"},oneargnumeric:{"n*":"|n*:n|","e*":"|e*:1|","t*":"|t*:e#VALUE!|",b:"|b:n|"},twoargnumeric:{"n*":"|n*:n|t*:e#VALUE!|e*:2|","e*":"|e*:1|n*:1|t*:1|","t*":"|t*:e#VALUE!|n*:e#VALUE!|e*:2|"},propagateerror:{"n*":"|n*:2|e*:2|","e*":"|e*:2|","t*":"|t*:2|e*:2|",b:"|b:2|e*:2|"}},t.Formula.ParseFormulaIntoTokens=function(e){var o,n,r,i,a,s,l,c,d=t.Formula,u=t.Constants,p=d.ParseState,h=d.TokenType,f=d.CharClass,m=d.CharClassTable,g=d.UpperCaseTable,v=d.ParsePushToken,y=/^\$?[A-Z]{1,2}\$?[1-9]\d*$/i,b=[],C="",w=0,i=!1;for(o=0;o<=e.length;o++)o<e.length?(n=e.charAt(o),r=m[n]):(n="",r=f.eof),w==p.num&&(r==f.num?C+=n:r!=f.numstart||i?"E"==n||"e"==n?(C+=n,i=!1,w=p.numexp1):(v(b,C,h.num,0),i=!1,w=0):(i=!0,C+=n)),w==p.numexp1&&(r==p.num?w=p.numexp2:"+"!=n&&"-"!=n||"E"!=g[C.charAt(C.length-1)]?"E"==n||"e"==n||(v(b,u.s_parseerrexponent,h.error,0),w=0):C+=n),w==p.numexp2&&(r==f.num?C+=n:(v(b,C,h.num,0),w=0)),w==p.alpha&&(r==f.num?w=p.coord:r==f.alpha||"."==n?C+=n:r==f.incoord?w=p.coord:r==f.op||r==f.numstart||r==f.space||r==f.eof?(v(b,C.toUpperCase(),h.name,0),w=0):(v(b,u.s_parseerrchar,h.error,0),w=0)),w==p.coord&&(r==f.num?C+=n:r==f.incoord?C+=n:r==f.alpha?w=p.alphanumeric:r==f.op||r==f.numstart||r==f.eof||r==f.space?(c=y.test(C)?h.coord:h.name,v(b,C.toUpperCase(),c,0),w=0):(v(b,u.s_parseerrchar,h.error,0),w=0)),w==p.alphanumeric&&(r==f.num||r==f.alpha?C+=n:r==f.op||r==f.numstart||r==f.space||r==f.eof?(v(b,C.toUpperCase(),h.name,0),w=0):(v(b,u.s_parseerrchar,h.error,0),w=0)),w==p.string?r==f.quote?w=p.stringquote:r==f.eof?(v(b,u.s_parseerrstring,h.error,0),w=0):C+=n:w==p.stringquote?r==f.quote?(C+=n,w=p.string):(v(b,C,h.string,0),w=0):w==p.specialvalue&&("!"==C.charAt(C.length-1)?(v(b,C,h.name,0),w=0):r==f.eof?(v(b,u.s_parseerrspecialvalue,h.error,0),w=0):C+=n),0==w&&(r==f.num?(C=n,w=p.num):r==f.numstart?(C=n,i=!0,w=p.num):r==f.alpha||r==f.incoord?(C=n,w=p.alpha):r==f.specialstart?(C=n,w=p.specialvalue):r==f.op?(C=n,b.length>0?(a=b[b.length-1],s=a.type,l=a.text,s==f.op&&("<"!=l&&">"!=l||(C=l+C,b.pop(),b.length>0?(a=b[b.length-1],s=a.type,l=a.text):(s=f.eof,l="EOF")))):(s=f.eof,l="EOF"),c=h.op,0==b.length||s==f.op&&")"!=l&&"%"!=l?"-"==C?(C="M",n="M"):"+"==C?(C="P",n="P"):")"==C&&"("==l||"("!=C&&(c=h.error,C=u.s_parseerrtwoops):C.length>1&&(">="==C?(C="G",n="G"):"<="==C?(C="L",n="L"):"<>"==C?(C="N",n="N"):(c=h.error,C=u.s_parseerrtwoops)),v(b,C,c,n),w=0):r==f.quote?(C="",w=p.string):r==f.space||r==f.eof||v(b,u.s_parseerrchar,h.error,0));return b},t.Formula.ParsePushToken=function(e,t,o,n){e.push({text:t,type:o,opcode:n})},t.Formula.evaluate_parsed_formula=function(e,o,n){var r,i=t.Formula;i.TokenType;return r=i.ConvertInfixToPolish(e),i.EvaluatePolish(e,r,o,n)},t.Formula.ConvertInfixToPolish=function(e){var o,n,r,i,a,s,l=t.Formula,c=t.Constants,d=l.TokenType,u=l.TokenPrecedence,p=[],h=[],f="",m=-1;for(o=0;o<e.length;o++)if(n=e[o],r=n.type,i=n.text,r==d.num||r==d.coord||r==d.string)p.push(o);else if(r==d.name)h.push(o),p.push(m);else{if(r==d.space)continue;if(","==i){for(;h.length&&"("!=e[h[h.length-1]].text;)p.push(h.pop());if(0==h.length){f=c.s_parseerrmissingopenparen;break}}else if("("==i)h.push(o);else if(")"==i){for(;h.length&&"("!=e[h[h.length-1]].text;)p.push(h.pop());if(0==h.length){f=c.s_parseerrcloseparennoopen;break}h.pop(),h.length&&e[h[h.length-1]].type==d.name&&p.push(h.pop())}else{if(r!=d.op){if(r==d.error){f=i;break}f="Internal error while processing parsed formula. ";break}for(h.length&&e[h[h.length-1]].type==d.name&&p.push(h.pop());h.length&&e[h[h.length-1]].type==d.op&&"("!=e[h[h.length-1]].text&&(a=u[n.opcode],s=u[e[h[h.length-1]].opcode],!(a>=0&&a<s))&&!(a<0&&(a=-a,s<0&&(s=-s),a<=s));)p.push(h.pop());h.push(o)}}for(;h.length>0;){if("("==e[h[h.length-1]].text){f=c.s_parseerrmissingcloseparen;break}p.push(h.pop())}return f||p},"undefined"==typeof t.debug_log&&(t.debug_log=[]),t.DebugLog=function(){},t.Formula.EvaluatePolish=function(e,o,n,r){var i,a,s,l,c,d,u,p,h,f,m,g,v,y,b=t.Formula,C=t.Constants,w=b.TokenType,x=b.LookupResultType,S=b.TypeLookupTable,_=b.OperandAsNumber,k=b.OperandAsText,T=b.OperandValueAndType,E=b.OperandsAsCoordOnSheet,F=t.format_number_for_display||function(e){return e+""},D="",M=-1,A={value:"",type:"e#VALUE!",error:C.s_parseerrmissingoperand},P=[],L=function(e,t){P.push({type:e,value:t})};if(!(e.length&&o instanceof Array))return{value:"",type:"e#VALUE!",error:"string"==typeof o?o:""};var R=[];for(i=0;i<o.length;i++)if((a=o[i])!=M)if(s=e[a],l=s.type,c=s.text,R.push(s),l==w.num)L("n",c-0);else if(l==w.coord)L("coord",c);else if(l==w.string)L("t",c);else if(l==w.op){if(P.length<=0)return A;if("M"==c)d=_(n,P),f=x(d.type,d.type,S.unaryminus),L(f,-d.value);else if("P"==c)d=_(n,P),f=x(d.type,d.type,S.unaryplus),L(f,d.value);else if("%"==c)d=_(n,P),f=x(d.type,d.type,S.unarypercent),L(f,.01*d.value);else if("&"==c){if(P.length<=1)return A;u=k(n,P),d=k(n,P),f=x(d.type,d.type,S.concat),L(f,d.value+u.value)}else if(":"==c){if(P.length<=1)return A;d=b.OperandsAsRangeOnSheet(n,P),d.error&&(D=D||d.error),L(d.type,d.value)}else if("!"==c){if(P.length<=1)return A;d=E(n,P),d.error&&(D=D||d.error),L(d.type,d.value)}else if("<"==c||"L"==c||"="==c||"G"==c||">"==c||"N"==c){if(P.length<=1){D=C.s_parseerrmissingoperand;break}u=T(n,P),d=T(n,P),"n"==d.type.charAt(0)&&"n"==u.type.charAt(0)?(g=0,"<"==c?g=d.value<u.value?1:0:"L"==c?g=d.value<=u.value?1:0:"="==c?g=d.value==u.value?1:0:"G"==c?g=d.value>=u.value?1:0:">"==c?g=d.value>u.value?1:0:"N"==c&&(g=d.value!=u.value?1:0),L("nl",g)):"e"==d.type.charAt(0)?L(d.type,0):"e"==u.type.charAt(0)?L(u.type,0):(p=d.type.charAt(0),h=u.type.charAt(0),"n"==p?d.value=F(d.value,"n",""):"b"==p&&(d.value=""),"n"==h?u.value=F(u.value,"n",""):"b"==h&&(u.value=""),g=0,d.value=d.value.toLowerCase(),u.value=u.value.toLowerCase(),"<"==c?g=d.value<u.value?1:0:"L"==c?g=d.value<=u.value?1:0:"="==c?g=d.value==u.value?1:0:"G"==c?g=d.value>=u.value?1:0:">"==c?g=d.value>u.value?1:0:"N"==c&&(g=d.value!=u.value?1:0),L("nl",g))}else{if(P.length<=1){D=C.s_parseerrmissingoperand;break}"+"==c?(u=T(n,P),d=T(n,P),f=x(d.type,u.type,S.plus),L(f,d.value+u.value)):(u=_(n,P),d=_(n,P)),"-"==c?(f=x(d.type,u.type,S.plus),L(f,d.value-u.value)):"*"==c?(f=x(d.type,u.type,S.plus),L(f,d.value*u.value)):"/"==c?0!=u.value?L("n",d.value/u.value):L("e#DIV/0!",0):"^"==c&&(d.value=Math.pow(d.value,u.value),d.type="n",isNaN(d.value)&&(d.value=0,d.type="e#NUM!"),L(d.type,d.value))}}else{if(l!=w.name){D=C.s_InternalError+"Unknown token "+l+" ("+c+"). ";break}if(D=b.CalculateFunction(c,P,n,e.coord))break}else L("start",0);return value=P[0]?P[0].value:"",p=P[0]?P[0].type:"","name"==p&&(d=t.Formula.LookupName(n,value),value=d.value,p=d.type,D=D||d.error),"coord"==p&&(d=T(n,P),value=d.value,"b"==(p=d.type)&&(p="n",value=0)),P.length>1&&!D&&(D+=C.s_parseerrerrorinformula),m=p,"e"==p.charAt(0)?D=D||p.substring(1)||C.s_calcerrerrorvalueinformula:"range"==p&&(v=value.match(/^(.*)\|(.*)\|/),y=v[1].indexOf("!"),v[1]=y>=0?v[1].substring(y+1)+"!"+v[1].substring(0,y).toUpperCase():v[1].toUpperCase(),value=v[1]+":"+v[2].toUpperCase(),r||(D=C.s_formularangeresult+" "+value)),D&&"e"!=m.charAt(0)&&(value=D,m="e"),"n"!=m.charAt(0)||!isNaN(value)&&isFinite(value)||(value=0,m="e#NUM!",D=isNaN(value)?C.s_calcerrnumericnan:C.s_calcerrnumericoverflow),{value:value,type:m,error:D}},t.Formula.LookupResultType=function(e,t,o){var n,r,i,a=o[e];return a||(a=o[e.charAt(0)+"*"])?(n=a.indexOf("|"+t+":"))>=0?(r=a.indexOf("|",n+1))<0?"e#VALUE! (internal error, incorrect LookupResultType "+a+")":(i=a.substring(n+t.length+2,r),"1"==i?e:"2"==i?t:i):(n=a.indexOf("|"+t.charAt(0)+"*:"),n>=0?(r=a.indexOf("|",n+1))<0?"e#VALUE! (internal error, incorrect LookupResultType "+a+")":(i=a.substring(n+4,r),"1"==i?e:"2"==i?t:i):"e#VALUE!"):"e#VALUE! (internal error, missing LookupResultType "+e.charAt(0)+"*)"},t.Formula.TopOfStackValueAndType=function(e,o){var n=t.Formula,r={type:"",value:""},i=o.length;return i?(r.value=o[i-1].value,r.type=o[i-1].type,o.pop(),"name"==r.type&&(r=n.LookupName(e,r.value)),r):(r.error=t.Constants.s_InternalError+"no operand on stack",r)},t.Formula.OperandAsNumber=function(e,o){var n,r,i=t.Formula.OperandValueAndType(e,o);return n=i.type.charAt(0),"n"==n?i.value=i.value-0:"b"==n?(i.type="n",i.value=0):"e"==n?i.value=0:(r=t.DetermineValueType?t.DetermineValueType(i.value):{value:i.value-0,type:"n"},"n"==r.type.charAt(0)?(i.value=r.value-0,i.type=r.type):(i.value=0,i.type=r.type)),i},t.Formula.OperandAsText=function(e,o){var n,r=t.Formula.OperandValueAndType(e,o);return n=r.type.charAt(0),"t"==n||("n"==n?(r.value=t.format_number_for_display?t.format_number_for_display(r.value,r.type,""):r.value=r.value+"",r.type="t"):"b"==n?(r.value="",r.type="t"):"e"==n?r.value="":(o.value=r.value+"",o.type="t")),r},t.Formula.OperandValueAndType=function(e,o){var n,r,i,a,s=t.Formula,l={type:"",value:""},c=o.length;if(!c)return l.error=t.Constants.s_InternalError+"no operand on stack",l;if(l.value=o[c-1].value,l.type=o[c-1].type,o.pop(),"name"==l.type&&(l=s.LookupName(e,l.value)),"range"==l.type&&(l=s.StepThroughRangeDown(o,l.value)),"coord"==l.type){if(a=e,-1!=(i=l.value.indexOf("!"))){if(null==(a=s.FindInSheetCache(l.value.substring(i+1))))return l.type="e#REF!",l.error=t.Constants.s_sheetunavailable+" "+l.value.substring(i+1),l.value=0,l;l.value=l.value.substring(0,i)}a?(r=a.cells[t.Formula.PlainCoord(l.value)],r?(n=r.valuetype,l.value=r.datavalue):n="b"):(n="e#N/A",l.value=0),l.type=n||"b","b"==l.type&&(l.value=0)}return l},t.Formula.OperandAsCoord=function(e,o){return t.Formula.OperandAsType(e,o,"coord")},t.Formula.OperandAsRange=function(e,o){return t.Formula.OperandAsType(e,o,"range")},t.Formula.OperandAsType=function(e,o,n){var r=(t.Formula,{type:"",value:""}),i=o.length;return r.value=o[i-1].value,r.type=o[i-1].type,o.pop(),"name"==r.type&&(r=t.Formula.LookupName(e,r.value)),r.type==n?r:(r.value=t.Constants.s_calcerrcellrefmissing,r.type="e#REF!",r)},t.Formula.OperandsAsCoordOnSheet=function(e,o){var n,r,i,a,s={},l={},c=t.Formula,d=o.length;return s.value=o[d-1].value,s.type=o[d-1].type,o.pop(),n=c.OperandAsSheetName(e,o),null==(r=c.FindInSheetCache(n.value))?(l.type="e#REF!",l.value=0,l.error=t.Constants.s_sheetunavailable+" "+n.value,l):("name"==s.type&&(s=c.LookupName(r,s.value)),l.type=s.type,"coord"==s.type?l.value=s.value+"!"+n.value:"range"==s.type?(i=s.value.indexOf("|"),a=s.value.indexOf("|",i+1),l.value=s.value.substring(0,i)+"!"+n.value+"|"+s.value.substring(i+1,a)+"|"):"e"==s.type.charAt(0)?l.value=s.value:(l.error=t.Constants.s_calcerrcellrefmissing,l.type="e#REF!",l.value=0),l)},t.Formula.OperandsAsRangeOnSheet=function(e,o){var n,r,i,a,s={},l=t.Formula,c=t.Constants,d=o.length;return s.value=o[d-1].value,s.type=o[d-1].type,o.pop(),n=l.OperandAsCoord(e,o),"coord"!=n.type?{value:0,type:"e#REF!"}:(r=e,-1!=(i=n.value.indexOf("!"))&&(a=n.value.indexOf("|",i+1),a<0&&(a=n.value.length),null==(r=l.FindInSheetCache(n.value.substring(i+1,a))))?{value:0,type:"e#REF!",errortext:c.s_sheetunavailable+" "+n.value.substring(i+1,a)}:("name"==s.type&&(s=l.LookupName(r,s.value,"end")),"coord"==s.type?{value:n.value+"|"+s.value+"|",type:"range"}:{value:c.s_calcerrcellrefmissing,type:"e#REF!"}))},t.Formula.OperandAsSheetName=function(e,o){var n,r,i=(t.Formula,{type:"",value:""}),a=o.length;if(i.value=o[a-1].value,i.type=o[a-1].type,o.pop(),"name"==i.type){if(n=t.Formula.LookupName(e,i.value),!n.value)return i;i.value=n.value,i.type=n.type}return"coord"==i.type&&(r=e.cells[t.Formula.PlainCoord(i.value)],r?(i.value=r.datavalue,i.type=r.valuetype):(i.value="",i.type="b")),"t"==i.type.charAt(0)?i:(i.value="",i.error=t.Constants.s_calcerrsheetnamemissing,i)},t.Formula.LookupName=function(e,o,n){var r,i,a,s=e.names,l={},c=!1;if(s[o.toUpperCase()]){if(l.value=s[o.toUpperCase()].definition,"="==l.value.charAt(0)){if(e.checknamecirc){if(e.checknamecirc[o])return l.type="e#NAME?",l.error=t.Constants.s_circularnameref+' "'+o+'".',l}else e.checknamecirc={},c=!0;if(e.checknamecirc[o]=!0,a=t.Formula.ParseFormulaIntoTokens(l.value.substring(1)),l=t.Formula.evaluate_parsed_formula(a,e,1),delete e.checknamecirc[o],c&&delete e.checknamecirc,"range"!=l.type)return l}return r=l.value.indexOf(":"),-1!=r?(l.type="range",l.value=l.value.substring(0,r)+"|"+l.value.substring(r+1)+"|",l.value=l.value.toUpperCase()):(l.type="coord",l.value=l.value.toUpperCase()),l}return(i=t.Formula.SpecialConstants[o.toUpperCase()])?(r=i.indexOf(","),l.value=i.substring(0,r)-0,l.type=i.substring(r+1),l):/^[a-zA-Z][a-zA-Z]?$/.test(o)?(l.type="coord",l.value=o.toUpperCase()+(n?e.attribs.lastrow:1),l):(l.value="",l.type="e#NAME?",l.error=t.Constants.s_calcerrunknownname+' "'+o+'"',l)},t.Formula.StepThroughRangeDown=function(e,o){var n,r,i,a,s,l,c,d,u,p,h=t.Formula;for(a=o.indexOf("|"),s=o.indexOf("|",a+1),n=o.substring(0,a),r=o.substring(a+1,s),i=o.substring(s+1)-0,a=n.indexOf("!"),-1!=a?(l=n.substring(a),n=n.substring(0,a)):l="",a=r.indexOf("!"),-1!=a&&(r=r.substring(0,a)),c=h.OrderRangeParts(n,r),p=0,u=c.r1;u<=c.r2;u++)for(d=c.c1;d<=c.c2;d++)if(++p>i)return u==c.r2&&d==c.c2||h.PushOperand(e,"range",n+l+"|"+r+"|"+p),{value:t.crToCoord(d,u)+l,type:"coord"}},t.Formula.DecodeRangeParts=function(e,o){var n,r,i,a,s,l,c,d=t.Formula;return i=o.indexOf("|"),a=o.indexOf("|",i+1),n=o.substring(0,i),r=o.substring(i+1,a),i=n.indexOf("!"),-1!=i?(s=n.substring(i+1),n=n.substring(0,i)):s="",i=r.indexOf("!"),-1!=i&&(r=r.substring(0,i)),l=e,s&&null==(l=d.FindInSheetCache(s))?null:(c=d.OrderRangeParts(n,r),{sheetdata:l,sheetname:s,col1num:c.c1,ncols:c.c2-c.c1+1,row1num:c.r1,nrows:c.r2-c.r1+1})},t.Formula.FunctionList||(t.Formula.FunctionList={}),t.Formula.FunctionClasses=null,t.Formula.FunctionArgDefs={},t.Formula.StoreIoEventFormula=function(e,o,n,r,i){var a=[];if(t.Formula.Clone(a,n),a.reverse(),0!=a.length){if("undefined"==typeof r.ioEventTree&&(r.ioEventTree={}),"undefined"==typeof r.ioParameterList&&(r.ioParameterList={}),"undefined"==typeof r.ioTimeTriggerList&&(r.ioTimeTriggerList={}),"undefined"==typeof r.radioGroupList&&(r.radioGroupList={}),"undefined"==typeof r.ioParameterList[o]&&(r.ioParameterList[o]={}),r.ioParameterList[o]=a,r.ioParameterList[o].function_name=e,"TimeTrigger"==i){var s=function(e,t,o){var n=o.cells[t];void 0!==n&&"n"==n.valuetype.charAt(0)&&e.push(n.datavalue)},l=t.Formula.PlainCoord(a[0].value),c=[];if("range"==a[0].type)for(var d=t.Formula.DecodeRangeParts(r,l),u=0;u<d.ncols;u++)for(var p=0;p<d.nrows;p++){var h=t.crToCoord(d.col1num+u,d.row1num+p);s(c,h,r)}if("coord"==a[0].type&&s(c,l,r),"n"==a[0].type.charAt(0)&&c.push(a[0].value),"undefined"==typeof r.ioTimeTriggerList[o]||0==t.Formula.ArrayValuesEqual(r.ioTimeTriggerList[o],c)){r.ioTimeTriggerList[o]=c;for(var f=(new Date).getTimezoneOffset(),m=25569,g=[],v=0;v<c.length;++v)g[v]=Math.floor(24*(c[v]-m)*60+f);r.ScheduleSheetCommands("settimetrigger "+o+" "+g.toString())}}if("EventTree"==i&&("coord"==a[0].type||"range"==a[0].type)){var y=a[0].value.replace(/\$/g,""),b=function(e,t,o){"undefined"==typeof e[t]&&(e[t]={}),e[t][o]=o};if("range"==a[0].type)for(var d=t.Formula.DecodeRangeParts(r,y),u=0;u<d.ncols;u++)for(var p=0;p<d.nrows;p++){var C=t.crToCoord(d.col1num+u,d.row1num+p);b(r.ioEventTree,C,o)}"coord"==a[0].type&&b(r.ioEventTree,y,o)}if("Input"==i){var w=null!=t.CurrentSpreadsheetControlObject?t.CurrentSpreadsheetControlObject.formDataViewer:t.CurrentSpreadsheetViewerObject.formDataViewer;if(null!=w&&1==w.loaded){null==w.formFields&&t.Formula.LoadFormFields();var x=(e+o).toLowerCase(),S=null;if(null==w.formFields[x]){var _=w.formFields[x]=2+w.formFieldsLength++;S="set "+t.crToCoord(_,1)+" text t "+t.encodeForSave(e.toLowerCase()+o)}if("t"==a[0].type.charAt(0)||"n"==a[0].type.charAt(0)){var k=t.crToCoord(w.formFields[x],2);if(null==w.sheet.cells[k]||w.sheet.cells[k].datavalue!=a[0].value){var T="set "+k+" text t "+t.encodeForSave(a[0].value);S=null!=S?S+"\n"+T:T}}null!=S&&w.sheet.ScheduleSheetCommands(S,!1)}}}},t.Formula.ArrayValuesEqual=function(e,t){var o=e.length;if(o!=t.length)return!1;for(;o--;)if(e[o]!==t[o])return!1;return!0},t.Formula.Clone=function(e,o){for(var n in o)"object"==typeof o[n]&&null!==o[n]&&e[n]?t.Formula.Clone(e[n],o[n]):e[n]=o[n]},t.Formula.LoadFormFields=function(){var e=null!=t.CurrentSpreadsheetControlObject?t.CurrentSpreadsheetControlObject.formDataViewer:t.CurrentSpreadsheetViewerObject.formDataViewer;e.formFields={},null==e.sheet.cells.A1&&e.sheet.ScheduleSheetCommands("set A1 text t "+t.encodeForSave("FieldName:"),!1),null==e.sheet.cells.A2&&e.sheet.ScheduleSheetCommands("set A2 text t "+t.encodeForSave("Pending:"),!1);for(var o=2;;){var n=t.crToCoord(o,1),r=e.sheet.cells[n];if(!r)break;e.formFields[r.datavalue.toLowerCase()]=o,o++}e.formFieldsLength=o-2},t.Formula.CalculateFunction=function(e,o,n,r){var i,a,s,l,c,d=t.Formula,u="";if(i=d.FunctionList[e]){if(a=[],s=i[0],l=i[1],d.CopyFunctionArgs(o,a),i[6]&&""!=i[6]&&(t.DebugLog("action:"+e),d.StoreIoEventFormula(e,r,a,n,i[6])),100!=l)if(l<0){if(a.length<-l)return u=d.FunctionArgsError(e,o)}else if(a.length!=l)return u=d.FunctionArgsError(e,o);u=s(e,o,a,n,r)}else c=e,o.length&&"start"==o[o.length-1].type?(o.pop(),d.PushOperand(o,"name",c)):u=t.Constants.s_sheetfuncunknownfunction+" "+c+". ";return u},t.Formula.PushOperand=function(e,t,o){e.push({type:t,value:o})},t.Formula.CopyFunctionArgs=function(e,o){var o;for(t.Formula;e.length>0&&"start"!=e[e.length-1].type;)o.push(e.pop());e.pop()},t.Formula.FunctionArgsError=function(e,o){var n=t.Constants.s_calcerrincorrectargstofunction+" "+e+". ";return t.Formula.PushOperand(o,"e#VALUE!",n),n},t.Formula.FunctionSpecificError=function(e,o,n,r){return t.Formula.PushOperand(o,n,r),r},t.Formula.CheckForErrorValue=function(e,t){return"e"==t.type.charAt(0)&&(e.push(t),!0)},t.Formula.FillFunctionInfo=function(){var e,o,n,r,i,a=t.Formula,s=t.Constants;if(!a.FunctionClasses){for(e in a.FunctionList)o=a.FunctionList[e],o[2]&&(a.FunctionArgDefs[o[2]]=s["s_farg_"+o[2]]||""),o[3]||s["s_fdef_"+e]&&(a.FunctionList[e][3]=s["s_fdef_"+e]);for(a.FunctionClasses={},i=0;i<s.function_classlist.length;i++)r=s.function_classlist[i],a.FunctionClasses[r]={name:s["s_fclass_"+r],items:[]};for(e in a.FunctionList)for(o=a.FunctionList[e],n=o[4]?o[4].split(","):[],n.push("all"),i=0;i<n.length;i++)r=n[i],a.FunctionClasses[r].items.push(e);for(r in a.FunctionClasses)a.FunctionClasses[r].items.sort()}},t.Formula.FunctionArgString=function(e){var o,n,r,i=t.Formula,a=i.FunctionList[e],s=a[2];if(!s){if(0!=(o=a[1])){if(o>0){for(r="v1",n=2;n<=o;n++)r+=", v"+n;return r}if(o<0){for(r="v1",n=2;n<-o;n++)r+=", v"+n;return r+", ..."}return"nargs: "+o}s=" "}return r=i.FunctionArgDefs[s]||s},t.Formula.SeriesFunctions=function(e,o,n,r){for(var i,a,s,l,c,d,u,p,h,f=t.Formula,m=f.OperandValueAndType,g=f.LookupResultType,v=f.TypeLookupTable.plus,y=function(e,t){o.push({type:e,value:t})},b=0,C="",w=0,x=0,S=0,_=1;n.length>0;)i=m(r,n),a=i.type.charAt(0),"n"==a&&(w+=1),"b"!=a&&(x+=1),"b"==a&&(S+=1),"n"==a?(s=i.value-0,b+=s,_*=s,l=l!=undefined?s>l?s:l:s,c=c!=undefined?s<c?s:c:s,1==w?(p=s,h=0):(d=p+(s-p)/w,u=h+(s-p)*(s-d),h=u,p=d),C=g(i.type,C||i.type,v)):"e"==a&&"e"!=C.charAt(0)&&(C=i.type);switch(C=C||"n",e){case"SUM":y(C,b);break;case"PRODUCT":y(C,_);break;case"MIN":y(C,c||0);break;case"MAX":y(C,l||0);break;case"COUNT":y("n",w);break;case"COUNTA":y("n",x);break;case"COUNTBLANK":y("n",S);break;case"AVERAGE":w>0?y(C,b/w):y("e#DIV/0!",0);break;case"STDEV":w>1?y(C,Math.sqrt(u/(w-1))):y("e#DIV/0!",0);break;case"STDEVP":w>1?y(C,Math.sqrt(u/w)):y("e#DIV/0!",0);break;case"VAR":w>1?y(C,u/(w-1)):y("e#DIV/0!",0);break;case"VARP":w>1?y(C,u/w):y("e#DIV/0!",0)}return null},t.Formula.FunctionList.AVERAGE=[t.Formula.SeriesFunctions,-1,"vn",null,"stat"],t.Formula.FunctionList.COUNT=[t.Formula.SeriesFunctions,-1,"vn",null,"stat"],t.Formula.FunctionList.COUNTA=[t.Formula.SeriesFunctions,-1,"vn",null,"stat"],t.Formula.FunctionList.COUNTBLANK=[t.Formula.SeriesFunctions,-1,"vn",null,"stat"],t.Formula.FunctionList.MAX=[t.Formula.SeriesFunctions,-1,"vn",null,"stat"],t.Formula.FunctionList.MIN=[t.Formula.SeriesFunctions,-1,"vn",null,"stat"],t.Formula.FunctionList.PRODUCT=[t.Formula.SeriesFunctions,-1,"vn",null,"stat"],t.Formula.FunctionList.STDEV=[t.Formula.SeriesFunctions,-1,"vn",null,"stat"],t.Formula.FunctionList.STDEVP=[t.Formula.SeriesFunctions,-1,"vn",null,"stat"],t.Formula.FunctionList.SUM=[t.Formula.SeriesFunctions,-1,"vn",null,"stat"],t.Formula.FunctionList.VAR=[t.Formula.SeriesFunctions,-1,"vn",null,"stat"],t.Formula.FunctionList.VARP=[t.Formula.SeriesFunctions,-1,"vn",null,"stat"],t.Formula.SumProductFunction=function(e,o,n,r){for(var a,s=[],l=0,c=t.Formula,d=0,u=0,p=function(e,t){o.push({type:e,value:t})};n.length>0;){if(a=c.TopOfStackValueAndType(r,n),"range"!=a.type)return void p("e#VALUE!",0);if(rangeinfo=c.DecodeRangeParts(r,a.value),d){if(d!=rangeinfo.ncols)return void p("e#VALUE!",0)}else d=rangeinfo.ncols;if(u){if(u!=rangeinfo.nrows)return void p("e#VALUE!",0)}else u=rangeinfo.nrows;for(i=0;i<rangeinfo.ncols;i++)for(j=0;j<rangeinfo.nrows;j++)k=i*rangeinfo.nrows+j,cellcr=t.crToCoord(rangeinfo.col1num+i,rangeinfo.row1num+j),cell=rangeinfo.sheetdata.GetAssuredCell(cellcr),value="n"==cell.valuetype?cell.datavalue:0,s[k]=("undefined"!=typeof s[k]?s[k]:1)*value}for(i=0;i<s.length;i++)l+=s[i];p("n",l)},t.Formula.FunctionList.SUMPRODUCT=[t.Formula.SumProductFunction,-1,"rangen","","stat"],t.Formula.DSeriesFunctions=function(e,o,n,r){var i,a,s,l,c,d,u,p,h,f,m,g,v,y,b,C,w,x,S,_,k,T,E,F,D,M,A=t.Formula,P=(A.OperandValueAndType,A.LookupResultType),L=A.TypeLookupTable.plus,R=function(e,t){o.push({type:e,value:t})},i={},I=0,O="",$=0,N=0,U=0,j=0,H=1;if(s=A.TopOfStackValueAndType(r,n),l=A.OperandValueAndType(r,n),c=A.TopOfStackValueAndType(r,n),"range"!=s.type||"range"!=c.type)return A.FunctionArgsError(e,o);if(d=A.DecodeRangeParts(r,s.value),u=A.DecodeRangeParts(r,c.value),(p=A.FieldToColnum(d.sheetdata,d.col1num,d.ncols,d.row1num,l.value,l.type))<=0)return void R("e#VALUE!",0);for(h=d.col1num+p-1,y=[],f=0;f<u.ncols;f++){if(v=u.sheetdata.GetAssuredCell(t.crToCoord(u.col1num+f,u.row1num)),criterianum=A.FieldToColnum(d.sheetdata,d.col1num,d.ncols,d.row1num,v.datavalue,v.valuetype),criterianum<=0)return void R("e#VALUE!",0);y.push(d.col1num+criterianum-1)}for(f=1;f<d.nrows;f++){b=!1;e:for(m=1;m<u.nrows;m++){for(g=0;g<u.ncols;g++)if(C=t.crToCoord(u.col1num+g,u.row1num+m),v=u.sheetdata.GetAssuredCell(C),("string"!=typeof(w=v.datavalue)||0!=w.length)&&(x=y[g],S=t.crToCoord(x,d.row1num+f),v=d.sheetdata.GetAssuredCell(S),!A.TestCriteria(v.datavalue,v.valuetype||"b",w)))continue e;b=!0;break e}b&&(a=t.crToCoord(h,d.row1num+f),v=d.sheetdata.GetAssuredCell(a),i.value=v.datavalue,i.type=v.valuetype,_=i.type.charAt(0),j+=1,"n"==_&&($+=1),"b"!=_&&(N+=1),"b"==_&&(U+=1),"n"==_?(v1=i.value-0,I+=v1,H*=v1,k=k!=undefined?v1>k?v1:k:v1,T=T!=undefined?v1<T?v1:T:v1,1==$?(D=v1,M=0):(E=D+(v1-D)/$,F=M+(v1-D)*(v1-E),M=F,D=E),O=P(i.type,O||i.type,L)):"e"==_&&"e"!=O.charAt(0)&&(O=i.type))}switch(O=O||"n",e){case"DSUM":R(O,I);break;case"DPRODUCT":R(O,H);break;case"DMIN":R(O,T||0);break;case"DMAX":R(O,k||0);break;case"DCOUNT":R("n",$);break;case"DCOUNTA":R("n",N);break;case"DAVERAGE":$>0?R(O,I/$):R("e#DIV/0!",0);break;case"DSTDEV":$>1?R(O,Math.sqrt(F/($-1))):R("e#DIV/0!",0);break;case"DSTDEVP":$>1?R(O,Math.sqrt(F/$)):R("e#DIV/0!",0);break;case"DVAR":$>1?R(O,F/($-1)):R("e#DIV/0!",0);break;case"DVARP":$>1?R(O,F/$):R("e#DIV/0!",0);break;case"DGET":1==j?R(i.type,i.value):0==j?R("e#VALUE!",0):R("e#NUM!",0)}},t.Formula.FunctionList.DAVERAGE=[t.Formula.DSeriesFunctions,3,"dfunc","","stat"],t.Formula.FunctionList.DCOUNT=[t.Formula.DSeriesFunctions,3,"dfunc","","stat"],t.Formula.FunctionList.DCOUNTA=[t.Formula.DSeriesFunctions,3,"dfunc","","stat"],t.Formula.FunctionList.DGET=[t.Formula.DSeriesFunctions,3,"dfunc","","stat"],t.Formula.FunctionList.DMAX=[t.Formula.DSeriesFunctions,3,"dfunc","","stat"],t.Formula.FunctionList.DMIN=[t.Formula.DSeriesFunctions,3,"dfunc","","stat"],t.Formula.FunctionList.DPRODUCT=[t.Formula.DSeriesFunctions,3,"dfunc","","stat"],t.Formula.FunctionList.DSTDEV=[t.Formula.DSeriesFunctions,3,"dfunc","","stat"],t.Formula.FunctionList.DSTDEVP=[t.Formula.DSeriesFunctions,3,"dfunc","","stat"],t.Formula.FunctionList.DSUM=[t.Formula.DSeriesFunctions,3,"dfunc","","stat"],t.Formula.FunctionList.DVAR=[t.Formula.DSeriesFunctions,3,"dfunc","","stat"],t.Formula.FunctionList.DVARP=[t.Formula.DSeriesFunctions,3,"dfunc","","stat"],t.Formula.FieldToColnum=function(e,o,n,r,i,a){var s,l,c;if("n"==a.charAt(0))return s=i-0,s<=0||s>n?0:Math.floor(s);if("t"!=a.charAt(0))return 0;for(i=i?i.toLowerCase():"",s=0;s<n;s++)if(l=e.GetAssuredCell(t.crToCoord(o+s,r)),c=l.datavalue,(c=(c+"").toLowerCase())==i)return s+1;return 0},t.Formula.LookupFunctions=function(e,o,n,r){var i,a,s,l,c,d,u,p,h,f,m,g,v,y,b,C,i,w=t.Formula,x=w.OperandValueAndType,S=(w.LookupResultType,w.TypeLookupTable.plus,function(e,t){o.push({type:e,value:t})});if(i=x(r,n),"string"==typeof i.value&&(i.value=i.value.toLowerCase()),a=w.TopOfStackValueAndType(r,n),s=1,"MATCH"==e){if(n.length){if(s=w.OperandAsNumber(r,n),"n"!=s.type.charAt(0))return void S("e#VALUE!",0);if(n.length)return w.FunctionArgsError(e,o),0;s=s.value-0}}else{if(l=w.OperandAsNumber(r,n),"n"!=l.type.charAt(0))return void S("e#VALUE!",0);if(l=Math.floor(l.value),n.length){if(s=w.OperandAsNumber(r,n),"n"!=s.type.charAt(0))return void S("e#VALUE!",0);if(n.length)return w.FunctionArgsError(e,o),0;s=s.value?1:0}}if(i.type=i.type.charAt(0),"n"==i.type&&(i.value=i.value-0),"range"!=a.type)return w.FunctionArgsError(e,o),0;if(!(c=w.DecodeRangeParts(r,a.value,a.type)))return void S("e#REF!",0);if(d=0,u=0,p=0,h=0,"HLOOKUP"==e){if(p=1,l>c.nrows)return void S("e#REF!",0)}else if("VLOOKUP"==e){if(h=1,l>c.ncols)return void S("e#REF!",0)}else{if("MATCH"!=e)return w.FunctionArgsError(e,o),0;if(c.ncols>1){if(c.nrows>1)return void S("e#N/A",0);p=1}else h=1}if(l<1&&"MATCH"!=e)return S("e#VALUE!",0),0;for(;;){if(C=t.crToCoord(c.col1num+d,c.row1num+u),v=c.sheetdata.GetAssuredCell(C),y=v.datavalue,b=v.valuetype?v.valuetype.charAt(0):"b","n"==b&&(y-=0),s){if("n"==i.type&&"n"==b){if(i.value==y)break;if(s>0&&i.value>y||s<0&&i.value<y)f=1,m=d,g=u;else if(f){f=2;break}}else if("t"==i.type&&"t"==b){if(y="string"==typeof y?y.toLowerCase():"",i.value==y)break;if(s>0&&i.value>y||s<0&&i.value<y)f=1,m=d,g=u;else if(f){f=2;break}}}else if("n"==i.type&&"n"==b){if(i.value==y)break}else if("t"==i.type&&"t"==b&&(y="string"==typeof y?y.toLowerCase():"",i.value==y))break;if(u+=h,d+=p,u>=c.nrows||d>=c.ncols){if(f){f=2;break}return void S("e#N/A",0)}}2==f&&(u=g,d=m),"MATCH"==e?(y=d+u+1,b="n"):(C=t.crToCoord(c.col1num+d+("VLOOKUP"==e?l-1:0),c.row1num+u+("HLOOKUP"==e?l-1:0)),v=c.sheetdata.GetAssuredCell(C),y=v.datavalue,b=v.valuetype),S(b,y)},t.Formula.FunctionList.HLOOKUP=[t.Formula.LookupFunctions,-3,"hlookup","","lookup"],t.Formula.FunctionList.MATCH=[t.Formula.LookupFunctions,-2,"match","","lookup"],t.Formula.FunctionList.VLOOKUP=[t.Formula.LookupFunctions,-3,"vlookup","","lookup"],t.Formula.IndexFunction=function(e,o,n,r){var i,a,s,l,c,d,u,p=t.Formula,h=function(e,t){o.push({type:e,value:t})};if(i=p.TopOfStackValueAndType(r,n),"range"!=i.type)return p.FunctionArgsError(e,o),0;if(s=p.DecodeRangeParts(r,i.value,i.type),a=s.sheetname?"!"+s.sheetname:"",l={value:0},c={value:0},n.length){if(l=p.OperandAsNumber(r,n),"n"!=l.type.charAt(0)||l.value<0)return void h("e#VALUE!",0);if(n.length){if(c=p.OperandAsNumber(r,n),"n"!=c.type.charAt(0)||c.value<0)return void h("e#VALUE!",0);if(n.length)return p.FunctionArgsError(e,o),0}else 1==s.nrows&&(c.value=l.value,l.value=0)}if(l.value>s.nrows||c.value>s.ncols)return void h("e#REF!",0);0==l.value?0==c.value?1==s.nrows&&1==s.ncols?(d=t.crToCoord(s.col1num,s.row1num)+a,u="coord"):(d=t.crToCoord(s.col1num,s.row1num)+a+"|"+t.crToCoord(s.col1num+s.ncols-1,s.row1num+s.nrows-1)+"|",u="range"):1==s.nrows?(d=t.crToCoord(s.col1num+c.value-1,s.row1num)+a,u="coord"):(d=t.crToCoord(s.col1num+c.value-1,s.row1num)+a+"|"+t.crToCoord(s.col1num+c.value-1,s.row1num+s.nrows-1)+"|",u="range"):0==c.value?1==s.ncols?(d=t.crToCoord(s.col1num,s.row1num+l.value-1)+a,u="coord"):(d=t.crToCoord(s.col1num,s.row1num+l.value-1)+a+"|"+t.crToCoord(s.col1num+s.ncols-1,s.row1num+l.value-1)+"|",u="range"):(d=t.crToCoord(s.col1num+c.value-1,s.row1num+l.value-1)+a,u="coord"),h(u,d)},t.Formula.FunctionList.INDEX=[t.Formula.IndexFunction,-1,"index","","lookup"],t.Formula.CountifSumifFunctions=function(e,o,n,r){var i,a,s,l,c,d,u=0,p="",h=0,f=t.Formula,m=f.OperandValueAndType,g=f.LookupResultType,v=f.TypeLookupTable.plus,y=function(e,t){o.push({type:e,value:t})};if(i=f.TopOfStackValueAndType(r,n),a=f.OperandAsText(r,n),"SUMIF"==e)if(1==n.length)s=f.TopOfStackValueAndType(r,n);else{if(0!=n.length)return f.FunctionArgsError(e,o),0;s={value:i.value,type:i.type}}else s={value:i.value,type:i.type};if("n"==a.type.charAt(0)?a.value=a.value+"":"e"==a.type.charAt(0)?a.value=null:"b"==a.type.charAt(0)&&(a.value=null),"coord"!=i.type&&"range"!=i.type)return f.FunctionArgsError(e,o),0;if("SUMIF"==e&&"coord"!=s.type&&"range"!=s.type)return f.FunctionArgsError(e,o),0;for(n.push(i),l=[],l.push(s);n.length;)c=m(r,n),d=m(r,l),f.TestCriteria(c.value,c.type,a.value)&&(h+=1,"n"==d.type.charAt(0)?(u+=d.value-0,p=g(d.type,p||d.type,v)):"e"==d.type.charAt(0)&&"e"!=p.charAt(0)&&(p=d.type));p=p||"n","SUMIF"==e?y(p,u):"COUNTIF"==e&&y("n",h)},t.Formula.FunctionList.COUNTIF=[t.Formula.CountifSumifFunctions,2,"rangec","","stat"],t.Formula.FunctionList.SUMIF=[t.Formula.CountifSumifFunctions,-2,"sumif","","stat"],t.Formula.IfFunction=function(e,o,n,r){var i,a;if(i=t.Formula.OperandValueAndType(r,n),"n"!=(a=i.type.charAt(0))&&"b"!=a)return void o.push({type:"e#VALUE!",value:0});var s,l;if(s=n.pop(),1==n.length)l=n.pop();else{if(0!=n.length)return void scf.FunctionArgsError(e,o);l={type:"n",value:0}}o.push(i.value?s:l)},t.Formula.FunctionList.IF=[t.Formula.IfFunction,-2,"iffunc","","test"],t.Formula.DateFunction=function(e,o,n,r){var i=t.Formula,a=0,s=i.OperandAsNumber(r,n),l=i.OperandAsNumber(r,n),c=i.OperandAsNumber(r,n),d=i.LookupResultType(s.type,l.type,i.TypeLookupTable.twoargnumeric);d=i.LookupResultType(d,c.type,i.TypeLookupTable.twoargnumeric),
"n"==d.charAt(0)&&(a=t.FormatNumber.convert_date_gregorian_to_julian(Math.floor(s.value),Math.floor(l.value),Math.floor(c.value))-t.FormatNumber.datevalues.julian_offset,d="nd"),i.PushOperand(o,d,a)},t.Formula.FunctionList.DATE=[t.Formula.DateFunction,3,"date","","datetime"],t.Formula.TimeFunction=function(e,o,n,r){var i=t.Formula,a=0,s=i.OperandAsNumber(r,n),l=i.OperandAsNumber(r,n),c=i.OperandAsNumber(r,n),d=i.LookupResultType(s.type,l.type,i.TypeLookupTable.twoargnumeric);d=i.LookupResultType(d,c.type,i.TypeLookupTable.twoargnumeric),"n"==d.charAt(0)&&(a=(60*s.value*60+60*l.value+c.value)/86400,d="nt"),i.PushOperand(o,d,a)},t.Formula.FunctionList.TIME=[t.Formula.TimeFunction,3,"hms","","datetime"],t.Formula.DMYFunctions=function(e,o,n,r){var i,a,s,l=t.Formula,c=0,d=l.OperandAsNumber(r,n),u=l.LookupResultType(d.type,d.type,l.TypeLookupTable.oneargnumeric);if("n"==u.charAt(0))switch(i=t.FormatNumber.convert_date_julian_to_gregorian(Math.floor(d.value+t.FormatNumber.datevalues.julian_offset)),e){case"DAY":c=i.day;break;case"MONTH":c=i.month;break;case"YEAR":c=i.year;break;case"WEEKDAY":if(a={value:1},n.length){if(a=l.OperandAsNumber(r,n),"n"!=a.type.charAt(0)||a.value<1||a.value>3)return void l.PushOperand(o,"e#VALUE!",0);if(n.length)return void l.FunctionArgsError(e,o)}s=6,a.value>1&&(s-=1),c=Math.floor(d.value+s)%7+(a.value<3?1:0)}l.PushOperand(o,u,c)},t.Formula.FunctionList.DAY=[t.Formula.DMYFunctions,1,"v","","datetime"],t.Formula.FunctionList.MONTH=[t.Formula.DMYFunctions,1,"v","","datetime"],t.Formula.FunctionList.YEAR=[t.Formula.DMYFunctions,1,"v","","datetime"],t.Formula.FunctionList.WEEKDAY=[t.Formula.DMYFunctions,-1,"weekday","","datetime"],t.Formula.HMSFunctions=function(e,o,n,r){var i,a,s,l,c=t.Formula,d=0,u=c.OperandAsNumber(r,n),p=c.LookupResultType(u.type,u.type,c.TypeLookupTable.oneargnumeric);if("n"==p.charAt(0)){if(u.value<0)return void c.PushOperand(o,"e#NUM!",0);l=u.value-Math.floor(u.value),l*=24,i=Math.floor(l),l-=Math.floor(l),l*=60,a=Math.floor(l),l-=Math.floor(l),l*=60,s=Math.floor(l+(u.value>=0?.5:-.5)),"HOUR"==e?d=i:"MINUTE"==e?d=a:"SECOND"==e&&(d=s)}c.PushOperand(o,p,d)},t.Formula.FunctionList.HOUR=[t.Formula.HMSFunctions,1,"v","","datetime"],t.Formula.FunctionList.MINUTE=[t.Formula.HMSFunctions,1,"v","","datetime"],t.Formula.FunctionList.SECOND=[t.Formula.HMSFunctions,1,"v","","datetime"],t.Formula.ExactFunction=function(e,o,n,r){var i=t.Formula,a=0,s="nl",l=i.OperandValueAndType(r,n),c=l.type.charAt(0),d=i.OperandValueAndType(r,n),u=d.type.charAt(0);"t"==c?"t"==u?a=l.value==d.value?1:0:"b"==u?a=l.value.length?0:1:"n"==u?a=l.value==d.value+""?1:0:"e"==u?(a=d.value,s=d.type):a=0:"n"==c?"n"==u?a=l.value-0==d.value-0?1:0:"b"==u?a=0:"t"==u?a=l.value+""==d.value?1:0:"e"==u?(a=d.value,s=d.type):a=0:"b"==c?"t"==u?a=d.value.length?0:1:"b"==u?a=1:"n"==u?a=0:"e"==u?(a=d.value,s=d.type):a=0:"e"==c&&(a=l.value,s=l.type),i.PushOperand(o,s,a)},t.Formula.FunctionList.EXACT=[t.Formula.ExactFunction,2,"","","text"],t.Formula.ArgList={FIND:[1,1,0],LEFT:[1,0],LEN:[1],LOWER:[1],MID:[1,0,0],PROPER:[1],REPLACE:[1,0,0,1],REPT:[1,0],RIGHT:[1,0],SUBSTITUTE:[1,1,1,0],TRIM:[1],HEXCODE:[1],UPPER:[1]},t.Formula.StringFunctions=function(e,o,n,r){var i,a,s,l,c,d,u=t.Formula,p=0,h="e#VALUE!",f=n.length,m=u.ArgList[e],g=[],v=[];for(i=1;i<=f;i++){if(i>m.length)return void u.FunctionArgsError(e,o);if(0==m[i-1]?a=u.OperandAsNumber(r,n):1==m[i-1]?a=u.OperandAsText(r,n):-1==m[i-1]&&(a=u.OperandValueAndType(r,n)),g[i]=a.value,v[i]=a.type,"e"==a.type.charAt(0))return void u.PushOperand(o,a.type,p)}switch(e){case"FIND":s=v[3]?g[3]-1:0,s<0?p="Start is before string":(p=g[2].indexOf(g[1],s),p>=0?(p+=1,h="n"):p="Not found");break;case"LEFT":l=v[2]?g[2]-0:1,l<0?p="Negative length":(p=g[1].substring(0,l),h="t");break;case"LEN":p=g[1].length,h="n";break;case"LOWER":p=g[1].toLowerCase(),h="t";break;case"MID":c=g[2]-0,l=g[3]-0,l<1||c<1?p="Bad arguments":(p=g[1].substring(c-1,c+l-1),h="t");break;case"PROPER":p=g[1].replace(/\b\w+\b/g,function(e){return e.substring(0,1).toUpperCase()+e.substring(1)}),h="t";break;case"REPLACE":c=g[2]-0,l=g[3]-0,l<0||c<1?p="Bad arguments":(p=g[1].substring(0,c-1)+g[4]+g[1].substring(c-1+l),h="t");break;case"REPT":if((d=g[2]-0)<0)p="Negative count";else{for(p="";d>0;d--)p+=g[1];h="t"}break;case"RIGHT":l=v[2]?g[2]-0:1,l<0?p="Negative length":(p=g[1].slice(-l),h="t");break;case"SUBSTITUTE":if(fulltext=g[1],oldtext=g[2],newtext=g[3],null!=g[4]){if(which=g[4]-0,which<=0){p="Non-positive instance number";break}}else which=0;for(d=0,oldpos=0,p="";;){if(pos=fulltext.indexOf(oldtext,oldpos),!(pos>=0)){p+=fulltext.substring(oldpos);break}if(d++,//!!!!!! old test just in case: if (count>1000) {alert(pos); break;}
p+=fulltext.substring(oldpos,pos),0==which)p+=newtext;else{if(which==d){p+=newtext+fulltext.substring(pos+oldtext.length);break}p+=oldtext}oldpos=pos+oldtext.length}h="t";break;case"TRIM":p=g[1],p=p.replace(/^ */,""),p=p.replace(/ *$/,""),p=p.replace(/ +/g," "),h="t";break;case"HEXCODE":p=String(g[1]);var y=p.charCodeAt(0);if(55296<=y&&y<=56319){var b=p.charCodeAt(1);56320<=b&&b<=57343&&(y=1024*(y-55296)+(b-56320)+65536)}p=y.toString(16).toUpperCase(),h="t";break;case"UPPER":p=g[1].toUpperCase(),h="t"}u.PushOperand(o,h,p)},t.Formula.FunctionList.FIND=[t.Formula.StringFunctions,-2,"find","","text"],t.Formula.FunctionList.LEFT=[t.Formula.StringFunctions,-2,"tc","","text"],t.Formula.FunctionList.LEN=[t.Formula.StringFunctions,1,"txt","","text"],t.Formula.FunctionList.LOWER=[t.Formula.StringFunctions,1,"txt","","text"],t.Formula.FunctionList.MID=[t.Formula.StringFunctions,3,"mid","","text"],t.Formula.FunctionList.PROPER=[t.Formula.StringFunctions,1,"v","","text"],t.Formula.FunctionList.REPLACE=[t.Formula.StringFunctions,4,"replace","","text"],t.Formula.FunctionList.REPT=[t.Formula.StringFunctions,2,"tc","","text"],t.Formula.FunctionList.RIGHT=[t.Formula.StringFunctions,-1,"tc","","text"],t.Formula.FunctionList.SUBSTITUTE=[t.Formula.StringFunctions,-3,"subs","","text"],t.Formula.FunctionList.TRIM=[t.Formula.StringFunctions,1,"v","","text"],t.Formula.FunctionList.HEXCODE=[t.Formula.StringFunctions,1,"v","","text"],t.Formula.FunctionList.UPPER=[t.Formula.StringFunctions,1,"v","","text"],t.Formula.IsFunctions=function(e,o,n,r){var i=t.Formula,a=0,s="nl",l=i.OperandValueAndType(r,n),c=l.type.charAt(0);switch(e){case"ISBLANK":a="b"==l.type?1:0;break;case"ISERR":a="e"==c?"e#N/A"==l.type?0:1:0;break;case"ISERROR":a="e"==c?1:0;break;case"ISLOGICAL":a="nl"==l.type?1:0;break;case"ISNA":a="e#N/A"==l.type?1:0;break;case"ISNONTEXT":a="t"==c?0:1;break;case"ISNUMBER":a="n"==c?1:0;break;case"ISTEXT":a="t"==c?1:0}i.PushOperand(o,s,a)},t.Formula.FunctionList.ISBLANK=[t.Formula.IsFunctions,1,"v","","test"],t.Formula.FunctionList.ISERR=[t.Formula.IsFunctions,1,"v","","test"],t.Formula.FunctionList.ISERROR=[t.Formula.IsFunctions,1,"v","","test"],t.Formula.FunctionList.ISLOGICAL=[t.Formula.IsFunctions,1,"v","","test"],t.Formula.FunctionList.ISNA=[t.Formula.IsFunctions,1,"v","","test"],t.Formula.FunctionList.ISNONTEXT=[t.Formula.IsFunctions,1,"v","","test"],t.Formula.FunctionList.ISNUMBER=[t.Formula.IsFunctions,1,"v","","test"],t.Formula.FunctionList.ISTEXT=[t.Formula.IsFunctions,1,"v","","test"],t.Formula.NTVFunctions=function(e,o,n,r){var i=t.Formula,a=0,s="e#VALUE!",l=i.OperandValueAndType(r,n),c=l.type.charAt(0);switch(e){case"N":a="n"==c?l.value-0:0,s="n";break;case"T":a="t"==c?l.value+"":"",s="t";break;case"VALUE":"n"==c||"b"==c?(a=l.value||0,s="n"):"t"==c&&(l=t.DetermineValueType(l.value),"n"!=l.type.charAt(0)?(a=0,s="e#VALUE!"):(a=l.value-0,s="n"))}"e"==c&&(s=l.type),i.PushOperand(o,s,a)},t.Formula.FunctionList.N=[t.Formula.NTVFunctions,1,"v","","math"],t.Formula.FunctionList.T=[t.Formula.NTVFunctions,1,"v","","text"],t.Formula.FunctionList.VALUE=[t.Formula.NTVFunctions,1,"v","","text"],t.Formula.Math1Functions=function(e,o,n,r){var i,a,s,l={},c=t.Formula;if(i=c.OperandAsNumber(r,n),a=i.value,l.type=c.LookupResultType(i.type,i.type,c.TypeLookupTable.oneargnumeric),"n"==l.type)switch(e){case"ABS":a=Math.abs(a);break;case"ACOS":a>=-1&&a<=1?a=Math.acos(a):l.type="e#NUM!";break;case"ASIN":a>=-1&&a<=1?a=Math.asin(a):l.type="e#NUM!";break;case"ATAN":a=Math.atan(a);break;case"COS":a=Math.cos(a);break;case"DEGREES":a=180*a/Math.PI;break;case"EVEN":a=a<0?-a:a,a!=Math.floor(a)?a=Math.floor(a+1)+Math.floor(a+1)%2:a+=a%2,i.value<0&&(a=-a);break;case"EXP":a=Math.exp(a);break;case"FACT":for(s=1,a=Math.floor(a);a>0;a--)s*=a;a=s;break;case"INT":a=Math.floor(a);break;case"LN":a<=0&&(l.type="e#NUM!",l.error=t.Constants.s_sheetfunclnarg),a=Math.log(a);break;case"LOG10":a<=0&&(l.type="e#NUM!",l.error=t.Constants.s_sheetfunclog10arg),a=Math.log(a)/Math.log(10);break;case"ODD":a=a<0?-a:a,a!=Math.floor(a)?a=Math.floor(a+1)+(1-Math.floor(a+1)%2):a+=1-a%2,i.value<0&&(a=-a);break;case"RADIANS":a=a*Math.PI/180;break;case"SIN":a=Math.sin(a);break;case"SQRT":a>=0?a=Math.sqrt(a):l.type="e#NUM!";break;case"TAN":0!=Math.cos(a)?a=Math.tan(a):l.type="e#NUM!"}return l.value=a,o.push(l),null},t.Formula.FunctionList.ABS=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.ACOS=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.ASIN=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.ATAN=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.COS=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.DEGREES=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.EVEN=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.EXP=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.FACT=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.INT=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.LN=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.LOG10=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.ODD=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.RADIANS=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.SIN=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.SQRT=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.TAN=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.Math2Functions=function(e,o,n,r){var i,a,s,l,c,d={},u=t.Formula;if(i=u.OperandAsNumber(r,n),a=u.OperandAsNumber(r,n),0,d.type=u.LookupResultType(i.type,a.type,u.TypeLookupTable.twoargnumeric),"n"==d.type)switch(e){case"ATAN2":0==i.value&&0==a.value?d.type="e#DIV/0!":d.value=Math.atan2(a.value,i.value);break;case"POWER":d.value=Math.pow(i.value,a.value),isNaN(d.value)&&(d.value=0,d.type="e#NUM!");break;case"MOD":0==a.value?d.type="e#DIV/0!":(s=i.value/a.value,s=Math.floor(s),d.value=i.value-s*a.value);break;case"TRUNC":if(l=1,a.value>=0){for(a.value=Math.floor(a.value),c=0;c<a.value;c++)l*=10;d.value=Math.floor(Math.abs(i.value)*l)/l}else if(a.value<0){for(a.value=Math.floor(-a.value),c=0;c<a.value;c++)l*=10;d.value=Math.floor(Math.abs(i.value)/l)*l}i.value<0&&(d.value=-d.value)}return o.push(d),null},t.Formula.FunctionList.ATAN2=[t.Formula.Math2Functions,2,"xy","","math"],t.Formula.FunctionList.MOD=[t.Formula.Math2Functions,2,"","","math"],t.Formula.FunctionList.POWER=[t.Formula.Math2Functions,2,"","","math"],t.Formula.FunctionList.TRUNC=[t.Formula.Math2Functions,2,"valpre","","math"],t.Formula.LogFunction=function(e,o,n,r){var i,a,s={},l=t.Formula;if(s.value=0,i=l.OperandAsNumber(r,n),s.type=l.LookupResultType(i.type,i.type,l.TypeLookupTable.oneargnumeric),1==n.length){if(a=l.OperandAsNumber(r,n),"n"!=a.type.charAt(0)||a.value<=0)return l.FunctionSpecificError(e,o,"e#NUM!",t.Constants.s_sheetfunclogsecondarg),0}else{if(0!=n.length)return l.FunctionArgsError(e,o),0;a={value:Math.E,type:"n"}}if("n"==s.type){if(i.value<=0)return l.FunctionSpecificError(e,o,"e#NUM!",t.Constants.s_sheetfunclogfirstarg),0;s.value=Math.log(i.value)/Math.log(a.value)}o.push(s)},t.Formula.FunctionList.LOG=[t.Formula.LogFunction,-1,"log","","math"],t.Formula.RoundFunction=function(e,o,n,r){var i,a,s,l,c=t.Formula,d=0,u="e#VALUE!",p=c.OperandValueAndType(r,n),u=c.LookupResultType(p.type,p.type,c.TypeLookupTable.oneargnumeric);if(1==n.length){if(i=c.OperandValueAndType(r,n),"n"!=i.type.charAt(0))return c.FunctionSpecificError(e,o,"e#NUM!",t.Constants.s_sheetfuncroundsecondarg),0}else{if(0!=n.length)return c.FunctionArgsError(e,o),0;i={value:0,type:"n"}}if("n"==u)if(i.value=i.value-0,0==i.value)d=Math.round(p.value);else if(i.value>0){for(a=1,i.value=Math.floor(i.value),l=0;l<i.value;l++)a*=10;s=Math.round(p.value*a),d=s/a}else if(i.value<0){for(a=1,i.value=Math.floor(-i.value),l=0;l<i.value;l++)a*=10;s=Math.round(p.value/a),d=s*a}c.PushOperand(o,u,d)},t.Formula.FunctionList.ROUND=[t.Formula.RoundFunction,-1,"vp","","math"],t.Formula.CeilingFloorFunctions=function(e,o,n,r){var i,a,s=t.Formula,l=function(e,t){o.push({type:e,value:t})};if(i=s.OperandValueAndType(r,n),"n"!=i.type.charAt(0))return void l("e#VALUE!",0);if(0==i.value)return void l("n",0);if(1==n.length){if(a=s.OperandValueAndType(r,n),"n"!=i.type.charAt(0))return void l("e#VALUE!",0)}else{if(0!=n.length)return void l("e#VALUE!",0);a={type:"n",value:i.value>0?1:-1}}if(0==a.value)return void l("n",0);if(a.value*i.value<0)return void l("e#NUM!",0);switch(e){case"CEILING":l("n",Math.ceil(i.value/a.value)*a.value);break;case"FLOOR":l("n",Math.floor(i.value/a.value)*a.value)}},t.Formula.FunctionList.CEILING=[t.Formula.CeilingFloorFunctions,-1,"vsig","","math"],t.Formula.FunctionList.FLOOR=[t.Formula.CeilingFloorFunctions,-1,"vsig","","math"],t.Formula.AndOrFunctions=function(e,o,n,r){var i,a,s=t.Formula,l="";for("AND"==e?a=1:"OR"==e&&(a=0);n.length;)i=s.OperandValueAndType(r,n),"n"==i.type.charAt(0)?(i.value=i.value-0,"AND"==e?a=0!=i.value?a:0:"OR"==e&&(a=0!=i.value?1:a),l=s.LookupResultType(i.type,l||"nl",s.TypeLookupTable.propagateerror)):"e"==i.type.charAt(0)&&"e"!=l.charAt(0)&&(l=i.type);l.length<1&&(l="e#VALUE!",a=0),s.PushOperand(o,l,a)},t.Formula.FunctionList.AND=[t.Formula.AndOrFunctions,-1,"vn","","test"],t.Formula.FunctionList.OR=[t.Formula.AndOrFunctions,-1,"vn","","test"],t.Formula.NotFunction=function(e,o,n,r){var i=0,a=t.Formula,s=a.OperandValueAndType(r,n),l=a.LookupResultType(s.type,s.type,a.TypeLookupTable.propagateerror);"n"==s.type.charAt(0)||"b"==s.type?(i=s.value-0!=0?0:1,l="nl"):"t"==s.type.charAt(0)&&(l="e#VALUE!"),a.PushOperand(o,l,i)},t.Formula.FunctionList.NOT=[t.Formula.NotFunction,1,"v","","test"],t.Formula.ChooseFunction=function(e,o,n,r){var i,a,s,l=0,c=t.Formula,d=c.OperandAsNumber(r,n);for("n"!=d.type.charAt(0)&&(d.value=0),d.value=Math.floor(d.value),a=0;n.length;)if(s=c.TopOfStackValueAndType(r,n),a+=1,d.value==a){l=s.value,i=s.type;break}i?c.PushOperand(o,i,l):c.PushOperand(o,"e#VALUE!",0)},t.Formula.FunctionList.CHOOSE=[t.Formula.ChooseFunction,-2,"choose","","lookup"],t.Formula.ColumnsRowsFunctions=function(e,o,n,r){var i,a,s=0,l=t.Formula,c=l.TopOfStackValueAndType(r,n);"coord"==c.type?(s=1,i="n"):"range"==c.type?(a=l.DecodeRangeParts(r,c.value),"COLUMNS"==e?s=a.ncols:"ROWS"==e&&(s=a.nrows),i="n"):(s=0,i="e#VALUE!"),l.PushOperand(o,i,s)},t.Formula.FunctionList.COLUMNS=[t.Formula.ColumnsRowsFunctions,1,"range","","lookup"],t.Formula.FunctionList.ROWS=[t.Formula.ColumnsRowsFunctions,1,"range","","lookup"],t.Formula.ZeroArgFunctions=function(e,o){var n,r,i,a,s,l={value:0};switch(e){case"FALSE":l.type="nl",l.value=0;break;case"NA":l.type="e#N/A";break;case"NOW":n=new Date,r=n.getTimezoneOffset(),n=n.getTime()/1e3,i=25569,a=86400,s=i+n/a-r/1440,l.value=s,l.type="ndt",t.Formula.FreshnessInfo["volatile"].NOW=!0;break;case"PI":l.type="n",l.value=Math.PI;break;case"TODAY":n=new Date,r=n.getTimezoneOffset(),n=n.getTime()/1e3,i=25569,a=86400,s=i+n/a-r/1440,l.value=Math.floor(s),l.type="nd",t.Formula.FreshnessInfo["volatile"].TODAY=!0;break;case"TRUE":l.type="nl",l.value=1}return o.push(l),null},t.Formula.FunctionList.FALSE=[t.Formula.ZeroArgFunctions,0,"","","test"],t.Formula.FunctionList.NA=[t.Formula.ZeroArgFunctions,0,"","","test"],t.Formula.FunctionList.NOW=[t.Formula.ZeroArgFunctions,0,"","","datetime"],t.Formula.FunctionList.PI=[t.Formula.ZeroArgFunctions,0,"","","math"],t.Formula.FunctionList.TODAY=[t.Formula.ZeroArgFunctions,0,"","","datetime"],t.Formula.FunctionList.TRUE=[t.Formula.ZeroArgFunctions,0,"","","test"],t.Formula.DDBFunction=function(e,o,n,r){var i,a,s,l,c=t.Formula,d=c.OperandAsNumber(r,n),u=c.OperandAsNumber(r,n),p=c.OperandAsNumber(r,n),h=c.OperandAsNumber(r,n);if(!(c.CheckForErrorValue(o,d)||c.CheckForErrorValue(o,u)||c.CheckForErrorValue(o,p)||c.CheckForErrorValue(o,h))){if(p.value<1)return c.FunctionSpecificError(e,o,"e#NUM!",t.Constants.s_sheetfuncddblife),0;if(i={value:2,type:"n"},n.length>0&&(i=c.OperandAsNumber(r,n)),0!=n.length)return c.FunctionArgsError(e,o),0;if(!c.CheckForErrorValue(o,i)){for(a=0,s=0,l=1;l<=h.value-0&&l<=p.value;l++)a=(d.value-s)*(i.value/p.value),d.value-s-a<u.value&&(a=d.value-s-u.value),s+=a;c.PushOperand(o,"n$",a)}}},t.Formula.FunctionList.DDB=[t.Formula.DDBFunction,-4,"ddb","","financial"],t.Formula.SLNFunction=function(e,o,n,r){var i,a=t.Formula,s=a.OperandAsNumber(r,n),l=a.OperandAsNumber(r,n),c=a.OperandAsNumber(r,n);if(!a.CheckForErrorValue(o,s)&&!a.CheckForErrorValue(o,l)&&!a.CheckForErrorValue(o,c)){if(c.value<1)return a.FunctionSpecificError(e,o,"e#NUM!",t.Constants.s_sheetfuncslnlife),0;i=(s.value-l.value)/c.value,a.PushOperand(o,"n$",i)}},t.Formula.FunctionList.SLN=[t.Formula.SLNFunction,3,"csl","","financial"],t.Formula.SYDFunction=function(e,o,n,r){var i,a,s=t.Formula,l=s.OperandAsNumber(r,n),c=s.OperandAsNumber(r,n),d=s.OperandAsNumber(r,n),u=s.OperandAsNumber(r,n);if(!(s.CheckForErrorValue(o,l)||s.CheckForErrorValue(o,c)||s.CheckForErrorValue(o,d)||s.CheckForErrorValue(o,u))){if(d.value<1||u.value<=0)return s.PushOperand(o,"e#NUM!",0),0;a=(d.value+1)*d.value/2,i=(l.value-c.value)*(d.value-u.value+1)/a,s.PushOperand(o,"n$",i)}},t.Formula.FunctionList.SYD=[t.Formula.SYDFunction,4,"cslp","","financial"],t.Formula.InterestFunctions=function(e,o,n,r){var i,a,s,l,c,d,u,p,h,f,m,g,v,y,b,C,w,x,S,_,p,k,T,E=t.Formula,F=E.OperandAsNumber(r,n),D=E.OperandAsNumber(r,n),M=E.OperandAsNumber(r,n);if(i=E.LookupResultType(F.type,D.type,E.TypeLookupTable.twoargnumeric),i=E.LookupResultType(i,M.type,E.TypeLookupTable.twoargnumeric),n.length&&(s=E.OperandAsNumber(r,n),i=E.LookupResultType(i,s.type,E.TypeLookupTable.twoargnumeric),n.length&&(l=E.OperandAsNumber(r,n),i=E.LookupResultType(i,l.type,E.TypeLookupTable.twoargnumeric),n.length))){if("RATE"!=e)return E.FunctionArgsError(e,o),0;c=E.OperandAsNumber(r,n),i=E.LookupResultType(i,c.type,E.TypeLookupTable.twoargnumeric)}if("n"==i)switch(e){case"FV":p=F.value,h=D.value,f=M.value,d=null!=s?s.value:0,m=null!=l&&l.value?1:0,u=0==p?-d-f*h:-(d*Math.pow(1+p,h)+f*(1+p*m)*(Math.pow(1+p,h)-1)/p),a=u,i="n$";break;case"NPER":if(p=F.value,f=D.value,d=M.value,u=null!=s?s.value:0,m=null!=l&&l.value?1:0,0==p){if(0==f)return void E.PushOperand(o,"e#NUM!",0);h=(d+u)/-f}else{if(v=f*(1+p*m)/p,0==(y=d+v)||p<=-1)return void E.PushOperand(o,"e#NUM!",0);if((b=(v-u)/y)<=0)return void E.PushOperand(o,"e#NUM!",0);C=Math.log(b),w=Math.log(1+p),h=C/w}a=h,i="n";break;case"PMT":if(p=F.value,h=D.value,d=M.value,u=null!=s?s.value:0,m=null!=l&&l.value?1:0,0==h)return void E.PushOperand(o,"e#NUM!",0);f=0==p?(u-d)/h:(0-u-d*Math.pow(1+p,h))/((1+p*m)*(Math.pow(1+p,h)-1)/p),a=f,i="n$";break;case"PV":if(p=F.value,h=D.value,f=M.value,u=null!=s?s.value:0,m=null!=l&&l.value?1:0,-1==p)return void E.PushOperand(o,"e#DIV/0!",0);d=0==p?-u-f*h:(-u-f*(1+p*m)*(Math.pow(1+p,h)-1)/p)/Math.pow(1+p,h),a=d,i="n$";break;case"RATE":for(h=F.value,f=D.value,d=M.value,u=null!=s?s.value:0,m=null!=l&&l.value?1:0,g=null!=c?c.value:.1,S=100,_=0,delta=1,epsilon=1e-7,p=g||1e-8;(delta>=0?delta:-delta)>epsilon&&p!=k;)if(delta=u+d*Math.pow(1+p,h)+f*(1+p*m)*(Math.pow(1+p,h)-1)/p,null!=x?(T=(delta-x)/(p-k)||.001,k=p,p-=delta/T,x=delta):(k=p,p*=1.1,x=delta),++_>=S)return void E.PushOperand(o,"e#NUM!",0);a=p,i="n%"}E.PushOperand(o,i,a)},t.Formula.FunctionList.FV=[t.Formula.InterestFunctions,-3,"fv","","financial"],t.Formula.FunctionList.NPER=[t.Formula.InterestFunctions,-3,"nper","","financial"],t.Formula.FunctionList.PMT=[t.Formula.InterestFunctions,-3,"pmt","","financial"],t.Formula.FunctionList.PV=[t.Formula.InterestFunctions,-3,"pv","","financial"],t.Formula.FunctionList.RATE=[t.Formula.InterestFunctions,-3,"rate","","financial"],t.Formula.NPVFunction=function(e,o,n,r){var i,a,s,l,c,d=t.Formula,a=d.OperandAsNumber(r,n);if(!d.CheckForErrorValue(o,a)){for(s=0,i="n",l=1;n.length;)if(c=d.OperandValueAndType(r,n),"n"==c.type.charAt(0)){if(0==(l*=1+a.value))return void d.PushOperand(o,"e#DIV/0!",0);s+=c.value/l,i=d.LookupResultType(c.type,i||c.type,d.TypeLookupTable.plus)}else if("e"==c.type.charAt(0)&&"e"!=i.charAt(0)){i=c.type;break}"n"==i.charAt(0)&&(i="n$"),d.PushOperand(o,i,s)}},t.Formula.FunctionList.NPV=[t.Formula.NPVFunction,-2,"npv","","financial"],t.Formula.IRRFunction=function(e,o,n,r){var i,a,s,l,c,d,u,p,h,f,m,g,v=[],y=[],b=t.Formula;for(v.push(n.pop());v.length;)if(i=b.OperandValueAndType(r,v),"n"==i.type.charAt(0))y.push(i.value);else if("e"==i.type.charAt(0))return void b.PushOperand(o,"e#VALUE!",0);if(!y.length)return void b.PushOperand(o,"e#NUM!",0);if(a={value:0},n.length){if(a=b.OperandAsNumber(r,n),"n"!=a.type.charAt(0)&&"b"!=a.type.charAt(0))return void b.PushOperand(o,"e#VALUE!",0);if(n.length)return void b.FunctionArgsError(e,o)}for(a.value=a.value||.1,l=20,c=0,d=1e-7,u=a.value,f=1;(f>=0?f:-f)>d&&u!=p;){for(f=0,m=1,g=0;g<y.length;g++){if(0==(m*=1+u))return void b.PushOperand(o,"e#DIV/0!",0);f+=y[g]/m}if(null!=s?(h=(f-s)/(u-p),p=u,u-=f/h,s=f):(p=u,u*=1.1,s=f),++c>=l)return void b.PushOperand(o,"e#NUM!",0)}b.PushOperand(o,"n%",u)},t.Formula.FunctionList.IRR=[t.Formula.IRRFunction,-1,"irr","","financial"],t.Formula.IoFunctions=function(o,n,r,i,a){var s,l,c,d,u={BUTTON:[2],IMAGEBUTTON:[2],EMAIL:[14,14,14,14],EMAILIF:[13,14,14,14,14],EMAILONEDIT:[14,14,14,14,14],EMAILAT:[13,14,14,14,14],EMAILONEDITIF:[14,13,14,14,14,14],EMAILATIF:[13,13,14,14,14,14],SUBMIT:[2],TEXTBOX:[2],AUTOCOMPLETE:[2,14],SELECT:[2,14,1,1],CHECKBOX:[3],RADIOBUTTON:[2,2],COPYVALUE:[4,12,15],COPYFORMULA:[4,12,12],INSERT:[4,8,-12,-15],DELETEIF:[4,7,8],COMMAND:[4,14],COMMANDIF:[4,13,14],PANEL:[15,-12],SPLASH:[12],STYLE:[6]},p=t.Formula,h=0,f="e#VALUE!",m=r.length,g=u[o],v=[],y=[],b=-1;for(s=1;s<=m;s++){if(-1!=b)d=Math.abs(g[c+(s-1-c)%b]);else{if(s>g.length)return void p.FunctionArgsError(o,n);d=g[s-1],d<0&&(b=g.length-(s-1),c=s-1,d=Math.abs(d))}if(1==d)l=p.OperandAsNumber(i,r);else if(2==d)l=p.OperandAsText(i,r);else if(3==d)l=p.OperandValueAndType(i,r);else{var C=r[r.length-1].type,w=!1;if(("n"==C.charAt(0)&&0!=(1&d)||"t"==C.charAt(0)&&0!=(2&d))&&(w=!0,l=p.OperandValueAndType(i,r)),"coord"==C&&0!=(4&d)&&(w=!0,l=p.OperandAsCoord(i,r),l.value=t.Formula.PlainCoord(l.value)),"range"==C&&0!=(8&d)&&(w=!0,l=p.OperandAsRange(i,r),l.value=t.Formula.PlainCoord(l.value)),0==w)return void p.FunctionArgsError(o,n)}if(v[s]=l.value,y[s]=l.type,"e"==l.type.charAt(0))return void p.PushOperand(n,l.type,h)}switch(o){case"STYLE":var x=i.ioParameterList[a];if(x){var S=t.Formula.getStandardizedList(i,{value:v[1],type:y[1]});S.length>0&&(x.css=S[0],x.cssParameter="t"==y[1]?'"'+v[1]+'"':v[1]),h="",f="ni"}break;case"SELECT":var x=i.ioParameterList[a],_=t.Formula.getStandardizedList(i,x[1]);if(x.html=[],x.html[0]=1==v[4]?"multiple":"",x.html[1]=v[3]?""+v[3]:"1",_.length>0){var k="<option>"+_.join("</option><option>")+"</option>",T=new RegExp("<option>"+v[1],"");x.html[2]=k.replace(T,"<option selected>"+v[1])}h=v[1],f="ti"+o;break;case"SUBMIT":h="Submit";case"BUTTON":case"IMAGEBUTTON":case"TEXTBOX":case"AUTOCOMPLETE":m>0&&(h=v[1]),f="ti"+o;break;case"EMAIL":case"EMAILIF":f="ti"+o,h="Send";break;case"EMAILONEDIT":case"EMAILONEDITIF":case"EMAILAT":case"EMAILATIF":f="ti"+o,h="Send Now";break;case"CHECKBOX":case"RADIOBUTTON":h="t"==y[1].charAt(0)?"TRUE"==v[1].toUpperCase()?1:0:0==v[1]?0:1,f="ni"+o;break;case"COPYVALUE":case"COPYFORMULA":case"INSERT":case"DELETEIF":case"COMMAND":case"COMMANDIF":var E=i.cells[v[1]];if(void 0===E)break;h=E.datavalue,h=String(h).split("/"),h=h[h.length-1],f="t";break;case"PANEL":case"SPLASH":var F,D=2;if("SPLASH"==o){if(h="SPLASH:"+v[1],f="t",1==i.splashdone)break;i.splashdone=!0,D=1,F=[0]}else F=t.Formula.getStandardizedList(i,{value:v[1],type:y[1]}),h=o+":"+F;if(f="t",t._app){for(var M=[],A=[],P=D;P<v.length;++P){var L=!1;for(var R in F)if(F[R]==P-1){L=!0;break}if(!1!==L){for(var I=t.Formula.getStandardizedCoords(i,{value:v[P],type:y[P]}),s=0;s<I.ncols;s++)A[I.col1num+s]=!0;for(var O=0;O<I.nrows;O++)M[I.row1num+O]=!0}}var $=e.spreadsheet;null==$&&($=e.ss);var N=!1,U=0,j=function(e,t,o,n,r){for(var i=1;i<=t;i++){var a=r(i);"undefined"==typeof o[a]?!0!==n[i]?(o[a]="yes",N=!0):U=i:!0===n[i]&&(delete o[a],N=!0,U=i)}},H=function(e){return e};j(i,i.attribs.lastrow,i.rowattribs.hide,M,H),U=0,j(i,i.attribs.lastcol,i.colattribs.hide,A,t.rcColname),i.attribs.usermaxcol=U,N&&(i.renderneeded=!0,i.widgetsClean=!1,$.editor.context.rowpanes[0].first=1,$.editor.context.CalculateColWidthData(),$.width=$.editor.context.totalwidth,$.height=2500,$.editor.ResizeTableEditor($.editor.context.totalwidth,2500))}}p.PushOperand(n,f,h)},t.Formula.FunctionList.BUTTON=[t.Formula.IoFunctions,1,"label","","gui","<button type='button' onclick=\"SocialCalc.TriggerIoAction.Button('<%=cell_reference%>');\"><%=formated_value%></button>","ParameterList"],t.Formula.FunctionList.IMAGEBUTTON=[t.Formula.IoFunctions,1,"imageurl","","gui","<input type='image' src='<%=display_value%>' alt='Submit' onclick=\"SocialCalc.TriggerIoAction.Button('<%=cell_reference%>');\">","ParameterList"],t.Formula.FunctionList.EMAIL=[t.Formula.IoFunctions,-3,"to_range subject_range, body_range","","action","<button type='button' onclick=\"SocialCalc.TriggerIoAction.Email('<%=cell_reference%>');\"><%=formated_value%></button>","ParameterList"],t.Formula.FunctionList.EMAILIF=[t.Formula.IoFunctions,-4,"condition_range, to_range subject_range, body_range","","action","<button type='button' onclick=\"SocialCalc.TriggerIoAction.Email('<%=cell_reference%>');\"><%=formated_value%></button>","ParameterList"],t.Formula.FunctionList.EMAILONEDIT=[t.Formula.IoFunctions,-4,"editRange, to_range subject_range, body_range","","action","<button type='button' onclick=\"SocialCalc.TriggerIoAction.Email('<%=cell_reference%>');\"><%=formated_value%></button>","EventTree"];t.Formula.FunctionList.EMAILAT=[t.Formula.IoFunctions,-4,"datetime_value, to_range subject_range, body_range","","action","<button type='button' onclick=\"SocialCalc.TriggerIoAction.Email('<%=cell_reference%>');\"><%=formated_value%></button>","TimeTrigger"],t.Formula.FunctionList.EMAILONEDITIF=[t.Formula.IoFunctions,-5,"editRange, condition, to_range subject_range, body_range","","action","<button type='button' onclick=\"SocialCalc.TriggerIoAction.Email('<%=cell_reference%>');\"><%=formated_value%></button>","EventTree"],t.Formula.FunctionList.EMAILATIF=[t.Formula.IoFunctions,-5,"datetime_value, condition, to_range subject_range, body_range","","action","<button type='button' onclick=\"SocialCalc.TriggerIoAction.Email('<%=cell_reference%>');\"><%=formated_value%></button>","TimeTrigger"],t.Formula.FunctionList.SUBMIT=[t.Formula.IoFunctions,100,"[label]","","action","<button type='button' onclick=\"SocialCalc.TriggerIoAction.Submit('<%=cell_reference%>');\"><%=formated_value%></button>","ParameterList"],t.Formula.FunctionList.TEXTBOX=[t.Formula.IoFunctions,1,"value","","gui","<input type='text' id='TEXTBOX_<%=cell_reference%>' onblur='SocialCalc.CmdGotFocus(null);' oninput=\"SocialCalc.TriggerIoAction.TextBox('<%=cell_reference%>')\" value='<%=display_value%>' >","Input"],t.Formula.FunctionList.AUTOCOMPLETE=[t.Formula.IoFunctions,2,"value, range or csv_text","","gui","<input type='text' id='AUTOCOMPLETE_<%=cell_reference%>' onfocus=\"SocialCalc.TriggerIoAction.AddAutocomplete('<%=cell_reference%>');\" onblur='SocialCalc.CmdGotFocus(null);' value='<%=display_value%>' >","Input"],t.Formula.FunctionList.SELECT=[t.Formula.IoFunctions,-2,"value, range or csv_text [,size]","","gui","<select size='<%=html1_value%>' id='SELECT_<%=cell_reference%>' onchange=\"SocialCalc.TriggerIoAction.SelectList('<%=cell_reference%>')\" <%=html0_value%>><%=html2_value%></select>","Input"],t.Formula.FunctionList.CHECKBOX=[t.Formula.IoFunctions,1,"value","","gui","<input type='checkbox' id='CHECKBOX_<%=cell_reference%>' <%=checked%> onblur='SocialCalc.CmdGotFocus(null);' onchange=\"SocialCalc.TriggerIoAction.CheckBox('<%=cell_reference%>')\" >","Input"],t.Formula.FunctionList.RADIOBUTTON=[t.Formula.IoFunctions,2,"value, groupname","","gui","<input type='radio' value='<%=cell_reference%>' id='RADIOBUTTON_<%=cell_reference%>' <%=checked%> name='<%=parameter1_value%>' onblur=\"SocialCalc.CmdGotFocus(null);\" onclick=\"SocialCalc.TriggerIoAction.RadioButton('<%=parameter1_value%>');\" >","Input"],t.Formula.FunctionList.COPYVALUE=[t.Formula.IoFunctions,3,"trigger_cell, destinationCell, value_or_range","","action","","EventTree"],t.Formula.FunctionList.COPYFORMULA=[t.Formula.IoFunctions,3,"trigger_cell, destinationCell, formula_range","","action","","EventTree"],t.Formula.FunctionList.INSERT=[t.Formula.IoFunctions,-2,"trigger_cell, destination_range [,formula_range,value_or_range,formula_range, ...]","","action","","EventTree"],t.Formula.FunctionList.DELETEIF=[t.Formula.IoFunctions,-1,"trigger_cell, criteria , test_range","","action","","EventTree"],t.Formula.FunctionList.COMMAND=[t.Formula.IoFunctions,-1,"trigger_cell, commands","","action","","EventTree"],t.Formula.FunctionList.COMMANDIF=[t.Formula.IoFunctions,-1,"trigger_cell, conditions, commands","","action","","EventTree"],t.Formula.FunctionList.PANEL=[t.Formula.IoFunctions,-1,"showindices_range_or_csv, panel1_range [, panel2_range , ...]","","gui",""],t.Formula.FunctionList.SPLASH=[t.Formula.IoFunctions,-1,"splash_panel_range","","gui",""],t.Formula.FunctionList.STYLE=[t.Formula.IoFunctions,-1,"css","","gui",""],t.TriggerIoAction.AddAutocomplete=function(o){var n=e.spreadsheet;null==n&&(n=e.ss);var r=n.sheet,i=(t.Formula,r.ioParameterList[o]);if(void 0!==i){var a=t.Formula.getStandardizedList(r,i[1]);$.ui.autocomplete.filter=function(e,t){var o=new RegExp("\\b"+$.ui.autocomplete.escapeRegex(t),"i");return $.grep(e,function(e){return o.test(e.label||e.value||e)})},$("#AUTOCOMPLETE_"+o).autocomplete({source:a,minLength:1,autoFocus:!0,select:function(e,n){$(this).val(n.item.label),t.TriggerIoAction.AutoComplete(o)},change:function(e,n){null===n.item&&$(this).val(""),t.TriggerIoAction.AutoComplete(o)}})}},t.TriggerIoAction.Button=function(o){var n=e.spreadsheet;null==n&&(n=e.ss);var r=n.sheet;t.Formula;if("undefined"!=typeof r.ioEventTree&&"undefined"!=typeof r.ioParameterList&&"undefined"!==r.ioEventTree[o])for(var i in r.ioEventTree[o]){var a=r.ioParameterList[i],s=null;switch(a.function_name){case"COPYVALUE":var l=t.Formula.getStandardizedValues(r,a[2]),c=t.coordToCr(a[1].value),d=t.TriggerIoAction.CopyValueToRange(l,c);n.editor.EditorScheduleSheetCommands(d,!0,!1);break;case"COPYFORMULA":var l=t.Formula.getStandardizedValues(r,a[2]),c=t.coordToCr(a[1].value),d=t.TriggerIoAction.CopyFormulaToRange(l,c);n.editor.EditorScheduleSheetCommands(d,!0,!1);break;case"INSERT":var l=t.Formula.getStandardizedValues(r,a[1]);if("range"!=l.type)break;var u,p,h;l.ncols>1&&(p=1,h=0,u="insertcol"),l.nrows>1&&(p=0,h=1,u="insertrow");for(var f=l.cellcoord[p][h],d=u+" "+f,c=t.coordToCr(f),m=2;m<a.length;)"range"!=a[m].type&&"coord"!=a[m].type&&m%2!=1||(copyCellRange=t.Formula.getStandardizedValues(r,a[m]),d=m%2==0?d+"\n"+t.TriggerIoAction.CopyFormulaToRange(copyCellRange,c):d+"\n"+t.TriggerIoAction.CopyValueToRange(copyCellRange,c),l.nrows>1&&(c.col+=copyCellRange.ncols),l.ncols>1&&(c.row+=copyCellRange.nrows)),m++;n.editor.EditorScheduleSheetCommands(d,!0,!1);break;case"DELETEIF":var p,h,g,v=t.Formula.getStandardizedValues(r,a[1]),y=t.Formula.getStandardizedValues(r,a[2]),d="";if(y.ncols>1&&y.nrows>1)return;y.ncols>1&&(p=1,h=0,g="deletecol"),y.nrows>1&&(p=0,h=1,g="deleterow");for(var b=v.celldata[0][0].datavalue,C=y.ncols-p-1;C>=p;C--)for(var w=y.nrows-h-1;w>=h;w--){var x=y.celldata[C][w];1==t.Formula.TestCriteria(x.datavalue,x.valuetype,b)&&(""!=d&&(d+="\n"),d=d+g+" "+y.cellcoord[C][w])}""!=d&&n.editor.EditorScheduleSheetCommands(d,!0,!1);break;case"COMMANDIF":s=t.Formula.getStandardizedValues(r,a[1]);case"COMMAND":var S,d="";if(null!=s){var S=t.Formula.getStandardizedValues(r,a[2]);if(s.ncols!=S.ncols||s.nrows!=S.nrows)break}else S=t.Formula.getStandardizedValues(r,a[1]);for(var C=0;C<S.ncols;C++)for(var w=0;w<S.nrows;w++){if(null!=s){var _=s.celldata[C][w];if(0==_.datavalue)continue}""!=d&&(d+="\n");var k=S.celldata[C][w];d+=k.datavalue.toString().trim()}""!=d&&n.editor.EditorScheduleSheetCommands(d,!0,!1)}}},t.TriggerIoAction.CopyFormulaToRange=function(e,o){for(var n,r="",i=0;i<e.ncols;i++)for(var a=0;a<e.nrows;a++){var s=e.celldata[i][a],l=t.crToCoord(o.col+i,o.row+a);if(0==i&&0==a||(r+="\n"),void 0!==s&&"b"!=s.valuetype){var c=s.datatype,d=s.valuetype,u=s.datavalue,p=s.formula;"f"==c?(p=t.OffsetFormulaCoords(p,o.col-e.col1num,o.row-e.row1num),u="",d=""):"c"!=c&&(p=""),n="set "+l+" "+t.Constants.cellDataType[c]+" "+d+" "+t.encodeForSave(u)+" "+p}else n="set "+l+" empty";r+=n.trim()}return r},t.TriggerIoAction.CopyValueToRange=function(e,o){for(var n,r="",i=0;i<e.ncols;i++)for(var a=0;a<e.nrows;a++){var s=e.celldata[i][a],l=t.crToCoord(o.col+i,o.row+a);if(0==i&&0==a||(r+="\n"),void 0!==s&&"b"!=s.valuetype){var c=s.datatype,d=s.valuetype,u=s.datavalue,p=s.formula;"f"==c?(p="",c=d,"n"!=d&&"t"!=d.charAt(0)&&(c="c",p=s.displaystring),"t"==d.charAt(0)&&(c="t")):"c"!=c&&(p=""),n="set "+l+" "+t.Constants.cellDataType[c]+" "+d+" "+t.encodeForSave(u)+" "+p}else n="set "+l+" empty";r+=n.trim()}return r},t.TriggerIoAction.Email=function(o,n){n=void 0!==n?n:null;var r=t.Formula,i=e.spreadsheet;null==i&&(i=e.ss);var a=i.sheet,s=a.cells[o];if("undefined"!=typeof a.ioParameterList){var l=a.ioParameterList[o];if(void 0!==l){for(var c=[],d=[],u=1,p=0;p<l.length;p++)if("t"==l[p].type.charAt(0)&&(c[p]=[String(l[p].value).replace(/ /g,"%20")]),"coord"==l[p].type&&(c[p]=[String(a.GetAssuredCell(l[p].value).datavalue).replace(/ /g,"%20")]),"range"==l[p].type){var h=r.DecodeRangeParts(a,l[p].value);c[p]=[],d[p]=[];for(var f=0,m=0;m<h.ncols;m++)for(var g=0;g<h.nrows;g++){var v=t.crToCoord(h.col1num+m,h.row1num+g),s=h.sheetdata.GetAssuredCell(v);c[p].push(s.datavalue.toString().replace(/ /g,"%20")),d[p].push(v),f++}f>u&&(u=f)}var y=-1,b=0;switch(l.function_name){case"EMAILIF":y=0;case"EMAILAT":case"EMAILONEDIT":b=1;break;case"EMAILONEDITIF":case"EMAILATIF":y=1,b=2}switch(l.function_name){case"EMAILONEDIT":case"EMAILONEDITIF":n&&"coord"==l[0].type&&l[0].value==n&&(n=null);break;default:n=null}for(var C=!1,w=[],x=u-1;x>-1;x--){if(-1!=y){var S=x>=c[y].length?0:x;if(0==c[y][S])continue}if(!n||n==d[0][x]){var _=x>=c[b].length?0:x,k=x>=c[b+1].length?0:x,T=x>=c[b+2].length?0:x,E=c[b][_]+" "+c[b+1][k]+" "+c[b+2][T];C=!0,a.ScheduleSheetCommands("sendemail "+E,!1),w.push([c[b][_],c[b+1][k],c[b+2][T]])}}return C&&t.EditorSheetStatusCallback(null,"emailing",null,i.editor),w}}},t.TriggerIoAction.Submit=function(){var o=null!=t.CurrentSpreadsheetControlObject?t.CurrentSpreadsheetControlObject.formDataViewer:t.CurrentSpreadsheetViewerObject.formDataViewer;if(null!=o&&1==o.loaded){var n=e.spreadsheet;null==n&&(n=e.ss);for(var r=n.sheet,i=new Date,a=i.getFullYear()+"-"+(i.getMonth()+1)+"-"+i.getDate()+" "+i.getHours()+":"+i.getMinutes()+":"+i.getSeconds(),s=2;s<=o.formFieldsLength+1;s++){var l=t.crToCoord(s,2);a+="\r"+o.sheet.cells[l].datavalue}r.ScheduleSheetCommands("submitform \r"+a,!1)}},t.TriggerIoAction.SelectList=function(e){var o=function(e){return e.value};t.TriggerIoAction.updateInputWidgetFormula("SELECT",e,o)},t.TriggerIoAction.AutoComplete=function(e){var o=function(e){return e.value};t.TriggerIoAction.updateInputWidgetFormula("AUTOCOMPLETE",e,o)},t.TriggerIoAction.TextBox=function(e){var o=function(e){return e.value};t.TriggerIoAction.updateInputWidgetFormula("TEXTBOX",e,o)},t.TriggerIoAction.CheckBox=function(e){var o=function(e){return e.checked?"TRUE":"FALSE"};t.TriggerIoAction.updateInputWidgetFormula("CHECKBOX",e,o)},t.TriggerIoAction.RadioButton=function(e){var o=function(e){return e.checked?"TRUE":"FALSE"};$('input[name="'+e+'"]').each(function(){t.TriggerIoAction.updateInputWidgetFormula("RADIOBUTTON",$(this).attr("id").replace(/RADIOBUTTON_/,""),o)})},t.TriggerIoAction.updateInputWidgetFormula=function(o,n,r){var i=e.spreadsheet;null==i&&(i=e.ss);var a=i.sheet,s=(a.cells[n],a.ioParameterList[n]);if(void 0!==s){var l=document.getElementById(o+"_"+n),c=r(l);c=t.encodeForSave(c);for(var d="set "+n+" formula "+o+'("'+c+'"',u=1;u<s.length;u++)"n"==s[u].type.charAt(0)&&(d+=","+s[u].value),"t"==s[u].type.charAt(0)&&(d+=',"'+s[u].value+'"'),"range"==s[u].type&&(d+=","+s[u].value.toString().replace(/(\$?[A-Z]+\$?[0-9]+)([!]?)([^|]*)[|](\$?[A-Z]+\$?[0-9]+)[|]/i,"$3$2$1:$4")),"coord"==s[u].type&&(d+=","+s[u].value);d+=")",s.cssParameter&&(d+="+style("+s.cssParameter+")"),i.editor.EditorScheduleSheetCommands(d,!0,!1),t.TriggerIoAction.UpdateFormDataSheet(o,n,c)}},t.TriggerIoAction.UpdateFormDataSheet=function(e,o,n){
var r=null!=t.CurrentSpreadsheetControlObject?t.CurrentSpreadsheetControlObject.formDataViewer:t.CurrentSpreadsheetViewerObject.formDataViewer;if(null!=r){var i=(e+o).toLowerCase();if(null!=r.formFields[i]){var a=t.crToCoord(r.formFields[i],2);r.sheet.ScheduleSheetCommands("set "+a+" text t "+n,!1)}}},t.Formula.getStandardizedValues=function(e,o){return t.Formula.getStandardizedParameter(e,o,!0,!0)},t.Formula.getStandardizedCoords=function(e,o){return t.Formula.getStandardizedParameter(e,o,!0,!1)},t.Formula.getStandardizedList=function(e,o){var n=[],r=t.Formula.getStandardizedValues(e,o);if(1==r.ncols&&1==r.nrows)n=String(r.celldata[0][0].datavalue).split(",");else for(var i=0;i<r.ncols;i++)for(var a=0;a<r.nrows;a++){var s=r.celldata[i][a];n.push(s.datavalue.toString())}return n},t.Formula.getStandardizedParameter=function(e,o,n,r){var i={type:o.type,value:o.value};if(r&&(i.celldata=[]),"coord"!=o.type&&"range"!=o.type){if(i.ncols=1,i.nrows=1,i.col1num=1,i.row1num=1,n&&(i.cellcoord=null),r){i.celldata[0]=[];var a="n"==o.type?"v":"t"==o.type?o.type:"c";i.celldata[0][0]={coord:null,datatype:a,valuetype:o.type,datavalue:o.value}}}else{var s,l=t.Formula;if("coord"==o.type){var c=t.Formula.PlainCoord(o.value);s=l.DecodeRangeParts(e,c+"|"+c+"|")}"range"==o.type&&(s=l.DecodeRangeParts(e,o.value)),n&&(i.cellcoord=[]);for(var d=0;d<s.ncols;d++)for(var u=0;u<s.nrows;u++){var p=t.crToCoord(s.col1num+d,s.row1num+u);if(n&&("undefined"==typeof i.cellcoord[d]&&(i.cellcoord[d]=[]),i.cellcoord[d][u]=p),r){"undefined"==typeof i.celldata[d]&&(i.celldata[d]=[]);var h=s.sheetdata.GetAssuredCell(p);i.celldata[d][u]=h}}i.ncols=s.ncols,i.nrows=s.nrows,i.col1num=s.col1num,i.row1num=s.row1num}return i},t.Formula.SheetCache={sheets:{},waitingForLoading:null,constants:{asloaded:0,recalcing:1,recalcdone:2},loadsheet:null},t.Formula.FindInSheetCache=function(e){var o=t.Formula.SheetCache,n=t.Formula.NormalizeSheetName(e);return o.sheets[n]?o.sheets[n].sheet:o.waitingForLoading?null:o.loadsheet?(alert("Using SocialCalc.Formula.SheetCache.loadsheet - deprecated"),t.Formula.AddSheetToCache(n,o.loadsheet(n))):(o.waitingForLoading=n,null)},t.Formula.AddSheetToCache=function(e,o,n){var r=null,i=t.Formula.SheetCache,a=i.constants,s=t.Formula.NormalizeSheetName(e);return o&&(r=new t.Sheet,r.ParseSheetSave(o)),i.sheets[s]={sheet:r,recalcstate:a.asloaded,name:s},t.Formula.FreshnessInfo.sheets[s]=void 0===n||!1===n,r},t.Formula.NormalizeSheetName=function(e){return t.Callbacks.NormalizeSheetName?t.Callbacks.NormalizeSheetName(e):e.toLowerCase()},t.Formula.RemoteFunctionInfo={waitingForServer:null},t.Formula.FreshnessInfo={sheets:{},"volatile":{},recalc_completed:!1},t.Formula.FreshnessInfoReset=function(){var e=t.Formula.FreshnessInfo,o=t.Formula.SheetCache;for(var n in e.sheets)!1===e.sheets[n]&&delete o.sheets[n];e.sheets={},e["volatile"]={},e.recalc_completed=!1},t.Formula.PlainCoord=function(e){return-1==e.indexOf("$")?e:e.replace(/\$/g,"")},t.Formula.OrderRangeParts=function(e,o){var n,r,i={};return n=t.coordToCr(e),r=t.coordToCr(o),n.col>r.col?(i.c1=r.col,i.c2=n.col):(i.c1=n.col,i.c2=r.col),n.row>r.row?(i.r1=r.row,i.r2=n.row):(i.r1=n.row,i.r2=r.row),i},t.Formula.TestCriteria=function(e,o,n){var r,i,a,s,l;if(null==n)return!1;if(n+="",r=n.charAt(0),"="==r||"<"==r||">"==r?i=n.substring(1):-1!=n.search(/([^~]\*|^\*)/)||-1!=n.search(/([^~]\?|^\?)/)?(r="regex","*"==n?i=".+":(i=n.split("").reverse().join(""),i=i.replace(/\?(?=[^~])|\?$/g,"?.").replace(/\?~/g,"?\\").replace(/\*(?=[^~])|\*$/g,"*.").replace(/\*~/,"*\\"),i=i.split("").reverse().join("")),i="^"+i+"$"):(r=n.substring(0,2),"<="==r||"<>"==r||">="==r?i=n.substring(2):(r="none",i=n)),a=t.DetermineValueType(i),!a.type){if("none"==r)return!1;if("b"==o.charAt(0)){if("="==r)return!0}else if("<>"==r)return!0;return!1}if(s=!1,"n"==a.type.charAt(0)&&"t"==o.charAt(0)&&(l=t.DetermineValueType(e),"n"==l.type.charAt(0)&&(e=l.value,o=l.type)),"n"==o.charAt(0)&&"n"==a.type.charAt(0))switch(e-=0,a.value=a.value-0,r){case"<":s=e<a.value;break;case"<=":s=e<=a.value;break;case"=":case"none":s=e==a.value;break;case">=":s=e>=a.value;break;case">":s=e>a.value;break;case"<>":s=e!=a.value}else if("e"==o.charAt(0))s=!1;else if("e"==a.type.charAt(0))s=!1;else{if("n"==o.charAt(0)&&(e=t.format_number_for_display(e,"n","")),"n"==a.type.charAt(0))return!1;switch(e=e?e.toLowerCase():"",a.value=a.value?a.value.toLowerCase():"",r){case"<":s=e<a.value;break;case"<=":s=e<=a.value;break;case"=":s=e==a.value;break;case"none":s=e.substring(0,a.value.length)==a.value;break;case">=":s=e>=a.value;break;case">":s=e>a.value;break;case"<>":s=e!=a.value;break;case"regex":try{s=-1!=e.search(new RegExp(a.value))}catch(e){s=!1}}}return s};/*
// The module of the SocialCalc package for the optional popup menus in socialcalcspreadsheetcontrol.js
//
// (c) Copyright 2009 Socialtext, Inc.
// All Rights Reserved.
//
// The contents of this file are subject to the Artistic License 2.0; you may not
// use this file except in compliance with the License. You may obtain a copy of
// the License at http://socialcalc.org/licenses/al-20/.
//
// Some of the other files in the SocialCalc package are licensed under
// different licenses. Please note the licenses of the modules you use.
//
// Code History:
//
// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.
//
*/
var t;t||(t={}),t.Popup={},t.Popup.Types={},t.Popup.Controls={},t.Popup.Current={},t.Popup.LocalizeString=function(e){return e},t.Popup.Create=function(e,o,n){var r=t.Popup.Types[e];r&&r.Create&&r.Create(e,o,n),t.Popup.imagePrefix=t.Constants.defaultImagePrefix},t.Popup.SetValue=function(e,o){var n=t.Popup,r=n.Types,i=n.Controls;if(!i[e])return void alert("Unknown control "+e);var a=i[e].type,s=r[a],l=i[e].data;s&&s.Create&&(s.SetValue(a,e,o),l.attribs&&l.attribs.changedcallback&&l.attribs.changedcallback(l.attribs,e,o))},t.Popup.SetDisabled=function(e,o){var n=t.Popup,r=n.Types,i=n.Controls;if(!i[e])return void alert("Unknown control "+e);var a=i[e].type,s=r[a];s&&s.Create&&(n.Current.id&&e==n.Current.id&&(s.Hide(a,n.Current.id),n.Current.id=null),s.SetDisabled(a,e,o))},t.Popup.GetValue=function(e){var o=t.Popup,n=o.Types,r=o.Controls;if(!r[e])return void alert("Unknown control "+e);var i=r[e].type,a=n[i];return a&&a.Create?a.GetValue(i,e):null},t.Popup.Initialize=function(e,o){var n=t.Popup,r=n.Types,i=n.Controls;if(!i[e])return void alert("Unknown control "+e);var a=i[e].type,s=r[a];s&&s.Initialize&&s.Initialize(a,e,o)},t.Popup.Reset=function(e){var o=t.Popup,n=o.Types;o.Controls;n[e].Reset&&n[e].Reset(e)},t.Popup.CClick=function(e){var o=t.Popup,n=o.Types,r=o.Controls;if(!r[e])return void alert("Unknown control "+e);if(!r[e].data||!r[e].data.disabled){var i=r[e].type,a=n[i];if(o.Current.id&&(n[r[o.Current.id].type].Hide(i,o.Current.id),e==o.Current.id))return void(o.Current.id=null);a&&a.Show&&a.Show(i,e),o.Current.id=e}},t.Popup.Close=function(){var e=t.Popup;e.Types,e.Controls;e.Current.id&&e.CClick(e.Current.id)},t.Popup.Cancel=function(){var e=t.Popup,o=e.Types,n=e.Controls;if(e.Current.id){var r=n[e.Current.id].type;o[r].Cancel(r,e.Current.id),e.Current.id=null}},t.Popup.CreatePopupDiv=function(e,o){var n,r=t.Popup,i=r.Controls,a=i[e].data,s=document.createElement("div");return s.style.position="absolute",n=t.GetElementPosition(a.mainele),s.style.top=n.top+a.mainele.offsetHeight+"px",s.style.left=n.left+"px",s.style.zIndex=100,s.style.backgroundColor="#FFF",s.style.border="1px solid black",o.width&&(s.style.width=o.width),a.mainele.appendChild(s),o.title&&(s.innerHTML='<table cellspacing="0" cellpadding="0" style="border-bottom:1px solid black;"><tr><td style="font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;">'+o.title+'</td><td style="font-size:10px;cursor:default;color:#666;" onclick="SocialCalc.Popup.Cancel();">&nbsp;X&nbsp;</td></tr></table>',o.moveable&&(a.dragregistered=s.firstChild.firstChild.firstChild.firstChild,t.DragRegister(a.dragregistered,!0,!0,{MouseDown:t.DragFunctionStart,MouseMove:t.DragFunctionPosition,MouseUp:t.DragFunctionPosition,Disabled:null,positionobj:s},a.mainele))),s},t.Popup.EnsurePosition=function(e,o){function n(e){var o=t.GetElementPosition(e);return o.height=e.offsetHeight,o.width=e.offsetWidth,o.bottom=o.top+o.height,o.right=o.left+o.width,o}var r=t.Popup,i=r.Controls,a=i[e].data,s=a.mainele.firstChild;if(!s)return void alert("No main popup element firstChild.");var l=a.popupele,c=n(l),d=n(o),u=n(s);u.bottom+c.height<d.bottom&&u.left+c.width<d.right?(l.style.top=u.bottom+"px",l.style.left=u.left+"px"):u.top-c.height>d.top&&u.left+c.width<d.right?(l.style.top=u.top-c.height+"px",l.style.left=u.left+"px"):u.bottom+c.height<d.bottom&&u.right-c.width>d.left?(l.style.top=u.bottom+"px",l.style.left=u.right-c.width+"px"):u.top-c.height>d.top&&u.right-c.width>d.left?(l.style.top=u.top-c.height+"px",l.style.left=u.right-c.width+"px"):u.bottom+c.height<d.bottom&&c.width<d.width?(l.style.top=u.bottom+"px",l.style.left=d.left+Math.floor((d.width-c.width)/2)+"px"):u.top-c.height>d.top&&c.width<d.width?(l.style.top=u.top-c.height+"px",l.style.left=d.left+Math.floor((d.width-c.width)/2)+"px"):c.height<d.height&&u.right+c.width<d.right?(l.style.top=d.top+Math.floor((d.height-c.height)/2)+"px",l.style.left=u.right+"px"):c.height<d.height&&u.left-c.width>d.left&&(l.style.top=d.top+Math.floor((d.height-c.height)/2)+"px",l.style.left=u.left-c.width+"px")},t.Popup.DestroyPopupDiv=function(e,o){e&&(e.innerHTML="",t.DragUnregister(o),e.parentNode&&e.parentNode.removeChild(e))},t.Popup.RGBToHex=function(e){var o=t.Popup;if(""==e)return"000000";var n=e.match(/(\d+)\D+(\d+)\D+(\d+)/);return n?o.ToHex(n[1])+o.ToHex(n[2])+o.ToHex(n[3]):"000000"},t.Popup.HexDigits="0123456789ABCDEF",t.Popup.ToHex=function(e){var o=t.Popup,n=Math.floor(e/16),r=e%16;return o.HexDigits.charAt(n)+o.HexDigits.charAt(r)},t.Popup.FromHex=function(e){var o=t.Popup,n=o.HexDigits.indexOf(e.charAt(0).toUpperCase()),r=o.HexDigits.indexOf(e.charAt(1).toUpperCase());return 16*(n>=0?n:0)+(r>=0?r:0)},t.Popup.HexToRGB=function(e){var o=t.Popup;return"rgb("+o.FromHex(e.substring(1,3))+","+o.FromHex(e.substring(3,5))+","+o.FromHex(e.substring(5,7))+")"},t.Popup.makeRGB=function(e,t,o){return"rgb("+(e>0?e:0)+","+(t>0?t:0)+","+(o>0?o:0)+")"},t.Popup.splitRGB=function(e){var t=e.match(/(\d+)\D+(\d+)\D+(\d+)\D/);return t?{r:t[1]-0,g:t[2]-0,b:t[3]-0}:{r:0,g:0,b:0}},t.Popup.Types.List={},t.Popup.Types.List.Create=function(e,o,n){var r=t.Popup,i=(r.Types,r.Controls),a={type:e,value:"",display:"",data:{}};i[o]=a;var s=a.data;s.attribs=n||{};var l=document.getElementById(o);if(!l)return void alert("Missing element "+o);s.mainele=l,l.innerHTML='<input style="cursor:pointer;width:100px;font-size:smaller;" onfocus="this.blur();" onclick="SocialCalc.Popup.CClick(\''+o+'\');" value="">',s.options=[]},t.Popup.Types.List.SetValue=function(e,n,r){var i,a=t.Popup,s=(a.Types,a.Controls),l=s[n].data;for(l.value=r,l.custom=!1,i=0;i<l.options.length;i++)if(o=l.options[i],!(o.a&&(o.a.skip||o.a.custom||o.a.cancel)||o.v!=l.value)){l.display=o.o;break}i==l.options.length&&(l.display="Custom",l.custom=!0),l.mainele&&l.mainele.firstChild&&(l.mainele.firstChild.value=l.display)},t.Popup.Types.List.SetDisabled=function(e,o,n){var r=t.Popup,i=(r.Types,r.Controls),a=i[o].data;a.disabled=n,a.mainele&&a.mainele.firstChild&&(a.mainele.firstChild.disabled=n)},t.Popup.Types.List.GetValue=function(e,o){var n=t.Popup;n.Types;return n.Controls[o].data.value},t.Popup.Types.List.Initialize=function(e,o,n){var r,i=t.Popup,a=(i.Types,i.Controls),s=a[o].data;for(r in n.attribs)s.attribs[r]=n.attribs[r];s.options=n?n.options:[],n.value&&i.SetValue(o,n.value)},t.Popup.Types.List.Reset=function(e){var o=t.Popup,n=o.Types,r=o.Controls;o.Current.id&&r[o.Current.id].type==e&&(n[e].Hide(e,o.Current.id),o.Current.id=null)},t.Popup.Types.List.Show=function(e,o){var n,r=t.Popup,i=(r.Types,r.Controls),a=i[o].data,s="";a.popupele=r.CreatePopupDiv(o,a.attribs),a.custom?(s=t.Popup.Types.List.MakeCustom(e,o),n=document.createElement("div"),n.innerHTML='<div style="cursor:default;padding:4px;background-color:#CCC;">'+s+"</div>",a.customele=n.firstChild.firstChild.childNodes[1],a.listdiv=null,a.contentele=n):(s=t.Popup.Types.List.MakeList(e,o),n=document.createElement("div"),n.innerHTML='<div style="cursor:default;padding:4px;">'+s+"</div>",a.customele=null,a.listdiv=n.firstChild,a.contentele=n),a.mainele&&a.mainele.firstChild&&(a.mainele.firstChild.disabled=!0),a.popupele.appendChild(n),a.attribs.ensureWithin&&t.Popup.EnsurePosition(o,a.attribs.ensureWithin)},t.Popup.Types.List.MakeList=function(e,o){var n,r,i,a=t.Popup,s=(a.Types,a.Controls),l=s[o].data,c='<table cellspacing="0" cellpadding="0"><tr>',d='<td style="vertical-align:top;">';for(c+=d,l.ncols=1,n=0;n<l.options.length;n++){if(r=l.options[n],r.a){if(r.a.newcol){c+="</td>"+d+"&nbsp;&nbsp;&nbsp;&nbsp;</td>"+d,l.ncols+=1;continue}if(r.a.skip){c+='<div style="font-size:x-small;white-space:nowrap;">'+r.o+"</div>";continue}}i=r.v!=l.value||r.a&&(r.a.custom||r.a.cancel)?"":"background-color:#DDF;",c+='<div style="font-size:x-small;white-space:nowrap;'+i+'" onclick="SocialCalc.Popup.Types.List.ItemClicked(\''+o+"','"+n+"');\" onmousemove=\"SocialCalc.Popup.Types.List.MouseMove('"+o+"',this);\">"+r.o+"</div>"}return c+="</td></tr></table>"},t.Popup.Types.List.MakeCustom=function(e,o){var n=t.Popup.LocalizeString,r=t.Popup,i=(r.Types,r.Controls),a=i[o].data,s='style="font-size:smaller;"',l=a.value;return l=t.special_chars(l),'<div style="white-space:nowrap;"><br><input id="customvalue" value="'+l+'"><br><br><input '+s+' type="button" value="'+n("OK")+'" onclick="SocialCalc.Popup.Types.List.CustomOK(\''+o+"');return false;\"><input "+s+' type="button" value="'+n("List")+'" onclick="SocialCalc.Popup.Types.List.CustomToList(\''+o+"');\"><input "+s+' type="button" value="'+n("Cancel")+'" onclick="SocialCalc.Popup.Close();"><br></div>'},t.Popup.Types.List.ItemClicked=function(e,o){var n,r,i,a=t.Popup,s=(a.Types,a.Controls),l=s[e].data,c=l.options[o].a;return c&&c.custom?(n=l.contentele,r=t.Popup.Types.List.MakeCustom("List",e),i=document.createElement("div"),i.innerHTML='<div style="cursor:default;padding:4px;background-color:#CCC;">'+r+"</div>",l.customele=i.firstChild.firstChild.childNodes[1],l.listdiv=null,l.contentele=i,l.popupele.replaceChild(i,n),void(l.attribs.ensureWithin&&t.Popup.EnsurePosition(e,l.attribs.ensureWithin))):c&&c.cancel?void t.Popup.Close():(t.Popup.SetValue(e,l.options[o].v),void t.Popup.Close())},t.Popup.Types.List.CustomToList=function(e){var o,n,r,i=t.Popup,a=(i.Types,i.Controls),s=a[e].data;o=s.contentele,n=t.Popup.Types.List.MakeList("List",e),r=document.createElement("div"),r.innerHTML='<div style="cursor:default;padding:4px;">'+n+"</div>",s.customele=null,s.listdiv=r.firstChild,s.contentele=r,s.popupele.replaceChild(r,o),s.attribs.ensureWithin&&t.Popup.EnsurePosition(e,s.attribs.ensureWithin)},t.Popup.Types.List.CustomOK=function(e){var o=t.Popup,n=(o.Types,o.Controls),r=n[e].data;t.Popup.SetValue(e,r.customele.value),t.Popup.Close()},t.Popup.Types.List.MouseMove=function(e,o){var n,r,i=t.Popup,a=(i.Types,i.Controls),s=a[e].data,l=s.listdiv;if(l){var c=l.firstChild.firstChild.firstChild;for(n=0;n<s.ncols;n++)for(r=0;r<c.childNodes[2*n].childNodes.length;r++)c.childNodes[2*n].childNodes[r].style.backgroundColor="#FFF";o.style.backgroundColor="#DDF"}},t.Popup.Types.List.Hide=function(e,o){var n=t.Popup,r=(n.Types,n.Controls),i=r[o].data;n.DestroyPopupDiv(i.popupele,i.dragregistered),i.popupele=null,i.mainele&&i.mainele.firstChild&&(i.mainele.firstChild.disabled=!1)},t.Popup.Types.List.Cancel=function(e,o){t.Popup.Types.List.Hide(e,o)},t.Popup.Types.ColorChooser={},t.Popup.Types.ColorChooser.Create=function(e,o,n){var r=t.Popup,i=(r.Types,r.Controls),a={type:e,value:"",display:"",data:{}};i[o]=a;var s=a.data;s.attribs=n||{};var l=s.attribs;s.value="";var c=document.getElementById(o);if(!c)return void alert("Missing element "+o);s.mainele=c,c.innerHTML='<div style="cursor:pointer;border:1px solid black;vertical-align:top;width:'+(l.sampleWidth||"15px")+";height:"+(l.sampleHeight||"15px")+';" onclick="SocialCalc.Popup.Types.ColorChooser.ControlClicked(\''+o+"');\">&nbsp;</div>"},t.Popup.Types.ColorChooser.SetValue=function(e,o,n){var r,i,a=t.Popup,s=(a.Types,a.Controls),l=s[o].data,c=l.attribs;l.value=n,l.custom=!1,l.mainele&&l.mainele.firstChild&&(l.value?(l.mainele.firstChild.style.backgroundColor=l.value,r=c.backgroundImage?"url("+a.imagePrefix+c.backgroundImage+")":"",i="center center"):(l.mainele.firstChild.style.backgroundColor="#FFF",c.backgroundImageDefault?(r="url("+a.imagePrefix+c.backgroundImageDefault+")",i="center center"):(r="url("+a.imagePrefix+"defaultcolor.gif)",i="left top")),l.mainele.firstChild.style.backgroundPosition=i,l.mainele.firstChild.style.backgroundImage=r)},t.Popup.Types.ColorChooser.SetDisabled=function(e,o,n){var r=t.Popup,i=(r.Types,r.Controls),a=i[o].data,s=a.attribs;a.disabled=n,a.mainele&&a.mainele.firstChild&&(n?(a.mainele.firstChild.style.backgroundColor="#DDD",s.backgroundImageDisabled?(img="url("+r.imagePrefix+s.backgroundImageDisabled+")",pos="center center"):(img="url("+r.imagePrefix+"defaultcolor.gif)",pos="left top"),a.mainele.firstChild.style.backgroundPosition=pos,a.mainele.firstChild.style.backgroundImage=img):r.SetValue(o,a.value))},t.Popup.Types.ColorChooser.GetValue=function(e,o){var n=t.Popup;n.Types;return n.Controls[o].data.value},t.Popup.Types.ColorChooser.Initialize=function(e,o,n){var r,i=t.Popup,a=(i.Types,i.Controls),s=a[o].data;for(r in n.attribs)s.attribs[r]=n.attribs[r];n.value&&i.SetValue(o,n.value)},t.Popup.Types.ColorChooser.Reset=function(e){var o=t.Popup,n=o.Types,r=o.Controls;o.Current.id&&r[o.Current.id].type==e&&(n[e].Hide(e,o.Current.id),o.Current.id=null)},t.Popup.Types.ColorChooser.Show=function(e,o){var n,r,i=t.Popup,a=(i.Types,i.Controls),s=a[o].data,l="";s.oldvalue=s.value,s.popupele=i.CreatePopupDiv(o,s.attribs),s.custom?(l=t.Popup.Types.ColorChooser.MakeCustom(e,o),n=document.createElement("div"),n.innerHTML='<div style="cursor:default;padding:4px;background-color:#CCC;">'+l+"</div>",s.customele=n.firstChild.firstChild.childNodes[2],s.contentele=n):(r=t.Popup.Types.ColorChooser.CreateGrid(e,o),n=document.createElement("div"),n.style.padding="3px",n.style.backgroundColor="#CCC",n.appendChild(r),s.customele=null,s.contentele=n),s.popupele.appendChild(n),s.attribs.ensureWithin&&t.Popup.EnsurePosition(o,s.attribs.ensureWithin)},t.Popup.Types.ColorChooser.MakeCustom=function(e,o){var n=t.Popup,r=(n.Types,n.Controls),i=r[o].data,a=n.LocalizeString,s='style="font-size:smaller;"';return'<div style="white-space:nowrap;"><br>#<input id="customvalue" style="width:75px;" value="'+i.value+'"><br><br><input '+s+' type="button" value="'+a("OK")+'" onclick="SocialCalc.Popup.Types.ColorChooser.CustomOK(\''+o+"');return false;\"><input "+s+' type="button" value="'+a("Grid")+'" onclick="SocialCalc.Popup.Types.ColorChooser.CustomToGrid(\''+o+"');\"><br></div>"},t.Popup.Types.ColorChooser.ItemClicked=function(e){var o=t.Popup,n=(o.Types,o.Controls);n[e].data;t.Popup.Close()},t.Popup.Types.ColorChooser.CustomToList=function(e){var o=t.Popup,n=(o.Types,o.Controls);n[e].data},t.Popup.Types.ColorChooser.CustomOK=function(e){var o=t.Popup,n=(o.Types,o.Controls),r=n[e].data;o.SetValue(e,r.customele.value),o.Close()},t.Popup.Types.ColorChooser.Hide=function(e,o){var n=t.Popup,r=(n.Types,n.Controls),i=r[o].data;n.DestroyPopupDiv(i.popupele,i.dragregistered),i.popupele=null},t.Popup.Types.ColorChooser.Cancel=function(e,o){var n=t.Popup,r=(n.Types,n.Controls),i=r[o].data;n.SetValue(o,i.oldvalue),t.Popup.Types.ColorChooser.Hide(e,o)},t.Popup.Types.ColorChooser.CreateGrid=function(e,o){var n,r,i,a,s,l=t.Popup,c=l.Types,d=l.Controls,u=l.LocalizeString,p=d[o].data;p.grid={};var h=p.grid,f=document.createElement("div");for(n=document.createElement("table"),n.cellSpacing=0,n.cellPadding=0,n.style.width="100px",h.table=n,n=document.createElement("tbody"),h.table.appendChild(n),h.tbody=n,r=0;r<16;r++){for(i=document.createElement("tr"),a=0;a<5;a++)s={},h[r+","+a]=s,n=document.createElement("td"),n.style.fontSize="1px",n.innerHTML="&nbsp;",n.style.height="10px",a<=1?(n.style.width="17px",n.style.borderRight="3px solid white"):(n.style.width="20px",n.style.backgroundRepeat="no-repeat"),i.appendChild(n),s.ele=n;h.tbody.appendChild(i)}return f.appendChild(h.table),n=document.createElement("div"),n.style.marginTop="3px",n.innerHTML='<table cellspacing="0" cellpadding="0"><tr><td style="width:17px;background-color:#FFF;background-image:url('+l.imagePrefix+'defaultcolor.gif);height:16px;font-size:10px;cursor:pointer;" title="'+u("Default")+'">&nbsp;</td><td style="width:23px;height:16px;font-size:10px;text-align:center;cursor:pointer;" title="'+u("Custom")+'">#</td><td style="width:60px;height:16px;font-size:10px;text-align:center;cursor:pointer;">'+u("OK")+"</td></tr></table>",h.defaultbox=n.firstChild.firstChild.firstChild.childNodes[0],h.defaultbox.onclick=c.ColorChooser.DefaultClicked,h.custom=n.firstChild.firstChild.firstChild.childNodes[1],h.custom.onclick=c.ColorChooser.CustomClicked,h.msg=n.firstChild.firstChild.firstChild.childNodes[2],h.msg.onclick=c.ColorChooser.CloseOK,f.appendChild(n),h.table.onmousedown=c.ColorChooser.GridMouseDown,c.ColorChooser.DetermineColors(o),c.ColorChooser.SetColors(o),f},t.Popup.Types.ColorChooser.gridToG=function(e,t,o){return e[t+","+o]},t.Popup.Types.ColorChooser.DetermineColors=function(e){var o,n,r=t.Popup,i=r.Types,a=i.ColorChooser,s=r.Controls,l=s[e].data,c=l.grid,d=r.splitRGB(l.value);for(o=2,n=16-Math.floor((d.r+16)/16),c["selectedrow"+o]=n,n=0;n<16;n++)a.gridToG(c,n,o).rgb=r.makeRGB(17*(15-n),0,0);for(o=3,n=16-Math.floor((d.g+16)/16),c["selectedrow"+o]=n,n=0;n<16;n++)a.gridToG(c,n,o).rgb=r.makeRGB(0,17*(15-n),0);for(o=4,n=16-Math.floor((d.b+16)/16),c["selectedrow"+o]=n,n=0;n<16;n++)a.gridToG(c,n,o).rgb=r.makeRGB(0,0,17*(15-n));for(o=1,n=0;n<16;n++)a.gridToG(c,n,o).rgb=r.makeRGB(17*(15-n),17*(15-n),17*(15-n));o=0;var u,p=[0,68,153,204,255],h=["400","310","420","440","442","340","040","042","032","044","024","004","204","314","402","414"];for(n=0;n<16;n++)u=h[n],a.gridToG(c,n,o).rgb="rgb("+p[u.charAt(0)-0]+","+p[u.charAt(1)-0]+","+p[u.charAt(2)-0]+")"},t.Popup.Types.ColorChooser.SetColors=function(e){var o,n,r,i,a=t.Popup,s=a.Types,l=s.ColorChooser,c=a.Controls,d=c[e].data,u=d.grid;for(o=0;o<16;o++)for(n=0;n<5;n++)r=l.gridToG(u,o,n),r.ele.style.backgroundColor=r.rgb,r.ele.title=a.RGBToHex(r.rgb),u["selectedrow"+n]==o?r.ele.style.backgroundImage="url("+a.imagePrefix+"chooserarrow.gif)":r.ele.style.backgroundImage="";a.SetValue(e,d.value),u.msg.style.backgroundColor=d.value,i=a.splitRGB(d.value||"rgb(255,255,255)"),i.r+i.g+i.b<220?u.msg.style.color="#FFF":u.msg.style.color="#000",d.value?(u.msg.style.backgroundImage="",u.msg.title=a.RGBToHex(d.value)):(u.msg.style.backgroundColor="#FFF",u.msg.style.backgroundImage="url("+a.imagePrefix+"defaultcolor.gif)",u.msg.title="Default")},t.Popup.Types.ColorChooser.GridMouseDown=function(o){var n=o||e.event,r=t.Popup,i=r.Types,a=i.ColorChooser,s=r.Controls,l=r.Current.id;if(l){var c=s[l].data,d=c.grid;switch(n.type){case"mousedown":d.mousedown=!0;break;case"mouseup":d.mousedown=!1;break;case"mousemove":if(!d.mousedown)return}var u=t.GetElementPositionWithScroll(c.mainele),p=n.clientX-u.left,h=n.clientY-u.top,f=t.GetElementPositionWithScroll(d.table);f.left-=u.left,f.top-=u.top;var m=Math.floor((h-f.top-2)/10);m=m<0?0:m;var g=Math.floor((p-f.left)/20);m=m<0?0:m>15?15:m,g=g<0?0:g>4?4:g;var v=a.gridToG(d,m,g).ele.style.backgroundColor,y=r.splitRGB(v),b=r.splitRGB(c.value);switch(g){case 2:c.value=r.makeRGB(y.r,b.g,b.b);break;case 3:c.value=r.makeRGB(b.r,y.g,b.b);break;case 4:c.value=r.makeRGB(b.r,b.g,y.b);break;case 0:case 1:c.value=v}a.DetermineColors(l),a.SetColors(l)}},t.Popup.Types.ColorChooser.ControlClicked=function(e){var o=t.Popup,n=o.Types,r=n.ColorChooser,i=(o.Controls,o.Current.id);if(!i||e!=i)return void o.CClick(e);r.CloseOK()},t.Popup.Types.ColorChooser.DefaultClicked=function(o){var n=(o||e.event,t.Popup),r=n.Types,i=(r.ColorChooser,n.Controls),a=n.Current.id;if(a){var s=i[a].data;s.value="",t.Popup.SetValue(a,s.value),t.Popup.Close()}},t.Popup.Types.ColorChooser.CustomClicked=function(o){var n=(o||e.event,t.Popup),r=n.Types,i=(r.ColorChooser,n.Controls),a=n.Current.id;if(a){var s,l,c,d=i[a].data;s=d.contentele,l=t.Popup.Types.ColorChooser.MakeCustom("ColorChooser",a),c=document.createElement("div"),c.innerHTML='<div style="cursor:default;padding:4px;background-color:#CCC;">'+l+"</div>",d.customele=c.firstChild.firstChild.childNodes[2],d.contentele=c,d.popupele.replaceChild(c,s),d.customele.value=n.RGBToHex(d.value),d.attribs.ensureWithin&&t.Popup.EnsurePosition(a,d.attribs.ensureWithin)}},t.Popup.Types.ColorChooser.CustomToGrid=function(e){var o,n,r=t.Popup,i=(r.Types,r.Controls),a=i[e].data;t.Popup.SetValue(e,r.HexToRGB("#"+a.customele.value));var o,s,n;o=a.contentele,s=t.Popup.Types.ColorChooser.CreateGrid("ColorChooser",e),n=document.createElement("div"),n.style.padding="3px",n.style.backgroundColor="#CCC",n.appendChild(s),a.customele=null,a.contentele=n,a.popupele.replaceChild(n,o),a.attribs.ensureWithin&&t.Popup.EnsurePosition(e,a.attribs.ensureWithin)},t.Popup.Types.ColorChooser.CustomOK=function(e){var o=t.Popup,n=(o.Types,o.Controls),r=n[e].data;t.Popup.SetValue(e,o.HexToRGB("#"+r.customele.value)),t.Popup.Close()},t.Popup.Types.ColorChooser.CloseOK=function(o){var n=(o||e.event,t.Popup),r=n.Types,i=(r.ColorChooser,n.Controls),a=n.Current.id;if(a){var s=i[a].data;t.Popup.SetValue(a,s.value),t.Popup.Close()}};/*
// The code module of the SocialCalc package that lets you embed a spreadsheet
// control with toolbar, etc., into a web page.
//
// (c) Copyright 2008, 2009, 2010 Socialtext, Inc.
// All Rights Reserved.
//


/*

LEGAL NOTICES REQUIRED BY THE COMMON PUBLIC ATTRIBUTION LICENSE:

EXHIBIT A. Common Public Attribution License Version 1.0.

The contents of this file are subject to the Common Public Attribution License Version 1.0 (the
"License"); you may not use this file except in compliance with the License. You may obtain a copy
of the License at http://socialcalc.org. The License is based on the Mozilla Public License Version 1.1 but
Sections 14 and 15 have been added to cover use of software over a computer network and provide for
limited attribution for the Original Developer. In addition, Exhibit A has been modified to be
consistent with Exhibit B.

Software distributed under the License is distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY
KIND, either express or implied. See the License for the specific language governing rights and
limitations under the License.

The Original Code is SocialCalc JavaScript SpreadsheetControl.

The Original Developer is the Initial Developer.

The Initial Developer of the Original Code is Socialtext, Inc. All portions of the code written by
Socialtext, Inc., are Copyright (c) Socialtext, Inc. All Rights Reserved.

Contributor: Dan Bricklin.


EXHIBIT B. Attribution Information

When the SpreadsheetControl is producing and/or controlling the display the Graphic Image must be
displayed on the screen visible to the user in a manner comparable to that in the
Original Code. The Attribution Phrase must be displayed as a "tooltip" or "hover-text" for
that image. The image must be linked to the Attribution URL so as to access that page
when clicked. If the user interface includes a prominent "about" display which includes
factual prominent attribution in a form similar to that in the "about" display included
with the Original Code, including Socialtext copyright notices and URLs, then the image
need not be linked to the Attribution URL but the "tool-tip" is still required.

Attribution Copyright Notice:

 Copyright (C) 2010 Socialtext, Inc.
 All Rights Reserved.

Attribution Phrase (not exceeding 10 words): SocialCalc

Attribution URL: http://www.socialcalc.org/

Graphic Image: The contents of the sc-logo.gif file in the Original Code or
a suitable replacement from http://www.socialcalc.org/licenses specified as
being for SocialCalc.

Display of Attribution Information is required in Larger Works which are defined
in the CPAL as a work which combines Covered Code or portions thereof with code
not governed by the terms of the CPAL.

*/
var t;t||(alert("Main SocialCalc code module needed"),t={}),t.TableEditor||alert("SocialCalc TableEditor code module needed"),t.CurrentSpreadsheetControlObject=null,t.SpreadsheetControl=function(e){var o=t.Constants;this.parentNode=null,this.spreadsheetDiv=null,this.requestedHeight=0,this.requestedWidth=0,this.requestedSpaceBelow=0,this.height=0,this.width=0,this.viewheight=0,this.tabs=[],this.tabnums={},this.tabreplacements={},this.currentTab=-1,this.views={},this.sheet=null,this.context=null,this.editor=null,this.spreadsheetDiv=null,this.editorDiv=null,this.sortrange="",this.moverange="",this.idPrefix=e||"SocialCalc-",this.multipartBoundary="SocialCalcSpreadsheetControlSave",this.imagePrefix=o.defaultImagePrefix,this.toolbarbackground=o.SCToolbarbackground,this.tabbackground=o.SCTabbackground,this.tabselectedCSS=o.SCTabselectedCSS,this.tabplainCSS=o.SCTabplainCSS,this.toolbartext=o.SCToolbartext,this.formulabarheight=o.SCFormulabarheight,this.statuslineheight=o.SCStatuslineheight,this.statuslineCSS=o.SCStatuslineCSS,this.ExportCallback=null,"undefined"==typeof t.debug_log&&(t.debug_log=[]),this.sheet=new t.Sheet,this.context=new t.RenderContext(this.sheet),this.context.showGrid=!0,this.context.showRCHeaders=!0,this.editor=new t.TableEditor(this.context),this.editor.StatusCallback.statusline={func:t.SpreadsheetControlStatuslineCallback,params:{statuslineid:this.idPrefix+"statusline",recalcid1:this.idPrefix+"divider_recalc",recalcid2:this.idPrefix+"button_recalc"}},t.CurrentSpreadsheetControlObject=this,this.editor.MoveECellCallback.movefrom=function(e){var o=t.GetSpreadsheetControlObject();o.context.cursorsuffix="",e.range2.hasrange&&!e.cellhandles.noCursorSuffix&&(e.ecell.row==e.range2.top&&(e.ecell.col<e.range2.left||e.ecell.col>e.range2.right+1)&&(o.context.cursorsuffix="insertleft"),e.ecell.col==e.range2.left&&(e.ecell.row<e.range2.top||e.ecell.row>e.range2.bottom+1)&&(o.context.cursorsuffix="insertup"))},this.formulabuttons={formulafunctions:{image:"insertformula.png",tooltip:"Functions",command:t.SpreadsheetControl.DoFunctionList},multilineinput:{image:"listbox.png",tooltip:"Multi-line Input Box",command:t.SpreadsheetControl.DoMultiline},link:{image:"inserthyperlink.png",tooltip:"Link Input Box",command:t.SpreadsheetControl.DoLink},sum:{image:"autosum.png",tooltip:"Auto Sum",command:t.SpreadsheetControl.DoSum}},this.findbuttons={last:{image:"upsearch.png",tooltip:"Find Previous",command:t.SpreadsheetControl.SearchUp},next:{image:"downsearch.png",tooltip:"Find Next",command:t.SpreadsheetControl.SearchDown}},this.tabnums.edit=this.tabs.length,this.tabs.push({name:"edit",text:"Edit",html:' <div id="%id.edittools" style="padding:10px 0px 0px 0px;">&nbsp;<img id="%id.button_undo" src="%img.undo.png" style="vertical-align:bottom;"> <img id="%id.button_redo" src="%img.redo.png" style="vertical-align:bottom;"> &nbsp;<img src="%img.divider1.png" style="vertical-align:bottom;">&nbsp; <img id="%id.button_copy" src="%img.copy.png" style="vertical-align:bottom;"> <img id="%id.button_cut" src="%img.cut.png" style="vertical-align:bottom;"> <img id="%id.button_paste" src="%img.paste.png" style="vertical-align:bottom;"> &nbsp;<img src="%img.divider1.png" style="vertical-align:bottom;">&nbsp; <img id="%id.button_delete" src="%img.delete.png" style="vertical-align:bottom;"> <img id="%id.button_pasteformats" src="%img.formatpaintbrush.png" style="vertical-align:bottom;"> &nbsp;<img src="%img.divider1.png" style="vertical-align:bottom;">&nbsp;  <span id="%id.locktools"><img id="%id.button_lock" src="%img.lock.png" style="vertical-align:bottom;"> <img id="%id.button_unlock" src="%img.unlock.png" style="vertical-align:bottom;"> &nbsp;<img src="%img.divider1.png" style="vertical-align:bottom;">&nbsp;</span> <img id="%id.button_filldown" src="%img.filldown.png" style="vertical-align:bottom;"> <img id="%id.button_fillright" src="%img.fillright.png" style="vertical-align:bottom;"> &nbsp;<img src="%img.divider1.png" style="vertical-align:bottom;">&nbsp; <img id="%id.button_movefrom" src="%img.movefromoff.gif" style="vertical-align:bottom;"> <img id="%id.button_movepaste" src="%img.movepasteoff.gif" style="vertical-align:bottom;"> <img id="%id.button_moveinsert" src="%img.moveinsertoff.gif" style="vertical-align:bottom;"> &nbsp;<img src="%img.divider1.png" style="vertical-align:bottom;">&nbsp; <img id="%id.button_alignleft" src="%img.alignleft.png" style="vertical-align:bottom;"> <img id="%id.button_aligncenter" src="%img.aligncenter.png" style="vertical-align:bottom;"> <img id="%id.button_alignright" src="%img.alignright.png" style="vertical-align:bottom;"> &nbsp;<img src="%img.divider1.png" style="vertical-align:bottom;">&nbsp; <img id="%id.button_borderon" src="%img.borderson.png" style="vertical-align:bottom;">  <img id="%id.button_borderoff" src="%img.bordersoff.png" style="vertical-align:bottom;">  <img id="%id.button_swapcolors" src="%img.swapcolors.png" style="vertical-align:bottom;">  &nbsp;<img src="%img.divider1.png" style="vertical-align:bottom;">&nbsp; <img id="%id.button_merge" src="%img.mergecells.png" style="vertical-align:bottom;">  &nbsp;<img src="%img.divider1.png" style="vertical-align:bottom;">&nbsp; <img id="%id.button_insertrow" src="%img.insertrows.png" style="vertical-align:bottom;">  <img id="%id.button_insertcol" src="%img.insertcolumns.png" style="vertical-align:bottom;">  <img id="%id.button_deleterow" src="%img.deleterows.png" style="vertical-align:bottom;">  <img id="%id.button_deletecol" src="%img.deletecolumns.png" style="vertical-align:bottom;">  <img id="%id.button_hiderow" src="%img.hiderow.png" style="vertical-align:bottom;">  <img id="%id.button_hidecol" src="%img.hidecol.png" style="vertical-align:bottom;">  &nbsp;<img id="%id.divider_recalc" src="%img.divider1.png" style="vertical-align:bottom;">&nbsp; <img id="%id.button_recalc" src="%img.recalc.png" style="vertical-align:bottom;">  </div>',oncreate:null,onclick:null}),this.tabnums.settings=this.tabs.length,this.tabs.push({name:"settings",text:"Format",html:'<div id="%id.settingstools" style="display:none;"> <div id="%id.sheetsettingstoolbar" style="display:none;">  <table cellspacing="0" cellpadding="0"><tr><td>   <div style="%tbt.">%loc!SHEET SETTINGS!:</div>   </td></tr><tr><td>   <input id="%id.settings-savesheet" type="button" value="%loc!Save!" onclick="SocialCalc.SettingsControlSave(\'sheet\');">   <input type="button" value="%loc!Cancel!" onclick="SocialCalc.SettingsControlSave(\'cancel\');">   <input type="button" value="%loc!Show Cell Settings!" onclick="SocialCalc.SpreadsheetControlSettingsSwitch(\'cell\');return false;">   </td></tr></table> </div> <div id="%id.cellsettingstoolbar" style="display:none;">  <table cellspacing="0" cellpadding="0"><tr><td>   <div style="%tbt.">%loc!CELL SETTINGS!: <span id="%id.settingsecell">&nbsp;</span></div>   </td></tr><tr><td>  <input id="%id.settings-savecell" type="button" value="%loc!Save!" onclick="SocialCalc.SettingsControlSave(\'cell\');">  <input type="button" value="%loc!Cancel!" onclick="SocialCalc.SettingsControlSave(\'cancel\');">  <input type="button" value="%loc!Show Sheet Settings!" onclick="SocialCalc.SpreadsheetControlSettingsSwitch(\'sheet\');return false;">  </td></tr></table> </div></div>',view:"settings",onclick:function(e){t.SettingsControls.idPrefix=e.idPrefix,t.SettingControlReset();var o=e.sheet.EncodeSheetAttributes(),n=e.sheet.EncodeCellAttributes(e.editor.ecell.coord);t.SettingsControlLoadPanel(e.views.settings.values.sheetspanel,o),t.SettingsControlLoadPanel(e.views.settings.values.cellspanel,n),document.getElementById(e.idPrefix+"settingsecell").innerHTML=e.editor.ecell.coord,t.SpreadsheetControlSettingsSwitch("cell"),e.views.settings.element.style.height=e.viewheight+"px",e.views.settings.element.firstChild.style.height=e.viewheight+"px";var r;r=e.editor.range.hasrange?t.crToCoord(e.editor.range.left,e.editor.range.top)+":"+t.crToCoord(e.editor.range.right,e.editor.range.bottom):e.editor.ecell.coord,document.getElementById(e.idPrefix+"settings-savecell").value=t.LocalizeString("Save to")+": "+r},onclickFocus:!0}),this.views.settings={name:"settings",values:{},oncreate:function(e,o){var n=t.Constants;o.values.sheetspanel={colorchooser:{id:e.idPrefix+"scolorchooser"},formatnumber:{setting:"numberformat",type:"PopupList",id:e.idPrefix+"formatnumber",initialdata:n.SCFormatNumberFormats},formattext:{setting:"textformat",type:"PopupList",id:e.idPrefix+"formattext",initialdata:n.SCFormatTextFormats},fontfamily:{setting:"fontfamily",type:"PopupList",id:e.idPrefix+"fontfamily",initialdata:n.SCFormatFontfamilies},fontlook:{setting:"fontlook",type:"PopupList",id:e.idPrefix+"fontlook",initialdata:n.SCFormatFontlook},fontsize:{setting:"fontsize",type:"PopupList",id:e.idPrefix+"fontsize",initialdata:n.SCFormatFontsizes},textalignhoriz:{setting:"textalignhoriz",type:"PopupList",id:e.idPrefix+"textalignhoriz",initialdata:n.SCFormatTextAlignhoriz},numberalignhoriz:{setting:"numberalignhoriz",type:"PopupList",id:e.idPrefix+"numberalignhoriz",initialdata:n.SCFormatNumberAlignhoriz},alignvert:{setting:"alignvert",type:"PopupList",id:e.idPrefix+"alignvert",initialdata:n.SCFormatAlignVertical},textcolor:{setting:"textcolor",type:"ColorChooser",id:e.idPrefix+"textcolor"},bgcolor:{setting:"bgcolor",type:"ColorChooser",id:e.idPrefix+"bgcolor"},padtop:{setting:"padtop",type:"PopupList",id:e.idPrefix+"padtop",initialdata:n.SCFormatPadsizes},padright:{setting:"padright",type:"PopupList",id:e.idPrefix+"padright",initialdata:n.SCFormatPadsizes},padbottom:{setting:"padbottom",type:"PopupList",id:e.idPrefix+"padbottom",initialdata:n.SCFormatPadsizes},padleft:{setting:"padleft",type:"PopupList",id:e.idPrefix+"padleft",initialdata:n.SCFormatPadsizes},colwidth:{setting:"colwidth",type:"PopupList",id:e.idPrefix+"colwidth",initialdata:n.SCFormatColwidth},recalc:{setting:"recalc",type:"PopupList",id:e.idPrefix+"recalc",initialdata:n.SCFormatRecalc},usermaxcol:{setting:"usermaxcol",type:"PopupList",id:e.idPrefix+"usermaxcol",initialdata:n.SCFormatUserMaxCol},usermaxrow:{setting:"usermaxrow",type:"PopupList",id:e.idPrefix+"usermaxrow",initialdata:n.SCFormatUserMaxRow}},o.values.cellspanel={name:"cell",colorchooser:{id:e.idPrefix+"scolorchooser"},cformatnumber:{setting:"numberformat",type:"PopupList",id:e.idPrefix+"cformatnumber",initialdata:n.SCFormatNumberFormats},cformattext:{setting:"textformat",type:"PopupList",id:e.idPrefix+"cformattext",initialdata:n.SCFormatTextFormats},cfontfamily:{setting:"fontfamily",type:"PopupList",id:e.idPrefix+"cfontfamily",initialdata:n.SCFormatFontfamilies},cfontlook:{setting:"fontlook",type:"PopupList",id:e.idPrefix+"cfontlook",initialdata:n.SCFormatFontlook},cfontsize:{setting:"fontsize",type:"PopupList",id:e.idPrefix+"cfontsize",initialdata:n.SCFormatFontsizes},calignhoriz:{setting:"alignhoriz",type:"PopupList",id:e.idPrefix+"calignhoriz",initialdata:n.SCFormatTextAlignhoriz},calignvert:{setting:"alignvert",type:"PopupList",id:e.idPrefix+"calignvert",initialdata:n.SCFormatAlignVertical},ctextcolor:{setting:"textcolor",type:"ColorChooser",id:e.idPrefix+"ctextcolor"},cbgcolor:{setting:"bgcolor",type:"ColorChooser",id:e.idPrefix+"cbgcolor"},cbt:{setting:"bt",type:"BorderSide",id:e.idPrefix+"cbt"},cbr:{setting:"br",type:"BorderSide",id:e.idPrefix+"cbr"},cbb:{setting:"bb",type:"BorderSide",id:e.idPrefix+"cbb"},cbl:{setting:"bl",type:"BorderSide",id:e.idPrefix+"cbl"},cpadtop:{setting:"padtop",type:"PopupList",id:e.idPrefix+"cpadtop",initialdata:n.SCFormatPadsizes},cpadright:{setting:"padright",type:"PopupList",id:e.idPrefix+"cpadright",initialdata:n.SCFormatPadsizes},cpadbottom:{setting:"padbottom",type:"PopupList",id:e.idPrefix+"cpadbottom",initialdata:n.SCFormatPadsizes},cpadleft:{setting:"padleft",type:"PopupList",id:e.idPrefix+"cpadleft",initialdata:n.SCFormatPadsizes}},t.SettingsControlInitializePanel(o.values.sheetspanel),t.SettingsControlInitializePanel(o.values.cellspanel)},replacements:{itemtitle:{regex:/\%itemtitle\./g,replacement:'style="padding:12px 10px 0px 10px;font-weight:bold;text-align:right;vertical-align:top;font-size:small;"'},sectiontitle:{regex:/\%sectiontitle\./g,replacement:'style="padding:16px 10px 0px 0px;font-weight:bold;vertical-align:top;font-size:small;color:#C00;"'},parttitle:{regex:/\%parttitle\./g,replacement:'style="font-weight:bold;font-size:x-small;padding:0px 0px 3px 0px;"'},itembody:{regex:/\%itembody\./g,replacement:'style="padding:12px 0px 0px 0px;vertical-align:top;font-size:small;"'},bodypart:{regex:/\%bodypart\./g,replacement:'style="padding:0px 10px 0px 0px;font-size:small;vertical-align:top;"'}},divStyle:"border:1px solid black;overflow:auto;",html:'<div id="%id.scolorchooser" style="display:none;position:absolute;z-index:20;"></div><table cellspacing="0" cellpadding="0"> <tr><td style="vertical-align:top;"><table id="%id.sheetsettingstable" style="display:none;" cellspacing="0" cellpadding="0"><tr> <td %itemtitle.><br>%loc!Default Format!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Number!</div>     <span id="%id.formatnumber"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Text!</div>     <span id="%id.formattext"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Default Alignment!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Text Horizontal!</div>     <span id="%id.textalignhoriz"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Number Horizontal!</div>     <span id="%id.numberalignhoriz"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Vertical!</div>     <span id="%id.alignvert"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Default Font!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Family!</div>     <span id="%id.fontfamily"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Bold &amp; Italics!</div>     <span id="%id.fontlook"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Size!</div>     <span id="%id.fontsize"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Color!</div>     <div id="%id.textcolor"></div>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Background!</div>     <div id="%id.bgcolor"></div>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Default Padding!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Top!</div>     <span id="%id.padtop"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Right!</div>     <span id="%id.padright"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Bottom!</div>     <span id="%id.padbottom"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Left!</div>     <span id="%id.padleft"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Default Column Width!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>&nbsp;</div>     <span id="%id.colwidth"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Recalculation!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>&nbsp;</div>     <span id="%id.recalc"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Dimensions!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Columns!</div>     <span id="%id.usermaxcol"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Rows!</div>     <span id="%id.usermaxrow"></span>    </td>   </tr></table> </td></tr></table><table id="%id.cellsettingstable" cellspacing="0" cellpadding="0"><tr> <td %itemtitle.><br>%loc!Format!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Number!</div>     <span id="%id.cformatnumber"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Text!</div>     <span id="%id.cformattext"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Alignment!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Horizontal!</div>     <span id="%id.calignhoriz"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Vertical!</div>     <span id="%id.calignvert"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Font!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Family!</div>     <span id="%id.cfontfamily"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Bold &amp; Italics!</div>     <span id="%id.cfontlook"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Size!</div>     <span id="%id.cfontsize"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Color!</div>     <div id="%id.ctextcolor"></div>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Background!</div>     <div id="%id.cbgcolor"></div>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Borders!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0">    <tr><td %bodypart. colspan="3"><div %parttitle.>%loc!Top Border!</div></td>     <td %bodypart. colspan="3"><div %parttitle.>%loc!Right Border!</div></td>     <td %bodypart. colspan="3"><div %parttitle.>%loc!Bottom Border!</div></td>     <td %bodypart. colspan="3"><div %parttitle.>%loc!Left Border!</div></td>    </tr><tr>    <td %bodypart.>     <input id="%id.cbt-onoff-bcb" onclick="SocialCalc.SettingsControlOnchangeBorder(this);" type="checkbox">    </td>    <td %bodypart.>     <div id="%id.cbt-color"></div>    </td>    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>    <td %bodypart.>     <input id="%id.cbr-onoff-bcb" onclick="SocialCalc.SettingsControlOnchangeBorder(this);" type="checkbox">    </td>    <td %bodypart.>     <div id="%id.cbr-color"></div>    </td>    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>    <td %bodypart.>     <input id="%id.cbb-onoff-bcb" onclick="SocialCalc.SettingsControlOnchangeBorder(this);" type="checkbox">    </td>    <td %bodypart.>     <div id="%id.cbb-color"></div>    </td>    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>    <td %bodypart.>     <input id="%id.cbl-onoff-bcb" onclick="SocialCalc.SettingsControlOnchangeBorder(this);" type="checkbox">    </td>    <td %bodypart.>     <div id="%id.cbl-color"></div>    </td>    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Padding!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Top!</div>     <span id="%id.cpadtop"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Right!</div>     <span id="%id.cpadright"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Bottom!</div>     <span id="%id.cpadbottom"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Left!</div>     <span id="%id.cpadleft"></span>    </td>   </tr></table> </td></tr></table> </td><td style="vertical-align:top;padding:12px 0px 0px 12px;">  <div style="width:100px;height:100px;overflow:hidden;border:1px solid black;background-color:#EEE;padding:6px;">   <table cellspacing="0" cellpadding="0"><tr>    <td id="sample-text" style="height:100px;width:100px;"><div>%loc!This is a<br>sample!</div><div>-1234.5</div></td>   </tr></table>  </div> </td></tr></table><br>'},this.tabnums.sort=this.tabs.length,this.tabs.push({name:"sort",text:"Sort",html:' <div id="%id.sorttools" style="display:none;">  <table cellspacing="0" cellpadding="0"><tr>   <td style="vertical-align:top;padding-right:4px;width:160px;">    <div style="%tbt.">%loc!Set Cells To Sort!</div>    <select id="%id.sortlist" size="1" onfocus="%s.CmdGotFocus(this);"><option selected>[select range]</option><option value="all">Sort All</option></select>    <input type="button" value="%loc!OK!" onclick="%s.DoCmd(this, \'ok-setsort\');" style="font-size:x-small;">   </td>   <td style="vertical-align:middle;padding-right:16px;width:100px;text-align:right;">    <div style="%tbt.">&nbsp;</div>    <input type="button" id="%id.sortbutton" value="%loc!Sort Cells! A1:A1" onclick="%s.DoCmd(this, \'dosort\');" style="visibility:hidden;">   </td>   <td style="vertical-align:top;padding-right:16px;">    <table cellspacing="0" cellpadding="0"><tr>     <td style="vertical-align:top;">      <div style="%tbt.">%loc!Major Sort!</div>      <select id="%id.majorsort" size="1" onfocus="%s.CmdGotFocus(this);"></select>     </td><td>      <input type="radio" name="majorsort" id="%id.majorsortup" value="up" checked><span style="font-size:x-small;color:#555753;">%loc!Up!</span><br>      <input type="radio" name="majorsort" id="%id.majorsortdown" value="down"><span style="font-size:x-small;color:#555753;">%loc!Down!</span>     </td>    </tr></table>   </td>   <td style="vertical-align:top;padding-right:16px;">    <table cellspacing="0" cellpadding="0"><tr>     <td style="vertical-align:top;">      <div style="%tbt.">%loc!Minor Sort!</div>      <select id="%id.minorsort" size="1" onfocus="%s.CmdGotFocus(this);"></select>     </td><td>      <input type="radio" name="minorsort" id="%id.minorsortup" value="up" checked><span style="font-size:x-small;color:#555753;">%loc!Up!</span><br>      <input type="radio" name="minorsort" id="%id.minorsortdown" value="down"><span style="font-size:x-small;color:#555753;">%loc!Down!</span>     </td>    </tr></table>   </td>   <td style="vertical-align:top;padding-right:16px;">    <table cellspacing="0" cellpadding="0"><tr>     <td style="vertical-align:top;">      <div style="%tbt.">%loc!Last Sort!</div>      <select id="%id.lastsort" size="1" onfocus="%s.CmdGotFocus(this);"></select>     </td><td>      <input type="radio" name="lastsort" id="%id.lastsortup" value="up" checked><span style="font-size:x-small;color:#555753;">%loc!Up!</span><br>      <input type="radio" name="lastsort" id="%id.lastsortdown" value="down"><span style="font-size:x-small;color:#555753;">%loc!Down!</span>     </td>    </tr></table>   </td>  </tr></table> </div>',onclick:t.SpreadsheetControlSortOnclick}),this.editor.SettingsCallbacks.sort={save:t.SpreadsheetControlSortSave,load:t.SpreadsheetControlSortLoad},this.tabnums.audit=this.tabs.length,this.tabs.push({name:"audit",text:"Audit",html:'<div id="%id.audittools" style="display:none;"> <div style="%tbt.">&nbsp;</div></div>',view:"audit",onclick:function(e){var o,n,r=t.LocalizeString,i='<table cellspacing="0" cellpadding="0" style="margin-bottom:10px;"><tr><td style="font-size:small;padding:6px;"><b>'+r("Audit Trail This Session")+":</b><br><br>",a=e.sheet.changes.stack,s=e.sheet.changes.tos;for(o=0;o<a.length;o++)for(o==s+1&&(i+='<br></td></tr><tr><td style="font-size:small;background-color:#EEE;padding:6px;">'+r("UNDONE STEPS")+":<br>"),n=0;n<a[o].command.length;n++)i+=t.special_chars(a[o].command[n])+"<br>";var l=function(e){if("string"==typeof e)return e;if(!e)return"null";if("object"==typeof e){l.check||(l.check=new Array);for(var t=0,o=l.check.length;t<o;++t)if(l.check[t]==e)return"{}";l.check.push(e)}var o="",n="undefined"==typeof e.length?1:0,r="";for(var i in e)n&&(o="'"+i+"':"),"string"==typeof e[i]?r+=o+"'"+e[i]+"',":"object"==typeof e[i]?r+=o+l(e[i])+",":r+=o+e[i]+",";return"object"==typeof e&&l.check.pop(),n?"{"+r.slice(0,-1)+"}":"["+r.slice(0,-1)+"]"};if("undefined"!=typeof t.debug_log)for(var c in t.debug_log)i+=l(t.debug_log[c])+"<br>";e.views.audit.element.innerHTML=i+"</td></tr></table>",t.CmdGotFocus(!0)},onclickFocus:!0}),this.views.audit={name:"audit",divStyle:"border:1px solid black;overflow:auto;",html:"Audit Trail"},this.tabnums.comment=this.tabs.length,this.tabs.push({name:"comment",text:"Comment",html:'<div id="%id.commenttools" style="display:none;"><table cellspacing="0" cellpadding="0"><tr><td><textarea id="%id.commenttext" style="font-size:small;height:32px;width:600px;overflow:auto;" onfocus="%s.CmdGotFocus(this);"></textarea></td><td style="vertical-align:top;">&nbsp;<input type="button" value="%loc!Save!" onclick="%s.SpreadsheetControlCommentSet();" style="font-size:x-small;"></td></tr></table></div>',view:"sheet",onclick:t.SpreadsheetControlCommentOnclick,onunclick:t.SpreadsheetControlCommentOnunclick}),this.tabnums.names=this.tabs.length,this.tabs.push({name:"names",text:"Names",html:'<div id="%id.namestools" style="display:none;">  <table cellspacing="0" cellpadding="0"><tr>   <td style="vertical-align:top;padding-right:24px;">    <div style="%tbt.">%loc!Existing Names!</div>    <select id="%id.nameslist" size="1" onchange="%s.SpreadsheetControlNamesChangedName();" onfocus="%s.CmdGotFocus(this);"><option selected>[New]</option></select>   </td>   <td style="vertical-align:top;padding-right:6px;">    <div style="%tbt.">%loc!Name!</div>    <input type="text" id="%id.namesname" style="font-size:x-small;width:75px;" onfocus="%s.CmdGotFocus(this);">   </td>   <td style="vertical-align:top;padding-right:6px;">    <div style="%tbt.">%loc!Description!</div>    <input type="text" id="%id.namesdesc" style="font-size:x-small;width:150px;" onfocus="%s.CmdGotFocus(this);">   </td>   <td style="vertical-align:top;padding-right:6px;">    <div style="%tbt.">%loc!Value!</div>    <input type="text" id="%id.namesvalue" width="16" style="font-size:x-small;width:100px;" onfocus="%s.CmdGotFocus(this);">   </td>   <td style="vertical-align:top;padding-right:12px;width:100px;">    <div style="%tbt.">%loc!Set Value To!</div>    <input type="button" id="%id.namesrangeproposal" value="A1" onclick="%s.SpreadsheetControlNamesSetValue();" style="font-size:x-small;">   </td>   <td style="vertical-align:top;padding-right:6px;">    <div style="%tbt.">&nbsp;</div>    <input type="button" value="%loc!Save!" onclick="%s.SpreadsheetControlNamesSave();" style="font-size:x-small;">    <input type="button" value="%loc!Delete!" onclick="%s.SpreadsheetControlNamesDelete()" style="font-size:x-small;">   </td>  </tr></table></div>',view:"sheet",onclick:t.SpreadsheetControlNamesOnclick,onunclick:t.SpreadsheetControlNamesOnunclick}),this.tabnums.clipboard=this.tabs.length,this.tabs.push({name:"clipboard",text:"Clipboard",html:'<div id="%id.clipboardtools" style="display:none;">  <table cellspacing="0" cellpadding="0"><tr>   <td style="vertical-align:top;padding-right:24px;">    <div style="%tbt.">     &nbsp;    </div>   </td>  </tr></table></div>',view:"clipboard",onclick:t.SpreadsheetControlClipboardOnclick,onclickFocus:"clipboardtext"}),this.views.clipboard={name:"clipboard",divStyle:"overflow:auto;",html:' <div style="font-size:x-small;padding:5px 0px 10px 0px;">  <b>%loc!Display Clipboard in!:</b>  <input type="radio" id="%id.clipboardformat-tab" name="%id.clipboardformat" checked onclick="%s.SpreadsheetControlClipboardFormat(\'tab\');"> %loc!Tab-delimited format! &nbsp;  <input type="radio" id="%id.clipboardformat-csv" name="%id.clipboardformat" onclick="%s.SpreadsheetControlClipboardFormat(\'csv\');"> %loc!CSV format! &nbsp;  <input type="radio" id="%id.clipboardformat-scsave" name="%id.clipboardformat" onclick="%s.SpreadsheetControlClipboardFormat(\'scsave\');"> %loc!SocialCalc-save format! </div> <input type="button" value="%loc!Load SocialCalc Clipboard With This!" style="font-size:x-small;" onclick="%s.SpreadsheetControlClipboardLoad();">&nbsp;  <input type="button" value="%loc!Clear SocialCalc Clipboard!" style="font-size:x-small;" onclick="%s.SpreadsheetControlClipboardClear();">&nbsp;  <br> <textarea id="%id.clipboardtext" style="font-size:small;height:350px;width:800px;overflow:auto;" onfocus="%s.CmdGotFocus(this);"></textarea>'}},t.SpreadsheetControl.prototype.InitializeSpreadsheetControl=function(e,o,n,r){return t.InitializeSpreadsheetControl(this,e,o,n,r)},t.SpreadsheetControl.prototype.DoOnResize=function(){return t.DoOnResize(this)},t.SpreadsheetControl.prototype.SizeSSDiv=function(){return t.SizeSSDiv(this)},t.SpreadsheetControl.prototype.ExecuteCommand=function(e,o){return t.SpreadsheetControlExecuteCommand(this,e,o)},t.SpreadsheetControl.prototype.CreateSheetHTML=function(){return t.SpreadsheetControlCreateSheetHTML(this)},t.SpreadsheetControl.prototype.CreateSpreadsheetSave=function(e){return t.SpreadsheetControlCreateSpreadsheetSave(this,e)},t.SpreadsheetControl.prototype.DecodeSpreadsheetSave=function(e){return t.SpreadsheetControlDecodeSpreadsheetSave(this,e)},t.SpreadsheetControl.prototype.CreateCellHTML=function(e){return t.SpreadsheetControlCreateCellHTML(this,e)},t.SpreadsheetControl.prototype.CreateCellHTMLSave=function(e){return t.SpreadsheetControlCreateCellHTMLSave(this,e)},t.SpreadsheetControl.prototype.ParseSheetSave=function(e){return this.sheet.ParseSheetSave(e)},t.SpreadsheetControl.prototype.CreateSheetSave=function(){return this.sheet.CreateSheetSave()},t.InitializeSpreadsheetControl=function(e,o,n,r,i){var a,s,l,c,d,u,p,h,f=t.Constants,m=t.LocalizeString,g=t.LocalizeSubstrings,v=e.tabs,y=e.views;for(e.requestedHeight=n,e.requestedWidth=r,e.requestedSpaceBelow=i,"string"==typeof o&&(o=document.getElementById(o)),null==o&&alert("SocialCalc.SpreadsheetControl not given parent node."),e.parentNode=o,e.spreadsheetDiv=document.createElement("div"),e.SizeSSDiv(),s=o.firstChild;null!=s;s=o.firstChild)o.removeChild(s);for(a="<div>",a+='<div style="'+e.tabbackground+'"><table cellpadding="0" cellspacing="0"><tr>',l=0;l<v.length;l++)a+='  <td id="%id.'+v[l].name+'tab" style="'+(0==l?e.tabselectedCSS:e.tabplainCSS)+'" onclick="%s.SetTab(this);">'+m(v[l].text)+"</td>";for(a+=" </tr></table></div>",a+='<div style="'+e.toolbarbackground+'padding:12px 10px 10px 4px;">',l=0;l<v.length;l++)a+=v[l].html;a+="</div>",a+="</div>",e.currentTab=0;for(u in e.tabreplacements)a=a.replace(e.tabreplacements[u].regex,e.tabreplacements[u].replacement);a=a.replace(/\%s\./g,"SocialCalc."),a=a.replace(/\%id\./g,e.idPrefix),a=a.replace(/\%tbt\./g,e.toolbartext),a=a.replace(/\%img\./g,e.imagePrefix),a=g(a),e.spreadsheetDiv.innerHTML=a,o.appendChild(e.spreadsheetDiv),e.Buttons={button_undo:{tooltip:"Undo",command:"undo"},button_redo:{tooltip:"Redo",command:"redo"},button_copy:{tooltip:"Copy",command:"copy"},button_cut:{tooltip:"Cut",command:"cut"},button_paste:{tooltip:"Paste",command:"paste"},button_pasteformats:{tooltip:"Paste Formats",command:"pasteformats"},button_lock:{tooltip:"Lock Cell",command:"lock"},button_unlock:{tooltip:"Unlock Cell",command:"unlock"},button_delete:{tooltip:"Delete Cell Contents",command:"delete"},button_filldown:{tooltip:"Fill Down",command:"filldown"},button_fillright:{tooltip:"Fill Right",command:"fillright"},button_movefrom:{tooltip:"Set/Clear Move From",command:"movefrom"},button_movepaste:{tooltip:"Move Paste",command:"movepaste"},button_moveinsert:{tooltip:"Move Insert",command:"moveinsert"},button_alignleft:{tooltip:"Align Left",command:"align-left"},button_aligncenter:{tooltip:"Align Center",command:"align-center"},button_alignright:{tooltip:"Align Right",command:"align-right"},button_borderon:{tooltip:"Borders On",command:"borderon"},button_borderoff:{tooltip:"Borders Off",command:"borderoff"},button_swapcolors:{tooltip:"Swap Colors",command:"swapcolors"},button_merge:{tooltip:"Merge/Unmerge Cells",command:"merge"},button_insertrow:{tooltip:"Insert Row Before",command:"insertrow"},button_insertcol:{tooltip:"Insert Column Before",command:"insertcol"},button_deleterow:{tooltip:"Delete Row",command:"deleterow"},button_deletecol:{tooltip:"Delete Column",command:"deletecol"},button_hiderow:{tooltip:"Hide Row",command:"hiderow"},button_hidecol:{tooltip:"Hide Column",command:"hidecol"},button_recalc:{tooltip:"Recalculate",command:"recalc"}};for(p in e.Buttons)h=document.getElementById(e.idPrefix+p),h?(h.style.border="1px solid "+f.ISCButtonBorderNormal,t.TooltipRegister(h,m(e.Buttons[p].tooltip),{},e.spreadsheetDiv),t.ButtonRegister(e.editor,h,{normalstyle:"border:1px solid "+f.ISCButtonBorderNormal+";background-color:"+f.ISCButtonNormalBackground+";",hoverstyle:"border:1px solid "+f.ISCButtonBorderHover+";background-color:"+f.ISCButtonHoverBackground+";",downstyle:"border:1px solid "+f.ISCButtonBorderDown+";background-color:"+f.ISCButtonDownBackground+";"},{MouseDown:t.DoButtonCmd,command:e.Buttons[p].command})):alert("Button "+(e.idPrefix+p)+" missing");e.formulabarDiv=document.createElement("div"),e.formulabarDiv.innerHTML='<input type="text" size="60" value="">&nbsp;',e.spreadsheetDiv.appendChild(e.formulabarDiv);new t.InputBox(e.formulabarDiv.firstChild,e.editor);for(p in e.formulabuttons)h=document.createElement("img"),h.id=e.idPrefix+p,
h.src=(e.formulabuttons[p].skipImagePrefix?"":e.imagePrefix)+e.formulabuttons[p].image,h.style.verticalAlign="middle",h.style.border="1px solid #FFF",h.style.marginLeft="4px",t.TooltipRegister(h,m(e.formulabuttons[p].tooltip),{},e.spreadsheetDiv),t.ButtonRegister(e.editor,h,{normalstyle:"border:1px solid #FFF;backgroundColor:#FFF;",hoverstyle:"border:1px solid #CCC;backgroundColor:#FFF;",downstyle:"border:1px solid #000;backgroundColor:#FFF;"},{MouseDown:e.formulabuttons[p].command,Disabled:function(){return e.editor.ECellReadonly()}}),e.formulabarDiv.appendChild(h);var b=$("<input id='searchbarinput' value='' placeholder='Search sheet\u2026'>"),C=$("<span id='searchbar'></span>");C.append("<div id='searchstatus'></div>"),C.append(b);for(p in e.findbuttons)h=document.createElement("img"),h.id=e.idPrefix+p,h.src=e.imagePrefix+e.findbuttons[p].image,h.style.verticalAlign="middle",h.style.border="1px solid #FFF",t.TooltipRegister(h,m(e.findbuttons[p].tooltip),{},e.formulabardiv),t.ButtonRegister(e.editor,h,{normalstyle:"border:1px solid #FFF;backgroundColor:#FFF;",hoverstyle:"border:1px solid #CCC;backgroundColor:#FFF;",downstyle:"border:1px solid #000;backgroundColor:#FFF;"},{MouseDown:e.findbuttons[p].command,Disabled:function(){return!1}}),C[0].appendChild(h);for(b.on("input",t.SpreadsheetControl.FindInSheet),b.on("focus",function(){t.Keyboard.passThru=!0}),b.on("blur",function(){t.Keyboard.passThru=!1}),b.keyup(function(e){13==e.keyCode&&(e.shiftKey?t.SpreadsheetControl.SearchUp():t.SpreadsheetControl.SearchDown())}),e.formulabarDiv.appendChild(C[0]),l=0;l<v.length;l++)v[l].oncreate&&v[l].oncreate(e,v[l].name);t.CalculateSheetNonViewHeight(e),e.viewheight=e.height-e.nonviewheight,e.editorDiv=e.editor.CreateTableEditor(e.width,e.viewheight);var w=document.createElement("div");w.id="te_appView",w.appendChild(e.editorDiv),e.editorDiv=w;var x=document.createElement("div");x.id="te_formData",x.style.display="none",e.editorDiv.appendChild(x),e.spreadsheetDiv.appendChild(e.editorDiv),e.formDataViewer=new t.SpreadsheetViewer("te_FormData-"),e.formDataViewer.InitializeSpreadsheetViewer(x.id,180,0,200),e.formDataViewer.editor.ignoreRender=!0;for(c in y){a=y[c].html;for(u in y[c].replacements)a=a.replace(y[c].replacements[u].regex,y[c].replacements[u].replacement);a=a.replace(/\%s\./g,"SocialCalc."),a=a.replace(/\%id\./g,e.idPrefix),a=a.replace(/\%tbt\./g,e.toolbartext),a=a.replace(/\%img\./g,e.imagePrefix),d=document.createElement("div"),t.setStyles(d,y[c].divStyle),d.style.display="none",d.style.width=e.width+"px",d.style.height=e.viewheight+"px",d.id=e.idPrefix+y[c].name+"view",a=g(a),d.innerHTML=a,e.spreadsheetDiv.appendChild(d),y[c].element=d,y[c].oncreate&&y[c].oncreate(e,y[c])}if(y.sheet={name:"sheet",element:e.editorDiv},e.statuslineDiv=document.createElement("div"),e.statuslineDiv.style.cssText=e.statuslineCSS,e.statuslineDiv.style.height=e.statuslineheight-(e.statuslineDiv.style.paddingTop.slice(0,-2)-0)-(e.statuslineDiv.style.paddingBottom.slice(0,-2)-0)+"px",e.statuslineDiv.id=e.idPrefix+"statusline",e.spreadsheetDiv.appendChild(e.statuslineDiv),e.spreadsheetDiv.addEventListener)e.spreadsheetDiv.addEventListener("mousedown",function(){t.SetSpreadsheetControlObject(e)},!1),e.spreadsheetDiv.addEventListener("mouseover",function(){t.SetSpreadsheetControlObject(e)},!1);else{if(!e.spreadsheetDiv.attachEvent)throw t.Constants.s_BrowserNotSupported;e.spreadsheetDiv.attachEvent("onmousedown",function(){t.SetSpreadsheetControlObject(e)}),e.spreadsheetDiv.attachEvent("onmouseover",function(){t.SetSpreadsheetControlObject(e)})}},t.CalculateSheetNonViewHeight=function(e){e.nonviewheight=e.statuslineheight;for(var t=0;t<e.spreadsheetDiv.childNodes.length;t++)"SocialCalc-statusline"!=e.spreadsheetDiv.childNodes[t].id&&(e.nonviewheight+=e.spreadsheetDiv.childNodes[t].offsetHeight)},t.LocalizeString=function(e){var o=t.LocalizeStringList[e];return o||(o=t.Constants["s_loc_"+e.toLowerCase().replace(/\s/g,"_").replace(/\W/g,"X")]||e,t.LocalizeStringList[e]=o),o},t.LocalizeStringList={},t.LocalizeSubstrings=function(e){var o=t.LocalizeString;return e.replace(/%(loc|ssc)!(.*?)!/g,function(e,n,r){return"ssc"==n?t.Constants[r]||alert("Missing constant: "+r):o(r)})},t.GetSpreadsheetControlObject=function(){var e=null!=t.CurrentSpreadsheetControlObject?t.CurrentSpreadsheetControlObject:t.CurrentSpreadsheetViewerObject;if(e)return e},t.SetSpreadsheetControlObject=function(e){t.CurrentSpreadsheetControlObject=e,t.Keyboard.focusTable&&e&&(t.Keyboard.focusTable=e.editor)},t.DoOnResize=function(e){var t,o=e.views;if(e.SizeSSDiv()){for(vname in o)t=o[vname].element,t.style.width=e.width+"px",t.style.height=e.height-e.nonviewheight+"px";e.editor.ResizeTableEditor(e.width,e.height-e.nonviewheight)}},t.SizeSSDiv=function(e){var o,n,r,i,a;return r=!1,o=t.GetViewportInfo(),n=t.GetElementPosition(e.parentNode),n.bottom=0,n.right=0,i=e.parentNode.style,i.marginTop&&(n.top+=i.marginTop.slice(0,-2)-0),i.marginBottom&&(n.bottom+=i.marginBottom.slice(0,-2)-0),i.marginLeft&&(n.left+=i.marginLeft.slice(0,-2)-0),i.marginRight&&(n.right+=i.marginRight.slice(0,-2)-0),a=e.requestedHeight||o.height-(n.top+n.bottom+10)-(e.requestedSpaceBelow||0),e.height!=a&&(e.height=a,e.spreadsheetDiv.style.height=a+"px",r=!0),a=e.requestedWidth||o.width-(n.left+n.right+10)||700,e.width!=a&&(e.width=a,e.spreadsheetDiv.style.width=a+"px",r=!0),e.spreadsheetDiv.style.position="relative",r},t.SetTab=function(e){var o,n,r,i,a,s,l,c={},d={},u=t.GetSpreadsheetControlObject(),p=u.tabs,h=u.views;if(o="string"==typeof e?e:e.id.slice(u.idPrefix.length,-3),u.editor.busy&&(!p[u.currentTab].view||"sheet"==p[u.currentTab].view))for(a=0;a<p.length;a++)if(p[a].name==o&&p[a].view&&"sheet"!=p[a].view)return;for(u.tabs[u.currentTab].onunclick&&u.tabs[u.currentTab].onunclick(u,u.tabs[u.currentTab].name),a=0;a<p.length;a++)n=p[a].name,c[n]=document.getElementById(u.idPrefix+n+"tab"),d[n]=document.getElementById(u.idPrefix+n+"tools"),n==o?(r=a,d[n].style.display="block",c[n].style.cssText=u.tabselectedCSS):(d[n].style.display="none",c[n].style.cssText=u.tabplainCSS);u.currentTab=r,p[r].onclick&&p[r].onclick(u,o);for(s in h)!p[r].view&&"sheet"==s||p[r].view==s?(h[s].element.style.display="block",i=s):h[s].element.style.display="none";p[r].onclickFocus?(l=p[r].onclickFocus,"string"==typeof l&&(l=document.getElementById(u.idPrefix+l),l.focus()),t.CmdGotFocus(l)):t.KeyboardFocus(),h[i].needsresize&&h[i].onresize&&(h[i].needsresize=!1,h[i].onresize(u,h[i])),"sheet"==i?(u.statuslineDiv.style.display="block",u.editor.ScheduleRender()):u.statuslineDiv.style.display="none"},t.SpreadsheetControlStatuslineCallback=function(e,t,o,n){var r,i,a=document.getElementById(n.statuslineid);switch(a&&(a.innerHTML=e.GetStatuslineString(t,o,n)),t){case"cmdendnorender":case"calcfinished":case"doneposcalc":if(r=document.getElementById(n.recalcid1),i=document.getElementById(n.recalcid2),!r||!i)break;"yes"==e.context.sheetobj.attribs.needsrecalc?(r.style.display="inline",i.style.display="inline"):(r.style.display="none",i.style.display="none")}},t.UpdateSortRangeProposal=function(e){var o=document.getElementById(t.GetSpreadsheetControlObject().idPrefix+"sortlist");e.range.hasrange?o.options[0].text=t.crToCoord(e.range.left,e.range.top)+":"+t.crToCoord(e.range.right,e.range.bottom):o.options[0].text=t.LocalizeString("[select range]")},t.LoadColumnChoosers=function(e){var o,n,r,i,a,s,l,c=t.LocalizeString;e.sortrange&&-1==e.sortrange.indexOf(":")?(n=t.Formula.LookupName(e.sheet,e.sortrange||""),"range"==n.type?(r=n.value.match(/^(.*)\|(.*)\|$/),o=r[1]+":"+r[2]):o="A1:A1"):o=e.sortrange;var d=t.ParseRange(o);s=document.getElementById(e.idPrefix+"majorsort"),l=s.selectedIndex,s.options.length=0,s.options[s.options.length]=new Option(c("[None]"),"");for(var i=d.cr1.col;i<=d.cr2.col;i++)a=t.rcColname(i),s.options[s.options.length]=new Option(c("Column ")+a,a);s.selectedIndex=l>1&&l<=d.cr2.col-d.cr1.col+1?l:1,s=document.getElementById(e.idPrefix+"minorsort"),l=s.selectedIndex,s.options.length=0,s.options[s.options.length]=new Option(c("[None]"),"");for(var i=d.cr1.col;i<=d.cr2.col;i++)a=t.rcColname(i),s.options[s.options.length]=new Option(a,a);s.selectedIndex=l>0&&l<=d.cr2.col-d.cr1.col+1?l:0,s=document.getElementById(e.idPrefix+"lastsort"),l=s.selectedIndex,s.options.length=0,s.options[s.options.length]=new Option(c("[None]"),"");for(var i=d.cr1.col;i<=d.cr2.col;i++)a=t.rcColname(i),s.options[s.options.length]=new Option(a,a);s.selectedIndex=l>0&&l<=d.cr2.col-d.cr1.col+1?l:0},t.CmdGotFocus=function(e){t.Keyboard.passThru=e},t.DoButtonCmd=function(e,o,n){t.DoCmd(n.element,n.functionobj.command)},t.DoCmd=function(e,o){var n,r,i,a,s,l,c,d,u,p,h,f,m,g,v,y,b,C,w,x,S,_=t.GetSpreadsheetControlObject(),k=_.editor;switch(o){case"undo":_.ExecuteCommand("undo","");break;case"redo":_.ExecuteCommand("redo","");break;case"fill-rowcolstuff":case"fill-text":for(i=o.substring(5),s=document.getElementById(_.idPrefix+i+"list"),s.length=0,a=0;a<t.SpreadsheetCmdTable[i].length;a++)s.options[a]=new Option(t.SpreadsheetCmdTable[i][a].t);o="changed-"+i;case"changed-rowcolstuff":case"changed-text":for(i=o.substring(8),s=document.getElementById(_.idPrefix+i+"list"),l=t.SpreadsheetCmdTable.slists[t.SpreadsheetCmdTable[i][s.selectedIndex].s],c=document.getElementById(_.idPrefix+i+"slist"),c.length=0,a=0;a<(l.length||0);a++)c.options[a]=new Option(l[a].t,l[a].s);return;case"ok-rowcolstuff":case"ok-text":i=o.substring(3),s=document.getElementById(_.idPrefix+i+"list"),c=document.getElementById(_.idPrefix+i+"slist"),n=t.SpreadsheetCmdTable[i][s.selectedIndex].c,r=c[c.selectedIndex].value,t.SpreadsheetControlExecuteCommand(e,n,r);break;case"ok-setsort":if(h=document.getElementById(_.idPrefix+"sortlist"),0==h.selectedIndex)k.range.hasrange?_.sortrange=t.crToCoord(k.range.left,k.range.top)+":"+t.crToCoord(k.range.right,k.range.bottom):_.sortrange=k.ecell.coord+":"+k.ecell.coord;else{if("all"==h.options[h.selectedIndex].value){var T=_.sheet.cells,E=-1,F=-1,D=-1,M=-1;for(var A in T){var P=t.coordToCr(A);(-1==D||P.row<D)&&(D=P.row),(-1==E||P.col<E)&&(E=P.col),(-1==M||P.row>M)&&(M=P.row),(-1==F||P.col>F)&&(F=P.col)}_.sortrange=t.crToCoord(E,D)+":"+t.crToCoord(F,M),h.options[h.selectedIndex].text+=" ("+_.sortrange+")"}else _.sortrange=h.options[h.selectedIndex].value}return f=document.getElementById(_.idPrefix+"sortbutton"),f.value=t.LocalizeString("Sort ")+_.sortrange,f.style.visibility="visible",t.LoadColumnChoosers(_),e&&e.blur&&e.blur(),void t.KeyboardFocus();case"dosort":if(_.sortrange&&-1==_.sortrange.indexOf(":")){if(g=t.Formula.LookupName(_.sheet,_.sortrange||""),"range"!=g.type)return;v=g.value.match(/^(.*)\|(.*)\|$/),m=v[1]+":"+v[2]}else m=_.sortrange;if("A1:A1"==m)return;d="sort "+m+" ",u=document.getElementById(_.idPrefix+"majorsort"),p=document.getElementById(_.idPrefix+"majorsortup"),d+=u.options[u.selectedIndex].value+(p.checked?" up":" down"),u=document.getElementById(_.idPrefix+"minorsort"),u.selectedIndex>0&&(p=document.getElementById(_.idPrefix+"minorsortup"),d+=" "+u.options[u.selectedIndex].value+(p.checked?" up":" down")),u=document.getElementById(_.idPrefix+"lastsort"),u.selectedIndex>0&&(p=document.getElementById(_.idPrefix+"lastsortup"),d+=" "+u.options[u.selectedIndex].value+(p.checked?" up":" down")),_.ExecuteCommand(d,"");break;case"merge":n=t.SpreadsheetCmdLookup[o]||"",r=t.SpreadsheetCmdSLookup[o]||"",_.ExecuteCommand(n,r),k.range.hasrange&&(k.MoveECell(t.crToCoord(k.range.left,k.range.top)),k.RangeRemove());break;case"movefrom":k.range2.hasrange?(_.context.cursorsuffix="",k.Range2Remove(),_.ExecuteCommand("redisplay","")):k.range.hasrange?(k.range2.top=k.range.top,k.range2.right=k.range.right,k.range2.bottom=k.range.bottom,k.range2.left=k.range.left,k.range2.hasrange=!0,k.MoveECell(t.crToCoord(k.range.left,k.range.top))):(k.range2.top=k.ecell.row,k.range2.right=k.ecell.col,k.range2.bottom=k.ecell.row,k.range2.left=k.ecell.col,k.range2.hasrange=!0),d=k.range2.hasrange?"":"off",f=document.getElementById(_.idPrefix+"button_movefrom"),f.src=_.imagePrefix+"movefrom"+d+".gif",f=document.getElementById(_.idPrefix+"button_movepaste"),f.src=_.imagePrefix+"movepaste"+d+".gif",f=document.getElementById(_.idPrefix+"button_moveinsert"),f.src=_.imagePrefix+"moveinsert"+d+".gif",k.range2.hasrange&&k.RangeRemove();break;case"movepaste":case"moveinsert":k.range2.hasrange&&(_.context.cursorsuffix="",n=o+" "+t.crToCoord(k.range2.left,k.range2.top)+":"+t.crToCoord(k.range2.right,k.range2.bottom)+" "+k.ecell.coord,_.ExecuteCommand(n,""),k.Range2Remove(),f=document.getElementById(_.idPrefix+"button_movefrom"),f.src=_.imagePrefix+"movefromoff.gif",f=document.getElementById(_.idPrefix+"button_movepaste"),f.src=_.imagePrefix+"movepasteoff.gif",f=document.getElementById(_.idPrefix+"button_moveinsert"),f.src=_.imagePrefix+"moveinsertoff.gif");break;case"swapcolors":y=_.sheet,b=y.GetAssuredCell(k.ecell.coord),x=y.attribs.defaultcolor?y.colors[y.attribs.defaultcolor]:"rgb(0,0,0)",S=y.attribs.defaultbgcolor?y.colors[y.attribs.defaultbgcolor]:"rgb(255,255,255)",C=b.color?y.colors[b.color]:x,C==S&&(C=""),w=b.bgcolor?y.colors[b.bgcolor]:S,w==x&&(w=""),_.ExecuteCommand("set %C color "+w+"%Nset %C bgcolor "+C,"");break;default:n=t.SpreadsheetCmdLookup[o]||"",r=t.SpreadsheetCmdSLookup[o]||"",_.ExecuteCommand(n,r)}e&&e.blur&&e.blur(),t.KeyboardFocus()},t.SpreadsheetCmdLookup={copy:"copy %C all",cut:"cut %C all",paste:"paste %C all",pasteformats:"paste %C formats",lock:"set %C readonly yes",unlock:"set %C readonly no","delete":"erase %C formulas",filldown:"filldown %C all",fillright:"fillright %C all",erase:"erase %C all",borderon:"set %C bt %S%Nset %C br %S%Nset %C bb %S%Nset %C bl %S",borderoff:"set %C bt %S%Nset %C br %S%Nset %C bb %S%Nset %C bl %S",merge:"merge %C",unmerge:"unmerge %C","align-left":"set %C cellformat left","align-center":"set %C cellformat center","align-right":"set %C cellformat right","align-default":"set %C cellformat",insertrow:"insertrow %C",insertcol:"insertcol %C",deleterow:"deleterow %C",deletecol:"deletecol %C",hiderow:"set %H hide yes",hidecol:"set %W hide yes",undo:"undo",redo:"redo",recalc:"recalc"},t.SpreadsheetCmdSLookup={borderon:"1px solid rgb(0,0,0)",borderoff:""},t.SpreadsheetControlExecuteCommand=function(e,o,n){var r=t.GetSpreadsheetControlObject(),i=r.editor,a={};a.P="%",a.N="\n",i.range.hasrange?(a.R=t.crToCoord(i.range.left,i.range.top)+":"+t.crToCoord(i.range.right,i.range.bottom),a.C=a.R,a.W=t.rcColname(i.range.left)+":"+t.rcColname(i.range.right),a.H=i.range.top+":"+i.range.bottom):i.ecell?(a.C=i.ecell.coord,a.R=i.ecell.coord+":"+i.ecell.coord,a.W=t.rcColname(t.coordToCr(i.ecell.coord).col),a.H=t.coordToCr(i.ecell.coord).row):(a.C="A1",a.R="A1:A1",a.W=t.rcColname(t.coordToCr("A1").col),a.H=t.coordToCr("A1").row),a.S=n,o=o.replace(/%C/g,a.C),o=o.replace(/%R/g,a.R),o=o.replace(/%N/g,a.N),o=o.replace(/%S/g,a.S),o=o.replace(/%W/g,a.W),o=o.replace(/%H/g,a.H),o=o.replace(/%P/g,a.P),i.EditorScheduleSheetCommands(o,!0,!1)},t.SpreadsheetControlCreateSheetHTML=function(e){var o,n,r,i="";return o=new t.RenderContext(e.sheet),n=document.createElement("div"),r=o.RenderSheet(null,{type:"html"}),n.appendChild(r),delete o,i=n.innerHTML,delete r,delete n,i},t.SpreadsheetControlCreateCellHTML=function(e,o,n){var r="",i=e.sheet.cells[o];return i?(r=i.displaystring==undefined?t.FormatValueForDisplay(e.sheet,i.datavalue,o,n||e.context.defaultHTMLlinkstyle):i.displaystring,"&nbsp;"==r&&(r=""),r):""},t.SpreadsheetControlCreateCellHTMLSave=function(e,o,n){var r,i,a,s,l,c,d,u,p=[];for(u=o?t.ParseRange(o):{cr1:{row:1,col:1},cr2:{row:e.sheet.attribs.lastrow,col:e.sheet.attribs.lastcol}},r=u.cr1,i=u.cr2,p.push("version:1.0"),a=r.row;a<=i.row;a++)for(s=r.col;s<=i.col;s++)l=t.crToCoord(s,a),(c=e.sheet.cells[l])&&"&nbsp;"!=(d=c.displaystring==undefined?t.FormatValueForDisplay(e.sheet,c.datavalue,l,n||e.context.defaultHTMLlinkstyle):c.displaystring)&&p.push(l+":"+t.encodeForSave(d));return p.push(""),p.join("\n")},t.SpreadsheetControl.DoFunctionList=function(){var e,o,n,r=t.Formula,i=t.Constants,a=i.function_classlist,s=t.GetSpreadsheetControlObject(),l=s.idPrefix+"function";if(!(n=document.getElementById(l+"dialog"))){for(r.FillFunctionInfo(),o='<table><tr><td><span style="font-size:x-small;font-weight:bold">%loc!Category!</span><br><select id="'+l+'class" size="'+a.length+'" style="width:120px;" onchange="SocialCalc.SpreadsheetControl.FunctionClassChosen(this.options[this.selectedIndex].value);">',e=0;e<a.length;e++)o+='<option value="'+a[e]+'"'+(0==e?" selected>":">")+t.special_chars(r.FunctionClasses[a[e]].name)+"</option>";o+='</select></td><td>&nbsp;&nbsp;</td><td id="'+l+'list"><span style="font-size:x-small;font-weight:bold">%loc!Functions!</span><br><select id="'+l+'name" size="'+a.length+'" style="width:240px;" onchange="SocialCalc.SpreadsheetControl.FunctionChosen(this.options[this.selectedIndex].value);" ondblclick="SocialCalc.SpreadsheetControl.DoFunctionPaste();">',o+=t.SpreadsheetControl.GetFunctionNamesStr("all"),o+='</td></tr><tr><td colspan="3"><div id="'+l+'desc" style="width:380px;height:80px;overflow:auto;font-size:x-small;">'+t.SpreadsheetControl.GetFunctionInfoStr(r.FunctionClasses[a[0]].items[0])+'</div><div style="width:380px;text-align:right;padding-top:6px;font-size:small;"><input type="button" value="%loc!Paste!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.DoFunctionPaste();">&nbsp;<input type="button" value="%loc!Cancel!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.HideFunctions();"></div></td></tr></table>';var c=document.createElement("div");c.id=l+"dialog",c.style.position="absolute";var d=t.GetViewportInfo(),u=t.GetElementPositionWithScroll(s.spreadsheetDiv);c.style.top=d.height/3-u.top+"px",c.style.left=d.width/3-u.left+"px",c.style.zIndex=100,c.style.backgroundColor="#FFF",c.style.border="1px solid black",c.style.width="400px",o='<table cellspacing="0" cellpadding="0" style="border-bottom:1px solid black;"><tr><td style="font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;">&nbsp;%loc!Function List!</td><td style="font-size:10px;cursor:default;color:#666;" onclick="SocialCalc.SpreadsheetControl.HideFunctions();">&nbsp;X&nbsp;</td></tr></table><div style="background-color:#DDD;">'+o+"</div>",o=t.LocalizeSubstrings(o),c.innerHTML=o,t.DragRegister(c.firstChild.firstChild.firstChild.firstChild,!0,!0,{MouseDown:t.DragFunctionStart,MouseMove:t.DragFunctionPosition,MouseUp:t.DragFunctionPosition,Disabled:null,positionobj:c},s.spreadsheetDiv),s.spreadsheetDiv.appendChild(c),n=document.getElementById(l+"name"),n.focus(),t.CmdGotFocus(n)}},t.SpreadsheetControl.GetFunctionNamesStr=function(e){var o,n,r=t.Formula,i="";for(n=r.FunctionClasses[e],o=0;o<n.items.length;o++)i+='<option value="'+n.items[o]+'"'+(0==o?" selected>":">")+n.items[o]+"</option>";return i},t.SpreadsheetControl.FillFunctionNames=function(e,o){var n,r,i=t.Formula;for(o.length=0,r=i.FunctionClasses[e],n=0;n<r.items.length;n++)o.options[n]=new Option(r.items[n],r.items[n]),0==n&&(o.options[n].selected=!0)},t.SpreadsheetControl.GetFunctionInfoStr=function(e){var o=t.Formula,n=o.FunctionList[e],r=t.special_chars,i="<b>"+e+"("+r(o.FunctionArgString(e))+")</b><br>";return i+=r(n[3])},t.SpreadsheetControl.FunctionClassChosen=function(e){var o=t.GetSpreadsheetControlObject(),n=o.idPrefix+"function",r=t.Formula;t.SpreadsheetControl.FillFunctionNames(e,document.getElementById(n+"name")),t.SpreadsheetControl.FunctionChosen(r.FunctionClasses[e].items[0])},t.SpreadsheetControl.FunctionChosen=function(e){var o=t.GetSpreadsheetControlObject(),n=o.idPrefix+"function";document.getElementById(n+"desc").innerHTML=t.SpreadsheetControl.GetFunctionInfoStr(e)},t.SpreadsheetControl.HideFunctions=function(){var e=t.GetSpreadsheetControlObject(),o=document.getElementById(e.idPrefix+"functiondialog");o.innerHTML="",t.DragUnregister(o),t.KeyboardFocus(),o.parentNode&&o.parentNode.removeChild(o)},t.SpreadsheetControl.DoFunctionPaste=function(){var e=t.GetSpreadsheetControlObject(),o=e.editor,n=document.getElementById(e.idPrefix+"functionname"),r=document.getElementById(e.idPrefix+"multilinetextarea"),i=n.value+"(";t.SpreadsheetControl.HideFunctions(),r?(r.value+=i,r.focus(),t.CmdGotFocus(r)):o.EditorAddToInput(i,"=")},t.SpreadsheetControl.DoMultiline=function(){var e,o,n,r=t.LocalizeSubstrings,i=(t.Constants,t.GetSpreadsheetControlObject()),a=i.editor,s=a.workingvalues,i=t.GetSpreadsheetControlObject(),l=i.idPrefix+"multiline";if(!(o=document.getElementById(l+"dialog"))){switch(a.state){case"start":s.ecoord=a.ecell.coord,s.erow=a.ecell.row,s.ecol=a.ecell.col,a.RangeRemove(),n=t.GetCellContents(a.context.sheetobj,s.ecoord);break;case"input":case"inputboxdirect":n=a.inputBox.GetText()}a.inputBox.element.disabled=!0,n=t.special_chars(n),e='<textarea id="'+l+'textarea" style="width:380px;height:120px;margin:10px 0px 0px 6px;">'+n+'</textarea><div style="width:380px;text-align:right;padding:6px 0px 4px 6px;font-size:small;">'+r('<input type="button" value="%loc!Set Cell Contents!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.DoMultilinePaste();">&nbsp;<input type="button" value="%loc!Clear!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.DoMultilineClear();">&nbsp;<input type="button" value="%loc!Cancel!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.HideMultiline();"></div></div>');var c=document.createElement("div");c.id=l+"dialog",c.style.position="absolute";var d=t.GetViewportInfo(),u=t.GetElementPositionWithScroll(i.spreadsheetDiv);c.style.top=d.height/3-u.top+"px",c.style.left=d.width/3-u.left+"px",c.style.zIndex=100,c.style.backgroundColor="#FFF",c.style.border="1px solid black",c.style.width="400px",c.innerHTML='<table cellspacing="0" cellpadding="0" style="border-bottom:1px solid black;"><tr><td style="font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;">'+r("&nbsp;%loc!Multi-line Input Box!")+'</td><td style="font-size:10px;cursor:default;color:#666;" onclick="SocialCalc.SpreadsheetControl.HideMultiline();">&nbsp;X&nbsp;</td></tr></table><div style="background-color:#DDD;">'+e+"</div>",t.DragRegister(c.firstChild.firstChild.firstChild.firstChild,!0,!0,{MouseDown:t.DragFunctionStart,MouseMove:t.DragFunctionPosition,MouseUp:t.DragFunctionPosition,Disabled:null,positionobj:c},i.spreadsheetDiv),i.spreadsheetDiv.appendChild(c),o=document.getElementById(l+"textarea"),o.focus(),t.CmdGotFocus(o)}},t.SpreadsheetControl.HideMultiline=function(){var e=(t.Constants,t.GetSpreadsheetControlObject()),o=e.editor,n=document.getElementById(e.idPrefix+"multilinedialog");switch(n.innerHTML="",t.DragUnregister(n),t.KeyboardFocus(),n.parentNode&&n.parentNode.removeChild(n),o.state){case"start":o.inputBox.DisplayCellContents(null);break;case"input":case"inputboxdirect":o.inputBox.element.disabled=!1,o.inputBox.Focus()}},t.SpreadsheetControl.DoMultilineClear=function(){var e=t.GetSpreadsheetControlObject(),o=document.getElementById(e.idPrefix+"multilinetextarea");o.value="",o.focus()},t.SpreadsheetControl.DoMultilinePaste=function(){var e=t.GetSpreadsheetControlObject(),o=e.editor,n=o.workingvalues,r=document.getElementById(e.idPrefix+"multilinetextarea"),i=r.value;switch(t.SpreadsheetControl.HideMultiline(),o.state){case"start":n.partialexpr="",n.ecoord=o.ecell.coord,n.erow=o.ecell.row,n.ecol=o.ecell.col;break;case"input":case"inputboxdirect":o.inputBox.Blur(),o.inputBox.ShowInputBox(!1),o.state="start"}o.EditorSaveEdit(i)},t.SpreadsheetControl.DoLink=function(){var e,o,n,r,i,a,s=t.LocalizeString,l=(t.Constants,t.GetSpreadsheetControlObject()),c=l.editor,d=c.workingvalues,l=t.GetSpreadsheetControlObject(),u=l.idPrefix+"link";if(!(o=document.getElementById(u+"dialog"))){switch(c.state){case"start":d.ecoord=c.ecell.coord,d.erow=c.ecell.row,d.ecol=c.ecell.col,c.RangeRemove(),n=t.GetCellContents(c.context.sheetobj,d.ecoord);break;case"input":case"inputboxdirect":n=c.inputBox.GetText()}c.inputBox.element.disabled=!0,"'"==n.charAt(0)&&(n=n.slice(1));var p=t.ParseCellLinkText(n);n=t.special_chars(n),r=l.sheet.cells[c.ecell.coord],i=r&&r.textvalueformat?"":" checked",a=p.newwin?" checked":"",e='<div style="padding:6px 0px 4px 6px;"><span style="font-size:smaller;">'+s("Description")+'</span><br><input type="text" id="'+u+'desc" style="width:380px;" value="'+t.special_chars(p.desc)+'"><br><span style="font-size:smaller;">'+s("URL")+'</span><br><input type="text" id="'+u+'url" style="width:380px;" value="'+t.special_chars(p.url)+'"><br>',t.Callbacks.MakePageLink&&(e+='<span style="font-size:smaller;">'+s("Page Name")+'</span><br><input type="text" id="'+u+'pagename" style="width:380px;" value="'+t.special_chars(p.pagename)+'"><br><span style="font-size:smaller;">'+s("Workspace")+'</span><br><input type="text" id="'+u+'workspace" style="width:380px;" value="'+t.special_chars(p.workspace)+'"><br>'),e+=t.LocalizeSubstrings('<input type="checkbox" id="'+u+'format"'+i+'>&nbsp;<span style="font-size:smaller;">%loc!Set to Link format!</span><br><input type="checkbox" id="'+u+'popup"'+a+'>&nbsp;<span style="font-size:smaller;">%loc!Show in new browser window!</span></div><div style="width:380px;text-align:right;padding:6px 0px 4px 6px;font-size:small;"><input type="button" value="%loc!Set Cell Contents!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.DoLinkPaste();">&nbsp;<input type="button" value="%loc!Clear!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.DoLinkClear();">&nbsp;<input type="button" value="%loc!Cancel!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.HideLink();"></div></div>');var h=document.createElement("div");h.id=u+"dialog",h.style.position="absolute";var f=t.GetViewportInfo(),m=t.GetElementPositionWithScroll(l.spreadsheetDiv);h.style.top=f.height/3-m.top+"px",h.style.left=f.width/3-m.left+"px",h.style.zIndex=100,h.style.backgroundColor="#FFF",h.style.border="1px solid black",h.style.width="400px",h.innerHTML='<table cellspacing="0" cellpadding="0" style="border-bottom:1px solid black;"><tr><td style="font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;">&nbsp;'+s("Link Input Box")+'</td><td style="font-size:10px;cursor:default;color:#666;" onclick="SocialCalc.SpreadsheetControl.HideLink();">&nbsp;X&nbsp;</td></tr></table><div style="background-color:#DDD;">'+e+"</div>",t.DragRegister(h.firstChild.firstChild.firstChild.firstChild,!0,!0,{MouseDown:t.DragFunctionStart,MouseMove:t.DragFunctionPosition,MouseUp:t.DragFunctionPosition,Disabled:null,positionobj:h},l.spreadsheetDiv),l.spreadsheetDiv.appendChild(h),o=document.getElementById(u+"url"),o.focus(),t.CmdGotFocus(o)}},t.SpreadsheetControl.HideLink=function(){var e=(t.Constants,t.GetSpreadsheetControlObject()),o=e.editor,n=document.getElementById(e.idPrefix+"linkdialog");switch(n.innerHTML="",t.DragUnregister(n),t.KeyboardFocus(),n.parentNode&&n.parentNode.removeChild(n),o.state){case"start":o.inputBox.DisplayCellContents(null);break;case"input":case"inputboxdirect":o.inputBox.element.disabled=!1,o.inputBox.Focus()}},t.SpreadsheetControl.DoLinkClear=function(){var e=t.GetSpreadsheetControlObject();document.getElementById(e.idPrefix+"linkdesc").value="",document.getElementById(e.idPrefix+"linkpagename").value="",document.getElementById(e.idPrefix+"linkworkspace").value="";var o=document.getElementById(e.idPrefix+"linkurl");o.value="",o.focus()},t.SpreadsheetControl.DoLinkPaste=function(){var e,o,n,r,i=t.GetSpreadsheetControlObject(),a=i.editor,s=a.workingvalues,l=document.getElementById(i.idPrefix+"linkdesc"),c=document.getElementById(i.idPrefix+"linkurl"),d=document.getElementById(i.idPrefix+"linkpagename"),u=document.getElementById(i.idPrefix+"linkworkspace"),p=document.getElementById(i.idPrefix+"linkformat"),h=document.getElementById(i.idPrefix+"linkpopup"),f="";switch(h.checked?(e="<<",o=">>",n="[[",r="]]"):(e="<",o=">",n="[",r="]"),f=d&&d.value?u.value?l.value+"{"+u.value+n+d.value+r+"}":l.value+n+d.value+r:l.value+e+c.value+o,t.SpreadsheetControl.HideLink(),a.state){case"start":s.partialexpr="",s.ecoord=a.ecell.coord,s.erow=a.ecell.row,s.ecol=a.ecell.col;break;case"input":case"inputboxdirect":a.inputBox.Blur(),a.inputBox.ShowInputBox(!1),a.state="start"}p.checked&&t.SpreadsheetControlExecuteCommand(null,"set %C textvalueformat text-link",""),a.EditorSaveEdit(f)},t.SpreadsheetControl.DoSum=function(){var e,o,n,r,i,a,s,l=t.GetSpreadsheetControlObject(),c=l.editor,d=c.context.sheetobj;if(c.range.hasrange)i=t.crToCoord(c.range.left,c.range.top)+":"+t.crToCoord(c.range.right,c.range.bottom),e="set "+t.crToCoord(c.range.right,c.range.bottom+1)+" formula sum("+i+")";else if(n=c.ecell.row-1,r=c.ecell.col,n<=1)e="set "+c.ecell.coord+" constant e#REF! 0 #REF!";else{for(s=!1;n>0;){if(a=t.crToCoord(r,n),o=d.GetAssuredCell(a),o.datatype&&"t"!=o.datatype)s=!0;else if(s){n++;break}n--}e="set "+c.ecell.coord+" formula sum("+t.crToCoord(r,n)+":"+t.crToCoord(r,c.ecell.row-1)+")"}c.EditorScheduleSheetCommands(e,!0,!1)},t.SpreadsheetControl.FindInSheet=function(){var e=$("#searchstatus"),o=t.GetSpreadsheetControlObject();if(!this.value.length)return e.text(""),o.sheet.search_cells=[],void(o.sheet.selected_search_cell=undefined);var n,r,i=o.sheet.cells,a=new RegExp(this.value,"im"),s=[];for(var l in i){n=i[l];var c=t.coordToCr(l);"yes"!==o.sheet.rowattribs.hide[c.row]&&"yes"!==o.sheet.colattribs.hide[t.rcColname(c.col)]&&((r="c"===n.datatype?n.displaystring:String(n.datavalue))!==undefined&&r.match(a)&&s.push(l))}o.sheet.search_cells=s,s.length?(o.sheet.selected_search_cell=0,o.editor.MoveECell(s[0]),e.text("1 of "+s.length)):(o.sheet.selected_search_cell=undefined,e.text("No Matches"))},t.SpreadsheetControl.SearchSheet=function(e){var o=t.GetSpreadsheetControlObject(),n=o.sheet,r=n.search_cells;if(r.length){var i=n.selected_search_cell;i===(0===e?0:r.length-1)?i=0===e?r.length-1:0:i+=0===e?-1:1;var a=r[i];n.selected_search_cell=i,o.editor.MoveECell(a),document.getElementById("searchstatus").textContent=String(i+1)+" of "+r.length}},t.SpreadsheetControl.SearchUp=function(){t.SpreadsheetControl.SearchSheet(0)},t.SpreadsheetControl.SearchDown=function(){t.SpreadsheetControl.SearchSheet(1)},t.SpreadsheetControlSortOnclick=function(e){var o,n,r=[],i=document.getElementById(e.idPrefix+"sortlist");t.LoadColumnChoosers(e),e.editor.RangeChangeCallback.sort=t.UpdateSortRangeProposal;for(o in e.sheet.names)r.push(o);for(r.sort(),i.length=0,i.options[0]=new Option(t.LocalizeString("[select range]")),i.options[1]=new Option(t.LocalizeString("Sort All"),"all"),n_options=i.options.length,n=0;n<r.length;n++)o=r[n],i.options[n+n_options]=new Option(o,o),o==e.sortrange&&(i.options[n+n_options].selected=!0);""==e.sortrange&&(i.options[0].selected=!0),t.UpdateSortRangeProposal(e.editor),t.KeyboardFocus()},t.SpreadsheetControlSortSave=function(){var e,o,n,r=t.GetSpreadsheetControlObject();return e="sort:"+t.encodeForSave(r.sortrange)+":",o=document.getElementById(r.idPrefix+"majorsort"),n=document.getElementById(r.idPrefix+"majorsortup"),e+=o.selectedIndex+(n.checked?":up":":down"),o=document.getElementById(r.idPrefix+"minorsort"),o.selectedIndex>0?(n=document.getElementById(r.idPrefix+"minorsortup"),e+=":"+o.selectedIndex+(n.checked?":up":":down")):e+="::",o=document.getElementById(r.idPrefix+"lastsort"),o.selectedIndex>0?(n=document.getElementById(r.idPrefix+"lastsortup"),e+=":"+o.selectedIndex+(n.checked?":up":":down")):e+="::",e+"\n"},t.SpreadsheetControlSortLoad=function(e,o,n){var r,i,a=t.GetSpreadsheetControlObject();return r=n.split(":"),a.sortrange=t.decodeFromSave(r[1]),i=document.getElementById(a.idPrefix+"sortbutton"),a.sortrange?(i.value=t.LocalizeString("Sort ")+a.sortrange,i.style.visibility="visible"):i.style.visibility="hidden",t.LoadColumnChoosers(a),sele=document.getElementById(a.idPrefix+"majorsort"),sele.selectedIndex=r[2]-0,document.getElementById(a.idPrefix+"majorsort"+r[3]).checked=!0,sele=document.getElementById(a.idPrefix+"minorsort"),r[4]?(sele.selectedIndex=r[4]-0,document.getElementById(a.idPrefix+"minorsort"+r[5]).checked=!0):(sele.selectedIndex=0,document.getElementById(a.idPrefix+"minorsortup").checked=!0),sele=document.getElementById(a.idPrefix+"lastsort"),r[6]?(sele.selectedIndex=r[6]-0,document.getElementById(a.idPrefix+"lastsort"+r[7]).checked=!0):(sele.selectedIndex=0,document.getElementById(a.idPrefix+"lastsortup").checked=!0),!0},t.SpreadsheetControlCommentOnclick=function(e,o){e.editor.MoveECellCallback.comment=t.SpreadsheetControlCommentMoveECell,t.SpreadsheetControlCommentDisplay(e,o),t.KeyboardFocus()},t.SpreadsheetControlCommentDisplay=function(e){var t=""
;e.editor.ecell&&e.editor.ecell.coord&&e.sheet.cells[e.editor.ecell.coord]&&(t=e.sheet.cells[e.editor.ecell.coord].comment||""),document.getElementById(e.idPrefix+"commenttext").value=t},t.SpreadsheetControlCommentMoveECell=function(){t.SpreadsheetControlCommentDisplay(t.GetSpreadsheetControlObject(),"comment")},t.SpreadsheetControlCommentSet=function(){var e=t.GetSpreadsheetControlObject();e.ExecuteCommand("set %C comment "+t.encodeForSave(document.getElementById(e.idPrefix+"commenttext").value));var o=t.GetEditorCellElement(e.editor,e.editor.ecell.row,e.editor.ecell.col);e.editor.ECellReadonly()||(o.element.title=document.getElementById(e.idPrefix+"commenttext").value,e.editor.UpdateCellCSS(o,e.editor.ecell.row,e.editor.ecell.col)),t.KeyboardFocus()},t.SpreadsheetControlCommentOnunclick=function(e){delete e.editor.MoveECellCallback.comment},t.SpreadsheetControlNamesOnclick=function(e){document.getElementById(e.idPrefix+"namesname").value="",document.getElementById(e.idPrefix+"namesdesc").value="",document.getElementById(e.idPrefix+"namesvalue").value="",e.editor.RangeChangeCallback.names=t.SpreadsheetControlNamesRangeChange,e.editor.MoveECellCallback.names=t.SpreadsheetControlNamesRangeChange,t.SpreadsheetControlNamesRangeChange(e.editor),t.SpreadsheetControlNamesFillNameList(),t.SpreadsheetControlNamesChangedName()},t.SpreadsheetControlNamesFillNameList=function(){var e,o,n=t.LocalizeString,r=[],i=t.GetSpreadsheetControlObject(),a=document.getElementById(i.idPrefix+"nameslist"),s=document.getElementById(i.idPrefix+"namesname").value.toUpperCase().replace(/[^A-Z0-9_\.]/g,"");for(e in i.sheet.names)r.push(e);for(r.sort(),a.length=0,r.length>0?a.options[0]=new Option(n("[New]")):a.options[0]=new Option(n("[None]")),o=0;o<r.length;o++)e=r[o],a.options[o+1]=new Option(e,e),e==s&&(a.options[o+1].selected=!0);""==s&&(a.options[0].selected=!0)},t.SpreadsheetControlNamesChangedName=function(){var e=t.GetSpreadsheetControlObject(),o=document.getElementById(e.idPrefix+"nameslist"),n=o.options[o.selectedIndex].value;e.sheet.names[n]?(document.getElementById(e.idPrefix+"namesname").value=n,document.getElementById(e.idPrefix+"namesdesc").value=e.sheet.names[n].desc||"",document.getElementById(e.idPrefix+"namesvalue").value=e.sheet.names[n].definition||""):(document.getElementById(e.idPrefix+"namesname").value="",document.getElementById(e.idPrefix+"namesdesc").value="",document.getElementById(e.idPrefix+"namesvalue").value="")},t.SpreadsheetControlNamesRangeChange=function(e){var o=t.GetSpreadsheetControlObject(),n=document.getElementById(o.idPrefix+"namesrangeproposal");e.range.hasrange?n.value=t.crToCoord(e.range.left,e.range.top)+":"+t.crToCoord(e.range.right,e.range.bottom):n.value=e.ecell.coord},t.SpreadsheetControlNamesOnunclick=function(e){delete e.editor.RangeChangeCallback.names,delete e.editor.MoveECellCallback.names},t.SpreadsheetControlNamesSetValue=function(){var e=t.GetSpreadsheetControlObject();document.getElementById(e.idPrefix+"namesvalue").value=document.getElementById(e.idPrefix+"namesrangeproposal").value,t.KeyboardFocus()},t.SpreadsheetControlNamesSave=function(){var e=t.GetSpreadsheetControlObject(),o=document.getElementById(e.idPrefix+"namesname").value;t.SetTab(e.tabs[0].name),t.KeyboardFocus(),""!=o&&e.ExecuteCommand("name define "+o+" "+document.getElementById(e.idPrefix+"namesvalue").value+"\nname desc "+o+" "+document.getElementById(e.idPrefix+"namesdesc").value)},t.SpreadsheetControlNamesDelete=function(){var e=t.GetSpreadsheetControlObject(),o=document.getElementById(e.idPrefix+"namesname").value;t.SetTab(e.tabs[0].name),t.KeyboardFocus(),""!=o&&e.ExecuteCommand("name delete "+o),t.KeyboardFocus()},t.SpreadsheetControlClipboardOnclick=function(e){var e=t.GetSpreadsheetControlObject();clipele=document.getElementById(e.idPrefix+"clipboardtext"),document.getElementById(e.idPrefix+"clipboardformat-tab").checked=!0,clipele.value=t.ConvertSaveToOtherFormat(t.Clipboard.clipboard,"tab")},t.SpreadsheetControlClipboardFormat=function(e){var o=t.GetSpreadsheetControlObject();clipele=document.getElementById(o.idPrefix+"clipboardtext"),clipele.value=t.ConvertSaveToOtherFormat(t.Clipboard.clipboard,e)},t.SpreadsheetControlClipboardLoad=function(){var e=t.GetSpreadsheetControlObject(),o="tab";t.SetTab(e.tabs[0].name),t.KeyboardFocus(),document.getElementById(e.idPrefix+"clipboardformat-csv").checked?o="csv":document.getElementById(e.idPrefix+"clipboardformat-scsave").checked&&(o="scsave"),e.editor.pastescclipboard=!0,e.editor.EditorScheduleSheetCommands("loadclipboard "+t.encodeForSave(t.ConvertOtherFormatToSave(document.getElementById(e.idPrefix+"clipboardtext").value,o)),!0,!1)},t.SpreadsheetControlClipboardClear=function(){var e=t.GetSpreadsheetControlObject(),o=document.getElementById(e.idPrefix+"clipboardtext");o.value="",e.editor.EditorScheduleSheetCommands("clearclipboard",!0,!1),o.focus()},t.SpreadsheetControlClipboardExport=function(){var e=t.GetSpreadsheetControlObject();e.ExportCallback&&e.ExportCallback(e),t.SetTab(e.tabs[0].name),t.KeyboardFocus()},t.SpreadsheetControlSettingsSwitch=function(e){t.SettingControlReset();var o=t.GetSpreadsheetControlObject(),n=document.getElementById(o.idPrefix+"sheetsettingstable"),r=document.getElementById(o.idPrefix+"cellsettingstable"),i=document.getElementById(o.idPrefix+"sheetsettingstoolbar"),a=document.getElementById(o.idPrefix+"cellsettingstoolbar");"sheet"==e?(n.style.display="block",r.style.display="none",i.style.display="block",a.style.display="none",t.SettingsControlSetCurrentPanel(o.views.settings.values.sheetspanel)):(n.style.display="none",r.style.display="block",i.style.display="none",a.style.display="block",t.SettingsControlSetCurrentPanel(o.views.settings.values.cellspanel))},t.SettingsControlSave=function(e){var o,n,r=t.GetSpreadsheetControlObject(),i=t.SettingsControls,a=i.CurrentPanel,s=t.SettingsControlUnloadPanel(a);t.SetTab(r.tabs[0].name),t.KeyboardFocus(),"sheet"==e?n=r.sheet.DecodeSheetAttributes(s):"cell"==e&&(r.editor.range.hasrange&&(o=t.crToCoord(r.editor.range.left,r.editor.range.top)+":"+t.crToCoord(r.editor.range.right,r.editor.range.bottom)),n=r.sheet.DecodeCellAttributes(r.editor.ecell.coord,s,o)),n&&r.editor.EditorScheduleSheetCommands(n,!0,!1)},t.SpreadsheetControlCreateSpreadsheetSave=function(e,t){var o,n,r="",i="";if(t)for(o in t)n="\n"!=t[o].charAt(t[o]-1)?"\n":"",r+="--"+e.multipartBoundary+"\nContent-type: text/plain; charset=UTF-8\n\n"+t[o]+n,i+="part:"+o+"\n";return"socialcalc:version:1.0\nMIME-Version: 1.0\nContent-Type: multipart/mixed; boundary="+e.multipartBoundary+"\n--"+e.multipartBoundary+"\nContent-type: text/plain; charset=UTF-8\n\n# SocialCalc Spreadsheet Control Save\nversion:1.0\npart:sheet\npart:edit\npart:audit\n"+i+"--"+e.multipartBoundary+"\nContent-type: text/plain; charset=UTF-8\n\n"+e.CreateSheetSave()+"--"+e.multipartBoundary+"\nContent-type: text/plain; charset=UTF-8\n\n"+e.editor.SaveEditorSettings()+"--"+e.multipartBoundary+"\nContent-type: text/plain; charset=UTF-8\n\n"+e.sheet.CreateAuditString()+r+"--"+e.multipartBoundary+"--\n"},t.SpreadsheetControlDecodeSpreadsheetSave=function(e,t){var o,n,r,i,a,s,l,c,d,u,d,p,h={},f=[];if((o=t.search(/^MIME-Version:\s1\.0/im))<0)return h;if(n=/^Content-Type:\s*multipart\/mixed;\s*boundary=(\S+)/gim,n.lastIndex=o,r=n.exec(t),n.lastIndex<=0)return h;if(i=r[1],a=new RegExp("^--"+i+"(?:\r\n|\n)","mg"),a.lastIndex=n.lastIndex,r=a.exec(t),s=/(?:\r\n|\n)(?:\r\n|\n)/gm,s.lastIndex=a.lastIndex,!(r=s.exec(t)))return h;if(l=s.lastIndex,a.lastIndex=l,!(r=a.exec(t)))return h;for(c=r.index,d=t.substring(l,c).split(/\r\n|\n/),u=0;u<d.length;u++)switch(line=d[u],p=line.split(":"),p[0]){case"version":break;case"part":f.push(p[1])}for(pnum=0;pnum<f.length;pnum++){if(s.lastIndex=c,!(r=s.exec(t)))return h;if(l=s.lastIndex,pnum==f.length-1&&(a=new RegExp("^--"+i+"--$","mg")),a.lastIndex=l,!(r=a.exec(t)))return h;c=r.index,h[f[pnum]]={start:l,end:c}}return h},t.SettingsControls={Controls:{},CurrentPanel:null},t.SettingsControlSetCurrentPanel=function(e){t.SettingsControls.CurrentPanel=e,t.SettingsControls.PopupChangeCallback({panelobj:e},"",null)},t.SettingsControlInitializePanel=function(e){var o,n=t.SettingsControls;for(o in e)"name"!=o&&(ctrl=n.Controls[e[o].type],ctrl&&ctrl.Initialize&&ctrl.Initialize(e,o))},t.SettingsControlLoadPanel=function(e,o){var n,r=t.SettingsControls;for(n in e)"name"!=n&&(ctrl=r.Controls[e[n].type],ctrl&&ctrl.SetValue&&ctrl.SetValue(e,n,o[e[n].setting]))},t.SettingsControlUnloadPanel=function(e){var o,n=t.SettingsControls,r={};for(o in e)"name"!=o&&(ctrl=n.Controls[e[o].type],ctrl&&ctrl.GetValue&&(r[e[o].setting]=ctrl.GetValue(e,o)));return r},t.SettingsControls.PopupChangeCallback=function(e){var o=t.Constants,n=document.getElementById("sample-text");if(n&&e&&e.panelobj){var r,i,a,s,l,c=t.CurrentSpreadsheetControlObject.idPrefix,d="cell"==e.panelobj.name?"c":"";a=o.defaultCellLayout.match(/^padding.(\S+) (\S+) (\S+) (\S+).vertical.align.(\S+);$/)||[];var u={color:["textcolor"],backgroundColor:["bgcolor","#FFF"],fontSize:["fontsize",o.defaultCellFontSize],fontFamily:["fontfamily"],paddingTop:["padtop",a[1]],paddingRight:["padright",a[2]],paddingBottom:["padbottom",a[3]],paddingLeft:["padleft",a[4]],verticalAlign:["alignvert",a[5]]};for(i in u)r=t.Popup.GetValue(c+d+u[i][0])||u[i][1]||"",n.style[i]=r;if("c"==d){u={borderTop:"cbt",borderRight:"cbr",borderBottom:"cbb",borderLeft:"cbl"};for(i in u)r=t.SettingsControls.BorderSideGetValue(e.panelobj,u[i]),n.style[i]=r?r.val||"":"";r=t.Popup.GetValue(c+"calignhoriz"),n.style.textAlign=r||"left",n.childNodes[1].style.textAlign=r||"right"}else n.style.border="",r=t.Popup.GetValue(c+"textalignhoriz"),n.style.textAlign=r||"left",r=t.Popup.GetValue(c+"numberalignhoriz"),n.childNodes[1].style.textAlign=r||"right";r=t.Popup.GetValue(c+d+"fontlook"),a=r?r.match(/^(\S+) (\S+)$/)||[]:[],n.style.fontStyle=a[1]||"",n.style.fontWeight=a[2]||"",r=t.Popup.GetValue(c+d+"formatnumber")||"General",s=t.FormatNumber.formatNumberWithFormat(9.8765,r,""),l=t.FormatNumber.formatNumberWithFormat(-1234.5,r,""),"??-???-??&nbsp;??:??:??"!=l&&(s+="<br>"+l),n.childNodes[1].innerHTML=s}},t.SettingsControls.PopupListSetValue=function(e,o,n){if(!n)return void alert(o+" no value");var r=t.Popup;n.def?r.SetValue(e[o].id,""):r.SetValue(e[o].id,n.val)},t.SettingsControls.PopupListGetValue=function(e,o){var n=e[o];if(!n)return null;var r=t.Popup.GetValue(n.id);return r?{def:!1,val:r}:{def:!0,val:0}},t.SettingsControls.PopupListInitialize=function(e,o){var n,r,i,a,s=t.SettingsControls,l=e[o].initialdata||s.Controls[e[o].type].InitialData||"";l=t.LocalizeSubstrings(l);var c=l.split(/\|/),d=[];for(n=0;n<(c.length||0);n++)r=c[n],i=r.indexOf(":"),a=r.substring(0,i),-1!=a.indexOf("\\")&&(a=a.replace(/\\c/g,":"),a=a.replace(/\\b/g,"\\")),a=t.special_chars(a),d[n]="[custom]"==a?{o:t.Constants.s_PopupListCustom,v:r.substring(i+1),a:{custom:!0}}:"[cancel]"==a?{o:t.Constants.s_PopupListCancel,v:"",a:{cancel:!0}}:"[break]"==a?{o:"-----",v:"",a:{skip:!0}}:"[newcol]"==a?{o:"",v:"",a:{newcol:!0}}:{o:a,v:r.substring(i+1)};t.Popup.Create("List",e[o].id,{}),t.Popup.Initialize(e[o].id,{options:d,attribs:{changedcallback:t.SettingsControls.PopupChangeCallback,panelobj:e}})},t.SettingsControls.PopupListReset=function(){t.Popup.Reset("List")},t.SettingsControls.Controls.PopupList={SetValue:t.SettingsControls.PopupListSetValue,GetValue:t.SettingsControls.PopupListGetValue,Initialize:t.SettingsControls.PopupListInitialize,OnReset:t.SettingsControls.PopupListReset,ChangedCallback:null},t.SettingsControls.ColorChooserSetValue=function(e,o,n){if(!n)return void alert(o+" no value");var r=t.Popup;n.def?r.SetValue(e[o].id,""):r.SetValue(e[o].id,n.val)},t.SettingsControls.ColorChooserGetValue=function(e,o){var n=t.Popup.GetValue(e[o].id);return n?{def:!1,val:n}:{def:!0,val:0}},t.SettingsControls.ColorChooserInitialize=function(e,o){t.SettingsControls;t.Popup.Create("ColorChooser",e[o].id,{}),t.Popup.Initialize(e[o].id,{attribs:{title:"&nbsp;",moveable:!0,width:"106px",changedcallback:t.SettingsControls.PopupChangeCallback,panelobj:e}})},t.SettingsControls.ColorChooserReset=function(){t.Popup.Reset("ColorChooser")},t.SettingsControls.Controls.ColorChooser={SetValue:t.SettingsControls.ColorChooserSetValue,GetValue:t.SettingsControls.ColorChooserGetValue,Initialize:t.SettingsControls.ColorChooserInitialize,OnReset:t.SettingsControls.ColorChooserReset,ChangedCallback:null},t.SettingsControls.BorderSideSetValue=function(e,o,n){var r,i,a,s=(t.SettingsControls,e[o].id);if(!n)return void alert(o+" no value");(r=document.getElementById(s+"-onoff-bcb"))&&(n.val?(r.checked=!0,r.value=n.val,a=n.val.match(/(\S+)\s+(\S+)\s+(\S.+)/),i=s+"-color",t.Popup.SetValue(i,a[3]),t.Popup.SetDisabled(i,!1)):(r.checked=!1,r.value=n.val,i=s+"-color",t.Popup.SetValue(i,""),t.Popup.SetDisabled(i,!0)))},t.SettingsControls.BorderSideGetValue=function(e,o){var n,r,i=(t.SettingsControls,e[o].id);if(n=document.getElementById(i+"-onoff-bcb"))return n.checked?(r=t.Popup.GetValue(i+"-color"),r="1px solid "+(r||"rgb(0,0,0)"),{def:!1,val:r}):{def:!1,val:""}},t.SettingsControls.BorderSideInitialize=function(e,o){var n=(t.SettingsControls,e[o].id);t.Popup.Create("ColorChooser",n+"-color",{}),t.Popup.Initialize(n+"-color",{attribs:{title:"&nbsp;",width:"106px",moveable:!0,changedcallback:t.SettingsControls.PopupChangeCallback,panelobj:e}})},t.SettingsControlOnchangeBorder=function(e){var o=t.SettingsControls,n=o.CurrentPanel,r=e.id.match(/(^.*\-)(\w+)\-(\w+)\-(\w+)$/);if(r){var i=(r[1],r[2]),a=(r[3],r[4]),s=n[i].type;switch(a){case"bcb":e.checked?o.Controls[s].SetValue(o.CurrentPanel,i,{def:!1,val:e.value||"1px solid rgb(0,0,0)"}):o.Controls[s].SetValue(o.CurrentPanel,i,{def:!1,val:""})}}},t.SettingsControls.Controls.BorderSide={SetValue:t.SettingsControls.BorderSideSetValue,GetValue:t.SettingsControls.BorderSideGetValue,OnClick:t.SettingsControls.ColorComboOnClick,Initialize:t.SettingsControls.BorderSideInitialize,InitialData:{thickness:"1 pixel:1px",style:"Solid:solid"},ChangedCallback:null},t.SettingControlReset=function(){var e,o=t.SettingsControls;for(e in o.Controls)o.Controls[e].OnReset&&o.Controls[e].OnReset(e)},t.OtherSaveParts={},t.CtrlSEditor=function(e){var o,n;if(e.length>0)o=t.special_chars(t.OtherSaveParts[e]||"");else{o="Listing of Parts\n";for(n in t.OtherSaveParts)o+=t.special_chars("\nPart: "+n+"\n=====\n"+t.OtherSaveParts[n]+"\n")}var r=document.createElement("div");r.style.cssText="position:absolute;z-index:500;width:300px;height:300px;left:100px;top:200px;border:1px solid black;background-color:#EEE;text-align:center;",r.id="socialcalc-editbox",r.innerHTML=e+'<br><br><textarea id="socialcalc-editbox-textarea" style="width:250px;height:200px;">'+o+"</textarea><br><br><input type=button onclick=\"SocialCalc.CtrlSEditorDone ('socialcalc-editbox', '"+e+'\');" value="OK">',document.body.appendChild(r);var i=document.getElementById("socialcalc-editbox-textarea");i.focus(),t.CmdGotFocus(i)},t.CtrlSEditorDone=function(e,o){var n=document.getElementById(e+"-textarea"),r=n.value;o.length>0&&(r.length>0?t.OtherSaveParts[o]=r:delete t.OtherSaveParts[o]);var i=document.getElementById(e);t.KeyboardFocus(),i.parentNode.removeChild(i)};/*
// The code module of the SocialCalc package that lets you embed a spreadsheet viewer
// with an optional simple toolbar into a web page.
//
// (c) Copyright 2008, 2009, 2010 Socialtext, Inc.
// All Rights Reserved.
//
*/
/*

LEGAL NOTICES REQUIRED BY THE COMMON PUBLIC ATTRIBUTION LICENSE:

EXHIBIT A. Common Public Attribution License Version 1.0.

The contents of this file are subject to the Common Public Attribution License Version 1.0 (the
"License"); you may not use this file except in compliance with the License. You may obtain a copy
of the License at http://socialcalc.org. The License is based on the Mozilla Public License Version 1.1 but
Sections 14 and 15 have been added to cover use of software over a computer network and provide for
limited attribution for the Original Developer. In addition, Exhibit A has been modified to be
consistent with Exhibit B.

Software distributed under the License is distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY
KIND, either express or implied. See the License for the specific language governing rights and
limitations under the License.

The Original Code is SocialCalc JavaScript SpreadsheetViewer.

The Original Developer is the Initial Developer.

The Initial Developer of the Original Code is Socialtext, Inc. All portions of the code written by
Socialtext, Inc., are Copyright (c) Socialtext, Inc. All Rights Reserved.

Contributor: Dan Bricklin.


EXHIBIT B. Attribution Information

When the SpreadsheetViewer is producing and/or controlling the display the Graphic Image must be
displayed on the screen visible to the user in a manner comparable to that in the
Original Code. The Attribution Phrase must be displayed as a "tooltip" or "hover-text" for
that image. The image must be linked to the Attribution URL so as to access that page
when clicked. If the user interface includes a prominent "about" display which includes
factual prominent attribution in a form similar to that in the "about" display included
with the Original Code, including Socialtext copyright notices and URLs, then the image
need not be linked to the Attribution URL but the "tool-tip" is still required.

Attribution Copyright Notice:

 Copyright (C) 2010 Socialtext, Inc.
 All Rights Reserved.

Attribution Phrase (not exceeding 10 words): SocialCalc

Attribution URL: http://www.socialcalc.org/

Graphic Image: The contents of the sc-logo.gif file in the Original Code or
a suitable replacement from http://www.socialcalc.org/licenses specified as
being for SocialCalc.

Display of Attribution Information is required in Larger Works which are defined
in the CPAL as a work which combines Covered Code or portions thereof with code
not governed by the terms of the CPAL.

*/
var t;return t||(alert("Main SocialCalc code module needed"),t={}),t.TableEditor||alert("SocialCalc TableEditor code module needed"),t.CurrentSpreadsheetViewerObject=null,t.SpreadsheetViewer=function(e){var o=t.Constants;this.parentNode=null,this.spreadsheetDiv=null,this.requestedHeight=0,this.requestedWidth=0,this.requestedSpaceBelow=0,this.height=0,this.width=0,this.viewheight=0,this.sheet=null,this.context=null,this.editor=null,this.spreadsheetDiv=null,this.editorDiv=null,this.sortrange="",this.idPrefix=e||"SocialCalc-",this.imagePrefix=o.defaultImagePrefix,this.statuslineheight=o.SVStatuslineheight,this.statuslineCSS=o.SVStatuslineCSS,this.sheet=new t.Sheet,this.context=new t.RenderContext(this.sheet),1!=t._app&&1!=t._view||(o.defaultImagePrefix=this.imagePrefix="../"+this.imagePrefix),1==t._app?(this.context.showGrid=!1,this.context.showRCHeaders=!1,this.context.highlightTypes.range.style="",this.context.sheetobj.cells.A1=new t.Cell("A1"),this.context.sheetobj.cells.A1.displaystring="Loading ... "):(this.context.showGrid=!0,this.context.showRCHeaders=!0),this.editor=new t.TableEditor(this.context),this.editor.noEdit=!0,this.editor.StatusCallback.statusline={func:t.SpreadsheetViewerStatuslineCallback,params:{}},this.hasStatusLine=!0,this.statuslineHTML='<table cellspacing="0" cellpadding="0"><tr><td width="100%" style="overflow:hidden;">{status}</td><td>&nbsp;</td></tr></table>',this.statuslineFull=!0,this.noRecalc=!0,this.repeatingMacroTimer=null,this.repeatingMacroInterval=60,this.repeatingMacroCommands="",t.CurrentSpreadsheetViewerObject=this},t.SpreadsheetViewer.prototype.InitializeSpreadsheetViewer=function(e,o,n,r){return t.InitializeSpreadsheetViewer(this,e,o,n,r)},t.SpreadsheetViewer.prototype.LoadSave=function(e){return t.SpreadsheetViewerLoadSave(this,e)},t.SpreadsheetViewer.prototype.DoOnResize=function(){return t.DoOnResize(this)},t.SpreadsheetViewer.prototype.SizeSSDiv=function(){return t.SizeSSDiv(this)},t.SpreadsheetViewer.prototype.DecodeSpreadsheetSave=function(e){return t.SpreadsheetViewerDecodeSpreadsheetSave(this,e)},t.SpreadsheetViewer.prototype.ParseSheetSave=function(e){return this.sheet.ParseSheetSave(e)},t.InitializeSpreadsheetViewer=function(e,o,n,r,i){var a;t.Constants,t.LocalizeString,t.LocalizeSubstrings,e.tabs,e.views;for(e.requestedHeight=n,e.requestedWidth=r,e.requestedSpaceBelow=i,"string"==typeof o&&(o=document.getElementById(o)),null==o&&alert("SocialCalc.SpreadsheetControl not given parent node."),e.parentNode=o,e.spreadsheetDiv=document.createElement("div"),e.SizeSSDiv(),a=o.firstChild;null!=a;a=o.firstChild)o.removeChild(a);o.appendChild(e.spreadsheetDiv),e.nonviewheight=e.hasStatusLine?e.statuslineheight:0,e.viewheight=e.height-e.nonviewheight,e.editorDiv=e.editor.CreateTableEditor(e.width,e.viewheight),e.spreadsheetDiv.appendChild(e.editorDiv),e.hasStatusLine&&(e.statuslineDiv=document.createElement("div"),e.statuslineDiv.style.cssText=e.statuslineCSS,e.statuslineDiv.style.height=e.statuslineheight-(e.statuslineDiv.style.paddingTop.slice(0,-2)-0)-(e.statuslineDiv.style.paddingBottom.slice(0,-2)-0)+"px",e.statuslineDiv.id=e.idPrefix+"statusline",e.spreadsheetDiv.appendChild(e.statuslineDiv),e.editor.StatusCallback.statusline={func:t.SpreadsheetViewerStatuslineCallback,params:{spreadsheetobj:e}}),1==t._app&&(e.formDataViewer=new t.SpreadsheetViewer("te_FormData-"),e.formDataViewer.sheet.statuscallback=null,t.CurrentSpreadsheetViewerObject=e)},t.SpreadsheetViewerLoadSave=function(o,n){var r,i,a,s,l=o.DecodeSpreadsheetSave(n);l&&(l.sheet&&(o.sheet.ResetSheet(),o.sheet.ParseSheetSave(n.substring(l.sheet.start,l.sheet.end))),l.edit&&o.editor.LoadEditorSettings(n.substring(l.edit.start,l.edit.end)),l.startupmacro&&o.editor.EditorScheduleSheetCommands(n.substring(l.startupmacro.start,l.startupmacro.end),!1,!0),l.repeatingmacro&&(r=n.substring(l.repeatingmacro.start,l.repeatingmacro.end),r=r.replace("\r",""),(i=r.indexOf("\n"))>0&&(a=r.substring(0,i)-0,s=a,o.repeatingMacroInterval=a,o.repeatingMacroCommands=r.substring(i+1),s>0&&(o.repeatingMacroTimer=e.setTimeout(t.SpreadsheetViewerDoRepeatingMacro,1e3*o.repeatingMacroInterval))))),"off"==o.editor.context.sheetobj.attribs.recalc||o.noRecalc?o.editor.ScheduleRender():o.editor.EditorScheduleSheetCommands("recalc")},t.SpreadsheetViewerDoRepeatingMacro=function(){var e=t.GetSpreadsheetViewerObject(),o=e.editor;e.repeatingMacroTimer=null,t.SheetCommandInfo.CmdExtensionCallbacks.repeatmacro={func:t.SpreadsheetViewerRepeatMacroCommand,data:null},o.EditorScheduleSheetCommands(e.repeatingMacroCommands)},t.SpreadsheetViewerRepeatMacroCommand=function(o,n,r,i){var a=t.GetSpreadsheetViewerObject(),s=i.RestOfString(),l=s-0;l>0||(l=a.repeatingMacroInterval),a.repeatingMacroInterval=l,a.repeatingMacroTimer=e.setTimeout(t.SpreadsheetViewerDoRepeatingMacro,1e3*a.repeatingMacroInterval)},t.SpreadsheetViewerStopRepeatingMacro=function(){var o=t.GetSpreadsheetViewerObject();o.repeatingMacroTimer&&(e.clearTimeout(o.repeatingMacroTimer),o.repeatingMacroTimer=null)},t.SpreadsheetViewerDoButtonCmd=function(e,o,n){var r=n.element,i=n.functionobj.command,a=t.GetSpreadsheetViewerObject(),s=a.editor;switch(i){case"recalc":s.EditorScheduleSheetCommands("recalc")}r&&r.blur&&r.blur(),t.KeyboardFocus()},t.LocalizeString=function(e){var o=t.LocalizeStringList[e];return o||(o=t.Constants["s_loc_"+e.toLowerCase().replace(/\s/g,"_").replace(/\W/g,"X")]||e,t.LocalizeStringList[e]=o),o},t.LocalizeStringList={},t.LocalizeSubstrings=function(e){var o=t.LocalizeString;return e.replace(/%(loc|ssc)!(.*?)!/g,function(e,n,r){return"ssc"==n?t.Constants[r]||alert("Missing constant: "+r):o(r)})},t.GetSpreadsheetViewerObject=function(){var e=t.CurrentSpreadsheetViewerObject;if(e)return e;throw"No current SpreadsheetViewer object."},t.DoOnResize=function(e){var o,n=e.views;if(e.SizeSSDiv()){for(vname in n)o=n[vname].element,o.style.width=e.width+"px",o.style.height=e.height-e.nonviewheight+"px";t._app||e.editor.ResizeTableEditor(e.width,e.height-e.nonviewheight)}},t.SizeSSDiv=function(e){var o,n,r,i,a;return r=!1,o=t.GetViewportInfo(),n=t.GetElementPosition(e.parentNode),n.bottom=0,n.right=0,i=e.parentNode.style,i.marginTop&&(n.top+=i.marginTop.slice(0,-2)-0),i.marginBottom&&(n.bottom+=i.marginBottom.slice(0,-2)-0),i.marginLeft&&(n.left+=i.marginLeft.slice(0,-2)-0),i.marginRight&&(n.right+=i.marginRight.slice(0,-2)-0),a=e.requestedHeight||o.height-(n.top+n.bottom+10)-(e.requestedSpaceBelow||0),e.height!=a&&(e.height=a,e.spreadsheetDiv.style.height=a+"px",r=!0),a=e.requestedWidth||o.width-(n.left+n.right+10)||700,e.width!=a&&(e.width=a,e.spreadsheetDiv.style.width=a+"px",r=!0),e.spreadsheetDiv.style.position="relative",r},t.SpreadsheetViewerStatuslineCallback=function(e,t,o,n){var r=n.spreadsheetobj,i="";r&&r.statuslineDiv&&(i=r.statuslineFull?e.GetStatuslineString(t,o,n):e.ecell.coord,i=r.statuslineHTML.replace(/\{status\}/,i),r.statuslineDiv.innerHTML=i)},t.CmdGotFocus=function(e){t.Keyboard.passThru=e},t.SpreadsheetViewerCreateSheetHTML=function(e){var o,n,r,i="";return o=new t.RenderContext(e.sheet),n=document.createElement("div"),r=o.RenderSheet(null,{type:"html"}),n.appendChild(r),delete o,i=n.innerHTML,delete r,delete n,i},t.SpreadsheetViewerDecodeSpreadsheetSave=function(e,t){var o,n,r,i,a,s,l,c,d,u,d,p,h={},f=[];if(/[^\n]\r[^\n]/.test(t)&&(t=t.replace(/([^\n])\r([^\n])/g,"$1\r\n$2")),(o=t.search(/^MIME-Version:\s1\.0/im))<0)return h;if(n=/^Content-Type:\s*multipart\/mixed;\s*boundary=(\S+)/gim,n.lastIndex=o,r=n.exec(t),n.lastIndex<=0)return h;if(i=r[1],a=new RegExp("^--"+i+"(?:\r\n|\n)","mg"),a.lastIndex=n.lastIndex,r=a.exec(t),s=/(?:\r\n|\n)(?:\r\n|\n)/gm,s.lastIndex=a.lastIndex,!(r=s.exec(t)))return h;if(l=s.lastIndex,a.lastIndex=l,!(r=a.exec(t)))return h;for(c=r.index,d=t.substring(l,c).split(/\r\n|\n/),u=0;u<d.length;u++)switch(line=d[u],p=line.split(":"),p[0]){case"version":break;case"part":f.push(p[1])}for(pnum=0;pnum<f.length;pnum++){if(s.lastIndex=c,!(r=s.exec(t)))return h;if(l=s.lastIndex,pnum==f.length-1&&(a=new RegExp("^--"+i+"--$","mg")),a.lastIndex=l,!(r=a.exec(t)))return h;c=r.index,h[f[pnum]]={start:l,end:c}}return h},"undefined"==typeof document&&(t.GetEditorCellElement=function(){},t.ReplaceCell=function(){},t.EditorRenderSheet=function(){},t.SpreadsheetControlSortSave=function(){return""},t.SpreadsheetControlStatuslineCallback=function(){},t.DoPositionCalculations=function(e){t.EditorSheetStatusCallback(null,"doneposcalc",null,e)}),"undefined"!=typeof self&&self.thread&&(e.setTimeout=function(e,t){t<=1&&self.thread.nextTick(e)},e.clearTimeout=function(){}),t}),function(e){e.fn.socialcalc=function(t){return this.each(function(){var o,n,r,i=this;t=t||{};var a=t.form||"#js-spreadsheet-form",s=t.content||"#js-spreadsheet-content",l=t.width||900,c=t.height||500;return n=new SocialCalc.SpreadsheetControl,n.InitializeSpreadsheetControl(i,c,l),o=e(s).val(),n.sheet.ResetSheet(),n.sheet.ParseSheetSave(o),n.sheet.ScheduleSheetCommands("recalc",!1,!1),r=function(t,o){return e.contains(i,o.target)||o.stopPropagation(),!0},e(a+" :submit").click(function(){return n=SocialCalc.GetSpreadsheetControlObject(),o=n.sheet.CreateSheetSave(),e(s).val(o)}),e(a).keydown(function(e){return r("keydown",e)}),e(a).keypress(function(e){return r("keypress",e)}),e(a).keyup(function(e){return r("keyup",e)})})}}(jQuery),$(function(){var e=$("<div />");e.html('<i class="fa fa-chevron-up"></i>'),e.css({position:"fixed",bottom:"20px",right:"25px",width:"40px",height:"40px",color:"#eee","font-size":"","line-height":"40px","text-align":"center","background-color":"#222d32",cursor:"pointer","border-radius":"5px","z-index":"99999",opacity:".7",display:"none"}),e.on("mouseenter",function(){$(this).css("opacity","1")}),e.on("mouseout",function(){$(this).css("opacity",".7")}),$(".wrapper").append(e),$(window).scroll(function(){$(window).scrollTop()>=150?$(e).is(":visible")||$(e).fadeIn(500):$(e).fadeOut(500)}),$(e).click(function(){$("html, body").animate({scrollTop:0},"500")}),$(".sidebar-menu li:not(.treeview) a").click(function(){var e=$(this),t=e.attr("href");"string"==typeof t&&$("body").animate({scrollTop:$(t).offset().top+"px"},500)})});